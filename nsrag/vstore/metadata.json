{"entries": [{"id": "373802b451f69c56396246f83972deeb8c97c1f2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 2, "start_line": 1, "end_line": 9, "text": "NETWORK SECURITY ESSENTIALS : APPLICATIONS AND STANDARDS FOURTH EDITION William Stallings Prentice Hall Boston Columbus Indianapolis New York San Francisco Upper Saddle River Amsterdam Cape Town Dubai London Madrid Milan Munich Paris Montreal Toronto Delhi Mexico City Sao Paulo Sydney Hong Kong Seoul Singapore Taipei Tokyo"}, {"id": "159026f1ba0168cc133a0d926d063703fffe0ff8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 3, "start_line": 1, "end_line": 14, "text": "Vice President and Editorial Director, ECS: Marcia J. Horton Editor in Chief, Computer Science: Michael Hirsch Executive Editor: Tracy Dunkelberger Assistant Editor: Melinda Haggerty Editorial Assistant: Allison MichaelManaging Editor: Scott Disanno Production Manager: Wanda Rockwell Art Director: Jayne Conte Cover Designer: Bruce Kenselaar Cover Art: Shutterstock Art Editor: Greg Dulles Copyright \u00a9 2011 Pearson Education, Inc., publishing as [Prentice Hall, 1 Lake Street, Upper Saddle River, NJ 07458] .All rights reserved. Manufactured in the United States of America.This publication is protected"}, {"id": "b0cf3aff7f93d7b0f3b0d055f550b25483c5ed47", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 3, "start_line": 15, "end_line": 21, "text": "by Copyright, and permission should be obtained from the publisher prior to any prohibited reproduction, storagein a retrieval system, or transmission in any form or by any means, electronic, mechanical, photocopying,recording, or likewise.T o obtain permission(s) to use material from this work, please submit a written request toPearson Education, Inc., Permissions Department, [imprint permissions address]. Many of the designations by manufacturers and seller to distinguish their products are claimed as trademarks. Where those designations appear in this book, and the publisher was aware of a trademark claim, thedesignations have been printed in initial caps or all caps. Library of Congress Cataloging-in-Publication Data 1 0987654321 ISBN 10: 0-13-610805-9 ISBN 13: 978-0-13-610805-4"}, {"id": "50a32484df9cb7218248c2521d2b1efaaa8b20da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 4, "start_line": 1, "end_line": 4, "text": "To Antigone never dull never boring always a Sage"}, {"id": "0c932005b04951500d7c98597497c3aae266b9eb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "This page intentionally left blank"}, {"id": "547fa9c32d664c393874eaf68b79f776e0fa12ec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 6, "start_line": 1, "end_line": 23, "text": "CONTENTS Preface ix About the Author xivChapter 1 Introduction 1 1.1 Computer Security Concepts 3 1.2 The OSI Security Architecture 8 1.3 Security Attacks 9 1.4 Security Services 13 1.5 Security Mechanisms 16 1.6 A Model for Network Security 19 1.7 Standards 21 1.8 Outline of This Book 21 1.9 Recommended Reading 22 1.10 Internet and Web Resources 23 1.11 Key T erms, Review Questions, and Problems 25 PART ONE CRYPTOGRAPHY 27 Chapter 2 Symmetric Encryption and Message Confidentiality 27 2.1 Symmetric Encryption Principles 28 2.2 Symmetric Block Encryption Algorithms 34 2.3 Random and Pseudorandom Numbers 42 2.4 Stream Ciphers and RC4 45 2.5 Cipher Block Modes of Operation 50 2.6 Recommended Reading and Web Sites 55 2.7 Key T erms, Review Questions, and Problems 56"}, {"id": "19130ef52b2c9f37206c45f37551a2f3ac8239cf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 6, "start_line": 24, "end_line": 39, "text": "Chapter 3 Public-Key Cryptography and Message Authentication 61 3.1 Approaches to Message Authentication 62 3.2 Secure Hash Functions 67 3.3 Message Authentication Codes 73 3.4 Public-Key Cryptography Principles 79 3.5 Public-Key Cryptography Algorithms 83 3.6 Digital Signatures 90 3.7 Recommended Reading and Web Sites 90 3.8 Key T erms, Review Questions, and Problems 91 PART TWO NETWORK SECURITY APPLICATIONS 97Chapter 4 Key Distribution and User Authentication 97 4.1 Symmetric Key Distribution Using Symmetric Encryption 98 4.2 Kerberos 99 4.3 Key Distribution Using Asymmetric Encryption 114 4.4 X.509 Certificates 116 4.5 Public-Key Infrastructure 124 v"}, {"id": "87e9af18a3bd3c4eef00b82185d93d7efdacc9cb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 7, "start_line": 1, "end_line": 20, "text": "viCONTENTS 4.6 Federated Identity Management 126 4.7 Recommended Reading and Web Sites 132 4.8 Key T erms, Review Questions, and Problems 133 Chapter 5 Transport-Level Security 139 5.1 Web Security Considerations 140 5.2 Secure Socket Layer and Transport Layer Security 143 5.3 Transport Layer Security 156 5.4 HTTPS 160 5.5 Secure Shell (SSH) 162 5.6 Recommended Reading and Web Sites 173 5.7 Key T erms, Review Questions, and Problems 173 Chapter 6 Wireless Network Security 175 6.1 IEEE 802.11 Wireless LAN Overview 177 6.2 IEEE 802.11i Wireless LAN Security 183 6.3 Wireless Application Protocol Overview 197 6.4 Wireless Transport Layer Security 204 6.5 WAP End-to-End Security 214 6.6 Recommended Reading and Web Sites 217 6.7 Key T erms, Review Questions, and Problems 218"}, {"id": "06cb5188c75ab1811c7d268549cb6418b527564d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 7, "start_line": 21, "end_line": 43, "text": "Chapter 7 Electronic Mail Security 221 7.1 Pretty Good Privacy 222 7.2 S/MIME 241 7.3 DomainKeys Identified Mail 257 7.4 Recommended Reading and Web Sites 264 7.5 Key T erms, Review Questions, and Problems 265 Appendix 7A Radix-64 Conversion 266 Chapter 8 IP Security 269 8.1 IP Security Overview 270 8.2 IP Security Policy 276 8.3 Encapsulating Security Payload 281 8.4 Combining Security Associations 288 8.5 Internet Key Exchange 292 8.6 Cryptographic Suites 301 8.7 Recommended Reading and Web Sites 302 8.8 Key T erms, Review Questions, and Problems 303 PART THREE SYSTEM SECURITY 305 Chapter 9 Intruders 305 9.1 Intruders 307 9.2 Intrusion Detection 312 9.3 Password Management 323 9.4 Recommended Reading and Web Sites 333 9.5 Key T erms, Review Questions, and Problems 334"}, {"id": "be8ae33e21c43d260a43b2775cd58f528de79810", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 7, "start_line": 44, "end_line": 44, "text": "Appendix 9A The Base-Rate Fallacy 337"}, {"id": "6ba0d772465c3bdc1f013f148fccc893ea34e98f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 8, "start_line": 1, "end_line": 23, "text": "CONTENTS vii Chapter 10 Malicious Software 340 10.1 T ypes of Malicious Software 341 10.2 Viruses 346 10.3 Virus Countermeasures 351 10.4 Worms 356 10.5 Distributed Denial of Service Attacks 365 10.6 Recommended Reading and Web Sites 370 10.7 Key T erms, Review Questions, and Problems 371 Chapter 11 Firewalls 374 11.1 The Need for Firewalls 375 11.2 Firewall Characteristics 376 11.3 T ypes of Firewalls 378 11.4 Firewall Basing 385 11.5 Firewall Location and Configurations 388 11.6 Recommended Reading and Web Site 393 11.7 Key T erms, Review Questions, and Problems 394 APPENDICES 398 Appendix A Some Aspects of Number Theory 398 A.1 Prime and Relatively Prime Numbers 399 A.2 Modular Arithmetic 401 Appendix B Projects for Teaching Network Security 403 B.1 Research Projects 404"}, {"id": "4b2c1bc1d0abdc2f8f75e7d9f7878a402b9d84d7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 8, "start_line": 24, "end_line": 43, "text": "B.2 Hacking Project 405 B.3 Programming Projects 405 B.4 Laboratory Exercises 406 B.5 Practical Security Assessments 406 B.6 Writing Assignments 406 B.7 Reading/Report Assignments 407 Index 408 ONLINE CHAPTERS Chapter 12 Network Management Security 12.1 Basic Concepts of SNMP 12.2 SNMPv1 Community Facility 12.3 SNMPv3 12.4 Recommended Reading and Web Sites 12.5 Key T erms, Review Questions, and Problems Chapter 13 Legal and Ethical Aspects 13.1 Cybercrime and Computer Crime 13.2 Intellectual Property 13.3 Privacy 13.4 Ethical Issues 13.5 Recommended Reading and Web Sites"}, {"id": "b9ffe2ee424ecd5bf7260370ef3eb2bcc215bbfc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 9, "start_line": 1, "end_line": 22, "text": "viii CONTENTS 13.6 Key T erms, Review Questions, and Problems ONLINE APPENDICES Appendix C Standards and Standards-Setting Organizations C.1 The Importance of Standards C.2 Internet Standards and the Internet Society C.3 National Institute of Standards and T echnology Appendix D TCP/IP and OSI D.1 Protocols and Protocol Architectures D.2 The TCP/IP Protocol Architecture D.3 The Role of an Internet Protocol D.4 IPv4 D.5 IPv6 D.6 The OSI Protocol Architecture Appendix E Pseudorandom Number Generation E.1 PRNG Requirements E.2 PRNG Using a Block Cipher E.3 PRNG Using a Hash Function or Message Authentication Code Appendix F Kerberos Encryption Techniques F. 1 Password-to-Key Transformation F. 2 Propagating Cipher Block Chaining Mode Appendix G Data Compression Using ZIP"}, {"id": "4bde4108fb5d45fb777d2540c3271c1df90e7577", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 9, "start_line": 23, "end_line": 29, "text": "G.1 Compression Algorithm G.2 Decompression Algorithm Appendix H PGP Random Number Generation H.1 True Random Numbers H.2 Pseudorandom Numbers Appendix I The International Reference Alphabet GlossaryReferences"}, {"id": "db3e51450351b39c2add4e9febc558c5ca9fddb0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 10, "start_line": 1, "end_line": 8, "text": "PREFACE \u201cThe tie, if I might suggest it, sir, a shade more tightly knotted. One aims at the perfect butterfly effect. If you will permit me _\u201d \u201cWhat does it matter, Jeeves, at a time like this? Do you realize that Mr. Little\u2019s domestic happiness is hanging in the scale?\u201d \u201cThere is no time, sir, at which ties do not matter.\u201d \u2014Very Good, Jeeves! P . G. Wodehouse In this age of universal electronic connectivity, of viruses and hackers, of electronic eaves-"}, {"id": "dcdd1eda2029787775c5d417aaac01b071f2061e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 10, "start_line": 9, "end_line": 10, "text": "dropping and electronic fraud, there is indeed no time at which security does not matter.Twotrends have come together to make the topic of this book of vital interest. First, the explosivegrowth in computer systems and their interconnections via networks has increased thedependence of both organizations and individuals on the information stored and communi-cated using these systems. This, in turn, has led to a heightened awareness of the need toprotect data and resources from disclosure, to guarantee the authenticity of data andmessages, and to protect systems from network-based attacks. Second, the disciplines ofcryptography and network security have matured, leading to the development of practical,readily available applications to enforce network security. OBJECTIVES"}, {"id": "189bc333688a6f49462f7dedc1b6b57a8617909b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 10, "start_line": 11, "end_line": 12, "text": "It is the purpose of this book to provide a practical survey of network security applications andstandards. The emphasis is on applications that are widely used on the Internet and for corpo-rate networks, and on standards (especially Internet standards) that have been widely deployed. INTENDED AUDIENCE"}, {"id": "3fd02431b793cb3b1409596a0f3aff4fd11f17f0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 10, "start_line": 13, "end_line": 17, "text": "This book is intended for both an academic and a professional audience. As a textbook, it isintended as a one-semester undergraduate course on network security for computer science,computer engineering, and electrical engineering majors. It covers the material in IAS2Security Mechanisms, a core area in the Information Technology body of knowledge; andNET4 Security, another core area in the Information Technology body of knowledge. Thesesubject areas are part of the Draft ACM/IEEE Computer Society Computing Curricula 2005. The book also serves as a basic reference volume and is suitable for self-study. PLAN OF THE BOOK The book is organized in three parts: Part One. Cryptography: A concise survey of the cryptographic algorithms and protocols"}, {"id": "ef384437436fe12ff7bfafcf1bb7e3d6114ffe22", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 10, "start_line": 18, "end_line": 19, "text": "underlying network security applications, including encryption, hash functions, digitalsignatures, and key exchange. ix"}, {"id": "cfb1b7138771bf2b981ef4660270a41f3ab9a5fd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 11, "start_line": 1, "end_line": 10, "text": "xPREFACE Part Two. Network Security Applications: Covers important network security tools and applications, including Kerberos, X.509v3 certificates, PGP , S/MIME, IP Security, SSL/TLS, SET, and SNMPv3. Part Three. System Security: Looks at system-level security issues, including the threat of and countermeasures for intruders and viruses and the use of firewalls and trusted systems. In addition, this book includes an extensive glossary, a list of frequently used acronyms, and a bibliography. Each chapter includes homework problems, review questions, a list of key words, suggestions for further reading, and recommended Web sites. In addition, a testbank is available to instructors. ONLINE DOCUMENTS FOR STUDENTS"}, {"id": "85eb0ce14200bdbab54d14ee5b98bcd11959fcc9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 11, "start_line": 11, "end_line": 16, "text": "For this new edition, a tremendous amount of original supporting material has been madeavailable online in the following categories. \u2022Online chapters: To limit the size and cost of the book, two chapters of the book are provided in PDF format. This includes a chapter on SNMP security and one on legaland ethical issues. The chapters are listed in this book\u2019s table of contents. \u2022Online appendices: There are numerous interesting topics that support material found in the text but whose inclusion is not warranted in the printed text. Seven online appen-dices cover these topics for the interested student. The appendices are listed in thisbook\u2019s table of contents. \u2022Homework problems and solutions: To aid the student in understanding the material,"}, {"id": "df739e38291c14f6635c7898d24e565d170c1ad6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 11, "start_line": 17, "end_line": 28, "text": "a separate set of homework problems with solutions are provided. These enable thestudents to test their understanding of the text. \u2022Supporting documents: A variety of other useful documents are referenced in the text and provided online. \u2022Key papers: Twenty-Four papers from the professional literature, many hard to find, are provided for further reading. Purchasing this textbook new grants the reader six months of access to this online material. INSTRUCTIONAL SUPPORT MATERIALS To support instructors, the following materials are provided. \u2022Solutions Manual: Solutions to end-of-chapter Review Questions and Problems. \u2022Projects Manual: Suggested project assignments for all of the project categories listed subsequently in this Preface."}, {"id": "c801a04b6491bc9dba7bcd13ef1cc8874b01026a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 11, "start_line": 29, "end_line": 34, "text": "\u2022PowerPoint Slides: A set of slides covering all chapters, suitable for use in lecturing. \u2022PDF Files: Reproductions of all figures and tables from the book. \u2022Test Bank: A chapter-by-chapter set of questions. All of these support materials are available at the Instructor Resource Center (IRC) for this textbook, which can be reached via pearsonhighered.com/stallings or by clicking on the button labeled \u201cBook Info and More Instructor Resources\u201d at this book\u2019s Web siteWilliamStallings.com/Crypto/Crypto5e.html. To gain access to the IRC, please contact your"}, {"id": "f0db475e3b45415f0bb37a04ac4b7c6f29964625", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 12, "start_line": 1, "end_line": 6, "text": "PREFACE xi local Prentice Hall sales representative via pearsonhighered.com/educator/replocator/ requestSalesRep.page or call Prentice Hall Faculty Services at 1-800-526-0485. INTERNET SERVICES FOR INSTRUCTORS AND STUDENTS There is a Web page for this book that provides support for students and instructors. Thepage includes links to other relevant sites, transparency masters of figures and tables in thebook in PDF (Adobe Acrobat) format, and PowerPoint slides. The Web page is atWilliamStallings.com/NetSec/NetSec4e.html . An Internet mailing list has been set up so that instructors using this book can"}, {"id": "a9a0fa47077ca64cde0b4da50c64aec43d7a49ed", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 12, "start_line": 7, "end_line": 9, "text": "exchange information, suggestions, and questions with each other and with the author. Assoon as typos or other errors are discovered, an errata list for this book will be available atWilliamStallings.com. In addition, the Computer Science Student Resource site, atWilliamStallings.com/StudentSupport.html , provides documents, information, and useful links for computer science students and professionals. PROJECTS FOR TEACHING NETWORK SECURITY"}, {"id": "b003ae94014b0107d772e6779d0c60f551f017d9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 12, "start_line": 10, "end_line": 14, "text": "For many instructors, an important component of a network security course is a project orset of projects by which the student gets hands-on experience to reinforce concepts from thetext. This book provides an unparalleled degree of support for including a projects compo-nent in the course. The IRC not only includes guidance on how to assign and structure theprojects, but also includes a set of suggested projects that covers a broad range of topics fromthe text: \u2022Research projects: A series of research assignments that instruct the student to research a particular topic on the Internet and write a report. \u2022Hacking project: This exercise is designed to illuminate the key issues in intrusion detection and prevention."}, {"id": "5c08553b5d91bf8da40ee730e537e7f1891a70c0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 12, "start_line": 15, "end_line": 26, "text": "\u2022Programming projects: A series of programming projects that cover a broad range of topics and that can be implemented in any suitable language on any platform. \u2022Lab exercises: A series of projects that involve programming and experimenting with concepts from the book. \u2022Practical security assessments: A set of exercises to examine current infrastructure and practices of an existing organization. \u2022Writing assignments: A set of suggested writing assignments organized by chapter. \u2022Reading/report assignments: A list of papers in the literature, one for each chapter, that can be assigned for the student to read and then write a short report. See Appendix B for details. WHAT\u2019S NEW IN THE FOURTH EDITION The changes for this new edition of Network Security Essentials are more substantial and"}, {"id": "ca0733f0ffbe89fcc4e562cd8686857cbfb13c11", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 12, "start_line": 27, "end_line": 29, "text": "comprehensive than those for any previous revision. In the four years since the third edition of this book was published, the field has seen continued innovations and improvements. In this fourth edition, I try to capture these"}, {"id": "acd4accb4780e1b507bce65c959f6473706e52c7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 13, "start_line": 1, "end_line": 6, "text": "xiiPREFACE changes while maintaining a broad and comprehensive coverage of the entire field. To begin this process of revision, the third edition was extensively reviewed by a number of professorswho teach the subject. In addition, a number of professionals working in the field reviewedindividual chapters. The result is that, in many places, the narrative has been clarified andtightened, and illustrations have been improved. Also, a large number of new \u201cfield-tested\u201dproblems have been added. Beyond these refinements to improve pedagogy and user friendliness, there have been major substantive changes throughout the book. Highlights include: \u2022Pseudorandom number generation and pseudorandom functions (revised): The treat-"}, {"id": "19540b5f093c5957c5af851e3bc4b65f8d97f3c9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 13, "start_line": 7, "end_line": 13, "text": "ment of this important topic has been expanded, with the addition of new material in Chapter 2 and a new appendix on the subject. \u2022Cryptographic hash functions and message authentication codes (revised): The material on hash functions and MAC has been revised and reorganized to provide a clearer andmore systematic treatment. \u2022Key distribution and remote user authentication (revised): In the third edition, these topics were scattered across three chapters. In the fourth edition, the material is revisedand consolidated into a single chapter to provide a unified, systematic treatment. \u2022Federated identity (new): A new section covers this common identity management scheme across multiple enterprises and numerous applications and supporting manythousands, even millions, of users."}, {"id": "b4ac1ad769a1645cdd85bf0c27b3a2b7b7c24704", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 13, "start_line": 14, "end_line": 22, "text": "\u2022HTTPS (new): A new section covers this protocol for providing secure communication between Web browser and Web server. \u2022Secure Shell (new): SSH, one of the most pervasive applications of encryption tech- nology, is covered in a new section. \u2022DomainKeys Identified Mail (new): A new section covers DKIM, which has become the standard means of authenticating e-mail to counter spam. \u2022Wireless network security (new): A new chapter covers this important area of network security. The chapter deals with the IEEE 802.11 (WiFi) security standard for wirelesslocal area networks and the Wireless Application Protocol (WAP) security standardfor communication between a mobile Web browser and a Web server. \u2022IPsec (revised): The chapter on IPsec has been almost completely rewritten. It now"}, {"id": "f0174426ee51df212bb27742dce90c743fdc14a8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 13, "start_line": 23, "end_line": 32, "text": "covers IPsecv3 and IKEv2. In addition, the presentation has been revised to improveclarity and breadth. \u2022Legal and ethical issues (new): A new online chapter covers these important topics. \u2022Online appendices (new): Six online appendices provide addition breadth and depth for the interested student on a variety of topics. \u2022Homework problems with solutions: A separate set of homework problems (with solu- tions) is provided online for students. \u2022Test bank: A test bank of review questions is available to instructors. This can be used for quizzes or to enable the students to check their understanding of the material. \u2022Firewalls (revised): The chapter on firewalls has been significantly expanded. With each new edition, it is a struggle to maintain a reasonable page count while adding"}, {"id": "d0e5026214ab6315bf7582c3b67d1f66c8373ec8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 13, "start_line": 33, "end_line": 33, "text": "new material. In part, this objective is realized by eliminating obsolete material and tighteningthe narrative. For this edition, chapters and appendices that are of less general interest have"}, {"id": "78a674d361a68a6b23e5772a0bdd73aa50cc389f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 14, "start_line": 1, "end_line": 7, "text": "PREFACE xiii been moved online as individual PDF files. This has allowed an expansion of material without the corresponding increase in size and price. RELATIONSHIP TO CRYPTOGRAPHY AND NETWORK SECURITY This book is adapted from Cryptography and Network Security, Fifth Edition (CNS5e). CNS5e provides a substantial treatment of cryptography, including detailed analysis of algorithms anda significant mathematical component, all of which covers 400 pages. Network Security Essen- tials: Applications and Standards, Fourth Edition (NSE4e) provides instead a concise overview"}, {"id": "1d14f391764970a3f4ddb28db9f1a75d99972192", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 14, "start_line": 8, "end_line": 9, "text": "of these topics in Chapters 2 and 3. NSE4e includes all of the remaining material of CNS5e.NSE4e also covers SNMP security, which is not covered in CNS5e.Thus, NSE4e is intended forcollege courses and professional readers where the interest is primarily in the application ofnetwork security and without the need or desire to delve deeply into cryptographic theory andprinciples. ACKNOWLEDGEMENTS"}, {"id": "dc41492b35b8e2ccbada8ccfcf1584aba9de3b76", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 14, "start_line": 10, "end_line": 11, "text": "This new edition has benefited from review by a number of people who gave generouslytheir time and expertise.The following people reviewed all or a large part of the manuscript:Marius Zimand (Towson State University), Shambhu Upadhyaya (University of Buffalo),Nan Zhang (George Washington University), Dongwan Shin (New Mexico Tech), MichaelKain (Drexel University), William Bard (University of Texas), David Arnold (BaylorUniversity), Edward Allen (Wake Forest University), Michael Goodrich (UC-Irvine),Xunhua Wang (James Madison University), Xianyang Li (Illinois Institute of Technology),and Paul Jenkins (Brigham Young University). Thanks also to the many people who provided detailed technical reviews of one or more"}, {"id": "f5e045400a69367b802c66188b5fe0698a3ff5d9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 14, "start_line": 12, "end_line": 14, "text": "chapters: Martin Bealby, Martin Hlavac (Department of Algebra, Charles University in Prague,Czech Republic), Martin Rublik (BSP Consulting and University of Economics in Bratislava),Rafael Lara (President of Venezuela\u2019s Association for Information Security and CryptographyResearch), Amitabh Saxena, and Michael Spratte (Hewlett-Packard Company). I wouldespecially like to thank Nikhil Bhargava (IIT Delhi) for providing detailed reviews of variouschapters of the book. Nikhil Bhargava (IIT Delhi) developed the set of online homework problems and solutions. Professor Sreekanth Malladi of Dakota State University developed the hackingexercises. Sanjay Rao and Ruben Torres of Purdue developed the laboratory exercises thatappear in the IRC."}, {"id": "1fb074f8e6fdcfb5b31701a701537a61b106e4e2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 14, "start_line": 15, "end_line": 20, "text": "The following people contributed project assignments that appear in the instructor\u2019s supplement: Henning Schulzrinne (Columbia University), Cetin Kaya Koc (Oregon StateUniversity), and David Balenson (Trusted Information Systems and George WashingtonUniversity). Kim McLaughlin developed the test bank. Finally, I would like to thank the many people responsible for the publication of the book, all of whom did their usual excellent job. This includes my editor Tracy Dunkelbergerand her assistants Melinda Hagerty and Allison Michael. Also, Jake Warde of WardePublishers managed the reviews. With all this assistance, little remains for which I can take full credit. However, I am proud to say that, with no help whatsoever, I selected all of the quotations."}, {"id": "205a4e642810483a3f48e5c0270b6d83b1682b67", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 15, "start_line": 1, "end_line": 6, "text": "xivABOUT THE AUTHOR William Stallings has made a unique contribution to understanding the broad sweep of tech- nical developments in computer security, computer networking, and computer architecture.He has authored 17 titles and, counting revised editions, a total of 42 books on various aspectsof these subjects. His writings have appeared in numerous ACM and IEEE publications,including the Proceedings of the IEEE and ACM Computing Reviews. He has 11 times received the award for the best Computer Science textbook of the year from the Text and Academic Authors Association. In over 30 years in the field, he has been a technical contributor, technical manager, and"}, {"id": "d76674cbda7becd23ce4003bf78fa040c12ce839", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 15, "start_line": 7, "end_line": 9, "text": "an executive with several high-technology firms. He has designed and implemented bothTCP/IP-based and OSI-based protocol suites on a variety of computers and operating systems,ranging from microcomputers to mainframes. As a consultant, he has advised governmentagencies, computer and software vendors, and major users on the design, selection, and use ofnetworking software and products. He created and maintains the Computer Science Student Resource Site at WilliamStallings .com/StudentSupport.html. This site provides documents and links on a variety of subjects ofgeneral interest to computer science students (and professionals). He is a member of the editorialboard of Cryptologia, a scholarly journal devoted to all aspects of cryptology."}, {"id": "e1dfdba6fc484ea161a77400aea5ed9df8e2d8e7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 15, "start_line": 10, "end_line": 11, "text": "Dr. Stallings holds a PhD from M.I.T. in Computer Science and a B.S. from Notre Dame in electrical engineering."}, {"id": "9e7c0226bbfdb6052ff2403d5cb6010a7f2af967", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 16, "start_line": 1, "end_line": 18, "text": "INTRODUCTION 1.1 Computer Security Concepts A Definition of Computer Security ExamplesThe Challenges of Computer Security 1.2 The OSI Security Architecture 1.3 Security Attacks Passive AttacksActive Attacks 1.4 Security Services AuthenticationAccess ControlData ConfidentialityData IntegrityNonrepudiationAvailability Service 1.5 Security Mechanisms 1.6 A Model for Network Security 1.7 Standards 1.8 Outline of This Book 1.9 Recommended Reading 1.10 Internet and Web Resources Web Sites for This BookOther Web SitesUSENET Newsgroups 1.11 Key Terms, Review Questions, and ProblemsCHAPTER 1"}, {"id": "2926f411592282dc675a839421a73e8a15b1a3db", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 17, "start_line": 1, "end_line": 7, "text": "2CHAPTER 1 / INTRODUCTION The combination of space, time, and strength that must be considered as the basic elements of this theory of defense makes this a fairly complicated matter. Conse-quently, it is not easy to find a fixed point of departure. \u2014On War,Carl Von Clausewitz The art of war teaches us to rely not on the likelihood of the enemy\u2019s not coming,but on our own readiness to receive him; not on the chance of his not attacking,but rather on the fact that we have made our position unassailable. \u2014The Art of War, Sun Tzu The requirements of information security within an organization have undergone"}, {"id": "a66f241414e2fa737a09b2b58bda4fe2172ff21c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 17, "start_line": 8, "end_line": 9, "text": "two major changes in the last several decades. Before the widespread use of data pro-cessing equipment, the security of information felt to be valuable to an organizationwas provided primarily by physical and administrative means. An example of theformer is the use of rugged filing cabinets with a combination lock for storing sensi-tive documents.An example of the latter is personnel screening procedures used dur-ing the hiring process. With the introduction of the computer, the need for automated tools for"}, {"id": "411476ec21020b421b90caeea18b83f6797382fc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 17, "start_line": 10, "end_line": 12, "text": "protecting files and other information stored on the computer became evident. Thisis especially the case for a shared system, such as a time-sharing system, and theneed is even more acute for systems that can be accessed over a public telephonenetwork, data network, or the Internet. The generic name for the collection of toolsdesigned to protect data and to thwart hackers is computer security . The second major change that affected security is the introduction of distributed systems and the use of networks and communications facilities for carry-ing data between terminal user and computer and between computer and computer.Network security measures are needed to protect data during their transmission. Infact, the term network security is somewhat misleading, because virtually all busi-"}, {"id": "bb326d757a80cbe62dfc09fb1adbb8bcba4c8797", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 17, "start_line": 13, "end_line": 17, "text": "ness, government, and academic organizations interconnect their data processingequipment with a collection of interconnected networks. Such a collection is oftenreferred to as an internet, 1and the term internet security is used. There are no clear boundaries between these two forms of security. For exam- ple, one of the most publicized types of attack on information systems is the com-puter virus.A virus may be introduced into a system physically when it arrives on anoptical disk and is subsequently loaded onto a computer. Viruses may also arriveover an internet. In either case, once the virus is resident on a computer system,internal computer security tools are needed to detect and recover from the virus. This book focuses on internet security, which consists of measures to deter,"}, {"id": "54bac8661398ab60940b75af4107c8ac43742006", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 17, "start_line": 18, "end_line": 21, "text": "prevent, detect, and correct security violations that involve the transmission ofinformation. That is a broad statement that covers a host of possibilities. To giveyou a feel for the areas covered in this book, consider the following examples ofsecurity violations: 1We use the term internet with a lowercase \u201ci\u201d to refer to any interconnected collection of network. A corporate intranet is an example of an internet.The Internet with a capital \u201cI\u201d may be one of the facilities used by an organization to construct its internet."}, {"id": "b3536260c353fce3fcf8f5a8a4e95e30cb402ca8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 18, "start_line": 1, "end_line": 4, "text": "1.1 / COMPUTER SECURITY CONCEPTS 3 1.User A transmits a file to user B. The file contains sensitive information (e.g., payroll records) that is to be protected from disclosure. User C, who is notauthorized to read the file, is able to monitor the transmission and capture acopy of the file during its transmission. 2.A network manager, D, transmits a message to a computer, E, under itsmanagement.The message instructs computer E to update an authorization fileto include the identities of a number of new users who are to be given access tothat computer. User F intercepts the message, alters its contents to add ordelete entries, and then forwards the message to E, which accepts the messageas coming from manager D and updates its authorization file accordingly."}, {"id": "8667eb9c5df13d1664f407c152124df04c7863b3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 18, "start_line": 5, "end_line": 5, "text": "3.Rather than intercept a message, user F constructs its own message with thedesired entries and transmits that message to E as if it had come from managerD. Computer E accepts the message as coming from manager D and updates itsauthorization file accordingly."}, {"id": "48ea671fff0e4f5959256698ed2a025d9788c246", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 18, "start_line": 6, "end_line": 7, "text": "4.An employee is fired without warning. The personnel manager sends a messageto a server system to invalidate the employee\u2019s account.When the invalidation isaccomplished, the server is to post a notice to the employee\u2019s file as confirma-tion of the action. The employee is able to intercept the message and delay itlong enough to make a final access to the server to retrieve sensitive informa-tion. The message is then forwarded, the action taken, and the confirmationposted. The employee\u2019s action may go unnoticed for some considerable time. 5.A message is sent from a customer to a stockbroker with instructions for varioustransactions. Subsequently, the investments lose value and the customer deniessending the message."}, {"id": "3a0273217670825db24228ef1b9956a6e4807545", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 18, "start_line": 8, "end_line": 14, "text": "Although this list by no means exhausts the possible types of security violations, it illus-trates the range of concerns of network security. This chapter provides a general overview of the subject matter that structures the material in the remainder of the book. We begin with a general discussion ofnetwork security services and mechanisms and of the types of attacks they aredesigned for. Then we develop a general overall model within which the securityservices and mechanisms can be viewed. 1.1 COMPUTER SECURITY CONCEPTS A Definition of Computer Security The NIST Computer Security Handbook [NIST95] defines the term computer security as COMPUTER SECURITY"}, {"id": "3eb26e2e4dd1633b3191dd1a572bc458478af0e0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 18, "start_line": 15, "end_line": 15, "text": "The protection afforded to an automated information system in order to attain theapplicable objectives of preserving the integrity, availability, and confidentiality ofinformation system resources (includes hardware, software, firmware, information/data, and telecommunications)."}, {"id": "4fb7f20adb3ac27605ee1ef69b99979153867656", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 19, "start_line": 1, "end_line": 14, "text": "4CHAPTER 1 / INTRODUCTION This definition introduces three key objectives that are at the heart of com- puter security. \u2022Confidentiality: This term covers two related concepts: Data2confidentiality: Assures that private or confidential information is not made available or disclosed to unauthorized individuals. Privacy: Assures that individuals control or influence what information related to them may be collected and stored and by whom and to whom that information may be disclosed. \u2022Integrity: This term covers two related concepts: Data integrity: Assures that information and programs are changed only in a specified and authorized manner. System integrity: Assures that a system performs its intended function in an unimpaired manner, free from deliberate or inadvertent unauthorized"}, {"id": "faa163c42f404370a3c710b7ba9ed1a910f534f1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 19, "start_line": 15, "end_line": 22, "text": "manipulation of the system. \u2022Availability: Assures that systems work promptly and service is not denied to authorized users. These three concepts form what is often referred to as the CIA triad (Figure 1.1). The three concepts embody the fundamental security objectives for both data and for information and computing services. For example, the NIST Standards for Security Categoriz ation of Federal Information and Information Systems (FIPS 199) lists confidentiality, integrity, and availability as the three security objectives for informa-tion and for information systems. FIPS 199 provides a useful characterization of thesethree objectives in terms of requirements and the definition of a loss of security in eachcategory."}, {"id": "01a6735a92e6137f865166e90d83d784b1ac2c44", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 19, "start_line": 23, "end_line": 31, "text": "2RFC 2828 defines information as \u201cfacts and ideas, which can be represented (encoded) as various forms of data,\u201d and data as \u201cinformation in a specific physical representation, usually a sequence of symbols that have meaning; especially a representation of information that can be processed or produced by a computer.\u201d Security literature typically does not make much of a distinction, nor does this book.ConfidentialityData and servicesIntegrity Availability Figure 1.1 The Security Requirements Triad"}, {"id": "731bb8eff51bb1b69bb70072d4a5e0910c6a8b04", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 20, "start_line": 1, "end_line": 9, "text": "1.1 / COMPUTER SECURITY CONCEPTS 5 \u2022Confidentiality: Preserving authorized restrictions on information access and disclosure, including means for protecting personal privacy and propri- etary information. A loss of confidentiality is the unauthorized disclosure ofinformation. \u2022Integrity: Guarding against improper information modification or des- truction, including ensuring information nonrepudiation and authenticity.A loss of integrity is the unauthorized modification or destruction ofinformation. \u2022Availability: Ensuring timely and reliable access to and use of information.A loss of availability is the disruption of access to or use of information or an informa-tion system. Although the use of the CIA triad to define security objectives is well estab-"}, {"id": "519796c0e739d24acc8ec55429920d949b520136", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 20, "start_line": 10, "end_line": 14, "text": "lished, some in the security field feel that additional concepts are needed to present a complete picture. Two of the most commonly mentioned are \u2022Authenticity: The property of being genuine and being able to be verified and trusted; confidence in the validity of a transmission, a message, or messageoriginator. This means verifying that users are who they say they are and thateach input arriving at the system came from a trusted source. \u2022Accountability: The security goal that generates the requirement for actions"}, {"id": "526544dea12568b1c6ebdae7e79cee22652503e2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 20, "start_line": 15, "end_line": 19, "text": "of an entity to be traced uniquely to that entity. This supports nonrepudiation,deterrence, fault isolation, intrusion detection and prevention, and after-actionrecovery and legal action. Because truly secure systems are not yet an achiev-able goal, we must be able to trace a security breach to a responsible party.Systems must keep records of their activities to permit later forensic analysisto trace security breaches or to aid in transaction disputes. Examples We now provide some examples of applications that illustrate the requirements justenumerated. 3For these examples, we use three levels of impact on organizations or individuals should there be a breach of security (i.e., a loss of confidentiality,integrity, or availability). These levels are defined in FIPS 199:"}, {"id": "fbb6f937343dfc1f953d33bd34644dc022778e1c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 20, "start_line": 20, "end_line": 23, "text": "\u2022Low: The loss could be expected to have a limited adverse effect on organiza- tional operations, organizational assets, or individuals.A limited adverse effectmeans that, for example, the loss of confidentiality, integrity, or availabilitymight (i) cause a degradation in mission capability to an extent and durationthat the organization is able to perform its primary functions, but the effec-tiveness of the functions is noticeably reduced; (ii) result in minor damage toorganizational assets; (iii) result in minor financial loss; or (iv) result in minorharm to individuals. 3These examples are taken from a security policy document published by the Information Technology Security and Privacy Office at Purdue University."}, {"id": "977cabf02561a33cdb3b7fb0cb2219b38a18b187", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 21, "start_line": 1, "end_line": 5, "text": "6CHAPTER 1 / INTRODUCTION \u2022Moderate: The loss could be expected to have a serious adverse effect on organizational operations, organizational assets, or individuals. A serious adverse effect means that, for example, the loss might (i) cause a significantdegradation in mission capability to an extent and duration that the organi-zation is able to perform its primary functions, but the effectiveness of thefunctions is significantly reduced; (ii) result in significant damage to organi-zational assets; (iii) result in significant financial loss; or (iv) result in signifi-cant harm to individuals that does not involve loss of life or serious,life-threatening injuries. \u2022High: The loss could be expected to have a severe or catastrophic adverse"}, {"id": "4a079edaba64f991954e6983499e357d6146b406", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 21, "start_line": 6, "end_line": 8, "text": "effect on organizational operations, organizational assets, or individuals. Asevere or catastrophic adverse effect means that, for example, the loss might(i) cause a severe degradation in or loss of mission capability to an extent andduration that the organization is not able to perform one or more of its pri-mary functions; (ii) result in major damage to organizational assets; (iii) resultin major financial loss; or (iv) result in severe or catastrophic harm to individ-uals involving loss of life or serious, life-threatening injuries. C ONFIDENTIALITY Student grade information is an asset whose confidentiality is"}, {"id": "4374a7e11e8747e4545319cf98c8d627a44cc018", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 21, "start_line": 9, "end_line": 10, "text": "considered to be highly important by students. In the United States, the release ofsuch information is regulated by the Family Educational Rights and Privacy Act(FERPA). Grade information should only be available to students, their parents,and employees that require the information to do their job. Student enrollmentinformation may have a moderate confidentiality rating. While still covered byFERPA, this information is seen by more people on a daily basis, is less likely to betargeted than grade information, and results in less damage if disclosed. Directoryinformation (such as lists of students, faculty, or departmental lists) may be assigneda low confidentiality rating or indeed no rating. This information is typically freelyavailable to the public and published on a school\u2019s Web site. I"}, {"id": "c465c04ac2abfe31d3f10a6a8b162de0c3d8b36c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 21, "start_line": 11, "end_line": 14, "text": "NTEGRITY Several aspects of integrity are illustrated by the example of a hospital patient\u2019s allergy information stored in a database. The doctor should be able to trust that the information is correct and current. Now suppose that anemployee (e.g., a nurse) who is authorized to view and update this informationdeliberately falsifies the data to cause harm to the hospital. The database needsto be restored to a trusted basis quickly, and it should be possible to trace theerror back to the person responsible. Patient allergy information is an example ofan asset with a high requirement for integrity. Inaccurate information couldresult in serious harm or death to a patient and expose the hospital to massiveliability. An example of an asset that may be assigned a moderate level of integrity"}, {"id": "2a4499878abeec24bb76a0c38ee77394dc951aef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 21, "start_line": 15, "end_line": 15, "text": "requirement is a Web site that offers a forum to registered users to discuss somespecific topic. Either a registered user or a hacker could falsify some entries ordeface the Web site. If the forum exists only for the enjoyment of the users, brings inlittle or no advertising revenue, and is not used for something important such asresearch, then potential damage is not severe. The Web master may experiencesome data, financial, and time loss."}, {"id": "ff0cd2682ff0bf5c35d2e9f53e3e8414a4db1c4b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 22, "start_line": 1, "end_line": 8, "text": "1.1 / COMPUTER SECURITY CONCEPTS 7 An example of a low-integrity requirement is an anonymous online poll. Many Web sites, such as news organizations, offer these polls to their users with very few safeguards. However, the inaccuracy and unscientific nature of such polls is wellunderstood. A V AILABILITY The more critical a component or service, the higher is the level of availability required. Consider a system that provides authentication services for critical systems, applications, and devices. An interruption of service results in theinability for customers to access computing resources and for the staff to accessthe resources they need to perform critical tasks. The loss of the service translatesinto a large financial loss due to lost employee productivity and potentialcustomer loss."}, {"id": "fa7b18bf7b6a9426badb361b1c5c730173826e23", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 22, "start_line": 9, "end_line": 14, "text": "An example of an asset that typically would be rated as having a moderate availability requirement is a public Web site for a university; the Web site providesinformation for current and prospective students and donors. Such a site is not acritical component of the university\u2019s information system, but its unavailability willcause some embarrassment. An online telephone directory lookup application would be classified as a low- availability requirement. Although the temporary loss of the application may be anannoyance, there are other ways to access the information, such as a hardcopy direc-tory or the operator. The Challenges of Computer Security Computer and network security is both fascinating and complex. Some of the reasonsinclude:"}, {"id": "576961ddd30a148544316b1d7bb641c0166dbbae", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 22, "start_line": 15, "end_line": 16, "text": "1.Security is not as simple as it might first appear to the novice. The require-ments seem to be straightforward; indeed, most of the major requirements forsecurity services can be given self-explanatory, one-word labels: confidential-ity, authentication, nonrepudiation, integrity. But the mechanisms used tomeet those requirements can be quite complex, and understanding them mayinvolve rather subtle reasoning. 2.In developing a particular security mechanism or algorithm, one must alwaysconsider potential attacks on those security features. In many cases, successfulattacks are designed by looking at the problem in a completely different way,therefore exploiting an unexpected weakness in the mechanism."}, {"id": "0c7f85ffb4485c3dd420480b9d17293b00244cd5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 22, "start_line": 17, "end_line": 18, "text": "3.Because of point 2, the procedures used to provide particular services are oftencounterintuitive. Typically, a security mechanism is complex, and it is not obviousfrom the statement of a particular requirement that such elaborate measures areneeded. It is only when the various aspects of the threat are considered that elab-orate security mechanisms make sense. 4.Having designed various security mechanisms, it is necessary to decide where touse them. This is true both in terms of physical placement (e.g., at what points ina network are certain security mechanisms needed) and in a logical sense [e.g., atwhat layer or layers of an architecture such as TCP/IP (Transmission ControlProtocol/Internet Protocol) should mechanisms be placed]."}, {"id": "fc06f9c07a5565694c3c0351e239d4b1da87bddd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 23, "start_line": 1, "end_line": 3, "text": "8CHAPTER 1 / INTRODUCTION 5.Security mechanisms typically involve more than a particular algorithm or protocol. They also require that participants be in possession of some secretinformation (e.g., an encryption key), which raises questions about the cre-ation, distribution, and protection of that secret information. There also maybe a reliance on communications protocols whose behavior may complicatethe task of developing the security mechanism. For example, if the properfunctioning of the security mechanism requires setting time limits on thetransit time of a message from sender to receiver, then any protocol or net-work that introduces variable, unpredictable delays may render such timelimits meaningless."}, {"id": "1cf83cafcf4d55edea3e70cd3a2156e899f43995", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 23, "start_line": 4, "end_line": 7, "text": "6.Computer and network security is essentially a battle of wits between a perpetra-tor who tries to find holes and the designer or administrator who tries to closethem.The great advantage that the attacker has is that he or she need only find asingle weakness, while the designer must find and eliminate all weaknesses toachieve perfect security. 7.There is a natural tendency on the part of users and system managers to perceivelittle benefit from security investment until a security failure occurs. 8.Security requires regular, even constant, monitoring, and this is difficult in today\u2019sshort-term, overloaded environment. 9.Security is still too often an afterthought to be incorporated into a systemafter the design is complete rather than being an integral part of the designprocess."}, {"id": "0131f39c292315bc9ee7ef87a7d53d2967a14d7c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 23, "start_line": 8, "end_line": 12, "text": "10.Many users (and even security administrators) view strong security as animpediment to efficient and user-friendly operation of an information systemor use of information. The difficulties just enumerated will be encountered in numerous ways as we examine the various security threats and mechanisms throughout this book. 1.2 THE OSI SECURITY ARCHITECTURE To assess effectively the security needs of an organization and to evaluate and"}, {"id": "251a3184566c179bcb14f92b7df7f105a7483945", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 23, "start_line": 13, "end_line": 19, "text": "choose various security products and policies, the manager responsible for com-puter and network security needs some systematic way of defining the requirementsfor security and characterizing the approaches to satisfying those requirements.Thisis difficult enough in a centralized data processing environment; with the use oflocal and wide area networks, the problems are compounded. ITU-T 4Recommendation X.800,Security Architecture for OSI,defines such a systematic approach.5The OSI security architecture is useful to managers as a way 4The International Telecommunication Union (ITU) Telecommunication Standardization Sector (ITU-T) is a United Nations-sponsored agency that develops standards, called Recommendations, relating to telecommunications and to open systems interconnection (OSI)."}, {"id": "5bda89b05c307db401789d65595473f4edaf4bc4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 23, "start_line": 20, "end_line": 21, "text": "5The OSI security architecture was developed in the context of the OSI protocol architecture, which is described in Appendix D. However, for our purposes in this chapter, an understanding of the OSI protocolarchitecture is not required."}, {"id": "9cfbe177fab3df3f9cf684ebf67584f54cde22f2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 24, "start_line": 1, "end_line": 8, "text": "1.3 / SECURITY ATTACKS 9 of organizing the task of providing security. Furthermore, because this architecture was developed as an international standard, computer and communications vendorshave developed security features for their products and services that relate to thisstructured definition of services and mechanisms. For our purposes, the OSI security architecture provides a useful, if abstract, overview of many of the concepts that this book deals with. The OSI security archi-tecture focuses on security attacks, mechanisms, and services. These can be definedbriefly as \u2022Security attack: Any action that compromises the security of information owned by an organization. \u2022Security mechanism: A process (or a device incorporating such a process) that"}, {"id": "94eb4d46fa35d3a558c96ffabba0754bc4ae3520", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 24, "start_line": 9, "end_line": 17, "text": "is designed to detect, prevent, or recover from a security attack. \u2022Security service: A processing or communication service that enhances the security of the data processing systems and the information transfers of anorganization. The services are intended to counter security attacks, and theymake use of one or more security mechanisms to provide the service. In the literature, the terms threat and attack are commonly used to mean more or less the same thing. Table 1.1 provides definitions taken from RFC 2828, Internet Security Glossary . 1.3 SECURITY ATTACKS A useful means of classifying security attacks, used both in X.800 and RFC 2828, is in terms of passive attacks and active attacks . A passive attack attempts to learn or"}, {"id": "a2a04304cbca56da5a4ebcb9ef6cdc1c4205e497", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 24, "start_line": 18, "end_line": 23, "text": "make use of information from the system but does not affect system resources. Anactive attack attempts to alter system resources or affect their operation. Passive Attacks Passive attacks are in the nature of eavesdropping on, or monitoring of, transmissions.The goal of the opponent is to obtain information that is being transmitted.Two typesof passive attacks are the release of message contents and traffic analysis.Table 1.1 Threats and Attacks (RFC 2828) Threat A potential for violation of security, which exists when there is a circumstance, capability, action,or event that could breach security and cause harm. That is, a threat is a possible danger that mightexploit a vulnerability. Attack"}, {"id": "7f30986a459b85437f020eb6aad07f2be7b7af81", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 24, "start_line": 24, "end_line": 24, "text": "An assault on system security that derives from an intelligent threat. That is, an intelligent act that is a deliberate attempt (especially in the sense of a method or technique) to evade security services andviolate the security policy of a system."}, {"id": "ad65fd8d8779a1e32ce87434e6333c96912792c6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 25, "start_line": 1, "end_line": 15, "text": "10CHAPTER 1 / INTRODUCTION The release of message contents is easily understood (Figure 1.2a). A tele- phone conversation, an electronic mail message, and a transferred file may contain sensitive or confidential information. We would like to prevent an opponent fromlearning the contents of these transmissions.(a) Release of message contentsBobDarth AliceRead contents of message from Bob to Alice (b) Traffic analysisBobDarth AliceObserve pattern of messages from Bob to AliceInternet or other comms facility Internet or other comms facility Figure 1.2 Passive Network Security Attacks"}, {"id": "4a1e100cc70de7b351d94e6cb497ce728452065f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 26, "start_line": 1, "end_line": 5, "text": "1.3 / SECURITY ATTACKS 11 A second type of passive attack, traffic analysis, is subtler (Figure 1.2b). Suppose that we had a way of masking the contents of messages or other information traffic so that opponents, even if they captured the message,could not extract the information from the message. The common techniquefor masking contents is encryption. If we had encryption protection in place,an opponent still might be able to observe the pattern of these messages. Theopponent could determine the location and identity of communicating hostsand could observe the frequency and length of messages being exchanged.This information might be useful in guessing the nature of the communica-tion that was taking place. Passive attacks are very difficult to detect, because they do not"}, {"id": "771894a451ca896e0a8494e28bcc802c2eea18bd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 26, "start_line": 6, "end_line": 9, "text": "involve any alteration of the data. Typically, the message traffic is sent andreceived in an apparently normal fashion, and neither the sender nor thereceiver is aware that a third party has read the messages or observed thetraffic pattern. However, it is feasible to prevent the success of theseattacks, usually by means of encryption. Thus, the emphasis in dealing withpassive attacks is on prevention rather than detection. Active Attacks Active attacks involve some modification of the data stream or the creationof a false stream and can be subdivided into four categories: masquerade,replay, modification of messages, and denial of service. A masquerade takes place when one entity pretends to be a different"}, {"id": "1170b067da67f06b0f28bebf91dec55922c13576", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 26, "start_line": 10, "end_line": 14, "text": "entity (Figure 1.3a). A masquerade attack usually includes one of the otherforms of active attack. For example, authentication sequences can be cap-tured and replayed after a valid authentication sequence has taken place,thus enabling an authorized entity with few privileges to obtain extra privi-leges by impersonating an entity that has those privileges. Replay involves the passive capture of a data unit and its subsequent retransmission to produce an unauthorized effect (Figure 1.3b). Modification of messages simply means that some portion of a legitimate message is altered, or that messages are delayed or reordered,to produce an unauthorized effect (Figure 1.3c). For example, a messagemeaning \u201cAllow John Smith to read confidential file accounts\u201di s"}, {"id": "d29b4185d84d580fbc006201c895274549402235", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 26, "start_line": 15, "end_line": 19, "text": "modified to mean \u201cAllow Fred Brown to read confidential fileaccounts.\u201d The denial of service prevents or inhibits the normal use or manage- ment of communications facilities (Figure 1.3d). This attack may have aspecific target; for example, an entity may suppress all messages directedto a particular destination (e.g., the security audit service). Another formof service denial is the disruption of an entire network\u2014either by dis-abling the network or by overloading it with messages so as to degradeperformance. Active attacks present the opposite characteristics of passive attacks. Whereas passive attacks are difficult to detect, measures are available to"}, {"id": "a79eedef17823f3fc6df9238fbdf1c80eced77f3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 27, "start_line": 1, "end_line": 13, "text": "12CHAPTER 1 / INTRODUCTION prevent their success. On the other hand, it is quite difficult to prevent active attacks absolutely because of the wide variety of potential physical, software, and networkvulnerabilities. Instead, the goal is to detect active attacks and to recover from any dis-ruption or delays caused by them. If the detection has a deterrent effect, it also maycontribute to prevention. (a) MasqueradeBobDarth Alice AliceMessage from Darth that appears to befrom Bob (b) ReplayBobDarthCapture message fromBob to Alice; later replay message to AliceInternet or other comms facility Internet or other comms facility Figure 1.3 Active Attacks"}, {"id": "38cc1c3b205e996c210bc4dc56613817a00a0b06", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 28, "start_line": 1, "end_line": 14, "text": "1.4 / SECURITY SERVICES 13 (c) Modification of messagesBobDarth AliceDarth modifies message from Bobto Alice (d) Denial of serviceBobDarth ServerDarth disrupts service provided by serverInternet or other comms facility Internet or other comms facility Figure 1.3 Active Attacks ( Continued ) 1.4 SECURITY SERVICES X.800 defines a security service as a service that is provided by a protocol layer of communicating open systems and that ensures adequate security of the systems orof data transfers. Perhaps a clearer definition is found in RFC 2828, which providesthe following definition: A processing or communication service that is provided by"}, {"id": "c7a9bea2439403610aab7307c794fc0c110a7b53", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 29, "start_line": 1, "end_line": 10, "text": "14CHAPTER 1 / INTRODUCTION a system to give a specific kind of protection to system resources; security services implement security policies and are implemented by security mechanisms. X.800 divides these services into five categories and fourteen specific services (Table 1.2). We look at each category in turn.6 6There is no universal agreement about many of the terms used in the security literature. For example, the term integrity is sometimes used to refer to all aspects of information security.The term authentication is sometimes used to refer both to verification of identity and to the various functions listed under integrity in this chapter. Our usage here agrees with both X.800 and RFC 2828.Table 1.2 Security Services (X.800) AUTHENTICATION"}, {"id": "dec31692d024f4a6bad31750b7102f50be979e61", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 29, "start_line": 11, "end_line": 22, "text": "The assurance that the communicating entity is the one that it claims to be. Peer Entity AuthenticationUsed in association with a logical connection toprovide confidence in the identity of the entitiesconnected. Data-Origin Authentication In a connectionless transfer, provides assurance thatthe source of received data is as claimed. ACCESS CONTROL The prevention of unauthorized use of a resource(i.e., this service controls who can have access to aresource, under what conditions access can occur,and what those accessing the resource are allowedto do). DATA CONFIDENTIALITY The protection of data from unauthorizeddisclosure. Connection ConfidentialityThe protection of all user data on a connection. Connectionless Confidentiality The protection of all user data in a single data block."}, {"id": "7924b8d804a2780b5cb3fdffef0fcb7f0e3e0c92", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 29, "start_line": 23, "end_line": 31, "text": "Selective-Field Confidentiality The confidentiality of selected fields within the userdata on a connection or in a single data block. Traffic-Flow Confidentiality The protection of the information that might bederived from observation of traffic flows.DATA INTEGRITY The assurance that data received are exactly assent by an authorized entity (i.e., contain nomodification, insertion, deletion, or replay). Connection Integrity with RecoveryProvides for the integrity of all user data on aconnection and detects any modification, insertion,deletion, or replay of any data within an entire datasequence, with recovery attempted. Connection Integrity without Recovery As above, but provides only detection without recovery. Selective-Field Connection Integrity"}, {"id": "9163a31c5e6ed328f7f3c6ec3a4d2f4c1e27bfba", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 29, "start_line": 32, "end_line": 37, "text": "Provides for the integrity of selected fields within theuser data of a data block transferred over a connec-tion and takes the form of determination of whetherthe selected fields have been modified, inserted,deleted, or replayed. Connectionless Integrity Provides for the integrity of a single connectionlessdata block and may take the form of detection ofdata modification. Additionally, a limited form ofreplay detection may be provided. Selective-Field Connectionless Integrity Provides for the integrity of selected fields within a singleconnectionless data block; takes the form of determina-tion of whether the selected fields have been modified. NONREPUDIATION"}, {"id": "5d9ad363d8cfd2c6809fa8b9b0d32582540a9f8c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 29, "start_line": 38, "end_line": 41, "text": "Provides protection against denial by one of theentities involved in a communication of havingparticipated in all or part of the communication. Nonrepudiation, OriginProof that the message was sent by the specified party. Nonrepudiation, Destination Proof that the message was received by the specifiedparty."}, {"id": "c3134daf4af0a3c3a6c0a6e4203d0fc34ed5488b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 30, "start_line": 1, "end_line": 4, "text": "1.4 / SECURITY SERVICES 15 Authentication The authentication service is concerned with assuring that a communication is authentic. In the case of a single message, such as a warning or alarm signal, the"}, {"id": "04d45ef6354980a810ff0b0e80550192a43938fd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 30, "start_line": 5, "end_line": 7, "text": "function of the authentication service is to assure the recipient that the message isfrom the source that it claims to be from. In the case of an ongoing interaction,such as the connection of a terminal to a host, two aspects are involved. First, atthe time of connection initiation, the service assures that the two entities areauthentic (that is, that each is the entity that it claims to be). Second, the servicemust assure that the connection is not interfered with in such a way that a thirdparty can masquerade as one of the two legitimate parties for the purposes ofunauthorized transmission or reception. Two specific authentication services are defined in X.800: \u2022Peer entity authentication: Provides for the corroboration of the identity of a"}, {"id": "70d43b20b6281f424c834e5802d283b37dd24325", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 30, "start_line": 8, "end_line": 11, "text": "peer entity in an association. Two entities are considered peers if they imple-ment the same protocol in different systems (e.g., two TCP modules in twocommunicating systems). Peer entity authentication is provided for use at theestablishment of or during the data transfer phase of a connection. It attemptsto provide confidence that an entity is not performing either a masquerade oran unauthorized replay of a previous connection. \u2022Data origin authentication: Provides for the corroboration of the source of a data unit. It does not provide protection against the duplication or modificationof data units. This type of service supports applications like electronic mail,where there are no prior interactions between the communicating entities. Access Control"}, {"id": "f72df03d9ec9cf0d74911611f4dbc8978dc9c787", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 30, "start_line": 12, "end_line": 15, "text": "In the context of network security, access control is the ability to limit and control the access to host systems and applications via communications links. To achievethis, each entity trying to gain access must first be identified, or authenticated, sothat access rights can be tailored to the individual. Data Confidentiality Confidentiality is the protection of transmitted data from passive attacks. With"}, {"id": "b44c27d68e51c82a9fee4ea60216100c005ed462", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 30, "start_line": 16, "end_line": 17, "text": "respect to the content of a data transmission, several levels of protection can beidentified.The broadest service protects all user data transmitted between two usersover a period of time. For example, when a TCP connection is set up between twosystems, this broad protection prevents the release of any user data transmitted overthe TCP connection. Narrower forms of this service can also be defined, includingthe protection of a single message or even specific fields within a message. Theserefinements are less useful than the broad approach and may even be more complexand expensive to implement. The other aspect of confidentiality is the protection of traffic flow from"}, {"id": "b5cbd496cc832c0e3b6261cd53df2a15baf21c8d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 30, "start_line": 18, "end_line": 18, "text": "analysis. This requires that an attacker not be able to observe the source and des-tination, frequency, length, or other characteristics of the traffic on a communica-tions facility."}, {"id": "2174df62cd98a9e9e0fe69bba9d2aae7d65a24cd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 31, "start_line": 1, "end_line": 7, "text": "16CHAPTER 1 / INTRODUCTION Data Integrity As with confidentiality, integrity can apply to a stream of messages, a single message, or selected fields within a message. Again, the most useful and straightforward approach is total stream protection. A connection-oriented integrity service deals with a stream of messages and assures that messages are received as sent with no duplication, insertion, mod-ification, reordering, or replays. The destruction of data is also covered under thisservice. Thus, the connection-oriented integrity service addresses both messagestream modification and denial of service. On the other hand, a connectionlessintegrity service deals with individual messages without regard to any larger con-text and generally provides protection against message modification only."}, {"id": "4934e31a88c506f995de429d780d9488e6b72d57", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 31, "start_line": 8, "end_line": 11, "text": "We can make a distinction between service with and without recovery. Because the integrity service relates to active attacks, we are concerned with detection ratherthan prevention. If a violation of integrity is detected, then the service may simply reportthis violation, and some other portion of software or human intervention is required torecover from the violation. Alternatively, there are mechanisms available to recoverfrom the loss of integrity of data, as we will review subsequently. The incorporation ofautomated recovery mechanisms is typically the more attractive alternative. Nonrepudiation Nonrepudiation prevents either sender or receiver from denying a transmitted mes-"}, {"id": "713efd6b4c6df91f762d2f335d1001396678701f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 31, "start_line": 12, "end_line": 14, "text": "sage. Thus, when a message is sent, the receiver can prove that the alleged sender infact sent the message. Similarly, when a message is received, the sender can provethat the alleged receiver in fact received the message. Availability Service Both X.800 and RFC 2828 define availability to be the property of a system or a sys-"}, {"id": "96c3ea87a130422d25ad3a1315cfaa2de0ec4efd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 31, "start_line": 15, "end_line": 16, "text": "tem resource being accessible and usable upon demand by an authorized systementity, according to performance specifications for the system (i.e., a system is avail-able if it provides services according to the system design whenever users requestthem). A variety of attacks can result in the loss of or reduction in availability. Someof these attacks are amenable to automated countermeasures, such as authentica-tion and encryption, whereas others require some sort of physical action to preventor recover from loss of availability of elements of a distributed system. X.800 treats availability as a property to be associated with various security"}, {"id": "de4e75679f0bf7de4f298f16f4f1ba716502d53f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 31, "start_line": 17, "end_line": 19, "text": "services. However, it makes sense to call out specifically an availability service. Anavailability service is one that protects a system to ensure its availability.This serviceaddresses the security concerns raised by denial-of-service attacks. It depends onproper management and control of system resources and thus depends on accesscontrol service and other security services. 1.5 SECURITY MECHANISMS Table 1.3 lists the security mechanisms defined in X.800.The mechanisms are divided intothose that are implemented in a specific protocol layer, such as TCP or an application-layer protocol, and those that are not specific to any particular protocol layer or security"}, {"id": "d752b1340dd8cb59188817d73985f4062d2f2a77", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 32, "start_line": 1, "end_line": 11, "text": "1.5 / SECURITY MECHANISMS 17 Table 1.3 Security Mechanisms (X.800) SPECIFIC SECURITY MECHANISMS May be incorporated into the appropriate protocol layer in order to provide some of the OSI securityservices. EnciphermentThe use of mathematical algorithms to transformdata into a form that is not readily intelligible. Thetransformation and subsequent recovery of thedata depend on an algorithm and zero or moreencryption keys. Digital Signature Data appended to, or a cryptographic transformationof, a data unit that allows a recipient of the data unitto prove the source and integrity of the data unit andprotect against forgery (e.g., by the recipient). Access Control A variety of mechanisms that enforce access rights toresources. Data Integrity"}, {"id": "c45c644920de36986d3491fc034f265110004a42", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 32, "start_line": 12, "end_line": 21, "text": "A variety of mechanisms used to assure the integrityof a data unit or stream of data units. Authentication Exchange A mechanism intended to ensure the identity of anentity by means of information exchange. Traffic Padding The insertion of bits into gaps in a data stream tofrustrate traffic analysis attempts. Routing Control Enables selection of particular physically secureroutes for certain data and allows routing changes,especially when a breach of security is suspected. Notarization The use of a trusted third party to assure certainproperties of a data exchange.PERVASIVE SECURITY MECHANISMS Mechanisms that are not specific to any particularOSI security service or protocol layer."}, {"id": "c098dc855d2e3f894b69d7acf357811e337a9e4d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 32, "start_line": 22, "end_line": 31, "text": "Trusted FunctionalityThat which is perceived to be correct with respect tosome criteria (e.g., as established by a security policy). Security Label The marking bound to a resource (which may be adata unit) that names or designates the securityattributes of that resource. Event Detection Detection of security-relevant events. Security Audit Trail Data collected and potentially used to facilitate asecurity audit, which is an independent review andexamination of system records and activities. Security Recovery Deals with requests from mechanisms, such as eventhandling and management functions, and takesrecovery actions. service.These mechanisms will be covered in the appropriate places in the book, so we do"}, {"id": "5d894147f1c0487eebe4ac730e6caeb72b427065", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 32, "start_line": 32, "end_line": 34, "text": "not elaborate now except to comment on the definition of encipherment. X.800 distin-guishes between reversible encipherment mechanisms and irreversible enciphermentmechanisms. A reversible encipherment mechanism is simply an encryption algorithmthat allows data to be encrypted and subsequently decrypted. Irreversible enciphermentmechanisms include hash algorithms and message authentication codes, which are used indigital signature and message authentication applications. Table 1.4, based on one in X.800, indicates the relationship between security services and security mechanisms."}, {"id": "54c56b66041fef9cb4fb8cdad1f0f663d4d18df3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 33, "start_line": 1, "end_line": 18, "text": "Table 1.4 Relationship Between Security Services and Mechanisms Mechanism Service EnciphermentDigital SignatureAccess ControlData IntegrityAuthentication ExchangeTraffic PaddingRouting Control Notarization Peer Entity Authentication Y Y Y Data-Origin Authentication Y Y Access Control Y Confidentiality Y Y Traffic-Flow Confidentiality Y Y Y Data Integrity Y Y Y Nonrepudiation Y Y Y Availability Y Y 18"}, {"id": "fde8cc9157796578317a8653cc6291af17940879", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 34, "start_line": 1, "end_line": 6, "text": "1.6 A MODEL FOR NETWORK SECURITY A model for much of what we will be discussing is captured, in very general terms, in Figure 1.4. A message is to be transferred from one party to anotheracross some sort of Internet service.The two parties, who are the principals in this transaction, must cooperate for the exchange to take place. A logical informationchannel is established by defining a route through the Internet from source todestination and by the cooperative use of communication protocols (e.g.,TCP/IP) by the two principals. Security aspects come into play when it is necessary or desirable to protect the information transmission from an opponent who may present a threat toconfidentiality, authenticity, and so on. All of the techniques for providing securityhave two components:"}, {"id": "bd28eefb27079406323453acbe785c890cacc512", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 34, "start_line": 7, "end_line": 24, "text": "1.A security-related transformation on the information to be sent. Examplesinclude the encryption of the message, which scrambles the message so thatit is unreadable by the opponent, and the addition of a code based on thecontents of the message, which can be used to verify the identity of thesender. 2.Some secret information shared by the two principals and, it is hoped, unknownto the opponent. An example is an encryption key used in conjunction with thetransformation to scramble the message before transmission and unscramble iton reception. 7 Information channelSecurity-related transformationSender Secret informationMessage MessageSecure message Secure messageRecipient OpponentTrusted third party (e.g., arbiter, distributer of secret information) Security-related transformation Secret"}, {"id": "3f27dc1c32fa9b2aec82b7881c6e35082e06ef35", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 34, "start_line": 25, "end_line": 28, "text": "information Figure 1.4 Model for Network Security 7Chapter 3 discusses a form of encryption, known as asymmetric encryption, in which only one of the two principals needs to have the secret information.1.6 / A MODEL FOR NETWORK SECURITY 19"}, {"id": "19d96294d1cc76bb517c22b6be85c3e7f21d4ada", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 35, "start_line": 1, "end_line": 9, "text": "20CHAPTER 1 / INTRODUCTION A trusted third party may be needed to achieve secure transmission. For example, a third party may be responsible for distributing the secret information to the two principals while keeping it from any opponent. Or a third party may beneeded to arbitrate disputes between the two principals concerning the authenticityof a message transmission. This general model shows that there are four basic tasks in designing a particular security service: 1.Design an algorithm for performing the security-related transformation. Thealgorithm should be such that an opponent cannot defeat its purpose. 2.Generate the secret information to be used with the algorithm. 3.Develop methods for the distribution and sharing of the secret information."}, {"id": "def90b78244b9000ec16758dcb67cbabfaeb11af", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 35, "start_line": 10, "end_line": 12, "text": "4.Specify a protocol to be used by the two principals that makes use of the securityalgorithm and the secret information to achieve a particular security service. Parts One and Two of this book concentrate on the types of security mechanisms and services that fit into the model shown in Figure 1.4. However, there are other"}, {"id": "bf1b3f699418f1a7dbe5e7421aa1b931de26fe1f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 35, "start_line": 13, "end_line": 13, "text": "security-related situations of interest that do not neatly fit this model but are consid-ered in this book. A general model of these other situations is illustrated by Figure 1.5,which reflects a concern for protecting an information system from unwanted access.Most readers are familiar with the concerns caused by the existence of hackers whoattempt to penetrate systems that can be accessed over a network. The hacker can besomeone who, with no malign intent, simply gets satisfaction from breaking and enter-ing a computer system. The intruder can be a disgruntled employee who wishes to dodamage or a criminal who seeks to exploit computer assets for financial gain (e.g.,obtaining credit card numbers or performing illegal money transfers)."}, {"id": "4f610341e6a71a6e3f807ed21fef95887a59b652", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 35, "start_line": 14, "end_line": 30, "text": "Another type of unwanted access is the placement in a computer system of logic that exploits vulnerabilities in the system and that can affect application pro-grams as well as utility programs, such as editors and compilers. Programs can pre-sent two kinds of threats: 1.Information access threats: Intercept or modify data on behalf of users who should not have access to that data. 2.Service threats: Exploit service flaws in computers to inhibit use by legitimate users. Computing resources (processor, memory, I/O) DataProcessesSoftware Internal security controlsInformation System Gatekeeper functionOpponent \u2014 human (e.g., hacker) \u2014 software (e.g., virus, worm) Access Channel Figure 1.5 Network Access Security Model"}, {"id": "9ae2e93199dc93c19f9c7898575dc36f19203959", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 36, "start_line": 1, "end_line": 5, "text": "1.8 / OUTLINE OF THIS BOOK 21 Viruses and worms are two examples of software attacks. Such attacks can be introduced into a system by means of a disk that contains the unwanted logic con- cealed in otherwise useful software. They also can be inserted into a system across anetwork; this latter mechanism is of more concern in network security. The security mechanisms needed to cope with unwanted access fall into two"}, {"id": "cd4914ec578e7086e832e67dff1437f415c7afc2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 36, "start_line": 6, "end_line": 7, "text": "broad categories (see Figure 1.5). The first category might be termed a gatekeeperfunction. It includes password-based login procedures that are designed to denyaccess to all but authorized users and screening logic that is designed to detect andreject worms, viruses, and other similar attacks. Once either an unwanted user orunwanted software gains access, the second line of defense consists of a variety ofinternal controls that monitor activity and analyze stored information in an attempt todetect the presence of unwanted intruders. These issues are explored in Part Three. 1.7 STANDARDS"}, {"id": "f89f274cc168601dc96938ee03c2b7c7b918901a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 36, "start_line": 8, "end_line": 9, "text": "Many of the security techniques and applications described in this book have beenspecified as standards. Additionally, standards have been developed to cover man-agement practices and the overall architecture of security mechanisms and services.Throughout this book, we describe the most important standards in use or beingdeveloped for various aspects of cryptography and network security.Various organi-zations have been involved in the development or promotion of these standards.The most important (in the current context) of these organizations are as follows. \u2022National Institute of Standards and Technology: NIST is a U.S. federal agency"}, {"id": "e2d0fc23f3fb2bf2d4f45ee46e56e228c53ce154", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 36, "start_line": 10, "end_line": 12, "text": "that deals with measurement science, standards, and technology related toU.S. government use and to the promotion of U.S. private-sector innovation.Despite its national scope, NIST Federal Information Processing Standards (FIPS) and Special Publications (SP) have a worldwide impact. \u2022Internet Society: ISOC is a professional membership society with worldwide"}, {"id": "872795ab2bb5b6dcff2279236dbe2048464adf37", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 36, "start_line": 13, "end_line": 16, "text": "organizational and individual membership. It provides leadership in address-ing issues that confront the future of the Internet and is the organization homefor the groups responsible for Internet infrastructure standards, including theInternet Engineering Task Force (IETF) and the Internet Architecture Board(IAB). These organizations develop Internet standards and related specifica-tions, all of which are published as Requests for Comments (RFCs) . A more detailed discussion of these organizations is contained in Appendix C. 1.8 OUTLINE OF THIS BOOK This chapter serves as an introduction to the entire book.The remainder of the bookis organized into three parts."}, {"id": "b8f24722aef2e1e6e40ed7446ce38355fc2be792", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 36, "start_line": 17, "end_line": 17, "text": "Part One: Provides a concise survey of the cryptographic algorithms and proto-cols underlying network security applications, including encryption,hash functions, and digital signatures."}, {"id": "089d50b470e39522f5a58356fc5030fc9635f98a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 37, "start_line": 1, "end_line": 8, "text": "22CHAPTER 1 / INTRODUCTION Part Two: Examines the use of cryptographic algorithms and security proto- cols to provide security over networks and the Internet.Topics cov-ered include key management, user authentication, transport-levelsecurity, wireless network security, e-mail security, and IP security. Part Three: Deals with security facilities designed to protect a computer sys-tem from security threats, including intruders, viruses, and worms.This part also looks at firewall technology. In addition, two online chapters cover network management security and legal and ethical issues. 1.9 RECOMMENDED READING [STAL08] provides a broad introduction to computer security. [SCHN00] is valuable reading"}, {"id": "2c249b3afba064333a9636198422cc468f6ee392", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 37, "start_line": 9, "end_line": 11, "text": "for any practitioner in the field of computer or network security: It discusses the limitations oftechnology (and cryptography in particular) in providing security and the need to considerthe hardware, the software implementation, the networks, and the people involved in provid-ing and attacking security. It is useful to read some of the classic tutorial papers on computer security; these provide a historical perspective from which to appreciate current work and thinking. The papers to readare [WARE79], [BROW72], [SALT75], [SHAN77], and [SUMM84]. Two more recent, shorttreatments of computer security are [ANDR04] and [LAMP04]. [NIST95] is an exhaustive (290pages) treatment of the subject. Another good treatment is [NRC91]. Also useful is [FRAS97]."}, {"id": "ddc1aec31266fa8de9804737fe594e02c984692e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 37, "start_line": 12, "end_line": 22, "text": "ANDR04 Andrews, M., and Whittaker, J. \u201cComputer Security.\u201d IEEE Security and Privacy, September/October 2004. BROW72 Browne, P . \u201cComputer Security \u2014 A Survey.\u201d ACM SIGMIS Database, Fall 1972. FRAS97 Fraser, B. Site Security Handbook. RFC 2196, September 1997. LAMP04 Lampson, B. \u201cComputer Security in the Real World.\u201d Computer , June 2004. NIST95 National Institute of Standards and Technology. An Introduction to Computer Security: The NIST Handbook. Special Publication 800\u201312. October 1995. NRC91 National Research Council. Computers at Risk: Safe Computing in the Information Age. Washington, D.C.: National Academy Press, 1991. SALT75 Saltzer, J., and Schroeder, M. \u201cThe Protection of Information in Computer Systems.\u201d Proceedings of the IEEE , September 1975."}, {"id": "73ed34094b21dd30248c07313b977213906a4316", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 37, "start_line": 23, "end_line": 32, "text": "SCHN00 Schneier, B. Secrets and Lies: Digital Security in a Networked World. New York: Wiley 2000. SHAN77 Shanker, K. \u201cThe Total Computer Security Problem: An Overview.\u201d Computer , June 1977. STAL08 Stallings, W., and Brown, L. Computer Security. Upper Saddle River, NJ: Prentice Hall, 2008. SUMM84 Summers, R. \u201cAn Overview of Computer Security.\u201d IBM Systems J ournal , Vol. 23, No. 4, 1984. WARE79 Ware, W., ed. Security Controls for Computer Systems. RAND Report 609\u20131. October 1979. http://www.rand.org/pubs/reports/R609-1/R609.1.html"}, {"id": "08541e5bb0e928a1cd8058ec96e5169159299e65", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 38, "start_line": 1, "end_line": 11, "text": "1.10 / INTERNET AND WEB RESOURCES 23 1.10 INTERNET AND WEB RESOURCES There are a number of resources available on the Internet and the Web to support this book and to help one keep up with developments in this field. Web Sites for This Book There is a Web page for this book at WilliamStallings.com/NetSec/NetSec4e.html . The site includes the following: \u2022Useful Web sites: There are links to other relevant Web sites organized by chapter, including the sites listed in this section and throughout this book. \u2022Online documents: Link to the Companion Website at Pearson that includes supple- mental online chapters and appendices, homework problems and solutions, impor-tant papers from the literature, and other supporting documents. See Preface fordetails."}, {"id": "d8537311c1603cca1a03998ad08eaab0abc3cbe9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 38, "start_line": 12, "end_line": 21, "text": "\u2022Errata sheet: An errata list for this book will be maintained and updated as needed. Please e-mail any errors that you spot to me. Errata sheets for my other books are atWilliamStallings.com . \u2022Internet mailing list: The site includes sign-up information for the book\u2019s Internet mail- ing list. \u2022Network security courses: There are links to home pages for courses based on this book; these pages may be useful to instructors in providing ideas about how to struc-ture their course. I also maintain the Computer Science Student Resource Site at WilliamStallings.com/ StudentSupport.html .The purpose of this site is to provide documents, information, and links for computer science students and professionals. Links and documents are organized into six categories:"}, {"id": "1e066ce9e82ca5af4f8ba73312c23bad6b0b82f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 38, "start_line": 22, "end_line": 32, "text": "\u2022Math: Includes a basic math refresher, a queuing analysis primer, a number system primer, and links to numerous math sites. \u2022How-to: Advice and guidance for solving homework problems, writing technical reports, and preparing technical presentations. \u2022Research resources: Links to important collections of papers, technical reports, and bibliographies. \u2022Computer science careers: Useful links and documents for those considering a career in computer science. \u2022Miscellaneous: A variety of other interesting documents and links. \u2022Humor and other diversions: You have to take your mind off your work once in a while."}, {"id": "4d8f0f8c49b35b41d55e8e433c94d4c8ba15a94d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 39, "start_line": 1, "end_line": 8, "text": "24CHAPTER 1 / INTRODUCTION Other Web Sites There are numerous Web sites that provide information related to the topics of this book. In subsequent chapters, pointers to specific Web sites can be found in theRecommended Reading and Web Sites section. Because the addresses for Web sites tend to change frequently, I have not included URLs in the book. For all of the Web siteslisted in the book, the appropriate link can be found at this book\u2019s Web site. Other linksnot mentioned in this book will be added to the Web site over time. The following Web sites are of general interest related to cryptography and network security. \u2022IETF Security Area: Material related to Internet security standardization efforts. \u2022Computer and Network Security Reference Index: A good index to vendor and"}, {"id": "b3631f67d7d92e98ade9d825376dc95bc8ecfc58", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 39, "start_line": 9, "end_line": 19, "text": "commercial products, frequently asked questions (FAQs), newsgroup archives,papers, and other Web sites. \u2022The Cryptography FAQ: Lengthy and worthwhile FAQ covering all aspects of cryptography. \u2022Tom Dunigan\u2019s Security Page: An excellent list of pointers to cryptography and network security Web sites. \u2022Helger Lipmaa\u2019s Cryptology Pointers: Another excellent list of pointers to cryptography and network security Web sites. \u2022IEEE Technical Committee on Security and Privacy: Copies of their newsletter and information on IEEE-related activities. \u2022Computer Security Resource Center: Maintained by the National Institute of Standards and Technology (NIST); contains a broad range of information on securitythreats, technology, and standards."}, {"id": "33df5f59a683f6e015b49c71712250ce9131aa48", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 39, "start_line": 20, "end_line": 27, "text": "\u2022Security Focus: A wide variety of security information with an emphasis on vendor products and end-user concerns. \u2022SANS Institute: Similar to Security Focus. Extensive collection of white papers. \u2022Center for Internet Security: Provides freeware benchmark and scoring tools for eval- uating security of operating systems, network devices, and applications. Includes casestudies and technical papers. \u2022Institute for Security and Open Methodologies: An open, collaborative security research community. Lots of interesting information. USENET Newsgroups"}, {"id": "0ba1ba228642679d8df38f929e338a4cfb199599", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 39, "start_line": 28, "end_line": 30, "text": "A number of USENET newsgroups are devoted to some aspect of network security or cryp-tography. As with virtually all USENET groups, there is a high noise-to-signal ratio, but it isworth experimenting to see if any meet your needs. The most relevant are the following: \u2022sci.crypt.research: The best group to follow. This is a moderated newsgroup that deals with research topics; postings must have some relationship to the technical aspects ofcryptology."}, {"id": "9427379267706699cb5fd72dd35b6034fc383ce9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 40, "start_line": 1, "end_line": 11, "text": "1.11 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 25 \u2022sci.crypt: A general discussion of cryptology and related topics. \u2022sci.crypt.random-numbers: A discussion of cryptographic strength randomness. \u2022alt.security: A general discussion of security topics. \u2022comp.security.misc: A general discussion of computer security topics. \u2022comp.security.firewalls: A discussion of firewall products and technology. \u2022comp.security.announce: News and announcements from CERT. \u2022comp.risks: A discussion of risks to the public from computers and users. \u2022comp.virus: A moderated discussion of computer viruses. In addition, there are a number of forums dealing with cryptography available on the Internet. Among the most worthwhile are"}, {"id": "66ada8eaf0060ccb22138b1403157158d1b490bc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 40, "start_line": 12, "end_line": 21, "text": "\u2022Security and Cryptography forum: Sponsored by DevShed. Discusses issues related to cod- ing, server applications, network protection, data protection, firewalls, ciphers, and the like. \u2022Cryptography forum: On Topix. Fairly good focus on technical issues. \u2022Security forums: On WindowsSecurity.com. Broad range of forums, including crypto- graphic theory, cryptographic software, firewalls, and malware. Links to these forums are provided at this book\u2019s Web site. 1.11 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms access control active threatauthenticationauthenticityavailabilitydata confidentialitydata integritydenial of serviceencryptionintegrityintrudermasqueradenonrepudiationOSI security architecturepassive threatreplaysecurity attackssecurity mechanismssecurity servicestraffic analysis"}, {"id": "a8931dc5c14a9dc318f61838b17e3d4568322f08", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 40, "start_line": 22, "end_line": 30, "text": "Review Questions 1.1 What is the OSI security architecture? 1.2 What is the difference between passive and active security threats? 1.3 List and briefly define categories of passive and active security attacks. 1.4 List and briefly define categories of security services. 1.5 List and briefly define categories of security mechanisms. Problems 1.1 Consider an automated teller machine (ATM) in which users provide a personal identification number (PIN) and a card for account access. Give examples of confi-dentiality, integrity, and availability requirements associated with the system. In eachcase, indicate the degree of importance of the requirement."}, {"id": "2577e53f295cd8797e09440d327c3f81cbef6227", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 41, "start_line": 1, "end_line": 6, "text": "26CHAPTER 1 / INTRODUCTION 1.2 Repeat Problem 1.1 for a telephone switching system that routes calls through a switching network based on the telephone number requested by the caller. 1.3 Consider a desktop publishing system used to produce documents for variousorganizations.a.Give an example of a type of publication for which confidentiality of the storeddata is the most important requirement. b.Give an example of a type of publication in which data integrity is the mostimportant requirement. c.Give an example in which system availability is the most important requirement."}, {"id": "06015185ee7c4ec417322fb7440b0609229ef50d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 41, "start_line": 7, "end_line": 10, "text": "1.4 For each of the following assets, assign a low, moderate, or high impact level for theloss of confidentiality, availability, and integrity, respectively. Justify your answers.a.An organization managing public information on its Web server. b.A law-enforcement organization managing extremely sensitive investigativeinformation. c.A financial organization managing routine administrative information (notprivacy-related information). d.An information system used for large acquisitions in a contracting organization thatcontains both sensitive, pre-solicitation phase contract information and routineadministrative information. Assess the impact for the two data sets separately andthe information system as a whole."}, {"id": "5b231477276b3960c05ee0a9ab1dc3d6d9dd8f74", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 41, "start_line": 11, "end_line": 13, "text": "e.A power plant contains a SCADA (supervisory control and data acquisition) systemcontrolling the distribution of electric power for a large military installation.The SCADA system contains both real-time sensor data and routine administrativeinformation. Assess the impact for the two data sets separately and the informationsystem as a whole. 1.5 Draw a matrix similar to Table 1.4 that shows the relationship between securityservices and attacks. 1.6 Draw a matrix similar to Table 1.4 that shows the relationship between securitymechanisms and attacks."}, {"id": "f7de43bfa35177882643ffbf7aa554816e35fd2a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 42, "start_line": 1, "end_line": 16, "text": "2.1 Symmetric Encryption Principles Cryptography CryptanalysisFeistel Cipher Structure 2.2 Symmetric Block Encryption Algorithms Data Encryption StandardTriple DESAdvanced Encryption Standard 2.3 Random and Pseudorandom Numbers The Use of Random NumbersTRNGs, PRNGs, and PRFsAlgorithm Design 2.4 Stream Ciphers and RC4 Stream Cipher StructureThe RC4 Algorithm 2.5 Cipher Block Modes of Operation Electronic Codebook ModeCipher Block Chaining ModeCipher Feedback ModeCounter Mode 2.6 Recommended Reading and Web Sites 2.7 Key Terms, Review Questions, and Problems 27SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITYPART1: C RYPTOGRAPHY CHAPTER"}, {"id": "cf08e5c2eb63675568d9a223ad46664dc6750cec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 43, "start_line": 1, "end_line": 4, "text": "28CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY All the afternoon Mungo had been working on Stern\u2019s code, principally with the aid of the latest messages which he had copied down at the Nevin Square drop.Stern was very confident. He must be well aware London Central knew about thatdrop. It was obvious that they didn\u2019t care how often Mungo read their messages, soconfident were they in the impenetrability of the code. \u2014Talking to Strange Men, Ruth Rendell"}, {"id": "f15dacbec7b4597cf2ae000d638b5ea98ccc4f67", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 43, "start_line": 5, "end_line": 6, "text": "Amongst the tribes of Central Australia every man, woman, and child has a secretor sacred name which is bestowed by the older men upon him or her soon afterbirth, and which is known to none but the fully initiated members of the group.Thissecret name is never mentioned except upon the most solemn occasions; to utter itin the hearing of men of another group would be a most serious breach of tribalcustom. When mentioned at all, the name is spoken only in a whisper, and not untilthe most elaborate precautions have been taken that it shall be heard by no one butmembers of the group. The native thinks that a stranger knowing his secret namewould have special power to work him ill by means of magic. \u2014The Golden Bough, Sir James George Frazer"}, {"id": "b2bd6dafa80c1f42ddfaf3a069ed3eb70081abfa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 43, "start_line": 7, "end_line": 10, "text": "Symmetric encryption, also referred to as conventional encryption, secret-key, orsingle-key encryption, was the only type of encryption in use prior to the develop-ment of public-key encryption in the late 1970s. 1It remains by far the most widely used of the two types of encryption. This chapter begins with a look at a general model for the symmetric encryp-"}, {"id": "dee67fbdf61cd09ff325c66d559cb0b80b0806f3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 43, "start_line": 11, "end_line": 17, "text": "tion process; this will enable us to understand the context within which thealgorithms are used. Then we look at three important block encryption algorithms:DES, triple DES, and AES. This is followed by a discussion of random andpseudorandom number generation. Next, the chapter introduces symmetric streamencryption and describes the widely used stream cipher RC4. Finally, we look at theimportant topic of block cipher modes of operation. 2.1 SYMMETRIC ENCRYPTION PRINCIPLES A symmetric encryption scheme has five ingredients (Figure 2.1): \u2022Plaintext: This is the original message or data that is fed into the algorithm as input. \u2022Encryption algorithm: The encryption algorithm performs various substitutions and transformations on the plaintext."}, {"id": "22641830a4b9d59190d7ee2fef1c5b364c2be3f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 43, "start_line": 18, "end_line": 21, "text": "\u2022Secret key: The secret key is also input to the algorithm.The exact substitutions and transformations performed by the algorithm depend on the key. 1Public-key encryption was first described in the open literature in 1976; the National Security Agency (NSA) claims to have discovered it some years earlier."}, {"id": "273636e9d1a4e5cd2f1a579e8db030c59b0137c0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 44, "start_line": 1, "end_line": 21, "text": "2.1 / SYMMETRIC ENCRYPTION PRINCIPLES 29 Plaintext inputTransmitted ciphertext Plaintext outputSecret key shared by sender and recipientSecret key shared by sender and recipient Encryption algorithm (e.g., AES)Decryption algorithm (reverse of encryption algorithm)K X Y /H11549 E[K, X] X /H11549 D[K, Y ]K Figure 2.1 Simplified Model of Symmetric Encryption \u2022Ciphertext: This is the scrambled message produced as output. It depends on the plaintext and the secret key. For a given message, two different keys will produce two different ciphertexts. \u2022Decryption algorithm: This is essentially the encryption algorithm run in reverse. It takes the ciphertext and the same secret key and produces the orig-inal plaintext. There are two requirements for secure use of symmetric encryption:"}, {"id": "84a54d2626f5617e0cbac1d9f3819c1b1a4ba48e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 44, "start_line": 22, "end_line": 25, "text": "1.We need a strong encryption algorithm. At a minimum, we would like the algorithm to be such that an opponent who knows the algorithm and hasaccess to one or more ciphertexts would be unable to decipher the ciphertextor figure out the key.This requirement is usually stated in a stronger form:Theopponent should be unable to decrypt ciphertext or discover the key even if heor she is in possession of a number of ciphertexts together with the plaintextthat produced each ciphertext. 2.Sender and receiver must have obtained copies of the secret key ina secure fashion and must keep the key secure. If someone can discoverthe key and knows the algorithm, all communication using this key isreadable. It is important to note that the security of symmetric encryption depends on"}, {"id": "3730a0332f0695556ed847bbaebfe2932b5ab221", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 44, "start_line": 26, "end_line": 30, "text": "the secrecy of the key, not the secrecy of the algorithm.That is, it is assumed that it is impractical to decrypt a message on the basis of the ciphertext plus knowledge of the encryption/decryption algorithm. In other words, we do not need to keep thealgorithm secret; we need to keep only the key secret. This feature of symmetric encryption is what makes it feasible for widespread use. The fact that the algorithm need not be kept secret means that manufacturerscan and have developed low-cost chip implementations of data encryption algo-rithms. These chips are widely available and incorporated into a number of products.With the use of symmetric encryption, the principal security problem is maintainingthe secrecy of the key."}, {"id": "0d8894b3b93566ec7fa2c107a9e823a53a6a30d3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 45, "start_line": 1, "end_line": 7, "text": "30CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY Cryptography Cryptographic systems are generically classified along three independent dimensions: 1.The type of operations used for transforming plaintext to ciphertext. All encryption algorithms are based on two general principles: substitution, in which each element in the plaintext (bit, letter, group of bits or letters) ismapped into another element, and transposition, in which elements in theplaintext are rearranged. The fundamental requirement is that no informationbe lost (that is, that all operations be reversible). Most systems, referred to asproduct systems, involve multiple stages of substitutions and transpositions. 2.The number of keys used. If both sender and receiver use the same key, the system"}, {"id": "6c9e5410d52ac3dbf033f5aa687aaf1652671cae", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 45, "start_line": 8, "end_line": 15, "text": "is referred to as symmetric, single-key, secret-key, or conventional encryption. If thesender and receiver each use a different key, the system is referred to as asymmetric,two-key, or public-key encryption. 3.The way in which the plaintext is processed. A block cipher processes the input one block of elements at a time, producing an output block for each inputblock. A stream cipher processes the input elements continuously, producing output one element at a time, as it goes along. Cryptanalysis The process of attempting to discover the plaintext or key is known as cryptanalysis . The strategy used by the cryptanalyst depends on the nature of the encryptionscheme and the information available to the cryptanalyst. Table 2.1 summarizes the various types of cryptanalytic attacks based on the"}, {"id": "4f60d20a72645035439ab89a333dcb94c7c74387", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 45, "start_line": 16, "end_line": 17, "text": "amount of information known to the cryptanalyst. The most difficult problem ispresented when all that is available is the ciphertext only . In some cases, not even the encryption algorithm is known, but in general, we can assume that the opponentdoes know the algorithm used for encryption. One possible attack under thesecircumstances is the brute-force approach of trying all possible keys. If the key spaceis very large, this becomes impractical. Thus, the opponent must rely on an analysisof the ciphertext itself, generally applying various statistical tests to it. To use thisapproach, the opponent must have some general idea of the type of plaintext that isconcealed, such as English or French text, an EXE file, a Java source listing, anaccounting file, and so on."}, {"id": "8d7d24286272333ede0c72b72cf3c33f7293efca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 45, "start_line": 18, "end_line": 20, "text": "The ciphertext-only attack is the easiest to defend against because the opponent has the least amount of information to work with. In many cases, however, the analysthas more information. The analyst may be able to capture one or more plaintextmessages as well as their encryptions. Or the analyst may know that certain plain-text patterns will appear in a message. For example, a file that is encoded in thePostscript format always begins with the same pattern, or there may be a standardizedheader or banner to an electronic funds transfer message, and so on. All of these areexamples of known plaintext. With this knowledge, the analyst may be able to deduce the key on the basis of the way in which the known plaintext is transformed."}, {"id": "93999fbdd1eaf7a123931cdd11986000d396acd6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 45, "start_line": 21, "end_line": 22, "text": "Closely related to the known-plaintext attack is what might be referred to as a probable-word attack. If the opponent is working with the encryption of some general"}, {"id": "e87cd9f6f1a6cb4f73aa9bcbb540848b11ad471b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 46, "start_line": 1, "end_line": 10, "text": "Table 2.1 Types of Attacks on Encrypted Messages Type of Attack Known to Cryptanalyst Ciphertext only \u2022 Encryption algorithm \u2022 Ciphertext to be decoded Known plaintext \u2022 Encryption algorithm\u2022 Ciphertext to be decoded\u2022 One or more plaintext\u2013ciphertext pairs formed with the secret key Chosen plaintext \u2022 Encryption algorithm\u2022 Ciphertext to be decoded\u2022 Plaintext message chosen by cryptanalyst, together with its corresponding ciphertext generated with the secret key Chosen ciphertext \u2022 Encryption algorithm\u2022 Ciphertext to be decoded\u2022 Purported ciphertext chosen by cryptanalyst, together with its corresponding decrypted plaintext generated with the secret key Chosen text \u2022 Encryption algorithm\u2022 Ciphertext to be decoded\u2022 Plaintext message chosen by cryptanalyst, together with its corresponding"}, {"id": "7d18edb1e610e9a5220d9beb5050c072caef6ad4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 46, "start_line": 11, "end_line": 16, "text": "ciphertext generated with the secret key \u2022 Purported ciphertext chosen by cryptanalyst, together with its corresponding decrypted plaintext generated with the secret key2.1 / SYMMETRIC ENCRYPTION PRINCIPLES 31 prose message, he or she may have little knowledge of what is in the message. However, if the opponent is after some very specific information, then parts of themessage may be known. For example, if an entire accounting file is being transmitted,the opponent may know the placement of certain key words in the header of the file.As another example, the source code for a program developed by a corporation mightinclude a copyright statement in some standardized position. If the analyst is able somehow to get the source system to insert into the"}, {"id": "e7ecc6730f890e696d9c7fa57baa85f31d5837b4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 46, "start_line": 17, "end_line": 24, "text": "system a message chosen by the analyst, then a chosen-plaintext attack is possible. In general, if the analyst is able to choose the messages to encrypt, the analyst maydeliberately pick patterns that can be expected to reveal the structure of the key. Table 2.1 lists two other types of attack: chosen ciphertext and chosen text. These are less commonly employed as cryptanalytic techniques but are neverthelesspossible avenues of attack. Only relatively weak algorithms fail to withstand a ciphertext-only attack. Generally, an encryption algorithm is designed to withstand a known-plaintext attack. An encryption scheme is computationally secure if the ciphertext generated by the scheme meets one or both of the following criteria:"}, {"id": "0fa0c91618e0c96373f933936333a7282ed8dfd6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 46, "start_line": 25, "end_line": 26, "text": "\u2022The cost of breaking the cipher exceeds the value of the encrypted information. \u2022The time required to break the cipher exceeds the useful lifetime of theinformation."}, {"id": "5d0a33fac14b92928bcb48bd2e6fe52e232b3085", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 47, "start_line": 1, "end_line": 5, "text": "32CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY Unfortunately, it is very difficult to estimate the amount of effort required to cryptanalyze ciphertext successfully. However, assuming there are no inherent mathematical weaknesses in the algorithm, then a brute-force approach is indicated,and here we can make some reasonable estimates about costs and time. A brute-force approach involves trying every possible key until an intelligi-"}, {"id": "e38c1aa3273a3cf00de1bd0d144954d0d06f8c90", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 47, "start_line": 6, "end_line": 7, "text": "ble translation of the ciphertext into plaintext is obtained. On average, half of allpossible keys must be tried to achieve success. Table 2.2 shows how much time isinvolved for various key sizes. The 56-bit key size is used with the DES(Data Encryption Standard) algorithm. For each key size, the results are shownassuming that it takes 1 \u00b5 s to perform a single decryption, which is a reasonable order of magnitude for today\u2019s machines. With the use of massively parallelorganizations of microprocessors, it may be possible to achieve processing ratesmany orders of magnitude greater. The final column of Table 2.2 considers theresults for a system that can process 1 million keys per microsecond. As you cansee, at this performance level, DES no longer can be considered computationallysecure."}, {"id": "dafc9496b49433c849d76e00e5c8b0ba1c10f337", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 47, "start_line": 8, "end_line": 15, "text": "Feistel Cipher Structure Many symmetric block encryption algorithms, including DES, have a structure firstdescribed by Horst Feistel of IBM in 1973 [FEIS73] and shown in Figure 2.2. Theinputs to the encryption algorithm are a plaintext block of length 2w bits and a key K. The plaintext block is divided into two halves, LE 0and RE 0. The two halves of the data pass through n rounds of processing and then combine to produce the ciphertext block. Each round ihas as inputs LE i1and RE i1derived from the previous round, as well as a subkey Kiderived from the overall K . In general, the subkeys Kiare different from K and from each other and are generated from"}, {"id": "5625e9ba3e208ff53ad9381b7f44644d4e3af91d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 47, "start_line": 16, "end_line": 26, "text": "the key by a subkey generation algorithm. In Figure 2.2, 16 rounds are used,although any number of rounds could be implemented. The right-hand side ofFigure 2.2 shows the decryption process. All rounds have the same structure. A substitution is performed on the left half of the data.This is done by applying a round function F to the right half of the data and then taking the exclusive-OR (XOR) of the output of that function and the left half ofthe data. The round function has the same general structure for each round but is- - Table 2.2 Average Time Required for Exhaustive Key Search Key Size (bits)Number of Alternative KeysTime Required at 1 Decryption/ \u00b5sTime Required at 106Decryptions/ \u00b5s 32 232=4.3*109231ms=35.8 minutes 2.15 milliseconds 56 256=7.2*1016255ms=1142 years 10.01 hours"}, {"id": "c97ee7e83c43e5dd29a27e2206d0efec0255e576", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 47, "start_line": 27, "end_line": 30, "text": "128 2128=3.4*10382127ms=5.4*1024 years 5.4*1018 years 168 2168=3.7*10502167ms=5.9*1036 years 5.9*1030 years 26 characters (permutation)26!=4*10262*1026ms=6.4*1012 years 6.4*106 years"}, {"id": "d65f880992c6f5cd8435252f55c96863c38c726c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 48, "start_line": 1, "end_line": 23, "text": "2.1 / SYMMETRIC ENCRYPTION PRINCIPLES 33 Output (ciphertext)K1 LD0 = RE 16RD0 = LE 16LD2 = RE14RD2 = LE14LD14 = RE 2RD14 = LE2LD16 = RE 0LD17 = RE 0 RD16 = LE0RD17 = LE0 RD1 = LE15LD1 = RE15RD15 = LE1 LD15 = RE1 Input (ciphertext)Output (plaintext)Round 1K1 K2 K15 K16K2 K15 K16FLE0 RE0Input (plaintext) LE1 RE1 LE2 RE2F FLE14 RE14 LE15 RE15 LE16 RE16 LE17 RE17F FFFFRound 2 Round 15 Round 16 Round 16 Round 15 Round 2 Round 1 Figure 2.2 Feistel Encryption and Decryption (16 rounds) parameterized by the round subkey Ki. Following this substitution, a permutation is performed that consists of the interchange of the two halves of the data. The Feistel structure is a particular example of the more general structure"}, {"id": "e2c3819876ef897f3529a852fa324f01cac60c47", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 48, "start_line": 24, "end_line": 25, "text": "used by all symmetric block ciphers. In general, a symmetric block cipher consists of a sequence of rounds, with each round performing substitutions and permutationsconditioned by a secret key value. The exact realization of a symmetric block cipherdepends on the choice of the following parameters and design features."}, {"id": "c103934e0ddf6f7158644b96b8fd82ecdce71e7d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 49, "start_line": 1, "end_line": 10, "text": "34CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY \u2022Block size: Larger block sizes mean greater security (all other things being equal) but reduced encryption/decryption speed. A block size of 128 bits is a reasonable tradeoff and is nearly universal among recent block cipherdesigns. \u2022Key size: Larger key size means greater security but may decrease encryption/ decryption speed.The most common key length in modern algorithms is 128 bits. \u2022Number of rounds: The essence of a symmetric block cipher is that a single round offers inadequate security but that multiple rounds offer increasingsecurity. A typical size is 16 rounds. \u2022Subkey generation algorithm: Greater complexity in this algorithm should lead to greater difficulty of cryptanalysis."}, {"id": "5fb52d18b99b7a8d5c9ec917d601da7f6f8e9c27", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 49, "start_line": 11, "end_line": 17, "text": "\u2022Round function: Again, greater complexity generally means greater resistance to cryptanalysis. There are two other considerations in the design of a symmetric block cipher: \u2022Fast software encryption/decryption: In many cases, encryption is embedded in applications or utility functions in such a way as to preclude a hardware implementation. Accordingly, the speed of execution of the algorithmbecomes a concern. \u2022Ease of analysis: Although we would like to make our algorithm as difficult as"}, {"id": "f20e4739e46c3ffb8e8f747c097be4c1f4bc25ab", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 49, "start_line": 18, "end_line": 23, "text": "possible to cryptanalyze, there is great benefit in making the algorithm easy toanalyze. That is, if the algorithm can be concisely and clearly explained, it iseasier to analyze that algorithm for cryptanalytic vulnerabilities and thereforedevelop a higher level of assurance as to its strength. DES, for example, doesnot have an easily analyzed functionality. Decryption with a symmetric block cipher is essentially the same as the encryp- tion process. The rule is as follows: Use the ciphertext as input to the algorithm, but use the subkeys K iin reverse order. That is, use Knin the first round, Kn1in the second round, and so on until K1is used in the last round. This is a nice feature,"}, {"id": "8a1f7cffe6c45741ead78b0da77d1dbfcd189318", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 49, "start_line": 24, "end_line": 30, "text": "because it means we need not implement two different algorithms\u2014one for encryp-tion and one for decryption. 2.2 SYMMETRIC BLOCK ENCRYPTION ALGORITHMS The most commonly used symmetric encryption algorithms are block ciphers.Ablock cipher processes the plaintext input in fixed-sized blocks and produces a block of ciphertext of equal size for each plaintext block.This section focuses on thethree most important symmetric block ciphers: the Data Encryption Standard(DES), triple DES (3DES), and the Advanced Encryption Standard (AES). Data Encryption Standard The most widely used encryption scheme is based on the Data Encryption Standard (DES) issued in 1977, as Federal Information Processing Standard 46 (FIPS 46) by"}, {"id": "28e35bcc07b64dbf2c9e74d93327d5f1f5d9564d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 49, "start_line": 31, "end_line": 31, "text": "the National Bureau of Standards, now known as the National Institute of Standards-"}, {"id": "856734e1b92612136cc3f95981094e7e987a417b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 50, "start_line": 1, "end_line": 8, "text": "2.2 / SYMMETRIC BLOCK ENCRYPTION ALGORITHMS 35 and Technology (NIST). The algorithm itself is referred to as the Data Encryption Algorithm (DEA).2 DESCRIPTION OF THE ALGORITHM The plaintext is 64 bits in length and the key is 56 bits in length; longer plaintext amounts are processed in 64-bit blocks. The DESstructure is a minor variation of the Feistel network shown in Figure 2.2. There are16 rounds of processing. From the original 56-bit key, 16 subkeys are generated, oneof which is used for each round. The process of decryption with DES is essentially the same as the encryption process.The rule is as follows: Use the ciphertext as input to the DES algorithm, butuse the subkeys K iin reverse order. That is, use K16on the first iteration, K15on the"}, {"id": "ec68e490ad318accfc487a675183fb428fbe09e5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 50, "start_line": 9, "end_line": 14, "text": "second iteration, and so on until K1is used on the 16th and last iteration. THESTRENGTH OF DES Concerns about the strength of DES fall into two categories: concerns about the algorithm itself and concerns about the use of a 56-bit key. The first concern refers to the possibility that cryptanalysis is possible byexploiting the characteristics of the DES algorithm. Over the years, there have beennumerous attempts to find and exploit weaknesses in the algorithm, making DESthe most-studied encryption algorithm in existence. Despite numerous approaches,no one has so far succeeded in discovering a fatal weakness in DES. 3 A more serious concern is key length.With a key length of 56 bits, there are 256 possible keys, which is approximately 7.2 \u00d71016keys. Thus, on the face of it, a brute-"}, {"id": "afd5c5587366eb56bc7f63f12e17c05ba8634238", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 50, "start_line": 15, "end_line": 16, "text": "force attack appears impractical.Assuming that on average half the key space has tobe searched, a single machine performing one DES encryption per microsecondwould take more than a thousand years (see Table 2.2) to break the cipher. However, the assumption of one encryption per microsecond is overly conserv-"}, {"id": "0b49d4bfcff8c35b4df99dba5868297a53e01b42", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 50, "start_line": 17, "end_line": 18, "text": "ative. DES finally and definitively proved insecure in July 1998, when the ElectronicFrontier Foundation (EFF) announced that it had broken a DES encryption using aspecial-purpose \u201cDES cracker\u201d machine that was built for less than $250,000. Theattack took less than three days. The EFF has published a detailed description of themachine, enabling others to build their own cracker [EFF98]. And, of course, hard-ware prices will continue to drop as speeds increase, making DES virtually worthless. It is important to note that there is more to a key-search attack than simply"}, {"id": "ba5dcde3b2053e6266e63d8e47a643287ecf6101", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 50, "start_line": 19, "end_line": 21, "text": "running through all possible keys. Unless known plaintext is provided, the analystmust be able to recognize plaintext as plaintext. If the message is just plain text inEnglish, then the result pops out easily, although the task of recognizing Englishwould have to be automated. If the text message has been compressed beforeencryption, then recognition is more difficult. And if the message is some more gen-eral type of data, such as a numerical file, and this has been compressed, the problembecomes even more difficult to automate. Thus, to supplement the brute-force 2The terminology is a bit confusing. Until recently, the terms DES and DEA could be used interchange- ably. However, the most recent edition of the DES document includes a specification of the DEA"}, {"id": "d99f661fb1c8f650aa444c4c1097aff16703fff5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 50, "start_line": 22, "end_line": 25, "text": "described here plus the triple DEA (3DES) described subsequently. Both DEA and 3DES are part of theData Encryption Standard. Furthermore, until the recent adoption of the official term 3DES, the triple DEA algorithm was typically referred to as triple DES and written as 3DES. For the sake of convenience, we will use 3DES. 3At least, no one has publicly acknowledged such a discovery."}, {"id": "4b2498235000b2302cedf32ae41bb88463c5395c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 51, "start_line": 1, "end_line": 4, "text": "36CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY approach, some degree of knowledge about the expected plaintext is needed, and some means of automatically distinguishing plaintext from garble is also needed.TheEFF approach addresses this issue as well and introduces some automated tech-niques that would be effective in many contexts. A final point: If the only form of attack that could be made on an encryption"}, {"id": "5c8cef6b591e4f209194b23ec20ff1b9457429bb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 51, "start_line": 5, "end_line": 6, "text": "algorithm is brute force, then the way to counter such attacks is obvious: use longerkeys. To get some idea of the size of key required, let us use the EFF cracker as abasis for our estimates. The EFF cracker was a prototype, and we can assume thatwith today\u2019s technology a faster machine is cost effective. If we assume that a crackercan perform one million decryptions per \u00b5 s, which is the rate used in Table 2.2, then a DES code would take about 10 hours to crack. This is a speed-up of approximately afactor of 7 compared to the EFF result. Using this rate, Figure 2.3 shows how long itwould take to crack a DES-style algorithm as a function of key size. For example, fora 128-bit key, which is common among contemporary algorithms, it would take over10"}, {"id": "5d2bd522d19c24364682e9b8c1dab519aac1d3e4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 51, "start_line": 7, "end_line": 15, "text": "18years to break the code using the EFF cracker. Even if we managed to speed up the cracker by a factor of 1 trillion (1012), it would still take over 1 million years to break the code. So a 128-bit key is guaranteed to result in an algorithm that isunbreakable by brute force. Triple DES Triple DES (3DES) was first standardized for use in financial applications in ANSIstandard X9.17 in 1985. 3DES was incorporated as part of the Data EncryptionStandard in 1999 with the publication of FIPS 46-3. 50 100 150 128 168 200 Key Length (bits)10/H115464100104108101210161020102410281032103610401044Years to Break 56 Figure 2.3 Time to Break a Code (assuming 106decryptions/ s) m"}, {"id": "668ed8fbfaceec3a02217f990f21c42ee5c2945f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 52, "start_line": 1, "end_line": 16, "text": "2.2 / SYMMETRIC BLOCK ENCRYPTION ALGORITHMS 37 3DES uses three keys and three executions of the DES algorithm. The function follows an encrypt-decrypt-encrypt (EDE) sequence (Figure 2.4a): C E(K 3,D (K2,E (K1,P))) where C ciphertext P plaintext E[K, X] encryption of Xusing key K D[K, Y] decryption of Yusing key K Decryption is simply the same operation with the keys reversed (Figure 2.4b): P D(K 1,E (K2,D (K3,C))) There is no cryptographic significance to the use of decryption for the second stage of 3DES encryption. Its only advantage is that it allows users of 3DES to decrypt data encrypted by users of the older single DES: C E(K 1,D (K1,E (K1,P))) E[ K,P] With three distinct keys, 3DES has an effective key length of 168 bits. FIPS 46-3"}, {"id": "e404a27a834fe8707c9def87496cd7fbcc1494b8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 52, "start_line": 17, "end_line": 27, "text": "also allows for the use of two keys, with K 1K3; this provides for a key length of 112 bits. FIPS 46-3 includes the following guidelines for 3DES. \u20223DES is the FIPS approved symmetric encryption algorithm of choice. \u2022The original DES, which uses a single 56-bit key, is permitted under the standardfor legacy systems only. New procurements should support 3DES. \u2022Government organizations with legacy DES systems are encouraged totransition to 3DES. \u2022It is anticipated that 3DES and the Advanced Encryption Standard (AES) willcoexist as FIPS-approved algorithms, allowing for a gradual transition to AES. It is easy to see that 3DES is a formidable algorithm. Because the underlying cryptographic algorithm is DEA, 3DES can claim the same resistance to cryptanalysis== =======EK1 DK2 EK3 PA BC"}, {"id": "becfd04fcfefcb9e3a1a39a78a0fc620f67c57c7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 52, "start_line": 28, "end_line": 34, "text": "(a) Encryption DK3 EK2 DK1 CB AP (b) Decryption Figure 2.4 Triple DES"}, {"id": "f58d86a507579182828cdcfec8f1ff0089702348", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 53, "start_line": 1, "end_line": 6, "text": "38CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY based on the algorithm as is claimed for DEA. Furthermore, with a 168-bit key length, brute-force attacks are effectively impossible. Ultimately,AES is intended to replace 3DES, but this process will take a number of years. NIST anticipates that 3DES will remain an approved algorithm (for U.S.government use) for the foreseeable future. Advanced Encryption Standard"}, {"id": "9e0014e78670603f9dc04c131eeebab9b8da6ea9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 53, "start_line": 7, "end_line": 8, "text": "3DES has two attractions that assure its widespread use over the next few years.First, with its 168-bit key length, it overcomes the vulnerability to brute-force attackof DEA. Second, the underlying encryption algorithm in 3DES is the same as inDEA.This algorithm has been subjected to more scrutiny than any other encryptionalgorithm over a longer period of time, and no effective cryptanalytic attack basedon the algorithm rather than brute force has been found.Accordingly, there is a highlevel of confidence that 3DES is very resistant to cryptanalysis. If security were theonly consideration, then 3DES would be an appropriate choice for a standardizedencryption algorithm for decades to come. The principal drawback of 3DES is that the algorithm is relatively sluggish in"}, {"id": "f32351c2b3aa1ddb4da92d5bd419d3bcfe536193", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 53, "start_line": 9, "end_line": 11, "text": "software. The original DEA was designed for mid-1970s hardware implementationand does not produce efficient software code. 3DES, which has three times as manyrounds as DEA, is correspondingly slower.A secondary drawback is that both DEAand 3DES use a 64-bit block size. For reasons of both efficiency and security, a largerblock size is desirable. Because of these drawbacks, 3DES is not a reasonable candidate for long-term use. As a replacement, NIST in 1997 issued a call for proposals for a new Advanced"}, {"id": "20f73e29ba183f994e3655d92ed531e2ce9b1d67", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 53, "start_line": 12, "end_line": 13, "text": "Encryption Standard (AES), which should have a security strength equal to or betterthan 3DES and significantly improved efficiency. In addition to these generalrequirements, NIST specified that AES must be a symmetric block cipher with ablock length of 128 bits and support for key lengths of 128, 192, and 256 bits.Evaluation criteria included security, computational efficiency, memory require-ments, hardware and software suitability, and flexibility. In a first round of evaluation, 15 proposed algorithms were accepted.A second"}, {"id": "268f4cd8157e817d927007cc2bcc57e3f8f2bf0a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 53, "start_line": 14, "end_line": 19, "text": "round narrowed the field to five algorithms. NIST completed its evaluation processand published a final standard (FIPS PUB 197) in November of 2001. NIST selectedRijndael as the proposed AES algorithm. The two researchers who developed andsubmitted Rijndael for the AES are both cryptographers from Belgium: Dr. JoanDaemen and Dr. Vincent Rijmen. O VERVIEW OF THE ALGORITHM AES uses a block length of 128 bits and a key length that can be 128, 192, or 256 bits. In the description of this section, we assume a key length of 128 bits, which is likely to be the one most commonly implemented. Figure 2.5 shows the overall structure of AES. The input to the encryption and"}, {"id": "81b6987555aef5291a1fc8d0575d0e2103619333", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 53, "start_line": 20, "end_line": 22, "text": "decryption algorithms is a single 128-bit block. In FIPS PUB 197, this block is depictedas a square matrix of bytes.This block is copied into the State array, which is modified at each stage of encryption or decryption. After the final stage, State is copied to an output matrix. Similarly, the 128-bit key is depicted as a square matrix of bytes. Thiskey is then expanded into an array of key schedule words: each word is four bytes andthe total key schedule is 44 words for the 128-bit key. The ordering of bytes within a"}, {"id": "9868d3fcccc949ab502610d714e4abff87fccd3f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 54, "start_line": 1, "end_line": 38, "text": "2.2 / SYMMETRIC BLOCK ENCRYPTION ALGORITHMS 39 Add round key w[4, 7]Plaintext (16 bytes)Plaintext (16 bytes) Substitute bytesExpand key Shift rows Mix columnsRound 1 Round 9 Round 10Add round key \u2022 \u2022\u2022 Substitute bytes Shift rows Mix columns Add round key Substitute bytes Shift rows Add round key Ciphertext (16 bytes) (a) EncryptionKey (16 bytes) Add round key Inverse sub bytes Inverse shift rows Inverse mix cols Round 10 Round 9 Round 1Add round key \u2022\u2022\u2022Inverse sub bytes Inverse shift rows Inverse mix cols Add round key Inverse sub bytes Inverse shift rows Add round key Ciphertext (16 bytes) (b) Decryptionw[36, 39] w[40, 43]w[0, 3] Figure 2.5 AES Encryption and Decryption"}, {"id": "bffda967ecded6ef47554e18e626deeb1aa089a3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 54, "start_line": 39, "end_line": 42, "text": "matrix is by column. So, for example, the first four bytes of a 128-bit plaintext input tothe encryption cipher occupy the first column of the in matrix, the second four bytes occupy the second column, and so on. Similarly, the first four bytes of the expandedkey, which form a word, occupy the first column of the wmatrix. The following comments give some insight into AES. 1.One noteworthy feature of this structure is that it is not a Feistel structure. Recallthat in the classic Feistel structure, half of the data block is used to modify theother half of the data block, and then the halves are swapped. AES does not use"}, {"id": "649ecaee26f9ee3b15b5fde9912343116ebd6eab", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 55, "start_line": 1, "end_line": 12, "text": "40CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY a Feistel structure but processes the entire data block in parallel during each round using substitutions and permutation. 2.The key that is provided as input is expanded into an array of forty-four 32-bitwords, w[i]. Four distinct words (128 bits) serve as a round key for each round. 3.Four different stages are used, one of permutation and three of substitution: \u2022Substitute bytes: Uses a table, referred to as an S-box, 4to perform a byte-by- byte substitution of the block. \u2022Shift rows: A simple permutation that is performed row by row. \u2022Mix columns: A substitution that alters each byte in a column as a function of all of the bytes in the column. \u2022Add round key: A simple bitwise XOR of the current block with a portion"}, {"id": "84f83d8a28e033a25108092807abb77393d8c389", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 55, "start_line": 13, "end_line": 15, "text": "of the expanded key. 4.The structure is quite simple. For both encryption and decryption, the cipherbegins with an Add Round Key stage, followed by nine rounds that each includesall four stages, followed by a tenth round of three stages. Figure 2.6 depicts thestructure of a full encryption round. 5.Only the Add Round Key stage makes use of the key. For this reason, the cipherbegins and ends with an Add Round Key stage. Any other stage, applied at thebeginning or end, is reversible without knowledge of the key and so would addno security."}, {"id": "5cb2775c1c70e0505d2896992de79d2ed3179add", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 55, "start_line": 16, "end_line": 17, "text": "6.The Add Round Key stage by itself would not be formidable. The other threestages together scramble the bits, but by themselves, they would provide no secu-rity because they do not use the key. We can view the cipher as alternating oper-ations of XOR encryption (Add Round Key) of a block, followed by scramblingof the block (the other three stages), followed by XOR encryption, and so on.This scheme is both efficient and highly secure. 7.Each stage is easily reversible. For the Substitute Byte, Shift Row, and MixColumns stages, an inverse function is used in the decryption algorithm. For theAdd Round Key stage, the inverse is achieved by XORing the same round key tothe block, using the result that A B B A."}, {"id": "b83bcca69ae0119b84c70da24e49d37ceefda9b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 55, "start_line": 18, "end_line": 20, "text": "8.As with most block ciphers, the decryption algorithm makes use of the expandedkey in reverse order. However, the decryption algorithm is not identical to theencryption algorithm. This is a consequence of the particular structure of AES. 9.Once it is established that all four stages are reversible, it is easy to verify thatdecryption does recover the plaintext. Figure 2.5 lays out encryption and decryp-tion going in opposite vertical directions. At each horizontal point (e.g., thedashed line in the figure), State is the same for both encryption and decryption. 10.The final round of both encryption and decryption consists of only threestages. Again, this is a consequence of the particular structure of AES and isrequired to make the cipher reversible.=/H17053 /H17053"}, {"id": "6957038d7b193c78333f1aa1ae5ba61361f50dc8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 55, "start_line": 21, "end_line": 22, "text": "4The term S-box, or substitution box, is commonly used in the description of symmetric ciphers to refer to a table used for a table-lookup type of substitution mechanism."}, {"id": "b65f0b8b090d7f83aae71e7441532e849a19a37c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 56, "start_line": 1, "end_line": 10, "text": "S S S S S S S S S S S S S S S S SubBytesState State State State StateShiftRows MixColumns AddRoundKeyM M M M r0 r1 r2 r3 r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 Figure 2.6 AES Encryption Round 41"}, {"id": "ac57632698d6b9479d08d8d28c1e64b6af76d949", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 57, "start_line": 1, "end_line": 8, "text": "42CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY 2.3 RANDOM AND PSEUDORANDOM NUMBERS Random numbers play an important role in the use of encryption for various network security applications. We provide an overview in this section. The topic is examined inmore detail in Appendix E. The Use of Random Numbers A number of network security algorithms based on cryptography make use of randomnumbers. For example, \u2022Generation of keys for the RSA public-key encryption algorithm (describedin Chapter 3) and other public-key algorithms. \u2022Generation of a stream key for symmetric stream cipher (discussed in thefollowing section)."}, {"id": "24136603aff2c50fd16da54f1c4eb726b9cbd244", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 57, "start_line": 9, "end_line": 15, "text": "\u2022Generation of a symmetric key for use as a temporary session key.This functionis used in a number of networking applications, such as Transport Layer Security(Chapter 5), Wi-Fi (Chapter 6), e-mail security (Chapter 7), and IP security(Chapter 8). \u2022In a number of key distribution scenarios, such as Kerberos (Chapter 4),random numbers are used for handshaking to prevent replay attacks. These applications give rise to two distinct and not necessarily compatible requirements for a sequence of random numbers: randomness and unpredictability. R ANDOMNESS Traditionally, the concern in the generation of a sequence of allegedly random numbers has been that the sequence of numbers be random in some well-"}, {"id": "7080464f2f0f78647f13fbf5173071bccb0c7c2f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 57, "start_line": 16, "end_line": 23, "text": "defined statistical sense. The following criteria are used to validate that a sequenceof numbers is random. \u2022Uniform distribution: The distribution of bits in the sequence should be uniform; that is, the frequency of occurrence of ones and zeros should be approximatelythe same. \u2022Independence: No one subsequence in the sequence can be inferred from the others. Although there are well-defined tests for determining that a sequence of num- bers matches a particular distribution, such as the uniform distribution, there is no such test to \u201cprove\u201d independence. Rather, a number of tests can be applied to demonstrateif a sequence does not exhibit independence.The general strategy is to apply a numberof such tests until the confidence that independence exists is sufficiently strong."}, {"id": "9b58dc33edee63a85e4e073a5c0877329de11231", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 57, "start_line": 24, "end_line": 28, "text": "In the context of our discussion, the use of a sequence of numbers that appear statistically random often occurs in the design of algorithms related to cryptography.For example, a fundamental requirement of the RSA public-key encryption schemediscussed in Chapter 3 is the ability to generate prime numbers. In general, it isdifficult to determine if a given large number Nis prime. A brute-force approach would be to divide Nby every odd integer less than . If Nis on the order, say, of 10 150(a not uncommon occurrence in public-key cryptography), such a brute-force1N"}, {"id": "2805fe5e05d5b4d8467895f7ceae4ddccd12d316", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 58, "start_line": 1, "end_line": 5, "text": "2.3 / RANDOM AND PSEUDORANDOM NUMBERS 43 approach is beyond the reach of human analysts and their computers. However, a number of effective algorithms exist that test the primality of a number by using asequence of randomly chosen integers as input to relatively simple computations. Ifthe sequence is sufficiently long (but far, far less than ), the primality of anumber can be determined with near certainty.This type of approach, known as ran-domization, crops up frequently in the design of algorithms. In essence, if a problemis too hard or time-consuming to solve exactly, a simpler, shorter approach based onrandomization is used to provide an answer with any desired level of confidence. U NPREDICTABILITY In applications such as reciprocal authentication and session"}, {"id": "805103252f6c9245dc205db7d2a66619a4089491", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 58, "start_line": 6, "end_line": 8, "text": "key generation, the requirement is not so much that the sequence of numbers be statistically random but that the successive members of the sequence areunpredictable. With \u201ctrue\u201d random sequences, each number is statisticallyindependent of other numbers in the sequence and therefore unpredictable.However, as is discussed shortly, true random numbers are not always used; rather,sequences of numbers that appear to be random are generated by some algorithm.In this latter case, care must be taken that an opponent not be able to predict futureelements of the sequence on the basis of earlier elements. TRNGs, PRNGs, and PRFs"}, {"id": "f2ebce3985136ef147a6db70afba200cd2db5dfb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 58, "start_line": 9, "end_line": 11, "text": "Cryptographic applications typically make use of algorithmic techniques for randomnumber generation. These algorithms are deterministic and therefore producesequences of numbers that are not statistically random. However, if the algorithm isgood, the resulting sequences will pass many reasonable tests of randomness. Suchnumbers are referred to as pseudorandom numbers. You may be somewhat uneasy about the concept of using numbers generated by a deterministic algorithm as if they were random numbers. Despite what mightbe called \u201cphilosophical\u201d objections to such a practice, it generally works. As oneexpert on probability theory puts it [HAMM91],"}, {"id": "32ae11be50780da31e43d228e40bb9f2b34fce79", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 58, "start_line": 12, "end_line": 14, "text": "For practical purposes we are forced to accept the awkward conceptof \u201crelatively random\u201d meaning that with regard to the proposed usewe can see no reason why they will not perform as if they wererandom (as the theory usually requires).This is highly subjective andis not very palatable to purists, but it is what statisticians regularlyappeal to when they take \u201ca random sample\u201d \u2014 they hope that anyresults they use will have approximately the same properties as acomplete counting of the whole sample space that occurs in theirtheory. Figure 2.7 contrasts a true random number generator (TRNG) with two forms of pseudorandom number generators. A TRNG takes as input a source thatis effectively random; the source is often referred to as an entropy source.I n"}, {"id": "966b0889f6871819140fb5dac144ee9a610d5a3b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 58, "start_line": 15, "end_line": 16, "text": "essence, the entropy source is drawn from the physical environment of the com-puter and could include things such as keystroke timing patterns, disk electricalactivity, mouse movements, and instantaneous values of the system clock. Thesource, or combination of sources, serves as input to an algorithm that produces210 150"}, {"id": "b4cbcbd8488cf7e3d73c1a284cf5e5dcf60f0412", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 59, "start_line": 1, "end_line": 5, "text": "44CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY random binary output. The TRNG may simply involve conversion of an analog source to a binary output. The TRNG may involve additional processing to over-come any bias in the source. In contrast, a PRNG takes as input a fixed value, called the seed, and produces a sequence of output bits using a deterministic algorithm.Typically, as shown in Figure 2.7,there is some feedback path by which some of the results of the algorithm are fed backas input as additional output bits are produced. The important thing to note is that theoutput bit stream is determined solely by the input value or values, so that an adversarywho knows the algorithm and the seed can reproduce the entire bit stream."}, {"id": "bea0712898acb55ccd37d48b650d584a0d26fff1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 59, "start_line": 6, "end_line": 11, "text": "Figure 2.7 shows two different forms of PRNGs, based on application. \u2022Pseudorandom number generator: An algorithm that is used to produce an open-ended sequence of bits is referred to as a PRNG. A common applicationfor an open-ended sequence of bits is as input to a symmetric stream cipher, asdiscussed in the following section. \u2022Pseudorandom function (PRF): A PRF is used to produce a pseudorandom string of bits of some fixed length. Examples are symmetric encryption keysand nonces. Typically, the PRF takes as input a seed plus some context specificvalues, such as a user ID or an application ID. A number of examples of PRFswill be seen throughout this book. Other than the number of bits produced, there is no difference between a"}, {"id": "e7a369ba4401a79c5a0e6a08e675368255808962", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 59, "start_line": 12, "end_line": 32, "text": "PRNG and a PRF. The same algorithms can be used in both applications. Both require a seed and both must exhibit randomness and unpredictability. Furthermore,a PRNG application may also employ context-specific input.Conversion to binarySource of true randomness Random bit stream (a) TRNG TRNG = true random number generator PRNG = pseudorandom number generatorPRF = pseudorandom functionDeterministic algorithmSeed Pseudorandom bit stream (b) PRNGDeterministic algorithmSeed Pseudorandom value (c) PRFContext- specific values Figure 2.7 Random and Pseudorandom Number Generators"}, {"id": "83db5b96bb64c2ccf8495febb8c6a1c77ef497b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 60, "start_line": 1, "end_line": 7, "text": "2.4 / STREAM CIPHERS AND RC4 45 Algorithm Design Cryptographic PRNGs have been the subject of much research over the years, and a wide variety of algorithms have been developed.These fall roughly into two categories: \u2022Purpose-built algorithms: These are algorithms designed specifically and solely for the purpose of generating pseudorandom bit streams. Some of these algo-rithms are used for a variety of PRNG applications; several of these are describedin the next section. Others are designed specifically for use in a stream cipher.The most important example of the latter is RC4, described in the next section. \u2022Algorithms based on existing cryptographic algorithms: Cryptographic algo-"}, {"id": "e4f415c72646ba95a82ffc8886bd73f3f7093463", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 60, "start_line": 8, "end_line": 12, "text": "rithms have the effect of randomizing input. Indeed, this is a requirement ofsuch algorithms. For example, if a symmetric block cipher produced ciphertextthat had certain regular patterns in it, it would aid in the process of cryptanalysis.Thus, cryptographic algorithms can serve as the core of PRNGs. Three broadcategories of cryptographic algorithms are commonly used to create PRNGs: \u2014Symmetric block ciphers \u2014Asymmetric ciphers \u2014Hash functions and message authentication codes Any of these approaches can yield a cryptographically strong PRNG. A"}, {"id": "a0ce676a5a6f6a6db0355ef747f63a9f8c039b2c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 60, "start_line": 13, "end_line": 16, "text": "purpose-built algorithm may be provided by an operating system for general use.For applications that already use certain cryptographic algorithms for encryption orauthentication, it makes sense to re-use the same code for the PRNG. Thus, all ofthese approaches are in common use. 2.4 STREAM CIPHERS AND RC4 A block cipher processes the input one block of elements at a time, producing an output block for each input block. A stream cipher processes the input elements"}, {"id": "38ca2a2c6133137c85ab5472457b7a7b95a9f4e1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 60, "start_line": 17, "end_line": 18, "text": "continuously, producing output one element at a time as it goes along. Althoughblock ciphers are far more common, there are certain applications in which a streamcipher is more appropriate. Examples are given subsequently in this book. In thissection, we look at perhaps the most popular symmetric stream cipher, RC4.We begin with an overview of stream cipher structure, and then examine RC4. Stream Cipher Structure"}, {"id": "c5fb266bf59054a66f1b7dae583395422d46989b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 60, "start_line": 19, "end_line": 20, "text": "A typical stream cipher encrypts plaintext one byte at a time, although a streamcipher may be designed to operate on one bit at a time or on units larger than a byteat a time. Figure 2.8 is a representative diagram of stream cipher structure. In thisstructure, a key is input to a pseudorandom bit generator that produces a stream of8-bit numbers that are apparently random. A pseudorandom stream is one that isunpredictable without knowledge of the input key and which has an apparentlyrandom character. The output of the generator, called a keystream , is combined one byte at a time with the plaintext stream using the bitwise exclusive-OR (XOR)"}, {"id": "21fdbe0bb34789dd73f4f3dec598135a5fe5df97", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 61, "start_line": 1, "end_line": 14, "text": "46CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY operation. For example, if the next byte generated by the generator is 01101100 and the next plaintext byte is 11001100 , then the resulting ciphertext byte is 11001100 plaintext 01101100 key stream 10100000 ciphertext Decryption requires the use of the same pseudorandom sequence: 10100000 ciphertext 01101100 key stream 11001100 plaintext [KUMA97] lists the following important design considerations for a stream cipher. 1.The encryption sequence should have a large period. A pseudorandom num- ber generator uses a function that produces a deterministic stream of bits thateventually repeats.The longer the period of repeat, the more difficult it will beto do cryptanalysis."}, {"id": "9481cb94899358795ba925b91ffa7f84cb1bed53", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 61, "start_line": 15, "end_line": 16, "text": "2.The keystream should approximate the properties of a true random numberstream as close as possible. For example, there should be an approximately equalnumber of 1s and 0s. If the keystream is treated as a stream of bytes, then all ofthe 256 possible byte values should appear approximately equally often. Themore random-appearing the keystream is, the more randomized the ciphertext is,making cryptanalysis more difficult. 3.Note from Figure 2.8 that the output of the pseudorandom number generatoris conditioned on the value of the input key. To guard against brute-forceattacks, the key needs to be sufficiently long.The same considerations as applyfor block ciphers are valid here. Thus, with current technology, a key length ofat least 128 bits is desirable./H17053/H17053Pseudorandom byte"}, {"id": "fe86ebf8af9604488fa4ce649baa5c7b8387b6a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 61, "start_line": 17, "end_line": 33, "text": "generator (key stream generator) Plaintext byte stream MKey KKey K kPlaintext byte stream MCiphertext byte stream C ENCRYPTIONPseudorandom byte generator (key stream generator) DECRYPTIONk Figure 2.8 Stream Cipher Diagram"}, {"id": "7b7251de8911b13e7f2eb22169964149f079350b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 62, "start_line": 1, "end_line": 3, "text": "2.4 / STREAM CIPHERS AND RC4 47 With a properly designed pseudorandom number generator, a stream cipher can be as secure as block cipher of comparable key length.The primary advantage of"}, {"id": "da974e211644321f258b420744ddd86fa3a13cbd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 62, "start_line": 4, "end_line": 4, "text": "a stream cipher is that stream ciphers are almost always faster and use far less codethan do block ciphers.The example in this section, RC4, can be implemented in just afew lines of code. Table 2.3, using data from [RESC01], compares execution times ofRC4 with three well-known symmetric block ciphers. The advantage of a blockcipher is that you can reuse keys. However, if two plaintexts are encrypted with thesame key using a stream cipher, then cryptanalysis is often quite simple [DAWS96]. Ifthe two ciphertext streams are XORed together, the result is the XOR of the originalplaintexts. If the plaintexts are text strings, credit card numbers, or other byte streamswith known properties, then cryptanalysis may be successful."}, {"id": "e3e79315012178b0f658f9b64f3081d0d434fade", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 62, "start_line": 5, "end_line": 9, "text": "For applications that require encryption/decryption of a stream of data (such as over a data-communications channel or a browser/Web link), a stream ciphermight be the better alternative. For applications that deal with blocks of data (suchas file transfer, e-mail, and database), block ciphers may be more appropriate.However, either type of cipher can be used in virtually any application. The RC4 Algorithm RC4 is a stream cipher designed in 1987 by Ron Rivest for RSA Security. It is a vari-able key-size stream cipher with byte-oriented operations. The algorithm is basedon the use of a random permutation. Analysis shows that the period of the cipher isoverwhelmingly likely to be greater than 10 100[ROBS95a]. Eight to sixteen machine"}, {"id": "eaaae06a8efd3f8185d60493ba6db3524dd77262", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 62, "start_line": 10, "end_line": 11, "text": "operations are required per output byte, and the cipher can be expected to run veryquickly in software. RC4 is used in the Secure Sockets Layer/Transport Layer Security(SSL/TLS) standards that have been defined for communication between Webbrowsers and servers. It is also used in the Wired Equivalent Privacy (WEP) protocoland the newer WiFi Protected Access (WPA) protocol that are part of the IEEE802.11 wireless LAN standard. RC4 was kept as a trade secret by RSA Security. InSeptember 1994, the RC4 algorithm was anonymously posted on the Internet on theCypherpunks anonymous remailers list. The RC4 algorithm is remarkably simple and quite easy to explain. A variable-"}, {"id": "48b3bddc5eb238f105404ea11b5a46dcf0358af5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 62, "start_line": 12, "end_line": 20, "text": "length key of from 1 to 256 bytes (8 to 2048 bits) is used to initialize a 256-byte statevector S, with elements S[0], S[1],... ,S[255]. At all times, S contains a permutation of all 8-bit numbers from 0 through 255. For encryption and decryption, a byte k (see Figure 2.8) is generated from S by selecting one of the 255 entries in a systematicfashion. As each value of k is generated, the entries in S are once again permuted. Table 2.3 Speed Comparisons of Symmetric Ciphers on a Pentium II Cipher Key Length Speed (Mbps) DES 56 9 3DES 168 3 RC2 Variable 0.9 RC4 Variable 45"}, {"id": "1889ef1b63d19ba9f22e471ba15d70c8d66e982d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 63, "start_line": 1, "end_line": 11, "text": "48CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY INITIALIZATION OF STo begin, the entries of S are set equal to the values from 0 through 255 in ascending order; that is, S[0] 0, S[1] 1, . . ., S[255] 255. A temporary vector, T, is also created. If the length of the key K is 256 bytes, then K istransferred to T. Otherwise, for a key of length keylen bytes, the first keylen elements of T are copied from K, and then K is repeated as many times as necessary to fill outT. These preliminary operations can be summarized as: /* Initialization */ fori 0 to255 do S[i] i; T[i] K[i modkeylen]; Next we use T to produce the initial permutation of S. This involves starting with S[0] and going through to S[255] and, for each S[i], swapping S[i] with another"}, {"id": "5b297c875a384ae95fa9133d0314f046b2879713", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 63, "start_line": 12, "end_line": 31, "text": "byte in S according to a scheme dictated by T[i]: /* Initial Permutation of S */ j 0; fori 0 to255 do j (j S[i] T[i]) mod256; Swap (S[i], S[j]); Because the only operation on S is a swap, the only effect is a permutation. S still contains all the numbers from 0 through 255. S TREAM GENERATION Once the S vector is initialized, the input key is no longer used. Stream generation involves cycling through all the elements of S[i] and, for each S[i], swapping S[i] with another byte in S according to a scheme dictated by thecurrent configuration of S. After S[255] is reached, the process continues, startingover again at S[0]: /* Stream Generation */ i, j 0; while(true) i (i 1) mod256; j (j S[i]) mod256; Swap(S[i], S[j]); t (S[i] S[j]) mod256; k S[t];"}, {"id": "6e92b6b62f86769342e74d2b61f4b2ce5bfe8fe5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 63, "start_line": 32, "end_line": 38, "text": "To encrypt, XOR the value kwith the next byte of plaintext. To decrypt, XOR the value kwith the next byte of ciphertext. Figure 2.9 illustrates the RC4 logic. S TRENGTH OF RC4 A number of papers have been published analyzing methods of attacking RC4 (e.g., [KNUD98], [MIST98], [FLUH00], [MANT01], [PUDO02], [PAUL03], [PAUL04]). None of these approaches is practical against RC4 with areasonable key length, such as 128 bits. A more serious problem is reported in=+ =+ =+ ==+ + ======= = ="}, {"id": "208e802a245046b84cefd682613a8ce0a66ed2c8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 64, "start_line": 1, "end_line": 14, "text": "255 254 253 4 3 2 1 0 S T S(a) Initial state of S and T (b) Initial permutation of SSwapTK T[i] j /H11549 j /H11545 S[i] /H11545 T[i] t /H11549 S[i] /H11545 S[j]S[i] S[j]keylen i S (c) Stream generationSwapj /H11549 j /H11545 S[i] S[i] S[j] S[t] ki Figure 2.9 RC4 49"}, {"id": "a1ae21f440d06d7d63d2b228912129ce0c7de33c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 65, "start_line": 1, "end_line": 4, "text": "50CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY [FLUH01]. The authors demonstrate that the WEP protocol, intended to provide confidentiality on 802.11 wireless LAN networks, is vulnerable to a particular attackapproach. In essence, the problem is not with RC4 itself but the way in which keysare generated for use as input to RC4.This particular problem does not appear to berelevant to other applications using RC4 and can be remedied in WEP by changingthe way in which keys are generated. This problem points out the difficulty indesigning a secure system that involves both cryptographic functions and protocolsthat make use of them. 2.5 CIPHER BLOCK MODES OF OPERATION"}, {"id": "e53a82e5701805a3205596d165ace6bcddb4e053", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 65, "start_line": 5, "end_line": 9, "text": "A symmetric block cipher processes one block of data at a time. In the case of DES and3DES, the block length is b 64 bits; for AES, the block length is b 128 bits. For longer amounts of plaintext, it is necessary to break the plaintext into b -bit blocks (padding the last block if necessary). To apply a block cipher in a variety of applica-tions, five modes of operation have been defined by NIST (Special Publication 800- 38A). The five modes are intended to cover virtually all of the possible applications ofencryption for which a block cipher could be used. These modes are intended for usewith any symmetric block cipher, including triple DES and AES. The most importantmodes are described briefly in the remainder of this section. Electronic Codebook Mode"}, {"id": "ec3e3c283d5f0e287791d123877c590f58a8f32a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 65, "start_line": 10, "end_line": 16, "text": "The simplest way to proceed is using what is known as electronic codebook (ECB) mode, in which plaintext is handled bbits at a time and each block of plaintext is encrypted using the same key. The term codebook is used because, for a given key, there is a unique ciphertext for every b-bit block of plaintext. Therefore, one can imagine a gigantic codebook in which there is an entry for every possible b-bit plain- text pattern showing its corresponding ciphertext. With ECB, if the same b-bit block of plaintext appears more than once in the"}, {"id": "8a7894045a60baca242c2af1e355760072cd2faf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 65, "start_line": 17, "end_line": 19, "text": "message, it always produces the same ciphertext. Because of this, for lengthy mes-sages, the ECB mode may not be secure. If the message is highly structured, it maybe possible for a cryptanalyst to exploit these regularities. For example, if it is knownthat the message always starts out with certain predefined fields, then the cryptana-lyst may have a number of known plaintext\u2013ciphertext pairs to work with. If themessage has repetitive elements with a period of repetition a multiple of bbits, then these elements can be identified by the analyst.This may help in the analysis or mayprovide an opportunity for substituting or rearranging blocks. To overcome the security deficiencies of ECB, we would like a technique in"}, {"id": "8cce40f380772c52527d1dc8325f43ce2a4e5b09", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 65, "start_line": 20, "end_line": 23, "text": "which the same plaintext block, if repeated, produces different ciphertext blocks. Cipher Block Chaining Mode In the cipher block chaining (CBC) mode (Figure 2.10), the input to the encryption algorithm is the XOR of the current plaintext block and the preceding ciphertextblock; the same key is used for each block. In effect, we have chained together theprocessing of the sequence of plaintext blocks. The input to the encryption function= ="}, {"id": "4f19304086446f74a9f2eb2270f59cd33514b480", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 66, "start_line": 1, "end_line": 14, "text": "2.5 / CIPHER BLOCK MODES OF OPERATION 51 for each plaintext block bears no fixed relationship to the plaintext block. Therefore, repeating patterns of bbits are not exposed. For decryption, each cipher block is passed through the decryption algorithm. The result is XORed with the preceding ciphertext block to produce the plaintextblock. To see that this works, we can write C jE(K,[ Cj1 Pj]) where E[K ,X] is the encryption of plaintext X using key K , and is the exclusive- OR operation. Then D(K, Cj) D(K,E ( K,[Cj1 Pj])) D(K, Cj) Cj1 Pj Cj1 D(K, Cj) Cj1 Cj1 PjPj which verifies Figure 2.10b. To produce the first block of ciphertext, an initialization vector (IV) is XORed"}, {"id": "2a70976b9540c08fd1265b703ba84eab6c523595", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 66, "start_line": 15, "end_line": 31, "text": "with the first block of plaintext. On decryption, the IV is XORed with the output ofthe decryption algorithm to recover the first block of plaintext. The IV must be known to both the sender and receiver. For maximum security, the IV should be protected as well as the key. This could be done by sending the IV=/H17053 -/H17053- = /H17053-/H17053- =/H17053- =/H17053/H17053- =C1P1 EncryptIV KP2 C2EncryptKPN CNCN\u20131 EncryptK (a) Encryption P1C1 Decrypt IVKC2 P2DecryptKCN PNCN\u20131DecryptK (b) Decryption Figure 2.10 Cipher Block Chaining (CBC) Mode"}, {"id": "6fd86e730bece10afadfee6fc8b3314fba943134", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 67, "start_line": 1, "end_line": 13, "text": "52CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY using ECB encryption. One reason for protecting the IV is as follows: If an opponent is able to fool the receiver into using a different value for IV , then the opponent is ableto invert selected bits in the first block of plaintext.To see this, consider the following: C 1E(K,[ I V P1]) P1IV D(K, C1) Now use the notation that X[j] denotes the jth bit of the b-bit quantity X. Then P1[i] IV[i]D ( K,C1)[i] Then, using the properties of XOR, we can state P1[i]' IV[i]' D(K, C1)[i] where the prime notation denotes bit complementation. This means that if an oppo-nent can predictably change bits in IV , the corresponding bits of the received valueof P 1can be changed. Cipher Feedback Mode"}, {"id": "8e8d4855f653f07c55f1c42643eae43f70ce533d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 67, "start_line": 14, "end_line": 19, "text": "It is possible to convert any block cipher into a stream cipher by using the cipher feedback (CFB) mode . A stream cipher eliminates the need to pad a message to be an integral number of blocks. It also can operate in real time. Thus, if a characterstream is being transmitted, each character can be encrypted and transmitted imme-diately using a character-oriented stream cipher. One desirable property of a stream cipher is that the ciphertext be of the same length as the plaintext.Thus, if 8-bit characters are being transmitted, each charactershould be encrypted using 8 bits. If more than 8 bits are used, transmission capacityis wasted. Figure 2.11 depicts the CFB scheme. In the figure, it is assumed that the unit of"}, {"id": "c71b851fdf3c7856a3045f053a13af0925e4118c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 67, "start_line": 20, "end_line": 28, "text": "transmission is sbits; a common value is s8. As with CBC, the units of plaintext are chained together, so that the ciphertext of any plaintext unit is a function of allthe preceding plaintext. First, consider encryption. The input to the encryption function is a b-bit shift register that is initially set to some initialization vector (IV). The leftmost (mostsignificant) sbits of the output of the encryption function are XORed with the first unit of plaintext P 1to produce the first unit of ciphertext C 1, which is then transmitted. In addition, the contents of the shift register are shifted left by s bits, and C1is placed in the rightmost (least significant) s bits of the shift register. This process continues until all plaintext units have been encrypted."}, {"id": "d176bddce2f9145227135efe3cbd2046ec55c21b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 67, "start_line": 29, "end_line": 36, "text": "For decryption, the same scheme is used, except that the received ciphertext unit is XORed with the output of the encryption function to produce the plaintextunit. Note that it is the encryption function that is used, not the decryption function. This is easily explained. Let S s(X) be defined as the most significant s bits of X . Then C1P1 Ss[E(K, IV)] Therefore, P1C1 Ss[E(K, IV)] The same reasoning holds for subsequent steps in the process./H17053 =/H17053 ==/H17053 =/H17053 =/H17053 =/H17053 ="}, {"id": "7fbb0768a26987a94e5eeb950c3a27036852d816", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 68, "start_line": 1, "end_line": 18, "text": "2.5 / CIPHER BLOCK MODES OF OPERATION 53 Counter Mode Although interest in the counter mode (CTR) has increased recently, with applica- tions to ATM (asynchronous transfer mode) network security and IPSec (IP secu- rity), this mode was proposed early on (e.g., [DIFF79]). Figure 2.12 depicts the CTR mode. A counter equal to the plaintext block size is used.The only requirement stated in SP 800-38A is that the counter value must bedifferent for each plaintext block that is encrypted. Typically, the counter is initial-ized to some value and then incremented by 1 for each subsequent block (moduloC1IV P1Encrypt Select s bits Discard b \u2013 s bitsK (a) EncryptionCN\u20131 (b) Decryptions bits s bits s bitsC2P2Encrypt Select s bitsDiscard b \u2013 s bitsK s bitss bits b \u2013 s bitsShift register"}, {"id": "ca4833c03f39346660ba7ae2aacbe5480336ac76", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 68, "start_line": 19, "end_line": 41, "text": "s bitsCNPNEncrypt Select s bitsDiscard b \u2013 s bitsK s bitss bits b \u2013 s bitsShift register P1IV C1Encrypt Select s bits Discard b \u2013 s bitsKCN\u20131 s bitsC2 s bitsCN s bits s bits s bitsP2Encrypt Select s bitsDiscard b \u2013 s bitsKs bits b \u2013 s bitsShift register s bits b \u2013 s bitsShift register s bitsPNEncrypt Select s bitsDiscard b \u2013 s bitsK Figure 2.11 s-bit Cipher Feedback (CFB) Mode"}, {"id": "e187bc689c83478f98dc38816ce2a9b715ad0dc7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 69, "start_line": 1, "end_line": 8, "text": "54CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY 2b, where bis the block size). For encryption, the counter is encrypted and then XORed with the plaintext block to produce the ciphertext block; there is no chain- ing. For decryption, the same sequence of counter values is used, with eachencrypted counter XORed with a ciphertext block to recover the correspondingplaintext block. [LIPM00] lists the following advantages of CTR mode. \u2022Hardware efficiency: Unlike the chaining modes, encryption (or decryption) in CTR mode can be done in parallel on multiple blocks of plaintext or ciphertext.For the chaining modes, the algorithm must complete the computation on oneblock before beginning on the next block.This limits the maximum throughput of(a) EncryptionP1 C1Counter 1"}, {"id": "cb0e7b31ea6bbe9ac5c3ffff60532137ce65bda0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 69, "start_line": 9, "end_line": 19, "text": "EncryptKCounter 2 Counter N P2 PN C2EncryptK CNEncryptK (b) DecryptionC1 P1Counter 1 EncryptKCounter 2 Counter N C2 CN P2EncryptK PNEncryptK Figure 2.12 Counter (CTR) Mode"}, {"id": "15017ee6053dbd28108028532505d59d572ab534", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 70, "start_line": 1, "end_line": 6, "text": "2.6 / RECOMMENDED READING AND WEB SITES 55 the algorithm to the reciprocal of the time for one execution of block encryption or decryption. In CTR mode, the throughput is only limited by the amount ofparallelism that is achieved. \u2022Software efficiency: Similarly, because of the opportunities for parallel exe- cution in CTR mode, processors that support parallel features (suchas aggressive pipelining, multiple instruction dispatch per clock cycle, alarge number of registers, and SIMD instructions) can be effectivelyutilized. \u2022Preprocessing: The execution of the underlying encryption algorithm does"}, {"id": "092358eefd00a44ab9f22c0cb4459f3c7b46f97d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 70, "start_line": 7, "end_line": 12, "text": "not depend on input of the plaintext or ciphertext. Therefore, if sufficientmemory is available and security is maintained, preprocessing can be used toprepare the output of the encryption boxes that feed into the XOR functionsin Figure 2.12. When the plaintext or ciphertext input is presented, then theonly computation is a series of XORs. Such a strategy greatly enhancesthroughput. \u2022Random access: The ith block of plaintext or ciphertext can be processed in random-access fashion. With the chaining modes, block C icannot be com- puted until the i1 prior block are computed. There may be applications in which a ciphertext is stored, and it is desired to decrypt just one block; for suchapplications, the random access feature is attractive."}, {"id": "dd0cc6c4e2cd311dd24a504e378f3d6106057d0e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 70, "start_line": 13, "end_line": 18, "text": "\u2022Provable security: It can be shown that CTR is at least as secure as the other modes discussed in this section. \u2022Simplicity: Unlike ECB and CBC modes, CTR mode requires only the imple- mentation of the encryption algorithm and not the decryption algorithm. Thismatters most when the decryption algorithm differs substantially from theencryption algorithm, as it does for AES. In addition, the decryption keyscheduling need not be implemented. 2.6 RECOMMENDED READING AND WEB SITES The topics in this chapter are covered in greater detail in [STAL11]. For coverage of crypto-"}, {"id": "fdbef6842ad2678ff09575c1026b196c1e94c747", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 70, "start_line": 19, "end_line": 26, "text": "graphic algorithms, [SCHN96] is an essential reference work; it contains descriptions of virtu-ally every cryptographic algorithm and protocol published up to the time of the writing of thebook. Another worthwhile and detailed survey is [MENE97]. A more in-depth treatment,with rigorous mathematical discussion, is [STIN06].- MENE97 Menezes, A.; van Oorschot, P .; and Vanstone, S. Handbook of Applied Cryptography. Boca Raton, FL: CRC Press, 1997. SCHN96 Schneier, B. Applied Cryptography. New York: Wiley, 1996. STAL11 Stallings, W. Cryptography and Network Security: Principles and Practice, Fifth Edition. Upper Saddle River, NJ: Prentice Hall, 2011. STIN06 Stinson, D. Cryptography:Theory and Practice. Boca Raton, FL: Chapman&Hall/ CRC Press, 2006."}, {"id": "b65bc16eaf6588b7264bb31c52699ff70a73998c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 71, "start_line": 1, "end_line": 19, "text": "56CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY Recommended Web Sites: \u2022AES home page: NIST\u2019s page on AES. Contains the standard plus a number of other relevant documents. \u2022AES Lounge: Contains a comprehensive bibliography of documents and papers on AES with access to electronic copies. \u2022Block Cipher Modes of Operation: NIST page with full information on NIST-approved modes of operation. 2.7 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms Advanced Encryption Standard (AES) block cipher brute-force attackcipher block chaining (CBC) mode cipher feedback (CFB) modeciphertextcounter mode (CTR)cryptanalysisCryptographyData Encryption Standard (DES) decryptionelectronic codebook (ECB) mode"}, {"id": "69244e140809459a39d80df0d516da763e5bf768", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 71, "start_line": 20, "end_line": 31, "text": "encryptionend-to-end encryptionFeistel cipherkey distributionkeystreamlink encryptionplaintextsession keystream ciphersubkeysymmetric encryptiontriple DES (3DES) Review Questions 2.1 What are the essential ingredients of a symmetric cipher? 2.2 What are the two basic functions used in encryption algorithms? 2.3 How many keys are required for two people to communicate via a symmetric cipher? 2.4 What is the difference between a block cipher and a stream cipher? 2.5 What are the two general approaches to attacking a cipher? 2.6 Why do some block cipher modes of operation only use encryption while others useboth encryption and decryption? 2.7 What is triple encryption? 2.8 Why is the middle portion of 3DES a decryption rather than an encryption? Problems"}, {"id": "26373112edcb7522ad246aa7cb446221ab472fe5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 71, "start_line": 32, "end_line": 33, "text": "2.1 This problem uses a real-world example of a symmetric cipher, from an old U.S.Special Forces manual (public domain). The document, filename SpecialForces.pdf ,i s available at this book\u2019s Web site."}, {"id": "588fe4df434ada6ecaac489b59806b3bf38ca442", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 72, "start_line": 1, "end_line": 10, "text": "2.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 57 a.Using the two keys (memory words) cryptographic and network security , encrypt the following message: Be at the third pillar from the left outside the lyceum theatre tonight at seven. If you are distrustful bring two friends. Make reasonable assumptions about how to treat redundant letters and excess letters in the memory words and how to treat spaces and punctuation.Indicate what your assumptions are. Note: The message is from the Sherlock Holmes novel, The Sign of Four . b.Decrypt the ciphertext. Show your work. c.Comment on when it would be appropriate to use this technique and what itsadvantages are."}, {"id": "9b9f5ccf70b4f2879663920940e1f877ea6f78ef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 72, "start_line": 11, "end_line": 22, "text": "2.2 Consider a very simple symmetric block encryption algorithm in which 32-bits blocksof plaintext are encrypted using a 64-bit key. Encryption is defined as C (PK 0) K1 where C ciphertext, K secret key, K0leftmost 64 bits of K ,K1rightmost 64 bits of K , bitwise exclusive OR, and is addition mod 264. a.Show the decryption equation. That is, show the equation for Pas a function of C, K0, and K 1. b.Suppose and adversary has access to two sets of plaintexts and their correspond-ing ciphertexts and wishes to determine K. We have the two equations: C (PK 0) K1;C' (P' K0) K1 First, derive an equation in one unknown (e.g., K0). Is it possible to proceed fur- ther to solve for K0?"}, {"id": "43382d185dd35575cdfef907c86a75af257bb736", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 72, "start_line": 23, "end_line": 35, "text": "2.3 Perhaps the simplest \u201cserious\u201d symmetric block encryption algorithm is the TinyEncryption Algorithm (TEA). TEA operates on 64-bit blocks of plaintext using a128-bit key. The plaintext is divided into two 32-bit blocks (L 0,R0), and the key is divided into four 32-bit blocks ( K0,K1,K2,K3). Encryption involves repeated applica- tion of a pair of rounds, defined as follows for rounds iand i 1: LiRi1 RiLi1F(R i1,K0,K1,\u03b4i) Li1Ri Ri1LiF(R i,K2,K3,\u03b4i1) where F is defined as F(M, Kj,Kk,\u03b4i) ((M 4) Kj) ((M 5) Kk) (M \u03b4i) and where the logical shift of xby ybits is denoted by xy , the logical right shift of xby y bits is denoted by x y, and \u03b4iis a sequence of predetermined constants. a.Comment on the significance and benefit of using the sequence of constants."}, {"id": "1a3289ae64d8101182b31d65f068a094e16c6371", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 72, "start_line": 36, "end_line": 45, "text": "b.Illustrate the operation of TEA using a block diagram or flow chart type ofdepiction. c.If only one pair of rounds is used, then the ciphertext consists of the 64-bitblock (L 2,R2). For this case, express the decryption algorithm in terms of equations. d.Repeat part (c) using an illustration similar to that used for part (b). 2.4 Show that Feistel decryption is the inverse of Feistel encryption. 2.5 Consider a Feistel cipher composed of 16 rounds with block length 128 bits and keylength 128 bits. Suppose that, for a given k, the key scheduling algorithm determines values for the first eight round keys, k 1,k2,... , k8, and then sets k9k8,k10 k7,k11 k6,... , k16 k1= = = =7766n+/H17053 n+ 77/H17053 n+ 66 =+ n+ =+=+- n+-=-=+n+/H17053 = n+/H17053 =n+ =/H17053= = = =n+/H17053 ="}, {"id": "741922f8928b2b55d322104ae925c5215d5cfab3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 73, "start_line": 1, "end_line": 5, "text": "58CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY Suppose you have a ciphertext c. Explain how, with access to an encryption oracle, you can decrypt c and determine m using just a single oracle query. This shows that such a cipher is vulnerable to a chosen plaintext attack. (An encryption oracle can be thought of as a device that, when given a plaintext, returns the correspondingciphertext. The internal details of the device are not known to you, and you cannotbreak open the device. You can only gain information from the oracle by makingqueries to it and observing its responses.)"}, {"id": "4661c083e9cd98a47abf18891ac2f7a659899f52", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 73, "start_line": 6, "end_line": 12, "text": "2.6 For any block cipher, the fact that it is a nonlinear function is crucial to its security.To see this, suppose that we have a linear block cipher EL that encrypts 128-bitblocks of plaintext into 128-bit blocks of ciphertext. Let EL( k,m) denote the encryption of a 128-bit message munder a key k (the actual bit length of kis irrel- evant). Thus, EL(k,[ m 1 m2]) EL( k,m1) EL(k, m2) for all 128-bit patterns m1,m2 Describe how, with 128 chosen ciphertexts, an adversary can decrypt any ciphertextwithout knowledge of the secret key k. (A \u201cchosen ciphertext\u201d means that an adver- sary has the ability to choose a ciphertext and then obtain its decryption. Here, youhave 128 plaintext\u2013ciphertext pairs to work with, and you have the ability to chosethe value of the ciphertexts.)"}, {"id": "9eaf63e95bc406d82f6926337c53459acf71bfd4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 73, "start_line": 13, "end_line": 18, "text": "2.7 Suppose you have a true random bit generator where each bit in the generatedstream has the same probability of being a 0 or 1 as any other bit in the stream andthat the bits are not correlated; that is, the bits are generated from identical indepen-dent distribution. However, the bit stream is biased. The probability of a 1 is 0.5 \u03b4 and the probability of a 0 is 0.5 \u03b4, where 0 \u03b40.5.A simple deskewing algorithm is as follows: Examine the bit stream as a sequence of non-overlapping pairs. Discardall 00 and 11 pairs. Replace each 01 pair with 0 and each 10 pair with 1.a.What is the probability of occurrence of each pair in the original sequence? b.What is the probability of occurrence of 0 and 1 in the modified sequence? c.What is the expected number of input bits to produce xoutput bits?"}, {"id": "57de82ac9dac06fa382a65a630c20dfc9ab7823a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 73, "start_line": 19, "end_line": 24, "text": "d.Suppose that the algorithm uses overlapping successive bit pairs instead ofnonoverlapping successive bit pairs. That is, the first output bit is based on inputbits 1 and 2, the second output bit is based on input bits 2 and 3, and so on. Whatcan you say about the output bit stream? 2.8 Another approach to deskewing is to consider the bit stream as a sequence of non-overlapping groups of n bits each and output the parity of each group. That is, if a group contains an odd number of ones, the output is 1; otherwise the outputis 0.a.Express this operation in terms of a basic Boolean function. b.Assume, as in the Problem 2.7, that the probability of a 1 is 0.5 \u03b4. If each group consists of 2 bits, what is the probability of an output of 1?"}, {"id": "fdc9628e391d9c54775e9136c3c206a9ff92f0e8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 73, "start_line": 25, "end_line": 30, "text": "c.If each group consists of 4 bits, what is the probability of an output of 1? d.Generalize the result to find the probability of an output of 1 for input groups ofnbits. 2.9 What RC4 key value will leave S unchanged during initialization? That is, after theinitial permutation of S, the entries of S will be equal to the values from 0 through 255in ascending order. 2.10 RC4 has a secret internal state which is a permutation of all the possible values of thevector Sand the two indices iand j. a.Using a straightforward scheme to store the internal state, how many bits areused? b.Suppose we think of it from the point of view of how much information is repre-sented by the state. In that case, we need to determine how may different states+6 6 -+/H17053 =/H17053"}, {"id": "c4d184e97c80c043d42c068164f226aa1149d066", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 74, "start_line": 1, "end_line": 11, "text": "2.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 59 there are, then take the log to the base 2 to find out how many bits of information this represents. Using this approach, how many bits would be needed to representthe state? 2.11 Alice and Bob agree to communicate privately via e-mail using a scheme based onRC4, but they want to avoid using a new secret key for each transmission. Alice andBob privately agree on a 128-bit key k. To encrypt a message mconsisting of a string of bits, the following procedure is used. 1.Choose a random 80-bit value v 2.Generate the ciphertext cRC4(v7k) m 3.Send the bit string ( v7c) a.Suppose Alice uses this procedure to send a message mto Bob. Describe how Bob can recover the message mfrom ( v7c) using k. b.If an adversary observes several values ( v"}, {"id": "095cab2df30e506258bd0162ecb170a64d865fa3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 74, "start_line": 12, "end_line": 21, "text": "17c1), (v 27c2), . . . transmitted between Alice and Bob, how can he/she determine when the same key stream has been used to encrypt two messages? 2.12 With the ECB mode, if there is an error in a block of the transmitted ciphertext, onlythe corresponding plaintext block is affected. However, in the CBC mode, this errorpropagates. For example, an error in the transmitted C 1(Figure 2.10) obviously cor- rupts P1and P 2. a.Are any blocks beyond P2affected? b.Suppose that there is a bit error in the source version of P1. Through how many ciphertext blocks is this error propagated? What is the effect at thereceiver? 2.13 Is it possible to perform encryption operations in parallel on multiple blocks of plain-text in CBC mode? How about decryption?"}, {"id": "dc1a97609f35eadf959c6a2e49e26579be7c86f3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 74, "start_line": 22, "end_line": 23, "text": "2.14 Suppose an error occurs in a block of ciphertext on transmission using CBC. Whateffect is produced on the recovered plaintext blocks? 2.15 CBC-Pad is a block cipher mode of operation used in the RC5 block cipher, but itcould be used in any block cipher. CBC-Pad handles plaintext of any length. Theciphertext is longer than the plaintext by at most the size of a single block.Padding is used to assure that the plaintext input is a multiple of the block length.It is assumed that the original plaintext is an integer number of bytes. This plain-text is padded at the end by from 1 to bbbytes, where bbequals the block size in"}, {"id": "51bd1c6933413c8864242f1670f54a5749a5688b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 74, "start_line": 24, "end_line": 29, "text": "bytes. The pad bytes are all the same and set to a byte that represents the numberof bytes of padding. For example, if there are 8 bytes of padding, each byte has thebit pattern 00001000 . Why not allow zero bytes of padding? That is, if the orig- inal plaintext is an integer multiple of the block size, why not refrain frompadding? 2.16 Padding may not always be appropriate. For example, one might wish to store theencrypted data in the same memory buffer that originally contained the plaintext. Inthat case, the ciphertext must be the same length as the original plaintext. A mode forthat purpose is the ciphertext stealing (CTS) mode. Figure 2.13a shows an implemen-tation of this mode.a.Explain how it works. b.Describe how to decrypt C n1and C n."}, {"id": "7276ad89f7bf7cd8302190b48cfa007a4376ace5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 74, "start_line": 30, "end_line": 32, "text": "2.17 Figure 2.13b shows an alternative to CTS for producing ciphertext of equal length tothe plaintext when the plaintext is not an integer multiple of the block size.a.Explain the algorithm. b.Explain why CTS is preferable to this approach illustrated in Figure 2.13b. 2.18 If a bit error occurs in the transmission of a ciphertext character in 8-bit CFB mode,how far does the error propagate?-/H17053 ="}, {"id": "ba6cfafdc68c16ab06d695596d1f06893b16f9e9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 75, "start_line": 1, "end_line": 26, "text": "60CHAPTER 2 / SYMMETRIC ENCRYPTION AND MESSAGE CONFIDENTIALITY IVP1 C1K K K K/H11545 /H11545 /H11545 /H11545PN/H115462 CN/H115462CN/H115463 Encrypt Encrypt Encrypt EncryptEncrypt Encrypt (a) Cipheretext stealing mode (b) Alternative methodEncrypt CN XPN/H115461 CN/H115461PN00\u20260 IVP1 (bb bits) C1 (bb bits)K K K K/H11545 /H11545 /H11545 /H11545PN/H115462 (bb bits) CN/H115462 (bb bits)CN/H115463 Select leftmost j bitsPN/H115461 (bb bits) CN/H115461 (bb bits)PN ( j bits ) CN ( j bits )Encrypt Figure 2.13 Block Cipher Modes for Plaintext not a Multiple of Block Size"}, {"id": "52e1ef88504caa57bc2ad6fa676fca651ffe85a2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 76, "start_line": 1, "end_line": 17, "text": "PUBLIC-KEYCRYPTOGRAPHY ANDMESSAGE AUTHENTICATION 3.1 Approaches to Message Authentication Authentication Using Conventional Encryption Message Authentication without Message Encryption 3.2 Secure Hash Functions Hash Function RequirementsSecurity of Hash FunctionsSimple Hash FunctionsThe SHA Secure Hash Function 3.3 Message Authentication Codes HMACMACs Based on Block Ciphers 3.4 Public-Key Cryptography Principles Public-Key Encryption StructureApplications for Public-Key CryptosystemsRequirements for Public-Key Cryptography 3.5 Public-Key Cryptography Algorithms The RSA Public-Key Encryption AlgorithmDiffie-Hellman Key ExchangeOther Public-Key Cryptography Algorithms 3.6 Digital Signatures 3.7 Recommended Reading and Web Sites 3.8 Key Terms, Review Questions, and ProblemsCHAPTER 61"}, {"id": "af3543c3b77e658de467b6039cde5c4b831a3196", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 77, "start_line": 1, "end_line": 4, "text": "62CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION Every Egyptian received two names, which were known respectively as the true name and the good name, or the great name and the little name; and while thegood or little name was made public, the true or great name appears to have beencarefully concealed. \u2014The Golden Bough, Sir James George Frazer"}, {"id": "029e67c00a78251e322affa5e364586f2a87b4ea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 77, "start_line": 5, "end_line": 6, "text": "To guard against the baneful influence exerted by strangers is therefore an ele-mentary dictate of savage prudence. Hence before strangers are allowed to enter adistrict, or at least before they are permitted to mingle freely with the inhabitants,certain ceremonies are often performed by the natives of the country for the pur-pose of disarming the strangers of their magical powers, or of disinfecting, so tospeak, the tainted atmosphere by which they are supposed to be surrounded. \u2014The Golden Bough , Sir James George Frazer"}, {"id": "981f7c8a204a74aa8748badd02572f9c5329b78d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 77, "start_line": 7, "end_line": 8, "text": "In addition to message confidentiality, message authentication is an importantnetwork security function. This chapter examines three aspects of messageauthentication. First, we look at the use of message authentication codes and hashfunctions to provide message authentication. Then we look at public-key encryp-tion principles and two specific public-key algorithms. These algorithms are usefulin the exchange of conventional encryption keys. Then we look at the use ofpublic-key encryption to produce digital signatures, which provides an enhancedform of message authentication. 3.1 APPROACHES TO MESSAGE AUTHENTICATION"}, {"id": "69a289f7681862509575373d98780238ca34d55e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 77, "start_line": 9, "end_line": 12, "text": "Encryption protects against passive attack (eavesdropping). A different requirementis to protect against active attack (falsification of data and transactions). Protectionagainst such attacks is known as message authentication. A message, file, document, or other collection of data is said to be authentic when it is genuine and comes from its alleged source. Message authentication is aprocedure that allows communicating parties to verify that received messages areauthentic. 1The two important aspects are to verify that the contents of the message"}, {"id": "27e09c9fd1a37b7e22bf5382f13f0b9de32dcf3a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 77, "start_line": 13, "end_line": 17, "text": "have not been altered and that the source is authentic. We may also wish to verify amessage\u2019s timeliness (it has not been artificially delayed and replayed) andsequence relative to other messages flowing between two parties. All of theseconcerns come under the category of data integrity as described in Chapter 1. Authentication Using Conventional Encryption It would seem possible to perform authentication simply by the use of symmetricencryption. If we assume that only the sender and receiver share a key (which is asit should be), then only the genuine sender would be able to encrypt a message 1For simplicity, for the remainder of this chapter, we refer to message authentication. By this we mean both authentication of transmitted messages and of stored data ( data authentication )."}, {"id": "8c1623a4c4e55f05b993f522e89291991555ee5f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 78, "start_line": 1, "end_line": 4, "text": "3.1 / APPROACHES TO MESSAGE AUTHENTICATION 63 successfully for the other participant, provided the receiver can recognize a valid message. Furthermore, if the message includes an error-detection code and asequence number, the receiver is assured that no alterations have been made andthat sequencing is proper. If the message also includes a timestamp, the receiver isassured that the message has not been delayed beyond that normally expected fornetwork transit. In fact, symmetric encryption alone is not a suitable tool for data authentica-"}, {"id": "57ef731fa077993496c72eb39862abcf868811da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 78, "start_line": 5, "end_line": 6, "text": "tion. To give one simple example, in the ECB mode of encryption, if an attackerreorders the blocks of ciphertext, then each block will still decrypt successfully.However, the reordering may alter the meaning of the overall data sequence.Although sequence numbers may be used at some level (e.g., each IP packet), it istypically not the case that a separate sequence number will be associated with eachb-bit block of plaintext. Thus, block reordering is a threat. Message Authentication without Message Encryption"}, {"id": "a00e2e8dd0f79101429586cab313a7acc5f151a2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 78, "start_line": 7, "end_line": 8, "text": "In this section, we examine several approaches to message authentication that donot rely on encryption. In all of these approaches, an authentication tag is generatedand appended to each message for transmission. The message itself is not encryptedand can be read at the destination independent of the authentication function at thedestination. Because the approaches discussed in this section do not encrypt the message,"}, {"id": "b0f4956443301911837174d5af8e8d7a91acd354", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 78, "start_line": 9, "end_line": 9, "text": "message confidentiality is not provided. As was mentioned, message encryption byitself does not provide a secure form of authentication. However, it is possible tocombine authentication and confidentiality in a single algorithm by encrypting amessage plus its authentication tag. Typically, however, message authentication isprovided as a separate function from message encryption. [DA VI89] suggests threesituations in which message authentication without confidentiality is preferable:"}, {"id": "207950bcac82a4e096327d03fab31088183bacfa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 78, "start_line": 10, "end_line": 11, "text": "1.There are a number of applications in which the same message is broadcast toa number of destinations. Two examples are notification to users that the net-work is now unavailable and an alarm signal in a control center. It is cheaperand more reliable to have only one destination responsible for monitoringauthenticity. Thus, the message must be broadcast in plaintext with an associ-ated message authentication tag. The responsible system performs authenti-cation. If a violation occurs, the other destination systems are alerted by ageneral alarm. 2.Another possible scenario is an exchange in which one side has a heavy load andcannot afford the time to decrypt all incoming messages. Authentication is car-ried out on a selective basis with messages being chosen at random for checking."}, {"id": "ef883d7290a324bd17de165baa02de52931c59db", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 78, "start_line": 12, "end_line": 14, "text": "3.Authentication of a computer program in plaintext is an attractive service.Thecomputer program can be executed without having to decrypt it every time,which would be wasteful of processor resources. However, if a messageauthentication tag were attached to the program, it could be checked when-ever assurance is required of the integrity of the program. Thus, there is a place for both authentication and encryption in meeting security requirements."}, {"id": "a6b39c73f3d4331b270a75516c0d6d84398370ed", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 79, "start_line": 1, "end_line": 14, "text": "64CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION MAC algorithmMAC algorithm MAC KK CompareMessage Transmit Figure 3.1 Message Authentication Using a Message Authentication Code (MAC)MESSAGE AUTHENTICATION CODE One authentication technique involves the use of a secret key to generate a small block of data, known as a message authentication code (MAC), that is appended to the message. This technique assumes that two communicating parties, say A and B, share a common secret key KAB.When A has a message to send to B, it calculates the message authentication code as a function of themessage and the key: MAC M F(K AB,M). The message plus code are transmitted to"}, {"id": "36d5904f55101e5941ced2d14947bca96b08dfa6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 79, "start_line": 15, "end_line": 16, "text": "the intended recipient. The recipient performs the same calculation on the receivedmessage, using the same secret key, to generate a new message authentication code.The received code is compared to the calculated code (Figure 3.1). If we assume thatonly the receiver and the sender know the identity of the secret key, and if thereceived code matches the calculated code, then the following statements apply: 1.The receiver is assured that the message has not been altered. If an attackeralters the message but does not alter the code, then the receiver\u2019s calculationof the code will differ from the received code. Because the attacker is assumednot to know the secret key, the attacker cannot alter the code to correspond tothe alterations in the message."}, {"id": "0bef232a41c172fb7b75839359b7e8d12380c8af", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 79, "start_line": 17, "end_line": 18, "text": "2.The receiver is assured that the message is from the alleged sender. Because no oneelse knows the secret key, no one else could prepare a message with a proper code. 3.If the message includes a sequence number (such as is used with HDLC andTCP), then the receiver can be assured of the proper sequence, because anattacker cannot successfully alter the sequence number.="}, {"id": "44aee7eb5284d885ffeccfbe55350c0012ab1d29", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 80, "start_line": 1, "end_line": 9, "text": "3.1 / APPROACHES TO MESSAGE AUTHENTICATION 65 A number of algorithms could be used to generate the code.The NIST specifi- cation, FIPS PUB 113, recommends the use of DES. DES is used to generate an encrypted version of the message, and the last number of bits of ciphertext are usedas the code. A 16- or 32-bit code is typical. The process just described is similar to encryption. One difference is that the authentication algorithm need not be reversible, as it must for decryption. Becauseof the mathematical properties of the authentication function, it is less vulnerable tobeing broken than encryption. O NE-WAYHASHFUNCTION An alternative to the message authentication code is the one-way hash function. As with the message authentication code, a hash"}, {"id": "ee7d31dcf7d25610aa6fd75877029e0df1cac216", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 80, "start_line": 10, "end_line": 14, "text": "function accepts a variable-size message M as input and produces a fixed-size message digest H( M) as output. Unlike the MAC, a hash function does not take a secret key as input. To authenticate a message, the message digest is sent with the message in such a way that the message digest is authentic. Figure 3.2 illustrates three ways in which the message can be authenticated."}, {"id": "ab6203e871ab56fc4c8ba9bd0b8f7863c97a5a85", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 80, "start_line": 15, "end_line": 17, "text": "The message digest can be encrypted using conventional encryption (part a); if it isassumed that only the sender and receiver share the encryption key, then authentic-ity is assured. The message digest can be encrypted using public-key encryption(part b); this is explained in Section 3.5. The public-key approach has two advan-tages: (1) It provides a digital signature as well as message authentication. (2) It doesnot require the distribution of keys to communicating parties. These two approaches also have an advantage over approaches that encrypt the entire message in that less computation is required. Nevertheless, there has beeninterest in developing a technique that avoids encryption altogether. Several reasonsfor this interest are pointed out in [TSUD92]:"}, {"id": "62b1215bad3df3ba747d2e691ecb40cd765ea6aa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 80, "start_line": 18, "end_line": 25, "text": "\u2022Encryption software is quite slow. Even though the amount of data to beencrypted per message is small, there may be a steady stream of messages intoand out of a system. \u2022Encryption hardware costs are nonnegligible. Low-cost chip implementationsof DES are available, but the cost adds up if all nodes in a network must havethis capability. \u2022Encryption hardware is optimized toward large data sizes. For small blocks ofdata, a high proportion of the time is spent in initialization/invocation overhead. \u2022An encryption algorithm may be protected by a patent. Figure 3.2c shows a technique that uses a hash function but no encryption for message authentication. This technique assumes that two communicating parties, say A and B, share a common secret value S AB.When A has a message to send to B,"}, {"id": "8a0338d71bff5733f3b98ea8ce77b056e63f2ff2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 80, "start_line": 26, "end_line": 29, "text": "it calculates the hash function over the concatenation of the secret value and themessage: MD M H(S AB7M).2It then sends [M 7MD M] to B. Because B possesses SAB, it can recompute H( SAB7M) and verify MD M.Because the secret value itself is= 27denotes concatenation."}, {"id": "044c6307b97aa3655bd66620538aab59e0a2e25d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 81, "start_line": 1, "end_line": 20, "text": "66CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION Source A Destination BMessage Message CompareMessageH H E (a) Using conventional encryptionK DKMessageMessage MessageCompareMessageH H HE SS(b) Using public-key encryption (c) Using secret valuePRa PU a CompareHDMessage Message Figure 3.2 Message Authentication Using a One-Way Hash Function not sent, it is not possible for an attacker to modify an intercepted message. As long as the secret value remains secret, it is also not possible for an attacker to generate afalse message. A variation on the third technique, called HMAC, is the one adopted for IP security (described in Chapter 8); it also has been specified for SNMPv3 (Chapter 12)."}, {"id": "ba09b5770eb3425cd67d1b8aa6eecff928cb8010", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 82, "start_line": 1, "end_line": 11, "text": "3.2 / SECURE HASH FUNCTIONS 67 3.2 SECURE HASH FUNCTIONS The one-way hash function, or secure hash function , is important not only in mes- sage authentication but in digital signatures. In this section, we begin with a discus- sion of requirements for a secure hash function.Then we look at the most importanthash function, SHA. Hash Function Requirements The purpose of a hash function is to produce a \u201cfingerprint\u201d of a file, message, orother block of data.To be useful for message authentication, a hash function H musthave the following properties: 1.H can be applied to a block of data of any size. 2.H produces a fixed-length output. 3.H(x) is relatively easy to compute for any given x, making both hardware and software implementations practical."}, {"id": "5ac22b1e7589ec54c78c7a5aeddb757e519418f3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 82, "start_line": 12, "end_line": 22, "text": "4.For any given code h, it is computationally infeasible to find x such that H(x ) h. A hash function with this property is referred to as one-way or preimage resistant. 3 5.For any given block x, it is computationally infeasible to find yx with H(y ) H(x). A hash function with this property is referred to as second preimage resis- tant. This is sometimes referred to as weak collision resistant. 6.It is computationally infeasible to find any pair ( x,y) such that H( x) H(y). A hash function with this property is referred to as collision resistant . This is sometimes referred to as strong collision resistant . The first three properties are requirements for the practical application of a"}, {"id": "206441d92efcf14a547982d2f6839d699368927c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 82, "start_line": 23, "end_line": 26, "text": "hash function to message authentication. The fourth property, preimage resistant, isthe \u201cone-way\u201d property: It is easy to generate a code given a message, but virtuallyimpossible to generate a message given a code. This property is important if theauthentication technique involves the use of a secret value (Figure 3.2c). The secretvalue itself is not sent; however, if the hash function is not one way, an attacker caneasily discover the secret value: If the attacker can observe or intercept a transmis-sion, the attacker obtains the message Mand the hash code C H(S AB7M). The attacker then inverts the hash function to obtain SAB7M H1(C). Because the attacker now has both Mand S AB7M, it is a trivial matter to recover SAB."}, {"id": "b067f9f045312bde3e21a82fd89a819765fd6d63", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 82, "start_line": 27, "end_line": 30, "text": "The second preimage resistant property guarantees that it is impossible to find an alternative message with the same hash value as a given message.This prevents forgerywhen an encrypted hash code is used (Figures 3.2a and b). If this property were nottrue, an attacker would be capable of the following sequence: First, observe or intercepta message plus its encrypted hash code; second, generate an unencrypted hash codefrom the message; third, generate an alternate message with the same hash code.-==== Z= 3For f(x ) y,xis said to be a preimage of y.Unless f is one-to-one, there may be multiple preimage values for a given y.="}, {"id": "af366ff69c204ab962e8abf5f4513e386861c3cf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 83, "start_line": 1, "end_line": 7, "text": "68CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION A hash function that satisfies the first five properties in the preceding list is referred to as a weak hash function. If the sixth property is also satisfied, then it is referred to as a strong hash function. The sixth property, collision resistant, protectsagainst a sophisticated class of attack known as the birthday attack. Details of thisattack are beyond the scope of this book. The attack reduces the strength of an m-bit hash function from 2 mto 2m/2. See [STAL11] for details. In addition to providing authentication, a message digest also provides data integrity. It performs the same function as a frame check sequence: If any bits in themessage are accidentally altered in transit, the message digest will be in error."}, {"id": "1d2a155b302a38722a7316bc7790b8e17448d875", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 83, "start_line": 8, "end_line": 15, "text": "Security of Hash Functions As with symmetric encryption, there are two approaches to attacking a secure hashfunction: cryptanalysis and brute-force attack.As with symmetric encryption algorithms,cryptanalysis of a hash function involves exploiting logical weaknesses in the algorithm. The strength of a hash function against brute-force attacks depends solely on the length of the hash code produced by the algorithm. For a hash code of length n, the level of effort required is proportional to the following: If collision resistance is required (and this is desirable for a general-purpose secure hash code), then the value 2 n/2determines the strength of the hash code"}, {"id": "a4a8c86f2ddc4f72a234f8f992dba1004ac53d8a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 83, "start_line": 16, "end_line": 18, "text": "against brute-force attacks. Van Oorschot and Wiener [VANO94] presented adesign for a $10 million collision search machine for MD5, which has a 128-bit hashlength, that could find a collision in 24 days. Thus, a 128-bit code may be viewed asinadequate. The next step up, if a hash code is treated as a sequence of 32 bits, is a160-bit hash length. With a hash length of 160 bits, the same search machine wouldrequire over four thousand years to find a collision. With today\u2019s technology, thetime would be much shorter, so that 160 bits now appears suspect. Simple Hash Functions All hash functions operate using the following general principles. The input (mes-sage, file, etc.) is viewed as a sequence of n-bit blocks. The input is processed one"}, {"id": "527321dea4ab6e406c7e1baf39cd83c1f6b061f8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 83, "start_line": 19, "end_line": 30, "text": "block at a time in an iterative fashion to produce an n-bit hash function. One of the simplest hash functions is the bit-by-bit exclusive-OR (XOR) of every block. This can be expressed as C ibi1 bi2 ... bim where Ciith bit of the hash code, 1 \u2264i\u2264n m number of n-bit blocks in the input bijith bit in jth block XOR operation=/H17053===/H17053 /H17053 /H17053 =Preimage resistant 2n Second preimage resistant 2n Collision resistant 2n/2"}, {"id": "db2f2f727d9033178b6e38590110869d26f1d650", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 84, "start_line": 1, "end_line": 9, "text": "3.2 / SECURE HASH FUNCTIONS 69 Figure 3.3 illustrates this operation; it produces a simple parity for each bit position and is known as a longitudinal redundancy check. It is reasonably effective for random data as a data integrity check. Each n-bit hash value is equally likely. Thus, the probability that a data error will result in an unchanged hash value is 2n. With more predictably formatted data, the function is less effective. For example, inmost normal text files, the high-order bit of each octet is always zero. So if a 128-bithash value is used, instead of an effectiveness of 2 128, the hash function on this type of data has an effectiveness of 2112. A simple way to improve matters is to perform a 1-bit circular shift, or rotation,"}, {"id": "1a161532fcabc71f09b589a0447e6d88bc01d332", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 84, "start_line": 10, "end_line": 17, "text": "on the hash value after each block is processed.The procedure can be summarized as 1.Initially set the n-bit hash value to zero. 2.Process each successive n-bit block of data: a.Rotate the current hash value to the left by one bit. b.XOR the block into the hash value. This has the effect of \u201crandomizing\u201d the input more completely and overcoming anyregularities that appear in the input. Although the second procedure provides a good measure of data integrity, it is virtually useless for data security when an encrypted hash code is used with aplaintext message, as in Figures 3.2a and b. Given a message, it is an easy matter toproduce a new message that yields that hash code: Simply prepare the desired alter-nate message and then append an n-bit block that forces the combined new message"}, {"id": "56ac143a21ecdc58cec860638a683a061b8705a5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 84, "start_line": 18, "end_line": 27, "text": "plus block to yield the desired hash code. Although a simple XOR or rotated XOR (RXOR) is insufficient if only the hash code is encrypted, you may still feel that such a simple function could be usefulwhen the message as well as the hash code are encrypted. But one must be careful.Atechnique originally proposed by the National Bureau of Standards used the simpleXOR applied to 64-bit blocks of the message and then an encryption of the entiremessage using the cipher block chaining (CBC) mode. We can define the scheme asfollows: Given a message consisting of a sequence of 64-bit blocks X 1,X2,... ,X N, define the hash code C as the block-by-block XOR or all blocks and append the hash code as the final block: CX N1X1X2... XN/H17053 /H17053 /H17053 =+ =---bit 1 Block 1 Block 2 Block m"}, {"id": "7c666335dcba79ebd6aef18c9ca630b674a57bbe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 84, "start_line": 28, "end_line": 34, "text": "Hash codeb11 b21 bn1 bn2 bnmb22 b2mb12 b1m C1 C2 Cnbit 2 bit n Figure 3.3 Simple Hash Function Using Bitwise XOR"}, {"id": "11210d83ce14917b72ee513590be9ee1cc62fd93", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 85, "start_line": 1, "end_line": 13, "text": "70CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION Next, encrypt the entire message plus hash code using CBC mode to produce the encrypted message Y1,Y2,... , YN1. [JUEN85] points out several ways in which the ciphertext of this message can be manipulated in such a way that it is notdetectable by the hash code. For example, by the definition of CBC (Figure 2.10),we have X 1IV D(K, Y1) XiYi1D(K, Yi) XN1YN D(K, YN1) But X N1is the hash code: XN1X1X2... XN [IV D(K, Y1)] [Y 1 D(K, Y2) ] ... [ YN1D(K, YN)] Because the terms in the preceding equation can be XORed in any order, it followsthat the hash code would not change if the ciphertext blocks were permuted. The SHA Secure Hash Function"}, {"id": "20d731d1fa83fb6b500e25b910049b3aab288cfa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 85, "start_line": 14, "end_line": 14, "text": "In recent years, the most widely used hash function has been the Secure HashAlgorithm (SHA). Indeed, because virtually every other widely used hash functionhad been found to have substantial cryptanalytic weaknesses, SHA was more or lessthe last remaining standardized hash algorithm by 2005. SHA was developed by theNational Institute of Standards and Technology (NIST) and published as a federalinformation processing standard (FIPS 180) in 1993.When weaknesses were discov-ered in SHA (now known as SHA-0), a revised version was issued as FIPS 180-1 in1995 and is referred to as SHA-1 . The actual standards document is entitled \u201cSecure"}, {"id": "1147a2da2f059d28e8ea74f346d978fc99bf0e12", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 85, "start_line": 15, "end_line": 17, "text": "Hash Standard.\u201d SHA is based on the hash function MD4, and its design closelymodels MD4. SHA-1 is also specified in RFC 3174, which essentially duplicates thematerial in FIPS 180-1 but adds a C code implementation. SHA-1 produces a hash value of 160 bits. In 2002, NIST produced a revised version of the standard, FIPS 180-2, that defined three new versions of SHA withhash value lengths of 256, 384, and 512 bits known as SHA-256, SHA-384, and SHA-512, respectively. Collectively, these hash algorithms are known as SHA-2. These"}, {"id": "89dce14666488fe7f21d7018cff455dac20d1f81", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 85, "start_line": 18, "end_line": 22, "text": "new versions have the same underlying structure and use the same types of modulararithmetic and logical binary operations as SHA-1. A revised document was issuedas FIP PUB 180-3 in 2008, which added a 224-bit version (Table 3.1). SHA-2 is alsospecified in RFC 4634, which essentially duplicates the material in FIPS 180-3 butadds a C code implementation. In 2005, NIST announced the intention to phase out approval of SHA-1 and move to a reliance on SHA-2 by 2010. Shortly thereafter, a research team describedan attack in which two separate messages could be found that deliver the sameSHA-1 hash using 2 69operations, far fewer than the 280operations previously thought needed to find a collision with an SHA-1 hash [WANG05]. This resultshould hasten the transition to SHA-2."}, {"id": "f4b7beb4e5f640db38673538f33a6bf6c3ead14c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 85, "start_line": 23, "end_line": 25, "text": "In this section, we provide a description of SHA-512. The other versions are quite similar./H17053 -/H17053 /H17053 /H17053 /H17053 /H17053 =/H17053 /H17053 /H17053 =+++ /H17053 =+/H17053- =/H17053 =+"}, {"id": "f740ce1b95b1e0b1d907c28942946a85df961ecb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 86, "start_line": 1, "end_line": 15, "text": "Table 3.1 Comparison of SHA Parameters SHA-1 SHA-224 SHA-256 SHA-384 SHA-512 Message Digest Size 160 224 256 384 512 Message Size < 264< 264< 264< 2128< 2128 Block Size 512 512 512 1024 1024 Word Size 32 32 32 64 64 Number of Steps 80 64 64 80 80 Security 80 112 128 192 256 Notes : 1. All sizes are measured in bits. 2. Security refers to the fact that a birthday attack on a message digest of size nproduces a collision with a workfactor of approximately 2n/2.3.2 / SECURE HASH FUNCTIONS 71 The algorithm takes as input a message with a maximum length of less than 2128bits and produces as output a 512-bit message digest. The input is processed in 1024-bit blocks. Figure 3.4 depicts the overall processing of a message to produce a digest. The processing consists of the following steps."}, {"id": "e5bccb89550803cd5b803b1030985fda24be7bde", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 86, "start_line": 16, "end_line": 22, "text": "Step 1 Append padding bits: The message is padded so that its length is congruent to 896 modulo 1024 [length 896 (mod 1024)]. Padding is always added,even if the message is already of the desired length. Thus, the number ofpadding bits is in the range of 1 to 1024.The padding consists of a single 1 bitfollowed by the necessary number of 0 bits. Step 2 A ppend length: A block of 128 bits is appended to the message. This block is treated as an unsigned 128-bit integer (most significant byte first) and containsthe length of the original message (before the padding). The outcome of the first two steps yields a message that is an integer multiple of 1024 bits in length. In Figure 3.4, the expanded message is repre-sented as the sequence of 1024-bit blocks M 1,M2, ... , MN, so that the total"}, {"id": "c7903265f8ae6eb6f1b0fc4650fbd6f22692fe10", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 86, "start_line": 23, "end_line": 31, "text": "length of the expanded message is N\u00d71024 bits. Step 3 Initialize hash buffer: A 512-bit buffer is used to hold intermediate and final results of the hash function. The buffer can be represented as eight 64-bit reg-isters (a ,b,c,d,e,f,g,h). These registers are initialized to the following 64-bit integers (hexadecimal values): a6A09E667F3BCC908 e510E527FADE682D1 bBB67AE8584CAA73B f9B05688C2B3E6C1F c3C6EF372FE94F82B g1F83D9ABFB41BD6B dA54FF53A5F1D36F1 h5BE0CD19137E2179 These values are stored in big-endian format, which is the most significantbyte of a word in the low-address (leftmost) byte position. These words wereobtained by taking the first sixty-four bits of the fractional parts of the squareroots of the first eight prime numbers.= == == == =K"}, {"id": "9a3283e8b0ab8cc7ccf246f01f10f745ffdd31c3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 87, "start_line": 1, "end_line": 20, "text": "72CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION N /H11547 1024 bits M1 M2 H2MNMessage hash code1024 bits 1024 bits 1024 bitsL bits L128 bits 512 bits 512 bits 512 bits1000000..0 /H11545/H11549 word-by-word addition mod 264H1F /H11545 IV = H0F /H11545F /H11545 HN Figure 3.4 Message Digest Generation Using SHA-512 Step 4 Process message in 1024-bit (128-word) blocks: The heart of the algorithm is a module that consists of 80 rounds; this module is labeled F in Figure 3.4. The logic is illustrated in Figure 3.5. Each round takes as input the 512-bit buffer value abcdefgh and updates the contents of the buffer. At input to the first round, the buffer hasthe value of the intermediate hash value, H i1. Each round t makes use of a"}, {"id": "9485f5c737ab8e1296a2424dfe99c02034ba86b7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 87, "start_line": 21, "end_line": 30, "text": "64-bit value W tderived from the current 1024-bit block being processed (Mi). Each round also makes use of an additive constant Kt, where 0 \u2026 t\u202679 indicates one of the 80 rounds. These words represent the first 64 bits of thefractional parts of the cube roots of the first 80 prime numbers. The con-stants provide a \u201crandomized\u201d set of 64-bit patterns, which should eliminateany regularities in the input data. The output of the 80th round is added to the input to the first round (H i-1) to produce H i.The addition is done independently for each of the eight words in the buffer with each of the corresponding words in Hi1, using addi- tion modulo 264. Step 5 Output: After all N1024-bit blocks have been processed, the output from the Nth stage is the 512-bit message digest.--"}, {"id": "03b568eeb89a3b05636ada9622242a7df4c5fbbe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 88, "start_line": 1, "end_line": 8, "text": "3.3 / MESSAGE AUTHENTICATION CODES 73 The SHA-512 algorithm has the property that every bit of the hash code is a function of every bit of the input. The complex repetition of the basic function F produces results that are well mixed; that is, it is unlikely that two messages chosenat random, even if they exhibit similar regularities, will have the same hash code.Unless there is some hidden weakness in SHA-512, which has not so far been pub-lished, the difficulty of coming up with two messages having the same messagedigest is on the order of 2 256operations, while the difficulty of finding a message with a given digest is on the order of 2512operations. 3.3 MESSAGE AUTHENTICATION CODES HMAC"}, {"id": "55193b5eb4b4a3fe9cbe6d6833c3cd593b107f78", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 88, "start_line": 9, "end_line": 24, "text": "In recent years, there has been increased interest in developing a MAC derivedfrom a cryptographic hash code, such as SHA-1.The motivations for this interest are \u2022Cryptographic hash functions generally execute faster in software than con-ventional encryption algorithms such as DES. \u2022Library code for cryptographic hash functions is widely available.64Mi Wt HiHi/H115461 W0 W79KtK0 K79a b c Round 0d e f g h a b c Round td e f g hMessage schedule a b c Round 79d e f g h /H11545/H11545/H11545/H11545/H11545/H11545/H11545/H11545 Figure 3.5 SHA-512 Processing of a Single 1024-Bit Block"}, {"id": "eff8e1c7685bf988fbcb684e4d21845fe4418458", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 89, "start_line": 1, "end_line": 8, "text": "74CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION A hash function such as SHA-1 was not designed for use as a MAC and cannot be used directly for that purpose because it does not rely on a secret key. There have been a number of proposals for the incorporation of a secret key intoan existing hash algorithm. The approach that has received the most support isHMAC [BELL96a, BELL96b]. HMAC has been issued as RFC 2104, has beenchosen as the mandatory-to-implement MAC for IP Security, and is used in otherInternet protocols, such as Transport Layer Security (TLS) and Secure ElectronicTransaction (SET). HMAC D ESIGN OBJECTIVES RFC 2104 lists the following design objectives for HMAC. \u2022To use, without modifications, available hash functions. In particular, hash"}, {"id": "68c2d327c70ba5569e255181b9203a8a1ad82428", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 89, "start_line": 9, "end_line": 15, "text": "functions that perform well in software, and for which code is freely andwidely available \u2022To allow for easy replaceability of the embedded hash function in case fasteror more secure hash functions are found or required \u2022To preserve the original performance of the hash function without incurring asignificant degradation \u2022To use and handle keys in a simple way \u2022To have a well-understood cryptographic analysis of the strength of theauthentication mechanism based on reasonable assumptions on the embeddedhash function The first two objectives are important to the acceptability of HMAC. HMAC treats the hash function as a \u201cblack box.\u201d This has two benefits. First, an existing"}, {"id": "c303312e3ac25aaf52cd58ec3a8cf11132b628d3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 89, "start_line": 16, "end_line": 17, "text": "implementation of a hash function can be used as a module in implementingHMAC. In this way, the bulk of the HMAC code is prepackaged and ready to usewithout modification. Second, if it is ever desired to replace a given hash function inan HMAC implementation, all that is required is to remove the existing hash func-tion module and drop in the new module. This could be done if a faster hash func-tion were desired. More important, if the security of the embedded hash functionwere compromised, the security of HMAC could be retained simply by replacingthe embedded hash function with a more secure one. The last design objective in the preceding list is, in fact, the main advantage of"}, {"id": "b4cf528ebb805e956f98b526b1d64aec15295877", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 89, "start_line": 18, "end_line": 26, "text": "HMAC over other proposed hash-based schemes. HMAC can be proven secureprovided that the embedded hash function has some reasonable cryptographicstrengths. We return to this point later in this section, but first we examine thestructure of HMAC. HMAC A LGORITHM Figure 3.6 illustrates the overall operation of HMAC. The following terms are defined: H embedded hash function (e.g., SHA-1) M message input to HMAC (including the padding specified in the embed- ded hash function) Yiith block of M,0 \u2264i\u2264(L 1) L number of blocks in M =- ==="}, {"id": "e65b8191599d22d7adb7d9bd9753ad153d179c4b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 90, "start_line": 1, "end_line": 15, "text": "3.3 / MESSAGE AUTHENTICATION CODES 75 bnumber of bits in a block nlength of hash code produced by embedded hash function K secret key; if key length is greater than b, the key is input to the hash function to produce an n-bit key; recommended length is > n KK padded with zeros on the left so that the result is bbits in length ipad 00110110 (36 in hexadecimal) repeated b/8 times opad 01011100 (5C in hexadecimal) repeated b/8 times Then HMAC can be expressed as HMAC( K,M) H[(K opad) 7 H[(K ipad) 7 M]] In words, HMAC is defined as follows: 1.Append zeros to the left end of Kto create a b -bit string K (e.g., if Kis of length 160 bits and b512, then Kwill be appended with 44 zero bytes). 2.XOR (bitwise exclusive-OR) K with ipad to produce the b-bit block S i.+=+{+{+====+===K/H11545 Si"}, {"id": "a4bd89fa69463bb365f10f7036f4cd9dd9d8ad1b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 90, "start_line": 16, "end_line": 25, "text": "SoY0 Y1 YL/H115461b bits b bitsb bits b bits/H17053ipad K/H11545 opadHash IVn bits n bits pad to b bits Hash IVn bits n bits HMAC(K, M)H(S i || M) /H17053 Figure 3.6 HMAC Structure"}, {"id": "1d1ea4b63e4db4d097f63e3b6fe2a579ad9a794f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 91, "start_line": 1, "end_line": 13, "text": "76CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION 3.Append M to S i. 4.Apply H to the stream generated in step 3. 5.XOR K with opad to produce the b-bit block S o. 6.Append the hash result from step 4 to So. 7.Apply H to the stream generated in step 6 and output the result. Note that the XOR with ipad results in flipping one-half of the bits of K. Similarly, the XOR with opad results in flipping one-half of the bits of K, but a dif- ferent set of bits. In effect, by passing Siand Sothrough the hash algorithm, we have pseudorandomly generated two keys from K. HMAC should execute in approximately the same time as the embedded hash function for long messages. HMAC adds three executions of the basic hash function (for Si,So, and the block produced from the inner hash)."}, {"id": "a7c2cade005291212a37afccd5a38bb4bd2e2132", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 91, "start_line": 14, "end_line": 29, "text": "MACs Based on Block Ciphers In this section, we look at several MACs based on the use of a block cipher. CIPHER -BASED MESSAGE AUTHENTICATION CODE (CMAC) The Cipher-based Message Authentication Code (CMAC) mode of operation is for use with AES and triple DES. It is specified in NIST Special Publication 800-38B. First, let us consider the operation of CMAC when the message is an integer multiple nof the cipher block length b.For AES, b128, and for triple DES, b64. The message is divided into nblocks ( M1,M2,... , Mn). The algorithm makes use of a k-bit encryption key Kand an n-bit key, K1. For AES, the key size kis 128, 192, or 256 bits; for triple DES, the key size is 112 or 168 bits. CMAC is calculated as follows(Figure 3.7). C 1E(K, M1) C2E(K,[ M2C1]) C3E(K,[ M3C2]) \u2022 \u2022\u2022C"}, {"id": "9c010992d3f9d053c0ed5923ec92915c0e2cb2c6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 91, "start_line": 30, "end_line": 39, "text": "nE(K,[ MN Cn1K1]) T MSB Tlen(Cn) where T message authentication code, also referred to as the tag Tlen bit length of T MSB s(X) the sleftmost bits of the bit string X If the message is not an integer multiple of the cipher block length, then the final block is padded to the right (least significant bits) with a 1 and as many 0s as necessary so that the final block is also of length b. The CMAC operation then proceeds as before, except that a different n-bit key K2is used instead of K1.====/H17053-/H17053 =/H17053 =/H17053 === =+"}, {"id": "df78bcfc1b915cc0866b01a051c364e75ec78988", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 92, "start_line": 1, "end_line": 8, "text": "3.3 / MESSAGE AUTHENTICATION CODES 77 To generate the two n -bit keys, the block cipher is applied to the block that consists entirely of 0 bits.The first subkey is derived from the resulting ciphertext by a left shift of one bit and, conditionally, by XORing a constant that depends on theblock size. The second subkey is derived in the same manner from the first subkey. C OUNTER WITH CIPHER BLOCK CHAINING -MESSAGE AUTHENTICATION CODE The CCM mode of operation, defined in NIST SP 800-38C, is referred to as an authenticated encryption mode.Authenticated encryption is a term used to describe"}, {"id": "7ecf4375fb250c56f104036d146dd5739c083def", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 92, "start_line": 9, "end_line": 14, "text": "encryption systems that simultaneously protect confidentiality and authenticity(integrity) of communications. Many applications and protocols require both formsof security, but until recently the two services have been designed separately. The key algorithmic ingredients of CCM are the AES encryption algorithm (Section 2.2), the CTR mode of operation (Section 2.5), and the CMAC authentica-tion algorithm.A single key Kis used for both encryption and MAC algorithms.The input to the CCM encryption process consists of three elements. 1.Data that will be both authenticated and encrypted. This is the plaintextmessage P of data block. 2.Associated data A that will be authenticated but not encrypted. An example is a"}, {"id": "d230519a1ffa55ea64c483dfe54103df02ab8690", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 92, "start_line": 15, "end_line": 27, "text": "protocol header that must be transmitted in the clear for proper protocol opera-tion but which needs to be authenticated.Encrypt KK K TEncrypt Encrypt MSB(Tlen)M1 K1 K2M2 Mn (a) Message length is integer multiple of block size Encrypt KK K TEncrypt Encrypt MSB(Tlen)10...0 (b) Messa ge len gth is not inte ger multi ple of block sizeb k Mn M1 M2 Figure 3.7 Cipher-Based Message Authentication Code (CMAC)"}, {"id": "ba0a51bf07568b5feab5223445e7bba0849b1a5c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 93, "start_line": 1, "end_line": 17, "text": "78CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION 3.A nonce N that is assigned to the payload and the associated data. This is a unique value that is different for every instance during the lifetime of a proto- col association and is intended to prevent replay attacks and certain othertypes of attacks. Figure 3.8 illustrates the operation of CCM. For authentication, the input includes the nonce, the associated data, and the plaintext. This input is formatted as a sequence of blocks B 0through Br.The first block contains the nonce plus some formatting bits that indicate the lengths of the N,A, and Pelements.This is followed(a) Authentication (b) EncryptionB0 Ctr0B1 B2 Br Ta g Ta gNonce Plaintext Plaintext CiphertextAss. Data K CMAC MSB(Tlen)KCTRCtr1, Ctr2, ..., CtrmEncrypt K"}, {"id": "ebdc65a85bf7e4b4024e4e5a5de02f1dbe69d7d1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 93, "start_line": 18, "end_line": 18, "text": "Figure 3.8 Counter with Cipher Block Chaining-Message Authentication Code (CCM)"}, {"id": "ba7394bbb91d5af3787833d6fc35685ec4f3a808", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 94, "start_line": 1, "end_line": 9, "text": "3.4 / PUBLIC-KEY CRYPTOGRAPHY PRINCIPLES 79 by zero or more blocks that contain A, followed by zero of more blocks that contain P.The resulting sequence of blocks serves as input to the CMAC algorithm, which produces a MAC value with length Tlen, which is less than or equal to the block length (Figure 3.8a). For encryption, a sequence of counters is generated that must be independent of the nonce. The authentication tag is encrypted in CTR mode using the single counter Ctr0. The Tlen most significant bits of the output are XORed with the tag to produce an encrypted tag. The remaining counters are used for the CTR modeencryption of the plaintext (Figure 2.12). The encrypted plaintext is concatenatedwith the encrypted tag to form the ciphertext output (Figure 3.8b)."}, {"id": "eb05a53191743b853d98b409f87844e3d14ba080", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 94, "start_line": 10, "end_line": 13, "text": "3.4 PUBLIC-KEY CRYPTOGRAPHY PRINCIPLES Of equal importance to conventional encryption is public-key encryption, which finds use in message authentication and key distribution. This section looks first atthe basic concept of public-key encryption and takes a preliminary look at key dis-tribution issues. Section 3.5 examines the two most important public-key algorithms:RSA and Diffie-Hellman. Section 3.6 introduces digital signatures. Public-Key Encryption Structure"}, {"id": "c6ee00775cd3d64a3f0827ed7ccc859fb72a7d57", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 94, "start_line": 14, "end_line": 15, "text": "Public-key encryption, first publicly proposed by Diffie and Hellman in 1976[DIFF76], is the first truly revolutionary advance in encryption in literally thousandsof years. Public-key algorithms are based on mathematical functions rather than onsimple operations on bit patterns, such as are used in symmetric encryption algo-rithms. More important, public-key cryptography is asymmetric, involving the use oftwo separate keys\u2014in contrast to the symmetric conventional encryption, whichuses only one key. The use of two keys has profound consequences in the areas ofconfidentiality, key distribution, and authentication. Before proceeding, we should first mention several common misconceptions"}, {"id": "1c64e7c394b70d241740923c609883f45c93ea60", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 94, "start_line": 16, "end_line": 16, "text": "concerning public-key encryption. One is that public-key encryption is more securefrom cryptanalysis than conventional encryption. In fact, the security of anyencryption scheme depends on (1) the length of the key and (2) the computationalwork involved in breaking a cipher. There is nothing in principle about either con-ventional or public-key encryption that makes one superior to another from thepoint of view of resisting cryptanalysis. A second misconception is that public-keyencryption is a general-purpose technique that has made conventional encryptionobsolete. On the contrary, because of the computational overhead of currentpublic-key encryption schemes, there seems no foreseeable likelihood that conven-tional encryption will be abandoned. Finally, there is a feeling that key distributionis trivial when using public-key encryption, compared to the rather cumbersomehandshaking involved with key distribution centers for conventional encryption.In fact, some form of protocol is needed, often involving a central agent, and theprocedures involved are no simpler or any more efficient than those required forconventional encryption."}, {"id": "c8af60a5d116157c20abf64251f94b645b8746ff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 95, "start_line": 1, "end_line": 37, "text": "80CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION A public-key encryption scheme has six ingredients (Figure 3.9a). \u2022Plaintext: This is the readable message or data that is fed into the algorithm as input. \u2022Encryption algorithm: The encryption algorithm performs various transforma- tions on the plaintext.Plaintext inputBobs's public key ring Transmitted ciphertext Y /H11005 E[PU a, X]X /H11005 D[PR a, Y] Plaintext output Encryption algorithm (e.g., RSA)Decryption algorithmJoy Mike Mike BobTed Alice X Plaintext inputTransmitted ciphertext Y /H11005 E[PR b, X]X /H11005 D[PU b, Y] Plaintext output Encryption algorithm (e.g., RSA)XAlice's public key Bob's public keyPU a PU b Bob's private keyPRbPRaAlice's private key Decryption algorithmAlice's public key ring"}, {"id": "79a3539ab6544569ef01f3439c460815b5b925e1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 95, "start_line": 38, "end_line": 40, "text": "JoyTed(a) Encryption with public key Bob Alice (b) Encryption with private key Bob Alice Figure 3.9 Public-Key Cryptography"}, {"id": "c080d0d6cd7584903a79f5beb83bc72f1df27751", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 96, "start_line": 1, "end_line": 10, "text": "3.4 / PUBLIC-KEY CRYPTOGRAPHY PRINCIPLES 81 \u2022Public and private key: This is a pair of keys that have been selected so that if one is used for encryption, the other is used for decryption. The exact trans- formations performed by the encryption algorithm depend on the public orprivate key that is provided as input. \u2022Ciphertext: This is the scrambled message produced as output. It depends on the plaintext and the key. For a given message, two different keys will producetwo different ciphertexts. \u2022Decryption algorithm: This algorithm accepts the ciphertext and the matching key and produces the original plaintext. As the names suggest, the public key of the pair is made public for others to use, while the private key is known only to its owner. A general-purpose public-key"}, {"id": "355e011ebedc8acd4d6edf2dc184b07bc1cdbaba", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 96, "start_line": 11, "end_line": 16, "text": "cryptographic algorithm relies on one key for encryption and a different but relatedkey for decryption. The essential steps are the following: 1.Each user generates a pair of keys to be used for the encryption and decryp-tion of messages. 2.Each user places one of the two keys in a public register or other accessible file.This is the public key.The companion key is kept private.As Figure 3.9a suggests,each user maintains a collection of public keys obtained from others. 3.If Bob wishes to send a private message to Alice, Bob encrypts the message usingAlice\u2019s public key. 4.When Alice receives the message, she decrypts it using her private key. Noother recipient can decrypt the message because only Alice knows Alice\u2019s pri-vate key."}, {"id": "e9604759672fbc6918beb39a9327ae85406ab32f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 96, "start_line": 17, "end_line": 23, "text": "With this approach, all participants have access to public keys, and private keys are generated locally by each participant and therefore need never be distrib- uted. As long as a user protects his or her private key, incoming communication issecure. At any time, a user can change the private key and publish the companionpublic key to replace the old public key. The key used in conventional encryption is typically referred to as a secret key. The two keys used for public-key encryption are referred to as the public key and the private key. Invariably, the private key is kept secret, but it is referred to as a privatekey rather than a secret key to avoid confusion with conventional encryption. Applications for Public-Key Cryptosystems"}, {"id": "d14695c02e84dd45cf9db46547b60e1941515b7a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 96, "start_line": 24, "end_line": 26, "text": "Before proceeding, we need to clarify one aspect of public-key cryptosystems that isotherwise likely to lead to confusion. Public-key systems are characterized by theuse of a cryptographic type of algorithm with two keys, one held private and oneavailable publicly. Depending on the application, the sender uses either the sender\u2019sprivate key, the receiver\u2019s public key, or both to perform some type of cryptographicfunction. In broad terms, we can classify the use of public-key cryptosystems intothree categories: \u2022Encryption/decryption: The sender encrypts a message with the recipient\u2019s public key."}, {"id": "a970ce5c0500e7a402c8b86850cbe6d5b8e94988", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 97, "start_line": 1, "end_line": 14, "text": "82CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION Table 3.2 Applications for Public-Key Cryptosystems Algorithm Encryption/Decryption Digital Signature Key Exchange RSA Yes Yes Yes Diffie-Hellman No No Yes DSS No Yes No Elliptic curve Yes Yes Yes \u2022Digital signature: The sender \u201csigns\u201d a message with its private key. Signing is achieved by a cryptographic algorithm applied to the message or to a small block of data that is a function of the message. \u2022Key exchange: Two sides cooperate to exchange a session key. Several different approaches are possible, involving the private key(s) of one or both parties. Some algorithms are suitable for all three applications, whereas others can be used only for one or two of these applications. Table 3.2 indicates the applications"}, {"id": "378c74e1639f7a49d90485f3a8c8c77dcab43e8f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 97, "start_line": 15, "end_line": 23, "text": "supported by the algorithms discussed in this chapter: RSA and Diffie Hellman.This table also includes the Digital Signature Standard (DSS) and elliptic-curvecryptography, also mentioned later in this chapter. Requirements for Public-Key Cryptography The cryptosystem illustrated in Figure 3.9 depends on a cryptographic algorithmbased on two related keys. Diffie and Hellman postulated this system withoutdemonstrating that such algorithms exist. However, they did lay out the conditionsthat such algorithms must fulfill [DIFF76]: 1.It is computationally easy for a party B to generate a pair (public key PU b, private key PRb). 2.It is computationally easy for a sender A, knowing the public key and the mes-sage to be encrypted, M, to generate the corresponding ciphertext: C E(PU b,M)"}, {"id": "0897a48f1a84ec38f56cf64b29fc54b83efe865d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 97, "start_line": 24, "end_line": 35, "text": "3.It is computationally easy for the receiver B to decrypt the resulting ciphertextusing the private key to recover the original message: M D(PR b,C) D[PR b,E (PU b,M)] 4.It is computationally infeasible for an opponent, knowing the public key, PU b,t o determine the private key, PRb. 5.It is computationally infeasible for an opponent, knowing the public key, PU b, and a ciphertext, C, to recover the original message, M. We can add a sixth requirement that, although useful, is not necessary for all public-key applications. 6.Either of the two related keys can be used for encryption, with the other usedfor decryption. M D[PU b,E (PRb,M)] D[PR b,E (PU b,M)] = == =="}, {"id": "a01f551a4a6aaa46786dba055b98c2d8bbeb9266", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 98, "start_line": 1, "end_line": 11, "text": "3.5 / PUBLIC-KEY CRYPTOGRAPHY ALGORITHMS 83 3.5 PUBLIC-KEY CRYPTOGRAPHY ALGORITHMS The two most widely used public-key algorithms are RSA and Diffie-Hellman. We look at both of these in this section and then briefly introduce two other algorithms.4 The RSA Public-Key Encryption Algorithm One of the first public-key schemes was developed in 1977 by Ron Rivest, AdiShamir, and Len Adleman at MIT and first published in 1978 [RIVE78]. The RSAscheme has since that time reigned supreme as the most widely accepted and imple-mented approach to public-key encryption. RSA is a block cipher in which the plaintext and ciphertext are integers between 0 and n1 for some n. Encryption and decryption are of the following form period for some plaintext block Mand ciphertext block C: CM emod n"}, {"id": "0a64799abda227a82641ef16c79e6a0487fb1f7a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 98, "start_line": 12, "end_line": 23, "text": "MCdmod n (Me)dmod nMedmod n Both sender and receiver must know the values of nand e, and only the receiver knows the value of d.This is a public-key encryption algorithm with a pub- lic key of KU {e,n} and a private key of KR {d,n}. For this algorithm to be sat- isfactory for public-key encryption, the following requirements must be met. 1.It is possible to find values of e,d,nsuch that Medmod nM for all M< n. 2.It is relatively easy to calculate Meand Cdfor all values of M < n. 3.It is infeasible to determine dgiven e and n. The first two requirements are easily met. The third requirement can be met for large values of eand n. Figure 3.10 summarizes the RSA algorithm. Begin by selecting two prime numbers pand qand calculating their product n, which is the modulus for encryp-"}, {"id": "191e7f9f3da54a79e630622f191e111e4b6382d6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 98, "start_line": 24, "end_line": 34, "text": "tion and decryption. Next, we need the quantity f(n), referred to as the Euler totient of n, which is the number of positive integers less than nand relatively prime to n.Then select an integer ethat is relatively prime to f(n) [i.e., the greatest com- mon divisor of eand f(n) is 1]. Finally, calculate das the multiplicative inverse of e, modulo f(n). It can be shown that dand e have the desired properties. Suppose that user A has published its public key and that user B wishes to send the message Mto A. Then B calculates CMe(mod n) and transmits C.On receipt of this ciphertext, user A decrypts by calculating MCd(mod n). ==== == = ==- An example, from [SING99], is shown in Figure 3.11. For this example, the keys were generated as follows: 1.Select two prime numbers, p17 and q 11."}, {"id": "3afa85d34c0e357bc383eef7a778187c3bd65fee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 98, "start_line": 35, "end_line": 36, "text": "2.Calculate np q17 \u00d7 11 187.= = == = 4This section uses some elementary concepts from number theory. For a review, see Appendix A."}, {"id": "26f430d47c5a6f65f22c3f36dc66096bc8de3899", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 99, "start_line": 1, "end_line": 18, "text": "84CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION 3.Calculate f (n) (p 1)(q 1) 16 \u00d710 160. 4.Select esuch that e is relatively prime to f (n) 160 and less than f(n); we choose e7. 5.Determine dsuch that demod 160 1 and d < 160.The correct value is d23, because 23 \u00d7 7 161 (1 \u00d7160) 1. The resulting keys are public key PU {7, 187} and private key PR {23, 187}. The example shows the use of these keys for a plaintext input of M 88. For== =+ = == ==== = - - =Select p, q Select integer eCalculate n = p \u00d7 q Calculate dCalculate \u03c6(n) = (p \u2013 1)(q \u2013 1)p and q both prime, p \u2260 qKey Generation Encryptiongcd (\u03c6(n), e) = 1; 1 < e < \u03c6(n) Public keyde mod \u03c6(n) = 1 KU = {e, n} Plaintext: M < n Ciphertext: C = Me (mod n)Private key KR = {d, n} Decryption Ciphertext: C Plaintext: M = Cd (mod n)"}, {"id": "a4f808e52b164531426ff97dea59fe32e42b7a30", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 99, "start_line": 19, "end_line": 28, "text": "Figure 3.10 The RSA Algorithm Encryption plaintext 88plaintext 88ciphertext 1188 mod 187 /H11549 11 PU /H11549 7, 187Decryption 711 mod 187 /H11549 88 PR /H11549 23, 18723 Figure 3.11 Example of RSA Algorithm"}, {"id": "dbac2beaf0cbfae4c80a370ce432c8292637a641", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 100, "start_line": 1, "end_line": 18, "text": "3.5 / PUBLIC-KEY CRYPTOGRAPHY ALGORITHMS 85 encryption, we need to calculate C 887mod 187. Exploiting the properties of modular arithmetic, we can do this as follows: 887mod 187 [(884mod 187) \u00d7(882mod 187) \u00d7(881mod 187)] mod 187 881mod 187 88 882mod 187 7744 mod 187 77 884mod 187 59,969,536 mod 187 132 887mod 187 (88 \u00d777 \u00d7 132) mod 187 894,432 mod 187 11 For decryption, we calculate M 1123mod 187: 1123mod 187 [(111mod 187) \u00d7(112mod 187) \u00d7(114mod 187) \u00d7 (118mod 187) \u00d7(118mod 187)] mod 187 111mod 187 11 112mod 187 121 114mod 187 14,641 mod 187 55 118mod 187 214,358,881 mod 187 33 1123mod 187 (11 \u00d7121 \u00d7 55 \u00d7 33 \u00d7 33) mod 187 79,720,245 mod 187 88 There are two possible approaches to defeating the RSA algorithm.The first is"}, {"id": "8ea3954560397ef2568e71ff8f3150f2734ef112", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 100, "start_line": 19, "end_line": 24, "text": "the brute-force approach: Try all possible private keys. Thus, the larger the number of bits in eand d, the more secure the algorithm. However, because the calculations involved (both in key generation and in encryption/decryption) are complex, thelarger the size of the key, the slower the system will run. Most discussions of the cryptanalysis of RSA have focused on the task of fac- toring ninto its two prime factors. For a large nwith large prime factors, factoring is a hard problem, but not as hard as it used to be. A striking illustration of thisoccurred in 1977; the three inventors of RSA challenged Scientific American readers"}, {"id": "30412042396e3c288464b7cf49e63592607fb95e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 100, "start_line": 25, "end_line": 27, "text": "to decode a cipher they printed in Martin Gardner\u2019s \u201cMathematical Games\u201d column[GARD77]. They offered a $100 reward for the return of a plaintext sentence, anevent they predicted might not occur for some 40 quadrillion years. In April of 1994,a group working over the Internet and using over 1600 computers claimed the prizeafter only eight months of work [LEUT94]. This challenge used a public-key size(length of n ) of 129 decimal digits (approximately 428 bits). This result does not invalidate the use of RSA; it simply means that larger key sizes must be used.Currently, a 1024-bit key size (about 300 decimal digits) is considered strong enoughfor virtually all applications. Diffie-Hellman Key Exchange"}, {"id": "3483bec2040c1c7b1db8f4e9422ca7292d7d671e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 100, "start_line": 28, "end_line": 29, "text": "The first published public-key algorithm appeared in the seminal paper by Diffieand Hellman that defined public-key cryptography [DIFF76] and is generallyreferred to as the Diffie-Hellman key exchange . A number of commercial products employ this key exchange technique.= === == ====== = == == ===="}, {"id": "eaae703bc223d289ff88e2f882cfb86e660b9ac3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 101, "start_line": 1, "end_line": 11, "text": "86CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION The purpose of the algorithm is to enable two users to exchange a secret key securely that then can be used for subsequent encryption of messages. The algo- rithm itself is limited to the exchange of the keys. The Diffie-Hellman algorithm depends for its effectiveness on the difficulty of computing discrete logarithms. Briefly, we can define the discrete logarithm in thefollowing way. First, we define a primitive root of a prime number pas one whose powers generate all the integers from 1 to p1.That is, if ais a primitive root of the prime number p, then the numbers amod p, a 2mod p,... , ap1mod p are distinct and consist of the integers from 1 through p 1 in some permutation."}, {"id": "a7003853029a4c7fee1008888fd4510da1b946e4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 101, "start_line": 12, "end_line": 23, "text": "For any integer bless than pand a primitive root aof prime number p, one can find a unique exponent isuch that baimod p 0 \u2026i\u2026(p 1) The exponent iis referred to as the discrete logarithm, or index, of bfor the base a, mod p. We denote this value as dlog a,p(b).5 THEALGORITHM With this background, we can define the Diffie-Hellman key exchange, which is summarized in Figure 3.12. For this scheme, there are two publiclyknown numbers: a prime number q and an integer \u03b1that is a primitive root of q. Suppose the users A and B wish to exchange a key. User A selects a random integerX A< qand computes Similarly, user B independently selects a random integer X B< qand computes Each side keeps the Xvalue private and makes the Y value available publicly to the other side. User A computes"}, {"id": "eda1374a8d7ead3ef49939a7ab3fefd7e0e5045c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 101, "start_line": 24, "end_line": 33, "text": "the key as and user B computes the key as These two calculations produce identical results: The result is that the two sides have exchanged a secret value. Furthermore, because X Aand XBare private, an adversary only has the following ingredients to work with: q,,YA, and YB. Thus, the adversary is forced to take a discrete loga- rithm to determine the key. For example, to determine the private key of user B, anadversary must compute X Bdlog \u03b1,q(YB) =a=1YA2XB mod q=1aXA mod q2XB mod q=1aXA2XB mod q=aXBXA mod q=1aXB2XA mod q=1aXB mod q2XA mod qK=1YB2XA mod qK=1YA2XB mod q. K=1YB2XA mod qYB=aXB mod q.YA=aXA mod q.- =--- 5Many texts refer to the discrete logarithm as the index. There is no generally agreed notation for this concept, much less an agreed name."}, {"id": "be2c8adc51d6982f2b12bd0fcc5d25a4fc90313d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 102, "start_line": 1, "end_line": 12, "text": "3.5 / PUBLIC-KEY CRYPTOGRAPHY ALGORITHMS 87 The adversary can then calculate the key Kin the same manner as user B does. The security of the Diffie-Hellman key exchange lies in the fact that, while it is relatively easy to calculate exponentials modulo a prime, it is very difficult to calcu- late discrete logarithms. For large primes, the latter task is considered infeasible. Here is an example. Key exchange is based on the use of the prime number q 353 and a primitive root of 353, in this case \u03b1 3. A and B select secret keys XA 97 and X B233, respectively. Each computes its public key: A computes YA 397mod 353 40. B computes YB 3233mod 353 248. After they exchange public keys, each can compute the common secret key: A computes K (YB) mod 353 24897mod 353 160."}, {"id": "3b14e47e014220090a9aae81092a2bebb782daba", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 102, "start_line": 13, "end_line": 27, "text": "B computes K (YA) mod 353 40233mod 353 160. We assume an attacker would have available the following information: q353; \u03b1 3;YA 40; YB248= = = == =XB == =XA == == == == =q prime number aa /H11021 q and a a primitive root of q User A Key GenerationGlobal Public Elements Select private XA XA /H11021 q Calculate public Y A YA /H11005 aXA mod q User B Key Generation Select private XB XB /H11021 q Calculate public Y B YB /H11005 aXB mod q Generation of Secret Key by User A K /H11005 (Y B)XA mod q Generation of Secret Key by User B K /H11005 (Y A)XB mod q Figure 3.12 The Diffie-Hellman Key Exchange Algorithm"}, {"id": "c74c43600cb9b2c96137d3b4db7399c7220f3445", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 103, "start_line": 1, "end_line": 8, "text": "88CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION In this simple example, it would be possible to determine the secret key 160 by brute force. In particular, an attacker E can determine the common key by discovering asolution to the equation 3 amod 353 40 or the equation 3bmod 353 248. The brute-force approach is to calculate powers of 3 modulo 353, stopping when theresult equals either 40 or 248. The desired answer is reached with the exponentvalue of 97, which provides 3 97mod 353 40. With larger numbers, the problem becomes impractical. KEYEXCHANGE PROTOCOLS Figure 3.13 shows a simple protocol that makes use of"}, {"id": "8c952645137cef743222b73fd5a212addae77627", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 103, "start_line": 9, "end_line": 17, "text": "the Diffie-Hellman calculation. Suppose that user A wishes to set up a connectionwith user B and use a secret key to encrypt messages on that connection. User A cangenerate a one-time private key X A, calculate YA, and send that to user B. User B responds by generating a private value XB, calculating YB, and sending Y Bto user A. Both users can now calculate the key. The necessary public values q and \u03b1would need to be known ahead of time. Alternatively, user A could pick values for qand \u03b1 and include those in the first message. As an example of another use of the Diffie-Hellman algorithm, suppose that a group of users (e.g., all users on a LAN) each generate a long-lasting private valueX Aand calculate a public value YA.These public values, together with global public"}, {"id": "ee0d16a653eaad286f19ef491c20921991c184e3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 103, "start_line": 18, "end_line": 23, "text": "values for q and \u03b1, are stored in some central directory. At any time, user B can access user A\u2019s public value, calculate a secret key, and use that to send an encryptedmessage to user A. If the central directory is trusted, then this form of communica-tion provides both confidentiality and a degree of authentication. Because only Aand B can determine the key, no other user can read the message (confidentiality).Recipient A knows that only user B could have created a message using this key(authentication). However, the technique does not protect against replay attacks. M AN-IN-THE-MIDDLE ATTACK The protocol depicted in Figure 3.13 is insecure against a man-in-the-middle attack. Suppose Alice and Bob wish to exchange keys, and Darth is the adversary. The attack proceeds as follows:"}, {"id": "8acae5a37222b1539e35873e077141dcd11fb25f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 103, "start_line": 24, "end_line": 37, "text": "1.Darth prepares for the attack by generating two random private keys XD1and XD2, and then computing the corresponding public keys YD1and Y D2.== =YA YBUser A User B Generate random X A /H11021 q; Calculate Y A /H11005 aXA mod qGenerate random X B /H11021 q; Calculate Y B /H11005 aXB mod q; Calculate K /H11005 (Y A)XB mod q Calculate K /H11005 (Y B)XA mod q Figure 3.13 Diffie-Hellman Key Exchange"}, {"id": "b336b89d5fd2df98e9cdf5cfdc7fe3a4f0119d98", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 104, "start_line": 1, "end_line": 13, "text": "3.5 / PUBLIC-KEY CRYPTOGRAPHY ALGORITHMS 89 2.Alice transmits Y Ato Bob. 3.Darth intercepts Y Aand transmits Y D1to Bob. Darth also calculates 4.Bob receives Y D1and calculates 5.Bob transmits Y Bto Alice. 6.Darth intercepts Y Band transmits Y D2to Alice. Darth calculates 7.Alice receives YD2and calculates At this point, Bob and Alice think that they share a secret key. Instead Bob and Darth share secret key K1, and Alice and Darth share secret key K2. All future communication between Bob and Alice is compromised in the following way: 1.Alice sends an encrypted message M:E ( K2,M). 2.Darth intercepts the encrypted message and decrypts it to recover M. 3.Darth sends Bob E( K1,M) or E(K1, M'), where M' is any message. In the first"}, {"id": "4122ba2e3494ac262591b025f68b069738a44816", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 104, "start_line": 14, "end_line": 24, "text": "case, Darth simply wants to eavesdrop on the communication without altering it. In the second case, Darth wants to modify the message going to Bob. The key exchange protocol is vulnerable to such an attack because it does not authenticate the participants. This vulnerability can be overcome with the use of digital signatures and public-key certificates; these topics are explored later in thischapter and in Chapter 4. Other Public-Key Cryptography Algorithms Two other public-key algorithms have found commercial acceptance: DSS andelliptic-curve cryptography. D IGITAL SIGNATURE STANDARD The National Institute of Standards and Technology (NIST) has published Federal Information Processing Standard FIPS PUB 186, known as the Digital Signature Standard (DSS) . The DSS makes use of the SHA-1"}, {"id": "2be543b46c122f5a32338b20629d93badac2bde3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 104, "start_line": 25, "end_line": 28, "text": "and presents a new digital signature technique, the Digital Signature Algorithm(DSA). The DSS was originally proposed in 1991 and revised in 1993 in response topublic feedback concerning the security of the scheme. There was a further minorrevision in 1996. The DSS uses an algorithm that is designed to provide only thedigital signature function. Unlike RSA, it cannot be used for encryption or keyexchange. E LLIPTIC -CURVE CRYPTOGRAPHY The vast majority of the products and standards that use public-key cryptography for encryption and digital signatures use RSA.The"}, {"id": "fc1b0555edbfd70486c1393dc9f57d3122705bee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 104, "start_line": 29, "end_line": 34, "text": "bit length for secure RSA use has increased over recent years, and this has put aheavier processing load on applications using RSA. This burden has ramifications,especially for electronic commerce sites that conduct large numbers of securetransactions. Recently, a competing system has begun to challenge RSA: elliptic curve cryptography (ECC) . Already, ECC is showing up in standardization efforts, including the IEEE P1363 Standard for Public-Key Cryptography. The principal attraction of ECC compared to RSA is that it appears to offer equal security for a far smaller bit size, thereby reducing processing overhead. OnK2=1Y D22XA mod q.K1=1YB2XD1 mod q.K1=1YD12XB mod q.K2=1YA2XD2 mod q."}, {"id": "57d5f308c4b47882aebeda682b82dbf984e8ff09", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 105, "start_line": 1, "end_line": 6, "text": "90CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION the other hand, although the theory of ECC has been around for some time, it is only recently that products have begun to appear and that there has been sustainedcryptanalytic interest in probing for weaknesses. Thus, the confidence level in ECCis not yet as high as that in RSA. ECC is fundamentally more difficult to explain than either RSA or Diffie- Hellman, and a full mathematical description is beyond the scope of this book. Thetechnique is based on the use of a mathematical construct known as the elliptic curve. 3.6 DIGITAL SIGNATURES"}, {"id": "3e8d54914dce98cbd0df0e330911eea2070cd1d8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 105, "start_line": 7, "end_line": 7, "text": "Public-key encryption can be used in another way, as illustrated in Figure 3.9b.Suppose that Bob wants to send a message to Alice, and although it is not impor-tant that the message be kept secret, he wants Alice to be certain that the messageis indeed from him. In this case, Bob uses his own private key to encrypt the mes-sage. When Alice receives the ciphertext, she finds that she can decrypt it withBob\u2019s public key, thus proving that the message must have been encrypted by Bob.No one else has Bob\u2019s private key, and therefore no one else could have created aciphertext that could be decrypted with Bob\u2019s public key. Therefore, the entireencrypted message serves as a digital signature. In addition, it is impossible to"}, {"id": "087b274abc4ab585046f1e48d845d41c59da6011", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 105, "start_line": 8, "end_line": 9, "text": "alter the message without access to Bob\u2019s private key, so the message is authenti-cated both in terms of source and in terms of data integrity. In the preceding scheme, the entire message is encrypted. Although validating"}, {"id": "158bd6ee5c016ad0d5f0ce305f8f3153b125b321", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 105, "start_line": 10, "end_line": 10, "text": "both author and contents, this requires a great deal of storage. Each document mustbe kept in plaintext to be used for practical purposes. A copy also must be stored inciphertext so that the origin and contents can be verified in case of a dispute.A more efficient way of achieving the same results is to encrypt a small block of bitsthat is a function of the document. Such a block, called an authenticator, must havethe property that it is infeasible to change the document without changing theauthenticator. If the authenticator is encrypted with the sender\u2019s private key, itserves as a signature that verifies origin, content, and sequencing. A secure hashcode such as SHA-1 can serve this function. Figure 3.2b illustrates this scenario."}, {"id": "8e69ac07c1b389a4a691ded38eca79ab777b4657", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 105, "start_line": 11, "end_line": 16, "text": "It is important to emphasize that the encryption process just described does not provide confidentiality. That is, the message being sent is safe from alterationbut not safe from eavesdropping. This is obvious in the case of a signature based ona portion of the message, because the rest of the message is transmitted in the clear.Even in the case of complete encryption, there is no protection of confidentialitybecause any observer can decrypt the message by using the sender\u2019s public key. 3.7 RECOMMENDED READING AND WEB SITES Solid treatments of hash functions and message authentication codes are found in [STIN06] and {MENE97]. The recommended treatments of encryption provided in Chapter 2 cover public-key as"}, {"id": "3921b1ea095426dc9e85e71f71d90823d85c35ed", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 105, "start_line": 17, "end_line": 17, "text": "well as conventional encryption. [DIFF88] describes in detail the several attempts to devise securetwo-key cryptoalgorithms and the gradual evolution of a variety of protocols based on them."}, {"id": "42c2c136872d8432b6f15e59bd63eb33b4ac3f02", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 106, "start_line": 1, "end_line": 17, "text": "3.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 91 DIFF88 Diffie, W. \u201cThe First Ten Years of Public-Key Cryptography.\u201d Procedings of the IEEE, May 1988. MENE97 Menezes,A.; Oorschot, P .; and Vanstone, S. Handbook of Applied Cryptography. Boca Raton, FL: CRC Press, 1997. STIN06 Stinson, D. Cryptography: Theory and Practice. Boca Raton, FL: Chapman&Hall/ CRC Press, 2006. Recommended Web Sites: \u2022NIST Secure Hashing Page: SHA FIPS and related documents. \u2022RSA Laboratories: Extensive collection of technical material on RSA and other topics in cryptography. \u2022Digital Signatures: NIST page with information on NIST-approved digital signature options. 3.8 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms authenticated encryption Diffie-Hellman key exchangedigital signatureDigital Signature Standard"}, {"id": "d40d1c992a73daf4d4af854bb8624af055bbf57c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 106, "start_line": 18, "end_line": 31, "text": "(DSS) elliptic-curve cryptography (ECC) HMACkey exchangeMD5message authenticationmessage authentication code (MAC) message digestone-way hash functionprivate keypublic keypublic-key certificatepublic-key encryptionRIPEMD-160RSAsecret keysecure hash functionSHA-1strong collision resistanceweak collision resistance Review Questions 3.1 List three approaches to message authentication. 3.2 What is a message authentication code? 3.3 Briefly describe the three schemes illustrated in Figure 3.2. 3.4 What properties must a hash function have to be useful for message authentication? 3.5 In the context of a hash function, what is a compression function? 3.6 What are the principal ingredients of a public-key cryptosystem? 3.7 List and briefly define three uses of a public-key cryptosystem."}, {"id": "2e795e77371b614d5c84690ccf70d593f6ecd925", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 107, "start_line": 1, "end_line": 11, "text": "92CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION 3.8 What is the difference between a private key and a secret key? 3.9 What is a digital signature? Problems 3.1 Consider a 32-bit hash function defined as the concatenation of two 16-bit functions: XOR and RXOR, which are defined in Section 3.2 as \u201ctwo simple hash functions.\u201d a.Will this checksum detect all errors caused by an odd number of error bits? Explain. b.Will this checksum detect all errors caused by an even number of error bits? Ifnot, characterize the error patterns that will cause the checksum to fail. c.Comment on the effectiveness of this function for use as a hash function forauthentication. 3.2 Suppose H( m) is a collision-resistant hash function that maps a message of arbitrary"}, {"id": "a55da951ff5aca1a15d8e76a0c1a1f1b30b6a2a2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 107, "start_line": 12, "end_line": 25, "text": "bit length into an n-bit hash value. Is it true that, for all messages x,x' with xx ', we have H(x)H ( x')? Explain your answer. 3.3 State the value of the padding field in SHA-512 if the length of the message is a.1919 bits b.1920 bits c.1921 bits 3.4 State the value of the length field in SHA-512 if the length of the message isa.1919 bits b.1920 bits c.1921 bits 3.5 a. Consider the following hash function. Messages are in the form of a sequence ofZ[ 6I thank William K. Mason of the magazine staff of The Cryptogram for providing this example.decimal numbers, M (a1,a2,... , at). The hash value his calculated as , aat i=1aibmod n = for some predefined value n. Does this hash function satisfy any of the requirements for a hash function listed in Section 3.2? Explain your answer."}, {"id": "1bfca9cc918b1734b41acd0b679b314351464de0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 107, "start_line": 26, "end_line": 35, "text": "b.Repeat part (a) for the hash function . h=aat i=1(ai)2bmod n A B C D 0123 4567 8 9 10 11 12 13 14 15EFG H IJ K L MNO Pc.Calculate the hash function of part (b) for M (189, 632, 900, 722, 349) and n 989. 3.6 This problem introduces a hash function similar in spirit to SHA that operates on let- ters instead of binary data. It is called the toy tetragraph hash (tth).6Given a message"}, {"id": "0e4f43b4d62cbf8a5b9d741b46057c4a131b53cc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 107, "start_line": 36, "end_line": 39, "text": "consisting of a sequence of letters, tth produces a hash value consisting of four letters.First, tth divides the message into blocks of 16 letters, ignoring spaces, punctuation, andcapitalization. If the message length is not divisible by 16, it is padded out with nulls.A four-number running total is maintained that starts out with the value (0, 0, 0, 0); thisis input to the compression function for processing the first block. The compressionfunction consists of two rounds. Round 1: Get the next block of text and arrange it as a row-wise 4 \u00d7 4 block of text and covert it to numbers (A 0, B 1, etc.). For example, for the block ABCDEFGHIJKLMNOP , we have = == ="}, {"id": "17bc4d2225599080a7960c4487f8623d09dae52e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 108, "start_line": 1, "end_line": 12, "text": "3.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 93 Then, add each column mod 26 and add the result to the running total, mod 26. In this example, the running total is (24, 2, 6, 10). Round 2: Using the matrix from round 1, rotate the first row left by 1, second row left by 2, third row left by 3, and reverse theorder of the fourth row. In our example: B C D A 1230 6745 11 8 9 10 15 14 13 12GHE F LIJK PON M Now, add each column mod 26 and add the result to the running total. The new run- ning total is (5, 7, 9, 11). This running total is now the input into the first round of thecompression function for the next block of text. After the final block is processed,convert the final running total to letters. For example, if the message is ABCDEFGHIJKLMNOP , then the hash is FHJL."}, {"id": "fb82ec22a04d14bb982f8d91ce0cd57a4242a56e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 108, "start_line": 13, "end_line": 17, "text": "a.Draw figures comparable to Figures 3.4 and 3.5 to depict the overall tth logic and the compression function logic. b.Calculate the hash function for the 48-letter message \u201cI leave twenty million dollarsto my friendly cousin Bill.\u201d c.To demonstrate the weakness of tth, find a 48-letter block that produces the samehash as that just derived. Hint: Use lots of A\u2019s. 3.7 It is possible to use a hash function to construct a block cipher with a structure similarto DES. Because a hash function is one way and a block cipher must be reversible (todecrypt), how is it possible?"}, {"id": "cc800256f61c894c54e1cf76f25c33ed9db4f0a0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 108, "start_line": 18, "end_line": 20, "text": "3.8 Now consider the opposite problem: Use an encryption algorithm to construct a one-way hash function. Consider using RSA with a known key. Then process a message con-sisting of a sequence of blocks as follows: Encrypt the first block, XOR the result withthe second block and encrypt again, and so on. Show that this scheme is not secure bysolving the following problem. Given a two-block message B1, B2, and its hash, we have RSAH(B1, B2) RSA(RSA(B1) B2) Given an arbitrary block C1, choose C2 so that RSAH(C1, C2) RSAH(B1, B2).Thus, the hash function does not satisfy weak collision resistance."}, {"id": "e2d19da0910508b16213f8af4df01f16b55cc186", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 108, "start_line": 21, "end_line": 25, "text": "3.9 One of the most widely used MACs, referred to as the Data Authentication Algorithm,is based on DES. The algorithm is both a FIPS publication (FIPS PUB 113) andan ANSI standard (X9.17). The algorithm can be defined as using the cipher blockchaining (CBC) mode of operation of DES with an initialization vector of zero(Figure 2.10). The data (e.g., message, record, file, or program) to be authenticated isgrouped into contiguous 64-bit blocks: P 1,P2,..., PN.If necessary, the final block is padded on the right with 0s to form a full 64-bit block. The MAC consists of either theentire ciphertext block C Nor the leftmost M bits of the block with 16 M 64. Show that the same result can be produced using the cipher feedback mode."}, {"id": "b72cc6b61ee7305cfb9554fdffa66ce87b23e58d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 108, "start_line": 26, "end_line": 30, "text": "3.10 In this problem, we will compare the security services that are provided by digital sig-natures (DS) and message authentication codes (MAC).We assume that Oscar is ableto observe all messages send from Alice to Bob and vice versa. Oscar has no knowl-edge of any keys but the public one in case of DS. State whether and how (i) DS and(ii) MAC protect against each attack.The value auth(x) is computed with a DS or a MAC algorithm, respectively. a.(Message integrity) Alice sends a message x \u201cTransfer $1000 to Mark\u201d in the clear and also sends auth(x) to Bob. Oscar intercepts the message and replaces \u201cMark\u201d with \u201cOscar\u201d. Will Bob detect this?=\u2026 \u2026=/H17053 ="}, {"id": "18cffdb3e37feefd4d490d924185afe4679593f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 109, "start_line": 1, "end_line": 10, "text": "94CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION b.(Replay) Alice sends a message x \u201cTransfer $1000 to Oscar\u201d in the clear and also sends auth(x) to Bob. Oscar observes the message and signature and sends them 100 times to Bob. Will Bob detect this? c.(Sender Authentication with cheating third party) Oscar claims that he sent some message xwith a valid auth(x) to Bob, but Alice claims the same. Can Bob clear the question in either case? d.(Authentication with Bob cheating) Bob claims that he received a message xwith a valid signature auth(x) from Alice (e.g., \u201cTransfer $1000 from Alice to Bob\u201d) but Alice claims she has never sent it. Can Alice clear this question ineither case? 3.11 Figure 3.14 shows an alternative means of implementing HMAC."}, {"id": "8c71cee57de7e158bacd9be19197bdfce1c6825d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 109, "start_line": 11, "end_line": 29, "text": "a.Describe the operation of this implementation. b.What potential benefit does this implementation have over that shown in Figure 3.6? 3.12 In this problem, we demonstrate that for CMAC, a variant that XORs the second key after applying the final encryption doesn\u2019t work. Let us consider this for the case ofthe message being an integer multiple of the block size. Then the variant can beexpressed as VMAC( K,M) CBC(K, M) K 1. Now suppose an adversary is able to/H17053 == b bits b bits b bitsPrecomputed Computed per message Hash IVn bitsb bits n bits Pad to b bits n bitsn bits HMAC(K, M)f IVb bits ffSi SoY0 Y1ipad K/H11545K/H11545 opadYL/H110021 H(S i || M) \u2248\u2248 Figure 3.14 Efficient Implementation of HMACask for the MACs of three messages: the message 0 0n, where nis the cipher block"}, {"id": "0b66489ea975f62cd39b29b10ca07649cbe4ab05", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 109, "start_line": 30, "end_line": 30, "text": "size; the message 1 1n; and the message 170. As a result of these three queries, the =="}, {"id": "540f8e5ada73feed6a536d0d978c5b9fe3219fb1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 110, "start_line": 1, "end_line": 10, "text": "3.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 95 adversary gets T0 CBC(K ,0) K1;T1 CBC(K ,1) K1and T2 CBC(K , [CBC( K,1)]) K1. Show that the adversary can compute the correct MAC for the (unqueried) message 07(T0 T1). 3.13 Prior to the discovery of any specific public-key schemes, such as RSA, an existence proof was developed whose purpose was to demonstrate that public-key encryption ispossible in theory. Consider the functions f 1(x1) z1;f2(x2,y2) z2;f3(x3,y3) z3, where all values are integers with 1 \u2264xi,yi,zi\u2264N.Function f 1can be represented by a vector M1 of length Nin which the kth entry is the value of f 1(k). Similarly, f 2and f 3 can be represented by N\u00d7Nmatrices M2 and M3. The intent is to represent the"}, {"id": "32c4236d29fcd01bc4b8d0dd0d7fbb6e7162253d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 110, "start_line": 11, "end_line": 21, "text": "encryption/decryption process by table lookups for tables with very large values of N. Such tables would be impractically huge but in principle could be constructed. Thescheme works as follows: construct M1 with a random permutation of all integersbetween 1 and N; that is, each integer appears exactly once in M1. Construct M2 so that each row contains a random permutation of the first Nintegers. Finally, fill in M3 to satisfy the condition: f 3(f2(f1(k),p),k) pfor all k,pwith 1 k,pN In words, 1.M1 takes an input kand produces an output x. 2.M2 takes inputs xand p giving output z. 3.M3 takes inputs zand k and produces p. The three tables, once constructed, are made public."}, {"id": "5814e672d6193d71299079401cd183063cbf8633", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 110, "start_line": 22, "end_line": 39, "text": "a.It should be clear that it is possible to construct M3 to satisfy the preceding condition.As an example, fill in M3 for the following simple case:\u2026 \u2026 == = =/H17053/H17053= /H17053 = /H17053 = 5 4231M1 /H11005 5413222315352434142413551M2 /H11005 M3 /H11005 Convention: The ith element of M1 corresponds to ki . The ith row of M2 cor- responds to xi ; the jth column of M2 corresponds to pj . The ith row of M3 corresponds to zi ; the jth column of M3 corresponds to kj . b.Describe the use of this set of tables to perform encryption and decryption between two users. c.Argue that this is a secure scheme. 3.14 Perform encryption and decryption using the RSA algorithm (Figure 3.10) for thefollowing: a.p 3;q 11,e7;M 5 b.p 5;q 11,e3;M 9 c.p 7;q 11,e17;M 8 d.p 11;q 13,e11;M 7 e.p 17;q 31,e7;M 2"}, {"id": "4a4b7c7037d842574134a967f3a4ad8607edc806", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 110, "start_line": 40, "end_line": 47, "text": "Hint: Decryption is not as hard as you think; use some finesse. 3.15 In a public-key system using RSA, you intercept the ciphertext C 10 sent to a user whose public key is e5,n 35. What is the plaintext M? 3.16 In an RSA system, the public key of a given user is e31,n 3599. What is the pri- vate key of this user? 3.17 Suppose we have a set of blocks encoded with the RSA algorithm and we don\u2019t have the private key.Assume n pq, e is the public key. Suppose also someone tells us they know one of the plaintext blocks has a common factor with n.Does this help us in any way? == == === = = == = = == = = == = = == = = == == =="}, {"id": "1955e04768465560eda0ac6c886f76616d31e7b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 111, "start_line": 1, "end_line": 11, "text": "96CHAPTER 3 / PUBLIC-KEY CRYPTOGRAPHY AND MESSAGE AUTHENTICATION 3.18 Show how RSA can be represented by matrices M1, M2, and M3 of Problem 3.4. 3.19 Consider the following scheme. 1.Pick an odd number, E. 2.Pick two prime numbers, Pand Q, where (P 1)(Q 1) 1 is evenly divisible by E. 3.Multiply Pand Q to get N. 4.Calculate . Is this scheme equivalent to RSA? Show why or why not. 3.20 Suppose Bob uses the RSA cryptosystem with a very large modulus nfor which the factorization cannot be found in a reasonable amount of time. Suppose Alice sends a message to Bob by representing each alphabetic character as an integer between0 and 25 (A 0, . . ., Z 25), and then encrypting each number separately usingRSA with large eand large n. Is this method secure? If not, describe the most efficient"}, {"id": "92a70fb4bc8dce1483f63fa4c3373447f097a6cc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 111, "start_line": 12, "end_line": 17, "text": "attack against this encryption method. 3.21 Consider a Diffie-Hellman scheme with a common prime q 11 and a primitive root \u03b1 2. a.If user A has public key YA 9, what is A\u2019s private key XA? b.If user B has public key YB 3, what is the shared secret key K? ====: :D= (P-1)(Q -1)(E -1)+1 E- - -"}, {"id": "7ac80a95f3714f2e76435cd5c4a2a00b3d231334", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 112, "start_line": 1, "end_line": 17, "text": "4.1 Symmetric Key Distribution Using Symmetric Encryption 4.2 Kerberos Kerberos Version 4 Kerberos Version 5 4.3 Key Distribution Using Asymmetric Encryption Public-Key CertificatesPublic-Key Distribution of Secret Keys 4.4 X.509 Certificates CertificatesX.509 Version 3 4.5 Public-Key Infrastructure PKIX Management FunctionsPKIX Management Protocols 4.6 Federated Identity Management Identity ManagementIdentity Federation 4.7 Recommended Reading and Web Sites 4.8 Key Terms, Review Questions, and Problems 97KEYDISTRIBUTION AND USER AUTHENTICATIONPART2: N ETWORK SECURITY APPLICATIONS CHAPTER"}, {"id": "1839386cbc502221a87d0e0a0995891822925aca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 113, "start_line": 1, "end_line": 6, "text": "98CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION No Singhalese, whether man or woman, would venture out of the house without a bunch of keys in his hand, for without such a talisman he would fear that somedevil might take advantage of his weak state to slip into his body. \u2014The Golden Bough , Sir James George Frazer This chapter covers two important, related concepts. First is the complex topic of cryp-tographic key distribution, involving cryptographic, protocol, and managementconsiderations. This chapter gives the reader a feel for the issues involved and providesa broad survey of the various aspects of key management and distribution. This chapter also examines some of the authentication functions that have"}, {"id": "dc36ac2bbd32384bcbb8f453e12b888274ca6e15", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 113, "start_line": 7, "end_line": 9, "text": "been developed to support network-based user authentication.The chapter includesa detail discussion of one of the earliest and also one of the most widely used keydistribution and user authentication services: Kerberos. Next, the chapter looks atkey distribution schemes that rely on asymmetric encryption. This is followed by adiscussion of X.509 certificates and public-key infrastructure. Finally, the concept offederated identity management is introduced. 4.1 SYMMETRIC KEY DISTRIBUTION USING SYMMETRIC ENCRYPTION"}, {"id": "68e405ca3d7208ff098aa5ffe3dc4d5a34056d73", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 113, "start_line": 10, "end_line": 12, "text": "For symmetric encryption to work, the two parties to an exchange must share thesame key, and that key must be protected from access by others. Furthermore, fre-quent key changes are usually desirable to limit the amount of data compromised ifan attacker learns the key. Therefore, the strength of any cryptographic system restswith the key distribution technique, a term that refers to the means of delivering akey to two parties that wish to exchange data, without allowing others to see the key.Key distribution can be achieved in a number of ways. For two parties A and B,there are the following options: 1.A key could be selected by A and physically delivered to B. 2.A third party could select the key and physically deliver it to A and B."}, {"id": "d4b45910805a9c5d83db377f35c9bf2e38b92216", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 113, "start_line": 13, "end_line": 16, "text": "3.If A and B have previously and recently used a key, one party could transmit thenew key to the other, using the old key to encrypt the new key. 4.If A and B each have an encrypted connection to a third party C, C coulddeliver a key on the encrypted links to A and B. Options 1 and 2 call for manual delivery of a key. For link encryption, this is a reasonable requirement, because each link encryption device is only going to be"}, {"id": "891e0a8b8f0b5557e74ddb9eaba2330c9f164ea2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 113, "start_line": 17, "end_line": 19, "text": "exchanging data with its partner on the other end of the link. However, for end-to-end encryption over a network, manual delivery is awkward. In a distributed system,any given host or terminal may need to engage in exchanges with many other hostsand terminals over time. Thus, each device needs a number of keys supplied dynam-ically. The problem is especially difficult in a wide-area distributed system. Option 3 is a possibility for either link encryption or end-to-end encryption, but if an attacker ever succeeds in gaining access to one key, then all subsequent"}, {"id": "85f061fa8b12f2367fbea0e47119440ef6df3550", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 114, "start_line": 1, "end_line": 9, "text": "4.2 / KERBEROS 99 keys are revealed. Even if frequent changes are made to the link encryption keys, these should be done manually. To provide keys for end-to-end encryption, option 4is preferable. For option 4 , two kinds of keys are used: \u2022Session key: When two end systems (hosts, terminals, etc.) wish to communicate, they establish a logical connection (e.g., virtual circuit). For the duration of thatlogical connection, called a session, all user data are encrypted with a one-timesession key. At the conclusion of the session the session key is destroyed. \u2022Permanent key: A permanent key is a key used between entities for the purpose of distributing session keys. A necessary element of option 4 is a key distribution center (KDC) . The KDC"}, {"id": "d7086904243dc4174553a14157f738d2c82d9edb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 114, "start_line": 10, "end_line": 13, "text": "determines which systems are allowed to communicate with each other. When per- mission is granted for two systems to establish a connection, the key distributioncenter provides a one-time session key for that connection. In general terms, the operation of a KDC proceeds as follows: 1.When host A wishes to set up a connection to host B, it transmits a connection-request packet to the KDC. The communication between A and the KDC isencrypted using a master key shared only by A and the KDC."}, {"id": "8cebdede653446220f8cdeba56ba7d9073f30d0b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 114, "start_line": 14, "end_line": 19, "text": "2.If the KDC approves the connection request, it generates a unique one-time ses-sion key. It encrypts the session key using the permanent key it shares with A anddelivers the encrypted session key to A. Similarly, it encrypts the session key usingthe permanent key it shares with B and delivers the encrypted session key to B. 3.A and B can now set up a logical connection and exchange messages and data,all encrypted using the temporary session key. The automated key distribution approach provides the flexibility and dynamic characteristics needed to allow a number of users to access a number of servers and for the servers to exchange data with each other. The most widely used applicationthat implements this approach is Kerberos, described in the next section. 4.2 KERBEROS"}, {"id": "c10c0cb5430ecf3bee531f839daeb8afee5f2882", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 114, "start_line": 20, "end_line": 21, "text": "Kerberos is a key distribution and user authentication service developed at MIT.The problem that Kerberos addresses is this: Assume an open distributed environ-ment in which users at workstations wish to access services on servers distributedthroughout the network. We would like for servers to be able to restrict access toauthorized users and to be able to authenticate requests for service. In this environ-ment, a workstation cannot be trusted to identify its users correctly to network ser-vices. In particular, the following three threats exist: 1.A user may gain access to a particular workstation and pretend to be anotheruser operating from that workstation."}, {"id": "ae9665b55e7e8462f4612d08649b0ed1fdbe3bed", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 114, "start_line": 22, "end_line": 22, "text": "2.A user may alter the network address of a workstation so that the requests sentfrom the altered workstation appear to come from the impersonated workstation."}, {"id": "db1a91316a727e389df6cb9ce2b30509af32b599", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 115, "start_line": 1, "end_line": 5, "text": "100 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION 3.A user may eavesdrop on exchanges and use a replay attack to gain entrance to a server or to disrupt operations. In any of these cases, an unauthorized user may be able to gain access to services anddata that he or she is not authorized to access. Rather than building elaborate authen-tication protocols at each server, Kerberos provides a centralized authenticationserver whose function is to authenticate users to servers and servers to users. Kerberosrelies exclusively on symmetric encryption, making no use of public-key encryption. Two versions of Kerberos are in use. Version 4 [MILL88, STEI88] imple-"}, {"id": "cbe60a65e3e5c91b6bfcd2c12b6d47b83f72ce3f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 115, "start_line": 6, "end_line": 9, "text": "mentations still exist, although this version is being phased out. Version 5[KOHL94] corrects some of the security deficiencies of version 4 and has beenissued as a proposed Internet Standard (RFC 4120). Because of the complexity of Kerberos, it is best to start with a description of version 4. This enables us to see the essence of the Kerberos strategy without con-sidering some of the details required to handle subtle security threats. Then, weexamine version 5. Kerberos Version 4"}, {"id": "fede43e3fc1b642fecdf0f2b1a7e6f64e319deae", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 115, "start_line": 10, "end_line": 13, "text": "Version 4 of Kerberos makes use of DES, in a rather elaborate protocol, to providethe authentication service. Viewing the protocol as a whole, it is difficult to see theneed for the many elements contained therein. Therefore, we adopt a strategy usedby Bill Bryant [BRYA88] and build up to the full protocol by looking first at severalhypothetical dialogues. Each successive dialogue adds additional complexity tocounter security vulnerabilities revealed in the preceding dialogue. After examining the protocol, we look at some other aspects of version 4. A S IMPLE AUTHENTICATION DIALOGUE In an unprotected network environment,"}, {"id": "6dbcd11ced207a22ad8186a0a6279d4cc9155d0b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 115, "start_line": 14, "end_line": 17, "text": "any client can apply to any server for service. The obvious security risk is that ofimpersonation. An opponent can pretend to be another client and obtainunauthorized privileges on server machines. To counter this threat, servers must beable to confirm the identities of clients who request service. Each server can berequired to undertake this task for each client/server interaction, but in an openenvironment, this places a substantial burden on each server. An alternative is to use an authentication server (AS) that knows the passwords of all users and stores these in a centralized database. In addition, the AS shares aunique secret key with each server. These keys have been distributed physically or insome other secure manner. Consider the following hypothetical dialogue: 1"}, {"id": "2ea7b3e08409a49944f1363ddb77357874517665", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 115, "start_line": 18, "end_line": 23, "text": "(1)C AS: IDC7PC7IDV (2)AS C: Ticket (3)CV : IDC7Ticket Ticket E(K v,[IDC7AD C7IDV]) =::: 1The portion to the left of the colon indicates the sender and receiver, the portion to the right indicates the contents of the message, and the symbol 7indicates concatenation."}, {"id": "7a00d1c179a50e9fcb3a97c855ab2525ea7412ef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 116, "start_line": 1, "end_line": 11, "text": "4.2 / KERBEROS 101 where C client AS authentication serverV serverID C identifier of user on C IDV identifier of V PC password of user on C AD Cnetwork address of C Kv secret encryption key shared by AS and V In this scenario, the user logs on to a workstation and requests access to server V . The client module C in the user\u2019s workstation requests the user\u2019s password and thensends a message to the AS that includes the user\u2019s ID, the server\u2019s ID, and the user\u2019spassword.The AS checks its database to see if the user has supplied the proper pass-word for this user ID and whether this user is permitted access to server V . If bothtests are passed, the AS accepts the user as authentic and must now convince theserver that this user is authentic. To do so, the AS creates a ticket that contains the"}, {"id": "b2fb4b06545692f5d93eb66ed4be35aac55dfcd2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 116, "start_line": 12, "end_line": 17, "text": "user\u2019s ID and network address and the server\u2019s ID.This ticket is encrypted using thesecret key shared by the AS and this server. This ticket is then sent back to C.Because the ticket is encrypted, it cannot be altered by C or by an opponent. With this ticket, C can now apply to V for service. C sends a message to V con- taining C\u2019s ID and the ticket. V decrypts the ticket and verifies that the user ID inthe ticket is the same as the unencrypted user ID in the message. If these two match,the server considers the user authenticated and grants the requested service. Each of the ingredients of message (3) is significant. The ticket is encrypted to prevent alteration or forgery. The server\u2019s ID ( ID V) is included in the ticket so that"}, {"id": "77c17d08f873b1062a04a872207819f65693a24e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 116, "start_line": 18, "end_line": 24, "text": "the server can verify that it has decrypted the ticket properly. IDCis included in the ticket to indicate that this ticket has been issued on behalf of C. Finally, AD Cserves to counter the following threat.An opponent could capture the ticket transmitted inmessage (2), then use the name ID C, and transmit a message of form (3) from another workstation. The server would receive a valid ticket that matches the userID and grant access to the user on that other workstation.To prevent this attack, theAS includes in the ticket the network address from which the original request came.Now the ticket is valid only if it is transmitted from the same workstation that ini-tially requested the ticket. A M ORESECURE AUTHENTICATION DIALOGUE Although the foregoing scenario solves"}, {"id": "d233c4d5f6fa61cfabd1a0f78abf8516a71b5002", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 116, "start_line": 25, "end_line": 26, "text": "some of the problems of authentication in an open network environment, problems remain. Two in particular stand out. First, we would like to minimize the number oftimes that a user has to enter a password. Suppose each ticket can be used only once.If user C logs on to a workstation in the morning and wishes to check his or her mailat a mail server, C must supply a password to get a ticket for the mail server. If Cwishes to check the mail several times during the day, each attempt requiresreentering the password. We can improve matters by saying that tickets are reusable.For a single logon session, the workstation can store the mail-server ticket after it isreceived and use it on behalf of the user for multiple accesses to the mail server.========"}, {"id": "ab1d94de5ba3d9732d78516ef689220cf57b782c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 117, "start_line": 1, "end_line": 9, "text": "102 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION However, under this scheme, it remains the case that a user would need a new ticket for every different service. If a user wished to access a print server, a mail server, a file server, and so on, the first instance of each access would require a newticket and hence require the user to enter the password. The second problem is that the earlier scenario involved a plaintext transmis- sion of the password [message (1)]. An eavesdropper could capture the passwordand use any service accessible to the victim. To solve these additional problems, we introduce a scheme for avoiding plain- text passwords and a new server, known as the ticket-granting server (TGS) .T h e new (but still hypothetical) scenario is as follows."}, {"id": "9e21a094ec47a581b345f1bf4eccebefeab7bc16", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 117, "start_line": 10, "end_line": 22, "text": "Once per user logon session: (1)C : AS: ID C7IDtgs (2)AS : C: E(K c,Ticket tgs) Once per type of service: (3)C : TGS: IDC7IDV7Ticket tgs (4)TGS S C: Ticket v Once per service session: (5)C S V: IDC7Ticket v Ticket tgs E(K tgs,[IDC7AD C7IDtgs7TS17Lifetime 1]) Ticket vE(K v,[IDC7AD C7IDv7TS27Lifetime 2]) The new service, TGS, issues tickets to users who have been authenticated to AS. Thus, the user first requests a ticket-granting ticket ( Ticket tgs) from the AS. The"}, {"id": "1cb7c210a308eb608802d7abdc58167f72e398eb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 117, "start_line": 23, "end_line": 26, "text": "client module in the user workstation saves this ticket. Each time the user requiresaccess to a new service, the client applies to the TGS, using the ticket to authenticateitself. The TGS then grants a ticket for the particular service. The client saves eachservice-granting ticket and uses it to authenticate its user to a server each time aparticular service is requested. Let us look at the details of this scheme: 1.The client requests a ticket-granting ticket on behalf of the user by sending itsuser\u2019s ID to the AS, together with the TGS ID, indicating a request to use theTGS service. 2.The AS responds with a ticket that is encrypted with a key that is derived fromthe user\u2019s password (K C), which is already stored at the AS. When this"}, {"id": "48b2775dd2263150b533f6fb56d0c6630238d25c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 117, "start_line": 27, "end_line": 30, "text": "response arrives at the client, the client prompts the user for his or her pass-word, generates the key, and attempts to decrypt the incoming message. If thecorrect password is supplied, the ticket is successfully recovered. Because only the correct user should know the password, only the correct user can recover the ticket. Thus, we have used the password to obtain credentials from Kerberos without having to transmit the password in plaintext. The ticketitself consists of the ID and network address of the user and the ID of the TGS.=="}, {"id": "a6ecd2b4a825a2cd7f95117c164d4ce766e4a2d8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 118, "start_line": 1, "end_line": 4, "text": "4.2 / KERBEROS 103 This corresponds to the first scenario. The idea is that the client can use this ticket to request multiple service-granting tickets. So the ticket-granting ticket is to bereusable. However, we do not wish an opponent to be able to capture the ticket anduse it. Consider the following scenario: An opponent captures the login ticket andwaits until the user has logged off his or her workstation. Then the opponent eithergains access to that workstation or configures his workstation with the same net-work address as that of the victim. The opponent would be able to reuse the ticketto spoof the TGS. To counter this, the ticket includes a timestamp , indicating the date and time at which the ticket was issued, and a lifetime, indicating the length of"}, {"id": "afdbbe11a2aa9776d20197f4a8038389a8847d34", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 118, "start_line": 5, "end_line": 7, "text": "time for which the ticket is valid (e.g., eight hours). Thus, the client now has areusable ticket and need not bother the user for a password for each new servicerequest. Finally, note that the ticket-granting ticket is encrypted with a secret keyknown only to the AS and the TGS.This prevents alteration of the ticket.The ticketis reencrypted with a key based on the user\u2019s password. This assures that the ticketcan be recovered only by the correct user, providing the authentication. Now that the client has a ticket-granting ticket, access to any server can be obtained with steps 3 and 4."}, {"id": "ef30b305416eb1ca99a81a0ee0e1cddcb9a47c9c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 118, "start_line": 8, "end_line": 12, "text": "3.The client requests a service-granting ticket on behalf of the user. For this pur-pose, the client transmits a message to the TGS containing the user\u2019s ID, theID of the desired service, and the ticket-granting ticket. 4.The TGS decrypts the incoming ticket using a key shared only by the AS andthe TGS ( K tgs) and verifies the success of the decryption by the presence of its ID. It checks to make sure that the lifetime has not expired. Then it comparesthe user ID and network address with the incoming information to authenti-cate the user. If the user is permitted access to the server V , the TGS issues aticket to grant access to the requested service. The service-granting ticket has the same structure as the ticket-granting ticket."}, {"id": "69c8c25846e608f5359934a0cb72df3fd34bfcee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 118, "start_line": 13, "end_line": 18, "text": "Indeed, because the TGS is a server, we would expect that the same elements are needed to authenticate a client to the TGS and to authenticate a client to an appli-cation server. Again, the ticket contains a timestamp and lifetime. If the user wantsaccess to the same service at a later time, the client can simply use the previouslyacquired service-granting ticket and need not bother the user for a password. Notethat the ticket is encrypted with a secret key ( K v) known only to the TGS and the server, preventing alteration. Finally, with a particular service-granting ticket, the client can gain access to the corresponding service with step 5."}, {"id": "4efffd9d305747113aa814035c4122f822364414", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 118, "start_line": 19, "end_line": 25, "text": "5.The client requests access to a service on behalf of the user. For this purpose, theclient transmits a message to the server containing the user\u2019s ID and the service-granting ticket. The server authenticates by using the contents of the ticket. This new scenario satisfies the two requirements of only one password query per user session and protection of the user password. T HEVERSION 4 A UTHENTICATION DIALOGUE Although the foregoing scenario enhances security compared to the first attempt, two additional problems remain. The heart of the first problem is the lifetime associated with the ticket-granting"}, {"id": "9de7a0d6ec32be9a022f36b44ab2c983d7f96c5b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 119, "start_line": 1, "end_line": 5, "text": "104 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION ticket. If this lifetime is very short (e.g., minutes), then the user will be repeatedly asked for a password. If the lifetime is long (e.g., hours), then an opponent has agreater opportunity for replay. An opponent could eavesdrop on the network andcapture a copy of the ticket-granting ticket and then wait for the legitimate user tolog out. Then the opponent could forge the legitimate user\u2019s network address andsend the message of step (3) to the TGS. This would give the opponent unlimitedaccess to the resources and files available to the legitimate user. Similarly, if an opponent captures a service-granting ticket and uses it before it expires, the opponent has access to the corresponding service."}, {"id": "9a411ad536f666db01f66726f5793aad54bf93ea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 119, "start_line": 6, "end_line": 12, "text": "Thus, we arrive at an additional requirement. A network service (the TGS or an application service) must be able to prove that the person using a ticket is thesame person to whom that ticket was issued. The second problem is that there may be a requirement for servers to authen- ticate themselves to users.Without such authentication, an opponent could sabotagethe configuration so that messages to a server were directed to another location.Thefalse server then would be in a position to act as a real server, capture any informa-tion from the user, and deny the true service to the user. We examine these problems in turn and refer to Table 4.1, which shows the actual Kerberos protocol. First, consider the problem of captured ticket-granting tickets and the need to"}, {"id": "18bb7eb1ed0586b13e58db5025f410d1b420e5dd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 119, "start_line": 13, "end_line": 24, "text": "determine that the ticket presenter is the same as the client for whom the ticket wasissued.The threat is that an opponent will steal the ticket and use it before it expires. Table 4.1 Summary of Kerberos Version 4 Message Exchanges (1) C : AS IDc7IDtgs7TS1 (2) AS :CE(K c,[Kc,tgs7IDtgs7TS27Lifetime 27Ticket tgs]) Ticket tgs E(K tgs,[ K c,tgs7IDC7AD C7IDtgs7TS27Lifetime 2]) = (a) Authentication Service Exchange to obtain ticket-granting ticket (3) C : TGS IDv7Ticket tgs7Authenticator c (4) TGS :CE(K c,tgs,[Kc,v7IDv7TS47Ticket v]) Ticket tgs E(K tgs,[ K c,tgs7IDC7AD C7IDtgs7TS27Lifetime 2]) = Ticket v E(K v,[ K c,v7IDC7AD C7IDv7TS47Lifetime 4]) = Authenticator cE(K c,tgs, [ID C7AD C7TS3]) = (b) Ticket-Granting Service Exchange to obtain service-granting ticket"}, {"id": "99d6cb3c7743457faf06243caadd53b7ecd1d1de", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 119, "start_line": 25, "end_line": 29, "text": "(5) C : VTicket v7Authenticator c (6) V :CE(K c,v,[TS51]) (for mutual authentication)+ Ticket v E(K v,[ K c,v7IDC7AD C7IDv7TS47Lifetime 4]) = Authenticator cE(K c,v, [ID C7AD C7TS5]) = (c) Client/Server Authentication Exchange to obtain service"}, {"id": "c343bdefe58f5ad18a88d52a71059826b34b24dc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 120, "start_line": 1, "end_line": 7, "text": "4.2 / KERBEROS 105 To get around this problem, let us have the AS provide both the client and the TGS with a secret piece of information in a secure manner. Then the client can prove itsidentity to the TGS by revealing the secret information, again in a secure manner.An efficient way of accomplishing this is to use an encryption key as the secureinformation; this is referred to as a session key in Kerberos. Table 4.1a shows the technique for distributing the session key. As before, the client sends a message to the AS requesting access to the TGS. The AS respondswith a message, encrypted with a key derived from the user\u2019s password ( K C), that contains the ticket. The encrypted message also contains a copy of the session key,K"}, {"id": "74928e2549eef059edb0a2d0343d3412c0ce9554", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 120, "start_line": 8, "end_line": 13, "text": "C,tgs, where the subscripts indicate that this is a session key for C and TGS. Because this session key is inside the message encrypted with KC, only the user\u2019s client can read it. The same session key is included in the ticket, which can be read only by theTGS. Thus, the session key has been securely delivered to both C and the TGS. Note that several additional pieces of information have been added to this first phase of the dialogue. Message (1) includes a timestamp, so that the AS knowsthat the message is timely. Message (2) includes several elements of the ticket in aform accessible to C. This enables C to confirm that this ticket is for the TGS and tolearn its expiration time. Armed with the ticket and the session key, C is ready to approach the TGS. As"}, {"id": "451c81fa1a683bad6963ec271291205417205109", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 120, "start_line": 14, "end_line": 16, "text": "before, C sends the TGS a message that includes the ticket plus the ID of therequested service (message (3) in Table 4.1b). In addition, C transmits an authentica-tor, which includes the ID and address of C\u2019s user and a timestamp. Unlike the ticket,which is reusable, the authenticator is intended for use only once and has a very shortlifetime. The TGS can decrypt the ticket with the key that it shares with the AS. Thisticket indicates that user C has been provided with the session key K C,tgs. In effect, the ticket says, \u201cAnyone who uses KC,tgs must be C.\u201d The TGS uses the session key to"}, {"id": "c443c6ec39b849492c5caec63bbf369ef74702a2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 120, "start_line": 17, "end_line": 21, "text": "decrypt the authenticator. The TGS can then check the name and address from theauthenticator with that of the ticket and with the network address of the incomingmessage. If all match, then the TGS is assured that the sender of the ticket is indeedthe ticket\u2019s real owner. In effect, the authenticator says, \u201cAt time TS 3, I hereby use KC,tgs.\u201d Note that the ticket does not prove anyone\u2019s identity but is a way to distribute keys securely. It is the authenticator that proves the client\u2019s identity. Because theauthenticator can be used only once and has a short lifetime, the threat of an oppo-nent stealing both the ticket and the authenticator for presentation later is countered. The reply from the TGS in message (4) follows the form of message (2). The"}, {"id": "afbdd12e038814e97f82a0ca9e8a48d96c870517", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 120, "start_line": 22, "end_line": 25, "text": "message is encrypted with the session key shared by the TGS and C and includes asession key to be shared between C and the server V , the ID of V , and the timestampof the ticket. The ticket itself includes the same session key. C now has a reusable service-granting ticket for V .When C presents this ticket, as shown in message (5), it also sends an authenticator. The server can decrypt theticket, recover the session key, and decrypt the authenticator. If mutual authentication is required, the server can reply as shown in message"}, {"id": "70fbacccfbac9173190526b97e4d4c5e12b1f9d2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 120, "start_line": 26, "end_line": 26, "text": "(6) of Table 4.1. The server returns the value of the timestamp from the authentica-tor, incremented by 1, and encrypted in the session key. C can decrypt this messageto recover the incremented timestamp. Because the message was encrypted by thesession key, C is assured that it could have been created only by V . The contents ofthe message assure C that this is not a replay of an old reply."}, {"id": "c7a7b6ac40fcafc6d49e5544caf1d8889c177c6c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 121, "start_line": 1, "end_line": 12, "text": "106 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Finally, at the conclusion of this process, the client and server share a secret key. This key can be used to encrypt future messages between the two or to exchange a new random session key for that purpose. Table 4.2 summarizes the justification for each of the elements in the Kerberos protocol, and Figure 4.1 provides a simplified overview of the action. Table 4.2 Rationale for the Elements of the Kerberos Version 4 Protocol Message (1) Client requests ticket-granting ticket. IDC Tells AS identity of user from this client. IDtgs Tells AS that user requests access to TGS. TS1 Allows AS to verify that client\u2019s clock is synchronized with that of AS. Message (2) AS returns ticket-granting ticket."}, {"id": "c3c932940925f58c4167795d3d103e12d6ae7162", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 121, "start_line": 13, "end_line": 24, "text": "Kc Encryption is based on user\u2019s password, enabling AS and client to verify password, and protecting contents of message (2). Kc,tgs Copy of session key accessible to client created by AS to permit secure exchangebetween client and TGS without requiring them to share a permanent key. IDtgs Confirms that this ticket is for the TGS. TS2 Informs client of time this ticket was issued. Lifetime 2 Informs client of the lifetime of this ticket. Ticket tgs Ticket to be used by client to access TGS. (a) Authentication Service Exchange Message (3) Client requests service-granting ticket. IDV Tells TGS that user requests access to server V . Ticket tgs Assures TGS that this user has been authenticated by AS. Authenticator c Generated by client to validate ticket."}, {"id": "3da9565ace089d19617ba9d632b3c507b5f095c7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 121, "start_line": 25, "end_line": 33, "text": "Message (4) TGS returns service-granting ticket. Kc,tgs Key shared only by C and TGS protects contents of message (4). Kc,v Copy of session key accessible to client created by TGS to permit secure exchangebetween client and server without requiring them to share a permanent key. IDV Confirms that this ticket is for server V . TS4 Informs client of time this ticket was issued. Ticket V Ticket to be used by client to access server V . Ticket tgs Reusable so that user does not have to reenter password. Ktgs Ticket is encrypted with key known only to AS and TGS, to prevent tampering. Kc,tgs Copy of session key accessible to TGS used to decrypt authenticator, thereby authenti-cating ticket."}, {"id": "8f9d39f5c2650d22e68283797b1c26e238b37e43", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 122, "start_line": 1, "end_line": 13, "text": "4.2 / KERBEROS 107 IDC Indicates the rightful owner of this ticket. AD C Prevents use of ticket from workstation other than one that initially requested the ticket. IDtgs Assures server that it has decrypted ticket properly. TS2 Informs TGS of time this ticket was issued. Lifetime 2 Prevents replay after ticket has expired. Authenticator cAssures TGS that the ticket presenter is the same as the client for whom the ticket was issued has very short lifetime to prevent replay. Kc,tgs Authenticator is encrypted with key known only to client and TGS, to prevent tampering. IDC Must match ID in ticket to authenticate ticket. AD C Must match address in ticket to authenticate ticket. TS3 Informs TGS of time this authenticator was generated. (b) Ticket-Granting Service Exchange"}, {"id": "a6ac3b5a346f40739ceca4693103df3f7ab73995", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 122, "start_line": 14, "end_line": 24, "text": "Message (5) Client requests service. Ticket V Assures server that this user has been authenticated by AS. Authenticator cGenerated by client to validate ticket. Message (6) Optional authentication of server to client. Kc,v Assures C that this message is from V . TS51+ Assures C that this is not a replay of an old reply. Ticket v Reusable so that client does not need to request a new ticket from TGS for each accessto the same server. Kv Ticket is encrypted with key known only to TGS and server, to prevent tampering. Kc,v Copy of session key accessible to client; used to decrypt authenticator, therebyauthenticating ticket. IDC Indicates the rightful owner of this ticket. AD C Prevents use of ticket from workstation other than one that initially requested the ticket."}, {"id": "b554d623e39a524f8514cf6587540218bd0839fb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 122, "start_line": 25, "end_line": 33, "text": "IDV Assures server that it has decrypted ticket properly. TS4 Informs server of time this ticket was issued. Lifetime 4 Prevents replay after ticket has expired. Authenticator cAssures server that the ticket presenter is the same as the client for whom the ticket wasissued; has very short lifetime to prevent replay. Kc,v Authenticator is encrypted with key known only to client and server, to prevent tampering. IDC Must match ID in ticket to authenticate ticket. AD c Must match address in ticket to authenticate ticket. TS5 Informs server of time this authenticator was generated. (c) Client/Server Authentication Exchange"}, {"id": "38b5d75ff00cb3ceb94dc7936411e788ee00069d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 123, "start_line": 1, "end_line": 16, "text": "108 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Authentication server (AS) Ticket- granting server (TGS)Request ticket- granting ticketOnce peruser logonsession 1. User logs on toworkstation andrequests service on host. 3. Workstation prompts user for password anduses password to decryptincoming message, thensends ticket andauthenticator thatcontains user's name,network address, andtime to TGS.Ticket /H11001 session key Request service- granting ticket Ticket /H11001 session key Once pertype of service 4. TGS decrypts ticket andauthenticator, verifies request, then creates ticket for requestedserver.Kerberos 5. Workstation sendsticket and authenticatorto server.6. Server verifies thatticket and authenticatormatch, then grants accessto service. If mutualauthentication is"}, {"id": "e20d9c6f87fd2aad4ce2fe076e87f26f47a7848a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 123, "start_line": 17, "end_line": 30, "text": "required, server returnsan authenticator.Request serv ice Provide server authenticator Once per service session2. AS verifies user's access right in database, creates ticket-granting ticket and session key. Results are encryptedusing key derived from user's password. Figure 4.1 Overview of Kerberos KERBEROS REALMS AND MULTIPLE KERBERI A full-service Kerberos environment consisting of a Kerberos server, a number of clients, and a number of application servers requires the following: 1.The Kerberos server must have the user ID and hashed passwords of all partic-ipating users in its database. All users are registered with the Kerberos server. 2.The Kerberos server must share a secret key with each server. All servers areregistered with the Kerberos server."}, {"id": "91a9863e32e0a44347721f7040283f59a274b6fa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 123, "start_line": 31, "end_line": 33, "text": "Such an environment is referred to as a Kerberos realm . The concept of realm can be explained as follows. A Kerberos realm is a set of managed nodes that share the same Kerberos database.The Kerberos database resides on the Kerberos mastercomputer system, which should be kept in a physically secure room. A read-onlycopy of the Kerberos database might also reside on other Kerberos computer sys-tems. However, all changes to the database must be made on the master computersystem. Changing or accessing the contents of a Kerberos database requires theKerberos master password. A related concept is that of a Kerberos principal , which"}, {"id": "a530b1399e986a60c6c848103652a27f81a3ae5f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 124, "start_line": 1, "end_line": 5, "text": "4.2 / KERBEROS 109 is a service or user that is known to the Kerberos system. Each Kerberos principal is identified by its principal name. Principal names consist of three parts: a service oruser name, an instance name, and a realm name Networks of clients and servers under different administrative organizations typically constitute different realms. That is, it generally is not practical or does notconform to administrative policy to have users and servers in one administrativedomain registered with a Kerberos server elsewhere. However, users in one realmmay need access to servers in other realms, and some servers may be willing to pro-vide service to users from other realms, provided that those users are authenticated."}, {"id": "5f27968627fd610ee5a4c78ae4245ce37403fa11", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 124, "start_line": 6, "end_line": 12, "text": "Kerberos provides a mechanism for supporting such interrealm authentica- tion. For two realms to support interrealm authentication, a third requirement isadded: 3.The Kerberos server in each interoperating realm shares a secret key with theserver in the other realm. The two Kerberos servers are registered with eachother. The scheme requires that the Kerberos server in one realm trust the Kerberos server in the other realm to authenticate its users. Furthermore, the participating servers in the second realm also must be willing to trust the Kerberos server in thefirst realm. With these ground rules in place, we can describe the mechanism as follows"}, {"id": "4ce771c18e2aecf60ee15cd59f40f08df986aa8a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 124, "start_line": 13, "end_line": 22, "text": "(Figure 4.2): A user wishing service on a server in another realm needs a ticket forthat server. The user\u2019s client follows the usual procedures to gain access to the localTGS and then requests a ticket-granting ticket for a remote TGS (TGS in anotherrealm).The client can then apply to the remote TGS for a service-granting ticket forthe desired server in the realm of the remote TGS. The details of the exchanges illustrated in Figure 4.2 are as follows (compare Table 4.1). (1)C : AS: ID C7IDtgs7TS1 (2)AS : C: E(K C,[KC,tgs7IDtgs7TS27Lifetime 27Ticket tgs]) (3)C : TGS: IDtgsrem7Ticket tgs7Authenticator C (4)TGS : C: E(K C,tgs,[KC,tgsrem7IDtgsrem7TS47Ticket tgsrem ]) (5)C : TGS rem:IDVrem7Ticket tgsrem7Authenticator C (6)TGS rem:C: E(K C,tgsrem ,[KC,Vrem7IDVrem7TS67Ticket Vrem])"}, {"id": "16e784ca2d1780f2a8350d955561d1a6a2e46929", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 124, "start_line": 23, "end_line": 28, "text": "(7)C : Vrem: Ticket Vrem7Authenticator C The ticket presented to the remote server ( Vrem) indicates the realm in which the user was originally authenticated. The server chooses whether to honor the remoterequest. One problem presented by the foregoing approach is that it does not scale well to many realms. If there are Nrealms, then there must be N(N 1)/2 secure key exchanges so that each Kerberos realm can interoperate with all other Kerberosrealms.-"}, {"id": "a192480ba1e7c411b57682936dc6a4cbdc44cf23", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 125, "start_line": 1, "end_line": 20, "text": "110 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Kerberos Version 5 Kerberos version 5 is specified in RFC 4120 and provides a number of improve- ments over version 4 [KOHL94]. To begin, we provide an overview of the changesfrom version 4 to version 5 and then look at the version 5 protocol. D IFFERENCES BETWEEN VERSIONS 4 AND 5Version 5 is intended to address the limitations of version 4 in two areas: environmental shortcomings and technical deficiencies.We briefly summarize the improvements in each area. Kerberos versionAS TGSKerberos ClientRealm A AS TGSKerberos Server Realm B1. Request ticket for local TGS 2. Ticket for local TGS 3. Request t icket for remote TGS 4. Ticket for remote TGS 5. Request t icket for remote server6. Ticket for remote server 7. Request remote service"}, {"id": "0be52c5156152614424523a0134b08a2d82d0dc3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 125, "start_line": 21, "end_line": 21, "text": "Figure 4.2 Request for Service in Another Realm"}, {"id": "e359562f911863f3f52ddf0b64b0c26e5e181692", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 126, "start_line": 1, "end_line": 6, "text": "4.2 / KERBEROS 111 4 did not fully address the need to be of general purpose. This led to the following environmental shortcomings . 1.Encryption system dependence: Version 4 requires the use of DES. Export restriction on DES as well as doubts about the strength of DES were thus ofconcern. In version 5, ciphertext is tagged with an encryption-type identifier sothat any encryption technique may be used. Encryption keys are tagged with atype and a length, allowing the same key to be used in different algorithms andallowing the specification of different variations on a given algorithm. 2.Internet protocol dependence: Version 4 requires the use of Internet Protocol"}, {"id": "ed5242e135c416f6d29986d309ed5e9e84235ffb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 126, "start_line": 7, "end_line": 10, "text": "(IP) addresses. Other address types, such as the ISO network address, are notaccommodated. Version 5 network addresses are tagged with type and length,allowing any network address type to be used. 3.Message byte ordering: In version 4, the sender of a message employs a byte ordering of its own choosing and tags the message to indicate least significantbyte in lowest address or most significant byte in lowest address. This tech-niques works but does not follow established conventions. In version 5, allmessage structures are defined using Abstract Syntax Notation One (ASN.1)and Basic Encoding Rules (BER), which provide an unambiguous byteordering. 4.Ticket lifetime: Lifetime values in version 4 are encoded in an 8-bit quantity"}, {"id": "da4694ee39a7e90a028cffc2400f8413bad7b07c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 126, "start_line": 11, "end_line": 14, "text": "in units of five minutes. Thus, the maximum lifetime that can be expressed is 2 8\u00d75 1280 minutes (a little over 21 hours).This may be inadequate for some applications (e.g., a long-running simulation that requires valid Kerberos cre-dentials throughout execution). In version 5, tickets include an explicit starttime and end time, allowing tickets with arbitrary lifetimes. 5.Authentication forwarding: Version 4 does not allow credentials issued to one"}, {"id": "5753adfa0464848c13b96133520452780b38e897", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 126, "start_line": 15, "end_line": 21, "text": "client to be forwarded to some other host and used by some other client. Thiscapability would enable a client to access a server and have that server accessanother server on behalf of the client. For example, a client issues a request to aprint server that then accesses the client\u2019s file from a file server, using the client\u2019scredentials for access. Version 5 provides this capability. 6.Interrealm authentication: In version 4, interoperability among Nrealms requires on the order of N 2Kerberos-to-Kerberos relationships, as described earlier. Version 5 supports a method that requires fewer relationships, asdescribed shortly. Apart from these environmental limitations, there are technical deficiencies in the version 4 protocol itself. Most of these deficiencies were documented in"}, {"id": "9fe363e0d2ec18639bbdef9a9378de7575a02dff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 126, "start_line": 22, "end_line": 24, "text": "[BELL90], and version 5 attempts to address these. The deficiencies are thefollowing. 1.Double encryption: Note in Table 4.1 [messages (2) and (4)] that tickets pro- vided to clients are encrypted twice\u2014once with the secret key of the targetserver and then again with a secret key known to the client. The secondencryption is not necessary and is computationally wasteful.="}, {"id": "9028a0066ba440b71aa6058480e60539c7cca57f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 127, "start_line": 1, "end_line": 6, "text": "112 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION 2This is described in Appendix F.2.PCBC encryption: Encryption in version 4 makes use of a nonstandard mode of DES known as propagating cipher block chaining (PCBC).2It has been demonstrated that this mode is vulnerable to an attack involving the interchange of ciphertext blocks [KOHL89]. PCBC was intended to provide an integritycheck as part of the encryption operation. Version 5 provides explicit integritymechanisms, allowing the standard CBC mode to be used for encryption. In par-ticular, a checksum or hash code is attached to the message prior to encryptionusing CBC. 3.Session keys: Each ticket includes a session key that is used by the client to"}, {"id": "0b70a05f6c8237a9a1e8f7aeb4721ae3e35e548a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 127, "start_line": 7, "end_line": 9, "text": "encrypt the authenticator sent to the service associated with that ticket. In addi-tion, the session key subsequently may be used by the client and the server toprotect messages passed during that session. However, because the same ticketmay be used repeatedly to gain service from a particular server, there is the riskthat an opponent will replay messages from an old session to the client or theserver. In version 5, it is possible for a client and server to negotiate a subsessionkey, which is to be used only for that one connection. A new access by the clientwould result in the use of a new subsession key. 4.Password attacks: Both versions are vulnerable to a password attack.The mes- sage from the AS to the client includes material encrypted with a key based onthe client\u2019s password."}, {"id": "eb96eeea2c7ec574c07e0d19085e1b934d5b6624", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 127, "start_line": 10, "end_line": 15, "text": "3An opponent can capture this message and attempt to decrypt it by trying various passwords. If the result of a test decryption is of theproper form, then the opponent has discovered the client\u2019s password and maysubsequently use it to gain authentication credentials from Kerberos. This isthe same type of password attack described in Chapter 9, with the same kindsof countermeasures being applicable. Version 5 does provide a mechanismknown as preauthentication, which should make password attacks more diffi-cult, but it does not prevent them. T HEVERSION 5 AUTHENTICATION DIALOGUE Table 4.3 summarizes the basic version 5 dialogue. This is best explained by comparison with version 4 (Table 4.1). First, consider the authentication service exchange . Message (1) is a client"}, {"id": "848e11affbd7e7fff0f53a80bfbd5fbf6d827a92", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 127, "start_line": 16, "end_line": 24, "text": "request for a ticket-granting ticket. As before, it includes the ID of the user and theTGS. The following new elements are added: \u2022Realm: Indicates realm of user. \u2022Options: Used to request that certain flags be set in the returned ticket. \u2022Times: Used by the client to request the following time settings in the ticket: from: the desired start time for the requested ticket till: the requested expiration time for the requested ticketrtime: requested renew-till time \u2022Nonce: A random value to be repeated in message (2) to assure that the response is fresh and has not been replayed by an opponent. 3Appendix F describes the mapping of passwords to encryption keys."}, {"id": "43542c7dc22062a17b7744557148c4333d6c382f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 128, "start_line": 1, "end_line": 14, "text": "4.2 / KERBEROS 113 Table 4.3 Summary of Kerberos Version 5 Message Exchanges (1) C AS Options 7IDc7Realm c7IDtgs7Times7Nonce 1 : (2) AS C Realm c7IDC7Ticket tgs7E(K c,[Kc,tgs7Times7Nonce 17Realm tgs7IDtgs]) : Ticket tgs E(K tgs,[Flags7Kc,tgs7Realm c7IDC7AD C7Times]) = (a) Authentication Service Exchange to obtain ticket-granting ticket (3) C TGS Options 7IDv7Times77Nonce 27Ticket tgs7Authenticator c : (4) TGS C Realm c7IDC7Ticket v7E(K c,tgs,[Kc,v7Times7Nonce 27Realm v7IDv]) : Ticket tgs E(K tgs,[Flags7Kc,tgs7Realm c7IDC7AD C7Times]) = Ticket v E(K v,[Flags7Kc,v7Realm c7IDC7AD C7Times]) = Authenticator cE(K c,tgs,[IDC7Realm c7TS1]) = (b) Ticket-Granting Service Exchange to obtain service-granting ticket (5) C V Options 7Ticket v7Authenticator c : (6) V C EKc,v[ TS 27Subkey7Seq# ] :"}, {"id": "4246d06d32d8bff46d44dd0c58267674e6c261d0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 128, "start_line": 15, "end_line": 19, "text": "Ticket v E(K v, [Flags 7Kc,v7Realm c7IDC7AD C7Times]) = Authenticator cE(K c,v,[IDC7Realm c7TS27Subkey7Seq#]) = (c) Client/Server Authentication Exchange to obtain service Message (2) returns a ticket-granting ticket, identifying information for the client, and a block encrypted using the encryption key based on the user\u2019s password."}, {"id": "eb64b5e0714d67d4cd0c98d623428e3c7067be7c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 128, "start_line": 20, "end_line": 21, "text": "This block includes the session key to be used between the client and the TGS, timesspecified in message (1), the nonce from message (1), and TGS identifying informa-tion. The ticket itself includes the session key, identifying information for the client,the requested time values, and flags that reflect the status of this ticket and therequested options. These flags introduce significant new functionality to version 5.For now, we defer a discussion of these flags and concentrate on the overall structureof the version 5 protocol. Let us now compare the ticket-granting service exchange for versions 4 and 5."}, {"id": "51800879f691d555eddbf8b1a93d01f15b873def", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 128, "start_line": 22, "end_line": 26, "text": "We see that message (3) for both versions includes an authenticator, a ticket, and thename of the requested service. In addition, version 5 includes requested times andoptions for the ticket and a nonce\u2014all with functions similar to those of message (1).The authenticator itself is essentially the same as the one used in version 4. Message (4) has the same structure as message (2). It returns a ticket plus information needed by the client, with the information encrypted using the sessionkey now shared by the client and the TGS. Finally, for the client/server authentication exchange , several new features appear in version 5. In message (5), the client may request as an option that mutualauthentication is required. The authenticator includes several new fields:"}, {"id": "172b94d9518a04d2342de6da12494820119172f0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 128, "start_line": 27, "end_line": 29, "text": "\u2022Subkey: The client\u2019s choice for an encryption key to be used to protect this specific application session. If this field is omitted, the session key from theticket ( K C,V) is used."}, {"id": "2eba7a498e3361323d295409a2c20b0a19a16245", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 129, "start_line": 1, "end_line": 6, "text": "114 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION \u2022Sequence number: An optional field that specifies the starting sequence num- ber to be used by the server for messages sent to the client during this session. Messages may be sequence numbered to detect replays. If mutual authentication is required, the server responds with message (6). This message includes the timestamp from the authenticator. Note that in version 4,"}, {"id": "f2fdbfa2d73e9fa9b4d5e28b057953cc9f1c4ece", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 129, "start_line": 7, "end_line": 12, "text": "the timestamp was incremented by one. This is not necessary in version 5, becausethe nature of the format of messages is such that it is not possible for an opponent tocreate message (6) without knowledge of the appropriate encryption keys. The sub-key field, if present, overrides the subkey field, if present, in message (5). Theoptional sequence number field specifies the starting sequence number to be usedby the client. 4.3 KEY DISTRIBUTION USING ASYMMETRIC ENCRYPTION One of the major roles of public-key encryption is to address the problem of keydistribution. There are actually two distinct aspects to the use of public-key encryp-tion in this regard. \u2022The distribution of public keys. \u2022The use of public-key encryption to distribute secret keys. We examine each of these areas in turn."}, {"id": "14f0aa9ee62d6dfe248954e313da4b6818c6f4f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 129, "start_line": 13, "end_line": 14, "text": "Public-Key Certificates On the face of it, the point of public-key encryption is that the public key is public.Thus, if there is some broadly accepted public-key algorithm, such as RSA, anyparticipant can send his or her public key to any other participant or broadcast thekey to the community at large. Although this approach is convenient, it has amajor weakness.Anyone can forge such a public announcement.That is, some usercould pretend to be user A and send a public key to another participant or broad-cast such a public key. Until such time as user A discovers the forgery and alertsother participants, the forger is able to read all encrypted messages intended for Aand can use the forged keys for authentication."}, {"id": "a7a0e67d9c601cc9829ad1790a0c7ab3f4d28050", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 129, "start_line": 15, "end_line": 17, "text": "The solution to this problem is the public-key certificate . In essence, a cer- tificate consists of a public key plus a user ID of the key owner, with the wholeblock signed by a trusted third party. Typically, the third party is a certificateauthority (CA) that is trusted by the user community, such as a governmentagency or a financial institution. A user can present his or her public key to theauthority in a secure manner and obtain a certificate. The user can then publishthe certificate. Anyone needing this user\u2019s public key can obtain the certificateand verify that it is valid by way of the attached trusted signature. Figure 4.3 illus-trates the process. One scheme has become universally accepted for formatting public-key cer-"}, {"id": "0aadb9abe23601390d4a5b62be2b2edf332d40a7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 129, "start_line": 18, "end_line": 18, "text": "tificates: the X.509 standard. X.509 certificates are used in most network securityapplications, including IP security, secure sockets layer (SSL), secure electronic"}, {"id": "366b46e78a0c10ff42e1ed2d11b56cc0c3ab5df2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 130, "start_line": 1, "end_line": 4, "text": "4.3 / KEY DISTRIBUTION USING ASYMMETRIC ENCRYPTION 115 transactions (SET), and S/MIME\u2014all of which are discussed in Part Two. X.509 is examined in detail in the next section. Public-Key Distribution of Secret Keys"}, {"id": "3f0c0c24eaad8c05c5ff66ed423c4de6ba7b37d0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 130, "start_line": 5, "end_line": 5, "text": "With conventional encryption, a fundamental requirement for two parties to commu-nicate securely is that they share a secret key. Suppose Bob wants to create a messag-ing application that will enable him to exchange e-mail securely with anyone who hasaccess to the Internet or to some other network that the two of them share. SupposeBob wants to do this using conventional encryption. With conventional encryption,Bob and his correspondent, say, Alice, must come up with a way to share a uniquesecret key that no one else knows. How are they going to do that? If Alice is in thenext room from Bob, Bob could generate a key and write it down on a piece of paperor store it on a diskette and hand it to Alice. But if Alice is on the other side of the con-tinent or the world, what can Bob do? He could encrypt this key using conventionalencryption and e-mail it to Alice, but this means that Bob and Alice must share asecret key to encrypt this new secret key. Furthermore, Bob and everyone else whouses this new e-mail package faces the same problem with every potential correspon-dent: Each pair of correspondents must share a unique secret key."}, {"id": "a11044ed657864befeadd525d88d798400350087", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 130, "start_line": 6, "end_line": 17, "text": "One approach is the use of Diffie-Hellman key exchange. This approach is indeed widely used. However, it suffers the drawback that, in its simplest form,Diffie-Hellman provides no authentication of the two communicating partners.Unsigned certificate: contains user ID, user's public key Signed certificate: Recipient can verify signature using CA's public keyGenerate hashcode of unsignedcertificate Encrypt hash codewith CA's private key to form signatureH E Figure 4.3 Public-Key Certificate Use"}, {"id": "34d085756c19ee6c8115a5b96bfa90d96069fece", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 131, "start_line": 1, "end_line": 12, "text": "116 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION A powerful alternative is the use of public-key certificates. When Bob wishes to communicate with Alice, Bob can do the following: 1.Prepare a message. 2.Encrypt that message using conventional encryption with a one-time conven- tional session key. 3.Encrypt the session key using public-key encryption with Alice\u2019s public key. 4.Attach the encrypted session key to the message and send it to Alice. Only Alice is capable of decrypting the session key and therefore of recovering the original message. If Bob obtained Alice\u2019s public key by means of Alice\u2019s public- key certificate, then Bob is assured that it is a valid key. 4.4 X.509 CERTIFICATES"}, {"id": "44dc71b13c2c673a7a066a7e9935b7d887083e82", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 131, "start_line": 13, "end_line": 15, "text": "ITU-T recommendation X.509 is part of the X.500 series of recommendations thatdefine a directory service. The directory is, in effect, a server or distributed set ofservers that maintains a database of information about users. The informationincludes a mapping from user name to network address, as well as other attributesand information about the users. X.509 defines a framework for the provision of authentication services by the X.500 directory to its users. The directory may serve as a repository of public-keycertificates. Each certificate contains the public key of a user and is signed with theprivate key of a trusted certification authority. In addition, X.509 defines alternativeauthentication protocols based on the use of public-key certificates."}, {"id": "f528d15b89f3cea9060fdedfabd9f0ac5a2eb83c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 131, "start_line": 16, "end_line": 20, "text": "X.509 is an important standard because the certificate structure and authenti- cation protocols defined in X.509 are used in a variety of contexts. For example, theX.509 certificate format is used in S/MIME (Chapter 7), IP Security (Chapter 8),and SSL/TLS (Chapter 5). X.509 was initially issued in 1988. The standard was subsequently revised to address some of the security concerns documented in [IANS90] and [MITC90]; arevised recommendation was issued in 1993. A third version was issued in 1995 andrevised in 2000. X.509 is based on the use of public-key cryptography and digital signatures. The"}, {"id": "111a52c700418ede072909437bd5b6a995669ea2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 131, "start_line": 21, "end_line": 23, "text": "standard does not dictate the use of a specific algorithm but recommends RSA.The dig-ital signature scheme is assumed to require the use of a hash function. Again, thestandard does not dictate a specific hash algorithm.The 1988 recommendation includedthe description of a recommended hash algorithm; this algorithm has since been shownto be insecure and was dropped from the 1993 recommendation. Figure 4.3 illustratesthe generation of a public-key certificate. Certificates The heart of the X.509 scheme is the public-key certificate associated with eachuser. These user certificates are assumed to be created by some trusted certifica-tion authority (CA) and placed in the directory by the CA or by the user. Thedirectory server itself is not responsible for the creation of public keys or for the"}, {"id": "c9d3eea21975fa5c2060e8755e99c3898073e32e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 132, "start_line": 1, "end_line": 10, "text": "4.4 / X.509 CERTIFICATES 117 certification function; it merely provides an easily accessible location for users to obtain certificates. Figure 4.4a shows the general format of a certificate, which includes the following elements. \u2022Version: Differentiates among successive versions of the certificate format; the default is version 1. If the Issuer Unique Identifier or Subject UniqueIdentifier are present, the value must be version 2. If one or more extensionsare present, the version must be version 3. \u2022Serial number: An integer value, unique within the issuing CA, that is unam- biguously associated with this certificate. \u2022Signature algorithm identifier: The algorithm used to sign the certificate,"}, {"id": "ca53e6c184642a58ae1797f3325279f492d9f082", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 132, "start_line": 11, "end_line": 34, "text": "together with any associated parameters. Because this information is repeated inthe Signature field at the end of the certificate, this field has little, if any, utility. \u2022Issuer name: X.500 name of the CA that created and signed this certificate. \u2022Period of validity: Consists of two dates: the first and last on which the certifi- cate is valid. \u2022Subject name: The name of the user to whom this certificate refers.That is, this certificate certifies the public key of the subject who holds the correspondingprivate key.Certificate serial numberVersion Issuer nameSignature algorithm identifier Subject name ExtensionsIssuer unique identifier Subject unique identifierAlgorithm Parameters Not before Algorithms Parameters Key Algorithms Parameters Encrypted hash (a) X.509 certificateNot after"}, {"id": "75d4da742c7529a7b036819477e76d6b7a4ade94", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 132, "start_line": 35, "end_line": 58, "text": "Subject's public key info SignaturePeriod of validity Version 1 Version 2 Version 3All versionsIssuer name This update date Next update dateSignature algorithm identifierAlgorithm Parameters User certificate serial # (b) Certificate revocation listRevocation date Algorithms Parameters EncryptedSignatureRevoked certificate User certificate serial # Revocation dateRevoked certificate Figure 4.4 X.509 Formats"}, {"id": "1d87479ef2de73f9201995cf58b5827c2bb01e85", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 133, "start_line": 1, "end_line": 11, "text": "118 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION \u2022Subject\u2019s public-key information: The public key of the subject, plus an identi- fier of the algorithm for which this key is to be used, together with any associ- ated parameters. \u2022Issuer unique identifier: An optional bit string field used to identify uniquely the issuing CA in the event the X.500 name has been reused for differententities. \u2022Subject unique identifier: An optional bit string field used to identify uniquely the subject in the event the X.500 name has been reused for differ-ent entities. \u2022Extensions: A set of one or more extension fields. Extensions were added in version 3 and are discussed later in this section. \u2022Signature: Covers all of the other fields of the certificate; it contains the hash"}, {"id": "831eceff07ef6e60abaa1fbef4738a893900b86b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 133, "start_line": 12, "end_line": 19, "text": "code of the other fields encrypted with the CA\u2019s private key.This field includesthe signature algorithm identifier. The unique identifier fields were added in version 2 to handle the possible reuse of subject and/or issuer names over time. These fields are rarely used. The standard uses the following notation to define a certificate: CA A CA {V , SN, AI, CA, UCA, A, UA, Ap, T A} where Y X the certificate of user X issued by certification authority Y"}, {"id": "cf99c878ca69d5e9620c395a435a9dc0cedbca85", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 133, "start_line": 20, "end_line": 26, "text": "Y {I} the signing of I by Y; consists of I with an encrypted hash code appendedV version of the certificateSN serial number of the certificateAI identifier of the algorithm used to sign the certificateCA name of certificate authorityUCA optional unique identifier of the CAA name of user AUA optional unique identifier of the user AAp public key of user AT Aperiod of validity of the certificate The CA signs the certificate with its private key. If the corresponding public key is known to a user, then that user can verify that a certificate signed by the CA is valid. This is the typical digital signature approach, as illustrated in Figure 4.5. OBTAINING A USER\u2019SCERTIFICATE User certificates generated by a CA have the following characteristics:"}, {"id": "496c799e8b1456f2533403ec7ea1d8f5582eaee1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 133, "start_line": 27, "end_line": 29, "text": "\u2022Any user with access to the public key of the CA can verify the user public key that was certified. \u2022No party other than the certification authority can modify the certificate withoutthis being detected.=========== 77 66= 77 66"}, {"id": "7a7198a94fdc63f4ab4bf4b98485150d8b870b06", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 134, "start_line": 1, "end_line": 6, "text": "4.4 / X.509 CERTIFICATES 119 Because certificates are unforgeable, they can be placed in a directory without the need for the directory to make special efforts to protect them. If all users subscribe to the same CA, then there is a common trust of that CA. All user certificates can be placed in the directory for access by all users. In addition,a user can transmit his or her certificate directly to other users. In either case, onceB is in possession of A\u2019s certificate, B has confidence that messages it encrypts withA\u2019s public key will be secure from eavesdropping and that messages signed with A\u2019sprivate key are unforgeable. If there is a large community of users, it may not be practical for all users to"}, {"id": "5b356773bdf500cb953b2f0412caf130b0931981", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 134, "start_line": 7, "end_line": 28, "text": "subscribe to the same CA. Because it is the CA that signs certificates, each partic-ipating user must have a copy of the CA\u2019s own public key to verify signatures. Thispublic key must be provided to each user in an absolutely secure way (withrespect to integrity and authenticity) so that the user has confidence in the associ-ated certificates. Thus, with many users, it may be more practical for there to be anumber of CAs, each of which securely provides its public key to some fraction ofthe users.Encrypt CompareBob\u2019s private keyBob\u2019s public key Bob\u2019s signature for MSMessage Me c i l A b o B Cryptographic hash function hMessage M Cryptographic hash function hDecrypt h\u2032S Return signature valid or not valid Figure 4.5 Simplified Depiction of Essential Elements of Digital Signature Process"}, {"id": "cf7a8e811b173f80f8acffdd7198c63491450749", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 135, "start_line": 1, "end_line": 11, "text": "120 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Now suppose that A has obtained a certificate from certification authority X1and B has obtained a certificate from CA X 2. If A does not securely know the public key of X 2, then B\u2019s certificate, issued by X 2, is useless to A. A can read B\u2019s certificate, but A cannot verify the signature. However, if the two CAs have securely exchanged their own public keys, the following procedure will enable Ato obtain B\u2019s public key. 1.A obtains (from the directory) the certificate of X 2signed by X 1. Because A securely knows X 1\u2019s public key, A can obtain X 2\u2019s public key from its certificate and verify it by means of X 1\u2019s signature on the certificate. 2.A then goes back to the directory and obtains the certificate of B signed by X 2."}, {"id": "5e8c90ae56ff6421467179957ad9b4c44ec40d8c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 135, "start_line": 12, "end_line": 26, "text": "Because A now has a trusted copy of X 2\u2019s public key, A can verify the signature and securely obtain B\u2019s public key. A has used a chain of certificates to obtain B\u2019s public key. In the notation of X.509, this chain is expressed as X1 X2 X2 B In the same fashion, B can obtain A\u2019s public key with the reverse chain: X2 X1 X1 A This scheme need not be limited to a chain of two certificates. An arbitrarily long path of CAs can be followed to produce a chain. A chain with Nelements would be expressed as X1 X2 X2 X3 ...X N B In this case, each pair of CAs in the chain (X i,Xi1) must have created certificates for each other. All of these certificates of CAs by CAs need to appear in the directory, and the user needs to know how they are linked to follow a path to another user\u2019s public-key"}, {"id": "2f70dce2a1a7e60e4da7cc15984e927a44d10b1d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 135, "start_line": 27, "end_line": 36, "text": "certificate. X.509 suggests that CAs be arranged in a hierarchy so that navigation isstraightforward. Figure 4.6, taken from X.509, is an example of such a hierarchy. The connected circles indicate the hierarchical relationship among the CAs; the associated boxesindicate certificates maintained in the directory for each CA entry. The directoryentry for each CA includes two types of certificates: \u2022Forward certificates: Certificates of X generated by other CAs \u2022Reverse certificates: Certificates generated by X that are the certificates of other CAs In this example, user A can acquire the following certificates from the direc- tory to establish a certification path to B: XW WV VY YZ ZB When A has obtained these certificates, it can unwrap the certification path in"}, {"id": "52169e05c0e4b3fb10c938671af67b911db24036", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 135, "start_line": 37, "end_line": 38, "text": "sequence to recover a trusted copy of B\u2019s public key. Using this public key, A can send encrypted messages to B. If A wishes to receive encrypted messages back from77 66 77 66 77 66 77 66 77 66+77 66 77 66 77 6677 66 77 6677 66 77 66"}, {"id": "750e2dbc577f358e3a76a0e79b55ca18be9e1981", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 136, "start_line": 1, "end_line": 10, "text": "4.4 / X.509 CERTIFICATES 121 B, or to sign messages sent to B, then B will require A\u2019s public key, which can be obtained from the certification path: ZY YV VW WX XA B can obtain this set of certificates from the directory, or A can provide them as part of its initial message to B. REVOCATION OF CERTIFICATES Recall from Figure 4.4 that each certificate includes a period of validity, much like a credit card. Typically, a new certificate is issued just before the expiration of the old one. In addition, it may be desirable on occasion torevoke a certificate before it expires for one of the following reasons. 1.The user\u2019s private key is assumed to be compromised."}, {"id": "e8eb4df6a68316650e06d5e8e26db26ede8a185d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 136, "start_line": 11, "end_line": 23, "text": "2.The user is no longer certified by this CA. Reasons for this include subject\u2019s namehas changed, the certificate is superseded, or the certificate was not issued in con-formance with the CA\u2019s policies. 3.The CA\u2019s certificate is assumed to be compromised. Each CA must maintain a list consisting of all revoked but not expired certifi- cates issued by that CA, including both those issued to users and to other CAs. These lists also should be posted on the directory.77 66 77 66 77 66 77 66 77 66U V W Y Z BX C AU/H11021/H11021V/H11022/H11022 V/H11021/H11021U/H11022/H11022 V/H11021/H11021W/H11022/H11022 W/H11021/H11021V/H11022/H11022V/H11021/H11021Y/H11022/H11022Y/H11021/H11021V/H11022/H11022"}, {"id": "4a62ab4a5473b454a1bd0f428792fda92ed02be8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 136, "start_line": 24, "end_line": 26, "text": "W/H11021/H11021X/H11022/H11022X/H11021/H11021W/H11022/H11022X/H11021/H11021Z/H11022/H11022Y/H11021/H11021Z/H11022/H11022Z/H11021/H11021Y/H11022/H11022Z/H11021/H11021X/H11022/H11022 X/H11021/H11021C/H11022/H11022 X/H11021/H11021A/H11022/H11022 Z/H11021/H11021B/H11022/H11022 Figure 4.6 X.509 Hierarchy: A Hypothetical Example"}, {"id": "13f3c0c1df11b1ad1df5af5e6bc595026633832a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 137, "start_line": 1, "end_line": 5, "text": "122 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Each certificate revocation list (CRL) posted to the directory is signed by the issuer and includes (Figure 4.4b) the issuer\u2019s name, the date the list was created, the date the next CRL is scheduled to be issued, and an entry for each revoked certifi-cate. Each entry consists of the serial number of a certificate and revocation date forthat certificate. Because serial numbers are unique within a CA, the serial number issufficient to identify the certificate. When a user receives a certificate in a message, the user must determine"}, {"id": "667c1b2960ad98015f21703e186c3a8f8232ceea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 137, "start_line": 6, "end_line": 9, "text": "whether the certificate has been revoked. The user could check the directory eachtime a certificate is received. To avoid the delays (and possible costs) associated withdirectory searches, it is likely that the user would maintain a local cache of certificatesand lists of revoked certificates. X.509 Version 3 The X.509 version 2 format does not convey all of the information that recentdesign and implementation experience has shown to be needed. [FORD95] lists thefollowing requirements not satisfied by version 2: 1.The Subject field is inadequate to convey the identity of a key owner to a public-key user. X.509 names may be relatively short and lacking in obvious identifica-tion details that may be needed by the user."}, {"id": "d72ecdbc13a8a84b957c67130eea60e5fc0ae70c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 137, "start_line": 10, "end_line": 13, "text": "2.The Subject field is also inadequate for many applications, which typically recog-nize entities by an Internet e-mail address, a URL, or some other Internet-relatedidentification. 3.There is a need to indicate security policy information. This enables a securityapplication or function, such as IPSec, to relate an X.509 certificate to a givenpolicy. 4.There is a need to limit the damage that can result from a faulty or malicious CAby setting constraints on the applicability of a particular certificate. 5.It is important to be able to identify different keys used by the same owner atdifferent times. This feature supports key life cycle management, in particularthe ability to update key pairs for users and CAs on a regular basis or underexceptional circumstances."}, {"id": "859a3cc4918e18cbe1f3654df5bee2f043815dbb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 137, "start_line": 14, "end_line": 20, "text": "Rather than continue to add fields to a fixed format, standards developers felt that a more flexible approach was needed. Thus, version 3 includes a number of optional extensions that may be added to the version 2 format. Each extensionconsists of an extension identifier, a criticality indicator, and an extension value.The criticality indicator indicates whether an extension can be safely ignored.If the indicator has a value of TRUE and an implementation does not recognizethe extension, it must treat the certificate as invalid. The certificate extensions fall into three main categories: key and policy infor- mation, subject and issuer attributes, and certification path constraints. K EY AND POLICY INFORMATION These extensions convey additional information"}, {"id": "92fb6d2ed020058b52a28e47182fdf8892b3bc12", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 137, "start_line": 21, "end_line": 22, "text": "about the subject and issuer keys, plus indicators of certificate policy. A certificate policy is a named set of rules that indicates the applicability of a certificate to a"}, {"id": "3f287808bdef5f170119f275686e37c2d25232d6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 138, "start_line": 1, "end_line": 7, "text": "4.4 / X.509 CERTIFICATES 123 particular community and/or class of application with common security requirements. For example, a policy might be applicable to the authentication ofelectronic data interchange (EDI) transactions for the trading of goods within agiven price range. This area includes: \u2022Authority key identifier: Identifies the public key to be used to verify the sig- nature on this certificate or CRL. Enables distinct keys of the same CA to bedifferentiated. One use of this field is to handle CA key pair updating. \u2022Subject key identifier: Identifies the public key being certified. Useful for sub-"}, {"id": "fa6e2108a6d08b7cc6c217ac79d06ed789129921", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 138, "start_line": 8, "end_line": 11, "text": "ject key pair updating. Also, a subject may have multiple key pairs and, corre-spondingly, different certificates for different purposes (e.g., digital signatureand encryption key agreement). \u2022Key usage: Indicates a restriction imposed as to the purposes for which, and the policies under which, the certified public key may be used. May indicateone or more of the following: digital signature, nonrepudiation, key encryp-tion, data encryption, key agreement, CA signature verification on certificates,and CA signature verification on CRLs. \u2022Private-key usage period: Indicates the period of use of the private key corre-"}, {"id": "3b1059fae6a3b43d528312ef730a89a4d70d9742", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 138, "start_line": 12, "end_line": 17, "text": "sponding to the public key. Typically, the private key is used over a differentperiod from the validity of the public key. For example, with digital signaturekeys, the usage period for the signing private key is typically shorter than thatfor the verifying public key. \u2022Certificate policies: Certificates may be used in environments where multiple policies apply. This extension lists policies that the certificate is recognized assupporting, together with optional qualifier information. \u2022Policy mappings: Used only in certificates for CAs issued by other CAs. Policy mappings allow an issuing CA to indicate that one or more of that issuer\u2019spolicies can be considered equivalent to another policy used in the subjectCA\u2019s domain. C"}, {"id": "4e33eba134d16bae9890737dd6f3d42da0013e41", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 138, "start_line": 18, "end_line": 22, "text": "ERTIFICATE SUBJECT AND ISSUER ATTRIBUTES These extensions support alternative names, in alternative formats, for a certificate subject or certificate issuer and canconvey additional information about the certificate subject to increase a certificateuser\u2019s confidence that the certificate subject is a particular person or entity. Forexample, information such as postal address, position within a corporation, orpicture image may be required. The extension fields in this area include: \u2022Subject alternative name: Contains one or more alternative names, using any of a variety of forms. This field is important for supporting certain applications, suchas electronic mail, EDI, and IPSec, which may employ their own name forms."}, {"id": "c9a3e051bf58afefea2d4f4ab2df84e503f8a8e3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 138, "start_line": 23, "end_line": 26, "text": "\u2022Issuer alternative name: Contains one or more alternative names, using any of a variety of forms. \u2022Subject directory attributes: Conveys any desired X.500 directory attribute values for the subject of this certificate."}, {"id": "664d1c5cc835830e0814142d6475a5f242da6813", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 139, "start_line": 1, "end_line": 10, "text": "124 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION CERTIFICATION PATHCONSTRAINTS These extensions allow constraint specifications to be included in certificates issued for CAs by other CAs. The constraints may restrict the types of certificates that can be issued by the subject CA or that mayoccur subsequently in a certification chain. The extension fields in this area include: \u2022Basic constraints: Indicates if the subject may act as a CA. If so, a certification path length constraint may be specified. \u2022Name constraints: Indicates a name space within which all subject names in subsequent certificates in a certification path must be located. \u2022Policy constraints: Specifies constraints that may require explicit certificate"}, {"id": "dd75cdce4fee732d2226c7864b72124d2fe8f3a8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 139, "start_line": 11, "end_line": 13, "text": "policy identification or inhibit policy mapping for the remainder of the certifi-cation path. 4.5 PUBLIC-KEY INFRASTRUCTURE RFC 2822 (Internet Security Glossary ) defines public-key infrastructure (PKI) as"}, {"id": "f6685f8a37a9384fcfd5adeb5e8d2b2b490df804", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 139, "start_line": 14, "end_line": 17, "text": "the set of hardware, software, people, policies, and procedures needed to create,manage, store, distribute, and revoke digital certificates based on asymmetric cryp-tography. The principal objective for developing a PKI is to enable secure, conve-nient, and efficient acquisition of public keys. The Internet Engineering Task Force(IETF) Public Key Infrastructure X.509 (PKIX) working group has been the dri-ving force behind setting up a formal (and generic) model based on X.509 that issuitable for deploying a certificate-based architecture on the Internet. This sectiondescribes the PKIX model. Figure 4.7 shows the interrelationship among the key elements of the PKIX model. These elements are \u2022End entity: A generic term used to denote end users, devices (e.g., servers,"}, {"id": "d5aafafd379fa7c18c051c93f661c557245b16ad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 139, "start_line": 18, "end_line": 23, "text": "routers), or any other entity that can be identified in the subject field of a pub-lic key certificate. End entities typically consume and/or support PKI-relatedservices. \u2022Certification authority (CA): The issuer of certificates and (usually) certifi- cate revocation lists (CRLs). It may also support a variety of administrativefunctions, although these are often delegated to one or more registrationauthorities. \u2022Registration authority (RA): An optional component that can assume a num- ber of administrative functions from the CA. The RA is often associated withthe end entity registration process, but can assist in a number of other areas aswell. \u2022CRL issuer: An optional component that a CA can delegate to publish CRLs."}, {"id": "9831757ed3b7b0222fedbfe793a648704f0a3564", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 139, "start_line": 24, "end_line": 25, "text": "\u2022Repository: A generic term used to denote any method for storing certificates and CRLs so that they can be retrieved by end entities."}, {"id": "ce5d14e7b45c02a127aaaa1efcfbd224d622bad4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 140, "start_line": 1, "end_line": 7, "text": "4.5 / PUBLIC-KEY INFRASTRUCTURE 125 PKIX Management Functions PKIX identifies a number of management functions that potentially need to be sup- ported by management protocols. These are indicated in Figure 4.7 and include thefollowing: \u2022Registration: This is the process whereby a user first makes itself known to a CA (directly, or through an RA), prior to that CA issuing a certificate or cer-tificates for that user. Registration begins the process of enrolling in a PKI.Registration usually involves some off-line or online procedure for mutualauthentication. Typically, the end entity is issued one or more shared secretkeys used for subsequent authentication. \u2022Initialization: Before a client system can operate securely, it is necessary to"}, {"id": "a8e070e41ac612e845478c6a251be4bf59be901c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 140, "start_line": 8, "end_line": 26, "text": "install key materials that have the appropriate relationship with keys storedelsewhere in the infrastructure. For example, the client needs to be securelyinitialized with the public key and other assured information of the trustedCA(s) to be used in validating certificate paths. \u2022Certification: This is the process in which a CA issues a certificate for a user\u2019s public key and returns that certificate to the user\u2019s client system and/or poststhat certificate in a repository.End entityCertificate/CRL retrieval Certificate publication Certificate/CRL publication CRL publicationCross- certificationCertificate/CRL repositoryCertificate authorityRegistration authority Certificate authorityRegistration, initialization, certification, key pair recovery, key pair updaterevocation requestPKI users"}, {"id": "49aff25062450413d43820cece2f1de2006e764e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 140, "start_line": 27, "end_line": 30, "text": "PKI management entitiesCRL issuer Figure 4.7 PKIX Architectural Model"}, {"id": "b134fdb367a10cf72a1420844b48f056764c1d99", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 141, "start_line": 1, "end_line": 4, "text": "126 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION \u2022Key pair recovery: Key pairs can be used to support digital signature creation and verification, encryption and decryption, or both. When a key pair is used for encryption/decryption, it is important to provide a mechanism to recoverthe necessary decryption keys when normal access to the keying material is nolonger possible, otherwise it will not be possible to recover the encrypted data.Loss of access to the decryption key can result from forgotten passwords/PINs,corrupted disk drives, damage to hardware tokens, and so on. Key pair recov-ery allows end entities to restore their encryption/decryption key pair from anauthorized key backup facility (typically, the CA that issued the end entity\u2019scertificate)."}, {"id": "1dbf4825772da96f73309d96b1e2737befabaa11", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 141, "start_line": 5, "end_line": 11, "text": "\u2022Key pair update: All key pairs need to be updated regularly (i.e., replaced with a new key pair) and new certificates issued. Update is required when the cer-tificate lifetime expires and as a result of certificate revocation. \u2022Revocation request: An authorized person advises a CA of an abnormal situa- tion requiring certificate revocation. Reasons for revocation include privatekey compromise, change in affiliation, and name change. \u2022Cross certification: Two CAs exchange information used in establishing a cross-certificate.A cross-certificate is a certificate issued by one CA to anotherCA that contains a CA signature key used for issuing certificates. PKIX Management Protocols"}, {"id": "adc3b9629524375b6c8c605c4fa54a44898b4359", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 141, "start_line": 12, "end_line": 14, "text": "The PKIX working group has defines two alternative management protocolsbetween PKIX entities that support the management functions listed in the preced-ing subsection. RFC 2510 defines the certificate management protocols (CMP).Within CMP , each of the management functions is explicitly identified by specificprotocol exchanges. CMP is designed to be a flexible protocol able to accommodatea variety of technical, operational, and business models. RFC 2797 defines certificate management messages over CMS (CMC), where CMS refers to RFC 2630, cryptographic message syntax. CMC is built on earlier workand is intended to leverage existing implementations. Although all of the PKIX func-tions are supported, the functions do not all map into specific protocol exchanges."}, {"id": "aa94a01303bb2f8bc19cd0e6d2bc249779ce8acd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 141, "start_line": 15, "end_line": 19, "text": "4.6 FEDERATED IDENTITY MANAGEMENT Federated identity management is a relatively new concept dealing with the use of a common identity management scheme across multiple enterprises and numerousapplications and supporting many thousands, even millions, of users. We begin ouroverview with a discussion of the concept of identity management and then examinefederated identity management. Identity Management Identity management is a centralized, automated approach to provide enterprise-wide access to resources by employees and other authorized individuals. The focusof identity management is defining an identity for each user (human or process),"}, {"id": "bcfa3d7939866e9fdea72b20560354eb2d542f59", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 142, "start_line": 1, "end_line": 12, "text": "4.6 / FEDERATED IDENTITY MANAGEMENT 127 associating attributes with the identity, and enforcing a means by which a user can verify identity. The central concept of an identity management system is the useof single sign-on (SSO). SSO enables a user to access all network resources after asingle authentication. [PELT07] lists the following as the principal elements of an identity management system. \u2022Authentication: Confirmation that a user corresponds to the user name provided. \u2022Authorization: Granting access to specific services and/or resources based on the authentication. \u2022Accounting: A process for logging access and authorization. \u2022Provisioning: The enrollment of users in the system. \u2022Workflow automation: Movement of data in a business process."}, {"id": "0d1d209a7e4f74434f7ef9f3920f5b2446bc8adb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 142, "start_line": 13, "end_line": 21, "text": "\u2022Delegated administration: The use of role-based access control to grant permissions. \u2022Password synchronization: Creating a process for single sign-on (SSO) or reduced sign-on (RSO). Single sign-on enables a user to access all networkresources after a single authentication. RSO may involve multiple sign-ons butrequires less user effort than if each resource and service maintained its ownauthentication facility. \u2022Self-service password reset: Enables the user to modify his or her password. \u2022Federation: A process where authentication and permission will be passed on from one system to another\u2014usually across multiple enterprises, therebyreducing the number of authentications needed by the user. Note that Kerberos contains a number of the elements of an identity manage- ment system."}, {"id": "d54abf22ed99e5f6a7eaf8b1245775c5ec6edaad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 142, "start_line": 22, "end_line": 28, "text": "Figure 4.8 [LINN06] illustrates entities and data flows in a generic identity management architecture. A principal is an identity holder. Typically, this is a human user that seeks access to resources and services on the network. User devices, agent processes, and server systems may also function as principals.Principals authenticate themselves to an identity provider. The identity provider associates authentication information with a principal, as well as attributes andone or more identifiers. Increasingly, digital identities incorporate attributes other than simply an identifier and authentication information (such as passwords and biometric infor-mation). An attribute service manages the creation and maintenance of such"}, {"id": "27c594a90ec5c3c077c571a19ad2773da3653eb3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 142, "start_line": 29, "end_line": 30, "text": "attributes. For example, a user needs to provide a shipping address each time anorder is placed at a new Web merchant, and this information needs to be revisedwhen the user moves. Identity management enables the user to provide this infor-mation once, so that it is maintained in a single place and released to data con-sumers in accordance with authorization and privacy policies. Users may createsome of the attributes to be associated with their digital identity, such as address.Administrators may also assign attributes to users, such as roles, access permis- sions, and employee information."}, {"id": "203d76623334274af2ee8ebc05e27da2094ec8e9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 143, "start_line": 1, "end_line": 5, "text": "128 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Data consumers are entities that obtain and employ data maintained and pro- vided by identity and attribute providers, which are often used to support authoriza- tion decisions and to collect audit information. For example, a database server orfile server is a data consumer that needs a client\u2019s credentials so as to know whataccess to provide to that client. Identity Federation"}, {"id": "aaa31f9e88d6d203541a9d64534e8b67d4300dc7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 143, "start_line": 6, "end_line": 7, "text": "Identity federation is, in essence, an extension of identity management to multiplesecurity domains. Such domains include autonomous internal business units, exter-nal business partners, and other third-party applications and services. The goal is toprovide the sharing of digital identities so that a user can be authenticated a singletime and then access applications and resources across multiple domains. Becausethese domains are relatively autonomous or independent, no centralized control ispossible. Rather, the cooperating organizations must form a federation based onagreed standards and mutual levels of trust to securely share digital identities. Federated identity management refers to the agreements, standards, and tech-"}, {"id": "126edcb097336c72ef6669da3bcb496bc1dd83a6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 143, "start_line": 8, "end_line": 19, "text": "nologies that enable the portability of identities, identity attributes, and entitlementsacross multiple enterprises and numerous applications and supporting many thou-sands, even millions, of users.When multiple organizations implement interoperablefederated identity schemes, an employee in one organization can use a single sign-on to access services across the federation with trust relationships associated withthe identity. For example, an employee may log onto her corporate intranet and beauthenticated to perform authorized functions and access authorized services onPrincipal PrincipalAdministrator Administrator Data consumer Identity control interfacePrincipals provide attributes Principalsauthenticate, manage their identity elementsAdministrators provide attributes"}, {"id": "8707be53d5514c4b1681fd7d1ede1cb646edda0c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 143, "start_line": 20, "end_line": 34, "text": "Data consumers apply references to obtain attribute data Data consumers obtain identif iers, attribute referencesIdentity Provider Attribute locator Principal authenticationIdentifier translationData consumerAttribute service Attribute service Attribute service Principal Figure 4.8 Generic Identity Management Architecture"}, {"id": "c8696ab9f150f687c1be08c7659b5c352e3c5210", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 144, "start_line": 1, "end_line": 6, "text": "4.6 / FEDERATED IDENTITY MANAGEMENT 129 that intranet. The employee could then access their health benefits from an outside health-care provider without having to reauthenticate. Beyond SSO, federated identity management provides other capabilities. One is a standardized means of representing attributes. Increasingly, digital identitiesincorporate attributes other than simply an identifier and authentication informa-tion (such as passwords and biometric information). Examples of attributes includeaccount numbers, organizational roles, physical location, and file ownership. A usermay have multiple identifiers; for example, each identifier may be associated with aunique role with its own access permissions. Another key function of federated identity management is identity mapping."}, {"id": "ac8561d2e8abef4f994d5948bb903c8604acbaca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 144, "start_line": 7, "end_line": 18, "text": "Different security domains may represent identities and attributes differently.Furthermore, the amount of information associated with an individual in onedomain may be more than is necessary in another domain. The federated identitymanagement protocols map identities and attributes of a user in one domain to therequirements of another domain. Figure 4.9 illustrates entities and data flows in a generic federated identity management architecture. User 1 Identity Provider (source domain) Service Provider (destination domain)1End user's browser or other application engagesin an authentication dialogue with identity provider in the same domain. End user also provides attribute values associated with user's identity. 2Some attributes associated with an identity, such as"}, {"id": "97dadcef3cd3cbd9e916e61093c9ceabe76aa51d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 144, "start_line": 19, "end_line": 29, "text": "allowable roles, may be provided by an administrator in the same domain. 3A service provider in a remote domain, which the use r wishes to access, obtains identity information, authentication information, and associated attributes from the identity provider in the source domain. 4Service provider opens session with remote user and enforces access control restrictions based on user's identity and attributes.Administrator2 34 Figure 4.9 Federated Identity Operation"}, {"id": "dbc8ae03d5ce7209fc8b805a32512309eb5ebb70", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 145, "start_line": 1, "end_line": 5, "text": "130 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION The identity provider acquires attribute information through dialogue and protocol exchanges with users and administrators. For example, a user needs to provide a shipping address each time an order is placed at a new Web merchant,and this information needs to be revised when the user moves. Identity manage-ment enables the user to provide this information once, so that it is maintained in asingle place and released to data consumers in accordance with authorization andprivacy policies. Service providers are entities that obtain and employ data maintained and"}, {"id": "24d420cb9bdab0cedd5bd71af6ac8dd6511f0622", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 145, "start_line": 6, "end_line": 9, "text": "provided by identity providers, often to support authorization decisions and tocollect audit information. For example, a database server or file server is a dataconsumer that needs a client\u2019s credentials so as to know what access to provide tothat client. A service provider can be in the same domain as the user and theidentity provider. The power of this approach is for federated identity manage-ment, in which the service provider is in a different domain (e.g., a vendor orsupplier network). S TANDARDS Federated identity management uses a number of standards as the building blocks for secure identity exchange across different domains or"}, {"id": "6726a51b30834d9487a1b52a22e44bcfdbdf1a63", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 145, "start_line": 10, "end_line": 11, "text": "heterogeneous systems. In essence, organizations issue some form of securitytickets for their users that can be processed by cooperating partners. Identityfederation standards are thus concerned with defining these tickets in terms ofcontent and format, providing protocols for exchanging tickets, and performing anumber of management tasks. These tasks include configuring systems toperform attribute transfers and identity mapping and performing logging andauditing functions. The principal underlying standard for federated identity is the Security"}, {"id": "c8d26d3f8906496bc8b28d35f9213d4cebe2bc59", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 145, "start_line": 12, "end_line": 15, "text": "Assertion Markup Language (SAML), which defines the exchange of security infor-mation between online business partners. SAML conveys authentication informa-tion in the form of assertions about subjects. Assertions are statements about thesubject issued by an authoritative entity. SAML is part of a broader collection of standards being issued by the Organization for the Advancement of Structured Information Standards (OASIS)for federated identity management. For example, WS-Federation enables browser-based federation; it relies on a security token service to broker trust of identities,attributes, and authentication between participating Web services. The challenge with federated identity management is to integrate multiple"}, {"id": "fbf8bc8c95cda7b6ee57a123e615b820d9f8596f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 145, "start_line": 16, "end_line": 20, "text": "technologies, standards, and services to provide a secure, user-friendly utility. Thekey, as in most areas of security and networking, is the reliance on a few maturestandards widely accepted by industry. Federated identity management seems tohave reached this level of maturity. E XAMPLES To get some feel for the functionality of identity federation, we look at three scenarios, taken from [COMP06]. In the first scenario (Figure 4.10a), Workplace.com contracts with Health.com to provide employee health benefits.An employee uses a Web interface to sign on to Workplace.com and goes throughan authentication procedure there. This enables the employee to accessauthorized services and resources at Workplace.com. When the employee clicks"}, {"id": "6b49d1e5dee001cc6df5d4d45487283752f27da1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 146, "start_line": 1, "end_line": 4, "text": "4.6 / FEDERATED IDENTITY MANAGEMENT 131 on a link to access health benefits, her browser is redirected to Health.com. At the same time, the Workplace.com software passes the user\u2019s identifier toHealth.com in a secure manner. The two organizations are part of a federationthat cooperatively exchanges user identifiers. Health.com maintains useridentities for every employee at Workplace.com and associates with each identityhealth-benefits information and access rights. In this example, the linkagebetween the two companies is based on account information and userparticipation is browser based. Figure 4.10b shows a second type of browser-based scheme. PartsSupplier."}, {"id": "1ba14537500c7da366e328f297317b74239e6161", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 146, "start_line": 5, "end_line": 5, "text": "com is a regular supplier of parts to Workplace.com. In this case, a role-basedaccess-control (RBAC) scheme is used for access to information. An engineerof Workplace.com authenticates at the employee portal at Workplace.com andclicks on a link to access information at PartsSupplier.com. Because the user isauthenticated in the role of an engineer, he is taken to the technical documen-tation and troubleshooting portion of PartSupplier.com\u2019s Web site without hav-ing to sign on. Similarly, an employee in a purchasing role signs on atWorkplace.com and is authorized, in that role, to place purchases atPartSupplier.com without having to authenticate to PartSupplier.com. For thisscenario, PartSupplier.com does not have identity information for individualUser store"}, {"id": "72bdb2e1fe7b2a61721c514617d7dbde4cf246e2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 146, "start_line": 6, "end_line": 63, "text": "(a) Federation based on account linking (b) Chained Web servicesWorkplace.com (employee portal) Name Joe Jane RaviID 1213 1410 1603 User store Name Joe Jane RaviID 1213 1410 1603Links: health benefitsetc. Health.com Workplace.comEnd user (employee)Initial authenticationUser store (b) Federation based on rolesWorkplace.com (employee portal) Name Joe Jane RaviID 1213 1410 1603Dept Eng Purch Purch User store Role Engineer PurchaserLinks: parts supplieretc. PartsSupplier.com Welcome Joe! T echnical doc.T roubleshootingEnd user (employee)Initial authentication Procurement application End userSoap messageInitial message authentication Soap messagePinSupplies.com Purchasing W eb service E-ship.com Shipping W eb service Figure 4.10 Federated Identity Scenarios"}, {"id": "c91a9e6afe53889cf6eecbb170e891aead9f62f8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 147, "start_line": 1, "end_line": 4, "text": "132 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION employees at Workplace.com. Rather, the linkage between the two federated partners is in terms of roles. The scenario illustrated in Figure 4.10c can be referred to as document based"}, {"id": "9f54498653d3df56946439675972e7eabfe81c80", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 147, "start_line": 5, "end_line": 5, "text": "rather than browser based. In this third example, Workplace.com has a purchasingagreement with PinSupplies.com, and PinSupplies.com has a business relationshipwith E-Ship.com. An employee of Workplace.com signs on and is authenticated tomake purchases. The employee goes to a procurement application that provides alist of Workplace.com\u2019s suppliers and the parts that can be ordered.The user clickson the PinSupplies button and is presented with a purchase order Web page(HTML page). The employee fills out the form and clicks the submit button. Theprocurement application generates an XML/SOAP document that it inserts intothe envelope body of an XML-based message. The procurement application theninserts the user\u2019s credentials in the envelope header of the message, together withWorkplace.com\u2019s organizational identity. The procurement application posts themessage to the PinSupplies.com\u2019s purchasing Web service. This service authenti-cates the incoming message and processes the request. The purchasing Webservice then sends a SOAP message its shipping partner to fulfill the order. Themessage includes a PinSupplies.com security token in the envelope header andthe list of items to be shipped as well as the end user\u2019s shipping information in theenvelope body. The shipping Web service authenticates the request and processesthe shipment order."}, {"id": "daea2e0f5200ba10eae4bef4c9e6d74b8af6f79c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 147, "start_line": 6, "end_line": 13, "text": "4.7 RECOMMENDED READING AND WEB SITES An exhaustive and essential resource on the topics of this chapter is the three-volume NIST SP800-57 [BARK07b. BARK07c, BARK08]. [FUMY93] is a good survey of key managementprinciples. Another interesting survey, which looks at many key management techniques, is[HEGL06]. A painless way to get a grasp of Kerberos concepts is found in [BRYA88]. One of the best treatments of Kerberos is [KOHL94]. [PERL99] reviews various trust models that can be used in a PKI. [GUTM02] high- lights difficulties in PKI use and recommends approaches for an effective PKI. [SHIM05] provides a brief overview of federated identity management and examines"}, {"id": "b93e86d54c1c41d13dd0bc7406628009186a04f9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 147, "start_line": 14, "end_line": 23, "text": "one approach to standardization. [BHAT07] describes an integrated approach to federatedidentity management couple with management of access control privileges. BARK07b Barker, E., et al. Recommendation for Key Management\u2014Part 1: General. NIST SP800-57, March 2007. BARK07c Barker, E., et al. Recommendation for Key Management\u2014Part 2: Best Practices for Key Management Organization. NIST SP800-57, March 2007. BARK08 Barker, E., et al. Recommendation for Key Management\u2014Part 3:Specific Key Management Guidance. NIST SP800-57, August 2008. BHAT07 Bhatti, R.; Bertino, E.; and Ghafoor, A. \u201cAn Integrated Approach to Federated Identity and Privilege Management in Open Systems.\u201d Communications of the ACM , February 2007."}, {"id": "111b8a4e626dbc8e6ecba88458ff0d809dabcf49", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 148, "start_line": 1, "end_line": 11, "text": "4.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 133 BRYA88 Bryant, W. Designing an Authentication System: A Dialogue in Four Scenes. Project Athena document, February 1988.Available at http://web.mit.edu/kerberos/ www/dialogue.html. FUMY93 Fumy, S., and Landrock, P .\u201cPrinciples of Key Management.\u201d IEEE Journal on Selected Areas in Communications , June 1993. GUTM02 Gutmann, P . \u201cPKI: It\u2019s Not Dead, Just Resting.\u201d Computer , August 2002. HEGL06 Hegland, A., et al. \u201cA Survey of Key Management in Ad Hoc Networks.\u201d IEEE Communications Surveys & Tutorials. 3rdQuarter, 2006. KOHL94 Kohl, J.; Neuman, B.; and Ts\u2019o, T. \u201cThe Evolution of the Kerberos Authentication Service.\u201d in Brazier, F., and Johansen, D. Distributed Open Systems."}, {"id": "4a2baf8b7467363266c39267a2308a47789b0c83", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 148, "start_line": 12, "end_line": 23, "text": "Los Alamitos, CA: IEEE Computer Society Press, 1994. Available athttp://web.mit.edu/kerberos/www/papers.html. PERL99 Perlman, R. \u201cAn Overview of PKI Trust Models.\u201d IEEE Network , November/December 1999. SHIM05 Shim, S.; Bhalla, G.; and Pendyala, V . \u201cFederated Identity Management.\u201d Computer , December 2005. Recommended Web Sites: \u2022MIT Kerberos Site: Information about Kerberos, including the FAQ, papers and docu- ments, and pointers to commercial product sites. \u2022MIT Kerberos Consortium: Created to establish Kerberos as the universal authentica- tion platform for the world\u2019s computer networks. \u2022USC/ISI Kerberos Page: Another good source of Kerberos material. \u2022Kerberos Working Group: IETF group developing standards based on Kerberos."}, {"id": "62e0596d5192557b616d8997a39f21e0b07495fe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 148, "start_line": 24, "end_line": 34, "text": "\u2022Public-Key Infrastructure Working Group: IETF group developing standards based on X.509v3. \u2022Verisign: A leading commercial vendor of X.509-related products; white papers and other worthwhile material at this site. \u2022NIST PKI Program: Good source of information. 4.8 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms authenticationauthentication server (AS)federated identity manage- ment identity managementKerberosKerberos realmkey distributionkey distribution center (KDC)key managementmaster keymutual authenticationnonceone-way authentication"}, {"id": "4c021c944a803a03a81f1c275a3576c849c175a4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 149, "start_line": 1, "end_line": 13, "text": "134 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION Review Questions 4.1 List ways in which secret keys can be distributed to two communicating parties. 4.2 What is the difference between a session key and a master key? 4.3 What is a key distribution center? 4.4 What entities constitute a full-service Kerberos environment? 4.5 In the context of Kerberos, what is a realm? 4.6 What are the principal differences between version 4 and version 5 of Kerberos? 4.7 What is a nonce? 4.8 What are two different uses of public-key cryptography related to key distribution? 4.9 What are the essential ingredients of a public-key directory? 4.10 What is a public-key certificate? 4.11 What are the requirements for the use of a public-key certificate scheme?"}, {"id": "a3e6d699c008b60f479fb648c12d77ff53410ce0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 149, "start_line": 14, "end_line": 18, "text": "4.12 What is the purpose of the X.509 standard? 4.13 What is a chain of certificates? 4.14 How is an X.509 certificate revoked? Problems 4.1 \u201cWe are under great pressure, Holmes.\u201d Detective Lestrade looked nervous. \u201cWe have"}, {"id": "37135552029805a1fafcb2a061f5b07c2f7ed251", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 149, "start_line": 19, "end_line": 20, "text": "learned that copies of sensitive government documents are stored in computers of oneforeign embassy here in London. Normally these documents exist in electronic form onlyon a selected few government computers that satisfy the most stringent security require-ments. However, sometimes they must be sent through the network connecting all gov-ernment computers. But all messages in this network are encrypted using a top secretencryption algorithm certified by our best crypto experts. Even the NSA and the KGBare unable to break it.And now these documents have appeared in hands of diplomats ofa small, otherwise insignificant, country.And we have no idea how it could happen.\u201d \u201cBut you do have some suspicion who did it, do you?\u201d asked Holmes."}, {"id": "4b3b6aa013417f1d2eb5dc3afec2cb27c7d99099", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 149, "start_line": 21, "end_line": 27, "text": "\u201cYes, we did some routine investigation. There is a man who has legal access to one of the government computers and has frequent contacts with diplomats from the embassy. But the computer he has access to is not one of the trusted ones where thesedocuments are normally stored. He is the suspect, but we have no idea how he couldobtain copies of the documents. Even if he could obtain a copy of an encrypted docu-ment, he couldn\u2019t decrypt it.\u201d \u201cHmm, please describe the communication protocol used on the network.\u201d Holmes opened his eyes, thus proving that he had followed Lestrade\u2019s talk with anattention that contrasted with his sleepy look. \u201cWell, the protocol is as follows. Each node N of the network has been assigned a unique secret key K"}, {"id": "93524d173f8f61b654b8903db28aebd7e47b6716", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 149, "start_line": 28, "end_line": 35, "text": "n.This key is used to secure communication between the node and a trusted server.That is, all the keys are stored also on the server. User A, wishingto send a secret message Mto user B, initiates the following protocol: 1.A generates a random number Rand sends to the server his name A, destination B, and E(K a,R).ticket-granting server (TGS) timestampX.509 certificatepropagating cipher block chaining (PCBC) mode public-key certificatepublic-key directoryrealmreplay attackticket"}, {"id": "a492dc4589f8d1c440f84cac03ce85838b3030d5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 150, "start_line": 1, "end_line": 11, "text": "4.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 135 2.Server responds by sending E( Kb,R) to A. 3.A sends E( R,M) together with E( Kb,R) to B. 4.B knows K b, thus decrypts E(K b,R) to get R and will subsequently use R to decrypt E( R,M) to get M. You see that a random key is generated every time a message has to be sent. I admit the man could intercept messages sent between the top secret trusted nodes, but I seeno way he could decrypt them.\u201d \u201cWell, I think you have your man, Lestrade. The protocol isn\u2019t secure because the server doesn\u2019t authenticate users who send him a request. Apparently designersof the protocol have believed that sending E( K x,R) implicitly authenticates user X as the sender, as only X (and the server) knows Kx.But you know that E( Kx,R) can be"}, {"id": "450725880060d4170aa4fe74a5b8cef69a86cbbc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 150, "start_line": 12, "end_line": 23, "text": "intercepted and later replayed. Once you understand where the hole is, you willbe able to obtain enough evidence by monitoring the man\u2019s use of the computer hehas access to. Most likely he works as follows: After intercepting E( K a,R) and E(R, M) (see steps 1 and 3 of the protocol), the man, let\u2019s denote him as Z, will con- tinue by pretending to be A and... Finish the sentence for Holmes. 4.2 There are three typical ways to use nonces as challenges. Suppose Nais a nonce gen- erated by A, A and B share key K, and f() is a function (such as increment). The three usages are Usage 1 Usage 2 Usage 3 (1) A B: Na: (1) A B: E( K,Na) : (1) A B: E( K,Na) : (2) B A: E( K,Na) : (2) B A: Na: (2) B A: E( K,f ( Na)) : Describe situations for which each usage is appropriate."}, {"id": "c92b46fdda9d3829073d7ad074ce2e1f822d3a5e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 150, "start_line": 24, "end_line": 35, "text": "4.3 Show that a random error in one block of ciphertext is propagated to all subsequentblocks of plaintext in PCBC mode (see Figure F.2 in Appendix F). 4.4 Suppose that, in PCBC mode, blocks C iand Ci1are interchanged during transmis- sion. Show that this affects only the decrypted blocks Piand Pi1but not subsequent blocks. 4.5 In addition to providing a standard for public-key certificate formats, X.509 specifiesan authentication protocol. The original version of X.509 contains a security flaw. Theessence of the protocol is AB : A { t A,rA,IDB} BA : B { tB,rB,IDA,rA} AB : A { rB} where tAand tBare timestamps, rAand rBare nonces, and the notation X {Y} indicates that the message Y is transmitted, encrypted, and signed by X."}, {"id": "129605f0af5dd550be21538da2d80967c6cb2ab5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 150, "start_line": 36, "end_line": 42, "text": "The text of X.509 states that checking timestamps t Aand tBis optional for three-way authentication. But consider the following example: Suppose A and B haveused the preceding protocol on some previous occasion, and that opponent C hasintercepted the preceding three messages. In addition, suppose that timestamps arenot used and are all set to 0. Finally, suppose C wishes to impersonate A to B. Cinitially sends the first captured message to B: C B: A {0, r A,IDB} B responds, thinking it is talking to A but is actually talking to C: B:C: B{0, r\u0153 B, ID A, rA}::::++"}, {"id": "76c8db5f16dcdcd3b6d97696ebc41a54fff2b346", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 151, "start_line": 1, "end_line": 16, "text": "136 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION C meanwhile causes A to initiate authentication with C by some means.As a result,A sends C the following: C responds to A using the same nonce provided to C by B.A responds withThis is exactly what C needs to convince B that it is talking to A, so C now repeats the incoming message back out to B. So B will believe it is talking to A, whereas it is actually talking to C. Suggest a simple solution to this problem that does not involve the use of timestamps. 4.6 Consider a one-way authentication technique based on asymmetric encryption: AB : ID A BA : R1 AB : E ( PRa,R1) a.Explain the protocol. b.What type of attack is this protocol susceptible to? 4.7 Consider a one-way authentication technique based on asymmetric encryption: AB : IDA"}, {"id": "71f70714c8887b3834a870b7ee02f6821e0e4daa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 151, "start_line": 17, "end_line": 26, "text": "BA : E ( PU a,R2) AB : R2 a.Explain the protocol. b.What type of attack is this protocol susceptible to? 4.8 In Kerberos, when Bob receives a ticket from Alice, how does he know it is genuine? 4.9 In Kerberos, when Bob receives a ticket from Alice, how does he know it came fromAlice? 4.10 In Kerberos,Alice receives a reply, how does she know it came from Bob (that it\u2019s nota replay of an earlier message from Bob)? 4.11 In Kerberos, what does the ticket contain that allows Alice and Bob to talk securely? 4.12 The 1988 version of X.509 lists properties that RSA keys must satisfy to be secure,given current knowledge about the difficulty of factoring large numbers. The discus-sion concludes with a constraint on the public exponent and the modulus n: It must be ensured that elog"}, {"id": "2d7638fe2c2a6a57a908c0bf923498eaeae72158", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 151, "start_line": 27, "end_line": 34, "text": "2(n) to prevent attack by taking the eth root mod nto disclose the plaintext. Although the constraint is correct, the reason given for requiring it is incorrect. Whatis wrong with the reason given and what is the correct reason? 4.13 Find at least one intermediate certification authority\u2019s certificate and one trusted rootcertification authority\u2019s certificate on your computer (e.g. in the browser). Printscreenshots of both the general and details tab for each certificate. 4.14 NIST defines the term cryptoperiod as the time span during which a specific key isauthorized for use or in which the keys for a given system or application may remainin effect. One document on key management uses the following time diagram for ashared secret key.7::::::C:B: A {r\u0153 B}A:C: A {r\u0153 B}C:A: C {0, r\u0153"}, {"id": "4acbafbdbfadf883b264e81333ad8bb1de567421", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 151, "start_line": 35, "end_line": 37, "text": "B, ID A, r\u0153 A}A:C: A {0, r\u0153 A, ID C}"}, {"id": "a7ed7dac894aefb5f3618a68d8be8ac227d63798", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 152, "start_line": 1, "end_line": 13, "text": "4.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 137 Explain the overlap by giving an example application in which the originator\u2019s usage period for the shared secret key begins before the recipient\u2019s usage period and alsoends before the recipient\u2019s usage period. 4.15 Consider the following protocol, designed to let Aand Bdecide on a fresh, shared session key K' AB. We assume that they already share a long-term key KAB. 1.AB :A, N A 2.BA :E (KAB,[NA,K'AB]) 3.AB :E (K'AB,NA) a.We first try to understand the protocol designer\u2019s reasoning: \u2022Why would A and B believe after the protocol ran that they share K'ABwith the other party? \u2022Why would they believe that this shared key is fresh?"}, {"id": "e1a7a443752bc7275dfc70ed4e803d06b5fbf6d9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 152, "start_line": 14, "end_line": 21, "text": "In both cases, you should explain both the reasons of both A and B, so your answershould complete the following sentences. A believes that she shares K' ABwith B since . . . B believes that he shares K'ABwith A since . . . A believes that K'ABis fresh since . . . B believes that K'ABis fresh since . . . b.Assume now that A starts a run of this protocol with B. However, the connectionis intercepted by the adversary C. Show how C can start a new run of the protocolusing reflection, causing A to believe that she has agreed on a fresh key with B (inspite of the fact that she has only been communicating with C).Thus, in particular,the belief in (a) is false. c.Propose a modification of the protocol that prevents this attack."}, {"id": "01103b2dd49911b69d6bb59ec1ddb948aa702f0b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 152, "start_line": 22, "end_line": 36, "text": "4.16 What are the core components of a PKI? Briefly describe each component. 4.17 Explain the problems with key management and how it affects symmetric cryptography. 4.18 Consider the following protocol: A KDC: ID A7IDB7N1 KDC A: E( Ka,[KS7IDB7N17E(K b,[KS7IDA])) AB : E ( Kb,[KS7IDA]) BA : E ( KS,N2) AB : E ( KS,f (N2)) a.Explain the protocol. b.Can you think of a possible attack on this protocol? Explain how it can be done. c.Mention a possible technique to get around the attack\u2014not a detailed mechanism,just the basics of the idea. Note: The remaining problems deal with a cryptographic product developed by IBM,which is briefly described in a document at this book\u2019s Web site in IBMCrypto.pdf . Try these problems after reviewing the document.::::::::Originator Usage Period"}, {"id": "ae63ac430175fba5c1dc1fdf43cd7952d2919e64", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 152, "start_line": 37, "end_line": 38, "text": "Recipient Usage Period Cryptoperiod"}, {"id": "fb00508e21e825a2f433b03dd3353d3c1ed62ec6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 153, "start_line": 1, "end_line": 8, "text": "138 CHAPTER 4 / KEY DISTRIBUTION AND USER AUTHENTICATION 4.19 What is the effect of adding the instruction EMK i? EMK i:X E(KMH i,X)i0, 1 4.20 Suppose Ndifferent systems use the IBM Cryptographic Subsystem with host master keys KMH[i ] ( i 1 ,2 , ..., N). Devise a method for communicating between sys- tems without requiring the system to either share a common host master key or to divulge their individual host master keys. Hint: Each system needs three variants of its host master key."}, {"id": "11db754510bdff9eee41ae4eaaaa5df6f8814c75", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 153, "start_line": 9, "end_line": 9, "text": "4.21 The principal objective of the IBM Cryptographic Subsystem is to protect transmis-sions between a terminal and the processing system. Devise a procedure, perhapsadding instructions, which will allow the processor to generate a session key KS anddistribute it to Terminal i and Terminal j without having to store a key-equivalentvariable in the host.== :"}, {"id": "a56f60b6f5e71ea528388fd047fa9ae7f360f23a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 154, "start_line": 1, "end_line": 16, "text": "TRANSPORT -LEVELSECURITY 5.1 Web Security Considerations Web Security Threats Web Traffic Security Approaches 5.2 Secure Socket Layer and Transport Layer Security SSL ArchitectureSSL Record ProtocolChange Cipher Spec ProtocolAlert ProtocolHandshake ProtocolCryptographic Computations 5.3 Transport Layer Security Version NumberMessage Authentication CodePseudorandom FunctionAlert CodesCipher SuitesClient Certificate TypesCertificate_Verify and Finished Messages Cryptographic ComputationsPadding 5.4 HTTPS Connection InitiationConnection Closure 5.5 Secure Shell (SSH) Transport Layer ProtocolUser Authentication ProtocolConnection Protocol 5.6 Recommended Reading and Web Sites 5.7 Key Terms, Review Questions, and ProblemsCHAPTER 139"}, {"id": "30a2f0fcf133dfc2e5e3de114f61c84756f4098b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 155, "start_line": 1, "end_line": 12, "text": "140 CHAPTER 5 / TRANSPORT -LEVEL SECURITY Use your mentality Wake up to reality \u2014From the song , \u201cI\u2019ve Got You Under My Skin\u201d by Cole Porter KEY POINTS \u25c6Secure Socket Layer (SSL) provides security services between TCP and applications that use TCP . The Internet standard version is called TransportLayer Service (TLS). \u25c6SSL/TLS provides confidentiality using symmetric encryption and messageintegrity using a message authentication code. \u25c6SSL/TLS includes protocol mechanisms to enable two TCP users to deter-mine the security mechanisms and services they will use. \u25c6HTTPS (HTTP over SSL) refers to the combination of HTTP and SSL toimplement secure communication between a Web browser and a Web server. \u25c6Secure Shell (SSH) provides secure remote logon and other secure client/server facilities."}, {"id": "4d53e4e6f05ff132932763dba79ab5e11b682c35", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 155, "start_line": 13, "end_line": 14, "text": "Virtually all businesses, most government agencies, and many individuals now haveWeb sites. The number of individuals and companies with Internet access is expandingrapidly and all of these have graphical Web browsers.As a result, businesses are enthu-siastic about setting up facilities on the Web for electronic commerce. But the reality isthat the Internet and the Web are extremely vulnerable to compromises of varioussorts. As businesses wake up to this reality, the demand for secure Web services grows. The topic of Web security is a broad one and can easily fill a book. In this"}, {"id": "f9587f7652b2ddd19ce622a12e0ac8d82a2232b7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 155, "start_line": 15, "end_line": 17, "text": "chapter, we begin with a discussion of the general requirements for Web securityand then focus on three standardized schemes that are becoming increasinglyimportant as part of Web commerce and that focus on security at the transportlayer: SSL/TLS, HTTPS, and SSH. 5.1 WEB SECURITY CONSIDERATIONS The World Wide Web is fundamentally a client/server application running over theInternet and TCP/IP intranets. As such, the security tools and approaches discussedso far in this book are relevant to the issue of Web security. But, as pointed out in[GARF02], the Web presents new challenges not generally appreciated in the con-text of computer and network security."}, {"id": "f0ecab362f27e7b574c65a277c774aa4bc010f97", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 155, "start_line": 18, "end_line": 18, "text": "\u2022The Internet is two-way. Unlike traditional publishing environments\u2014evenelectronic publishing systems involving teletext, voice response, or fax-back\u2014the Web is vulnerable to attacks on the Web servers over the Internet."}, {"id": "7ed462eec474fdb804e3ff7031e2f94a7798572f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 156, "start_line": 1, "end_line": 4, "text": "5.1 / WEB SECURITY CONSIDERATIONS 141 \u2022The Web is increasingly serving as a highly visible outlet for corporate and product information and as the platform for business transactions. Reputationscan be damaged and money can be lost if the Web servers are subverted. \u2022Although Web browsers are very easy to use, Web servers are relatively easyto configure and manage, and Web content is increasingly easy to develop, theunderlying software is extraordinarily complex. This complex software mayhide many potential security flaws. The short history of the Web is filled withexamples of new and upgraded systems, properly installed, that are vulnerableto a variety of security attacks."}, {"id": "a9caffbf8f87b8e0f52af71779e92b2c636afa8e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 156, "start_line": 5, "end_line": 7, "text": "\u2022A Web server can be exploited as a launching pad into the corporation\u2019s oragency\u2019s entire computer complex. Once the Web server is subverted, anattacker may be able to gain access to data and systems not part of the Webitself but connected to the server at the local site. \u2022Casual and untrained (in security matters) users are common clients forWeb-based services. Such users are not necessarily aware of the securityrisks that exist and do not have the tools or knowledge to take effectivecountermeasures. Web Security Threats"}, {"id": "be87c0b206fae339e721cae9b3c9b9564c116603", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 156, "start_line": 8, "end_line": 9, "text": "Table 5.1 provides a summary of the types of security threats faced when using theWeb. One way to group these threats is in terms of passive and active attacks.Passive attacks include eavesdropping on network traffic between browser andserver and gaining access to information on a Web site that is supposed to berestricted. Active attacks include impersonating another user, altering messages intransit between client and server, and altering information on a Web site. Another way to classify Web security threats is in terms of the location of the"}, {"id": "eede76999ba2b50f595eae4baebb13f93640af95", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 156, "start_line": 10, "end_line": 12, "text": "threat: Web server, Web browser, and network traffic between browser and server.Issues of server and browser security fall into the category of computer system secu-rity; Part Four of this book addresses the issue of system security in general but isalso applicable to Web system security. Issues of traffic security fall into the categoryof network security and are addressed in this chapter. Web Traffic Security Approaches A number of approaches to providing Web security are possible. The variousapproaches that have been considered are similar in the services they provide and,to some extent, in the mechanisms that they use, but they differ with respect to theirscope of applicability and their relative location within the TCP/IP protocol stack."}, {"id": "ccc119dd0f4ecad99eb7cdd1707348b68303d089", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 156, "start_line": 13, "end_line": 16, "text": "Figure 5.1 illustrates this difference. One way to provide Web security is to use IP security (IPsec) (Figure 5.1a). The advantage of using IPsec is that it is transpar-ent to end users and applications and provides a general-purpose solution.Furthermore, IPsec includes a filtering capability so that only selected traffic needincur the overhead of IPsec processing. Another relatively general-purpose solution is to implement security just above TCP (Figure 5.1b). The foremost example of this approach is the Secure"}, {"id": "83e4cc9f0e37ec32531832a0935bcf5c03e4072a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 157, "start_line": 1, "end_line": 14, "text": "142 CHAPTER 5 / TRANSPORT -LEVEL SECURITY SMTP HTTP TCP IP/IPSec (a) Network levelFTPSMTP HTTP TCPSSL or TLS IP (b) Transport levelFTP IPS/MIME HTTP Kerberos UDPSMTP (c) Application levelTCP Figure 5.1 Relative Location of Security Facilities in the TCP/IP Protocol StackSockets Layer (SSL) and the follow-on Internet standard known as Transport Layer Security (TLS).At this level, there are two implementation choices. For full general-ity, SSL (or TLS) could be provided as part of the underlying protocol suite andtherefore be transparent to applications. Alternatively, SSL can be embedded inspecific packages. For example, Netscape and Microsoft Explorer browsers comeequipped with SSL, and most Web servers have implemented the protocol."}, {"id": "7bd462a7930e53fcc93c83044e6b92c0f5820ec7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 157, "start_line": 15, "end_line": 27, "text": "Application-specific security services are embedded within the particular appli- cation. Figure 5.1c shows examples of this architecture. The advantage of thisapproach is that the service can be tailored to the specific needs of a given application.Table 5.1 A Comparison of Threats on the Web Threats Consequences Countermeasures Integrity \u2022 Modification of user data \u2022 Trojan horse browser\u2022 Modification of memory\u2022 Modification of message traffic in transit\u2022 Loss of information\u2022 Compromise of machine\u2022 Vulnerabilty to all other threatsCryptographic checksums Confidentiality \u2022 Eavesdropping on the net\u2022 Theft of info from server\u2022 Theft of data from client\u2022 Info about network configuration \u2022 Info about which client talks to server\u2022 Loss of information\u2022 Loss of privacyEncryption, Web proxies"}, {"id": "2f5eac616a286d954e96bb24223488ac58d61834", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 157, "start_line": 28, "end_line": 39, "text": "Denial of Service\u2022 Killing of user threads \u2022 Flooding machine with bogus requests \u2022 Filling up disk or memory\u2022 Isolating machine by DNS attacks\u2022 Disruptive\u2022 Annoying\u2022 Prevent user from getting work doneDifficult to prevent Authentication \u2022 Impersonation of legitimate users \u2022 Data forgery\u2022 Misrepresentation of user\u2022 Belief that false information is validCryptographic techniques"}, {"id": "2311f36d8f37fcb0336b53302ab19bcc1e3aa7dd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 158, "start_line": 1, "end_line": 12, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 143 IPTCPSSL Record ProtocolSSL Handshake ProtocolSSL Change Cipher Spec ProtocolSSL Alert ProtocolHTTP Figure 5.2 SSL Protocol Stack5.2 SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY Netscape originated SSL. Version 3 of the protocol was designed with public review and input from industry and was published as an Internet draft document.Subsequently, when a consensus was reached to submit the protocol for Internetstandardization, the TLS working group was formed within IETF to develop a com-mon standard. This first published version of TLS can be viewed as essentially anSSLv3.1 and is very close to and backward compatible with SSLv3. This section is devoted to a discussion of SSLv3. In the next section, the principal"}, {"id": "083af06d884d3c45a34b9f368025ab7f9d7c03e8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 158, "start_line": 13, "end_line": 17, "text": "differences between SSLv3 and TLS are described. SSL Architecture SSL is designed to make use of TCP to provide a reliable end-to-end secure service.SSL is not a single protocol but rather two layers of protocols, as illustrated inFigure 5.2. The SSL Record Protocol provides basic security services to various higher- layer protocols. In particular, the Hypertext Transfer Protocol (HTTP), which pro-vides the transfer service for Web client/server interaction, can operate on top ofSSL. Three higher-layer protocols are defined as part of SSL: the HandshakeProtocol, The Change Cipher Spec Protocol, and the Alert Protocol. These SSL-specific protocols are used in the management of SSL exchanges and are examinedlater in this section."}, {"id": "9698adb350645575618882f475edfff5cac6a38c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 158, "start_line": 18, "end_line": 23, "text": "Two important SSL concepts are the SSL session and the SSL connection, which are defined in the specification as follows. \u2022Connection: A connection is a transport (in the OSI layering model defini- tion) that provides a suitable type of service. For SSL, such connections arepeer-to-peer relationships. The connections are transient. Every connection isassociated with one session. \u2022Session: An SSL session is an association between a client and a server. Sessions are created by the Handshake Protocol. Sessions define a set of cryptographic"}, {"id": "8758d6627d87f104e50600230707453903ea9de2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 159, "start_line": 1, "end_line": 7, "text": "144 CHAPTER 5 / TRANSPORT -LEVEL SECURITY security parameters which can be shared among multiple connections. Sessions are used to avoid the expensive negotiation of new security parameters foreach connection. Between any pair of parties (applications such as HTTP on client and server), there may be multiple secure connections. In theory, there may also be multiple simultaneous sessions between parties, but this feature is not used in practice. There are a number of states associated with each session. Once a session is"}, {"id": "2b2b31c5354461814e4970bc262867d300a2d906", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 159, "start_line": 8, "end_line": 15, "text": "established, there is a current operating state for both read and write (i.e., receiveand send). In addition, during the Handshake Protocol, pending read and writestates are created. Upon successful conclusion of the Handshake Protocol, thepending states become the current states. A session state is defined by the following parameters. \u2022Session identifier: An arbitrary byte sequence chosen by the server to identify an active or resumable session state. \u2022Peer certificate: An X509.v3 certificate of the peer. This element of the state may be null. \u2022Compression method: The algorithm used to compress data prior to encryption. \u2022Cipher spec: Specifies the bulk data encryption algorithm (such as null, AES,"}, {"id": "208e45c90a5f0c7305ad926dfbdcdf12ce8b3ba5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 159, "start_line": 16, "end_line": 28, "text": "etc.) and a hash algorithm (such as MD5 or SHA-1) used for MAC calculation.It also defines cryptographic attributes such as the hash_size. \u2022Master secret: 48-byte secret shared between the client and server. \u2022Is resumable: A flag indicating whether the session can be used to initiate new connections. A connection state is defined by the following parameters. \u2022Server and client random: Byte sequences that are chosen by the server and client for each connection. \u2022Server write MAC secret: The secret key used in MAC operations on data sent by the server. \u2022Client write MAC secret: The secret key used in MAC operations on data sent by the client. \u2022Server write key: The secret encryption key for data encrypted by the server and decrypted by the client."}, {"id": "ac864e91ac9fcbc8a43d05ca72bcd509f1b9eaa8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 159, "start_line": 29, "end_line": 36, "text": "\u2022Client write key: The symmetric encryption key for data encrypted by the client and decrypted by the server. \u2022Initialization vectors: When a block cipher in CBC mode is used, an initializa- tion vector (IV) is maintained for each key. This field is first initialized by the SSL Handshake Protocol. Thereafter, the final ciphertext block from eachrecord is preserved for use as the IV with the following record. \u2022Sequence numbers: Each party maintains separate sequence numbers for transmitted and received messages for each connection.When a party sends orreceives a change cipher spec message, the appropriate sequence number is setto zero. Sequence numbers may not exceed 2 64 \u2013 1."}, {"id": "19e2c0a276a9ddde78597ed7a6950b6c9f08efd7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 160, "start_line": 1, "end_line": 9, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 145 SSL Record Protocol The SSL Record Protocol provides two services for SSL connections: \u2022Confidentiality: The Handshake Protocol defines a shared secret key that is used for conventional encryption of SSL payloads. \u2022Message Integrity: The Handshake Protocol also defines a shared secret key that is used to form a message authentication code (MAC). Figure 5.3 indicates the overall operation of the SSL Record Protocol. The Record Protocol takes an application message to be transmitted, fragments the data"}, {"id": "5f860edbf968792c870972bca3e1450e432408fb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 160, "start_line": 10, "end_line": 17, "text": "into manageable blocks, optionally compresses the data, applies a MAC, encrypts,adds a header, and transmits the resulting unit in a TCP segment. Received data aredecrypted, verified, decompressed, and reassembled before being delivered tohigher-level users. The first step is fragmentation. Each upper-layer message is fragmented into blocks of 2 14bytes (16384 bytes) or less. Next, compression is optionally applied. Compression must be lossless and may not increase the contentlength by more than 1024 bytes. 1In SSLv3 (as well as the current version of TLS), no compression algorithm is specified, so the default compression algorithmis null. The next step in processing is to compute a message authentication code over"}, {"id": "3cf8cfcbd3f70f980fab79bec3522a490941fecf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 160, "start_line": 18, "end_line": 25, "text": "the compressed data. For this purpose, a shared secret key is used. The calculation isdefined as 1Of course, one hopes that compression shrinks rather than expands the data. However, for very short blocks, it is possible, because of formatting conventions, that the compression algorithm will actually provide output that is longer than the input.Application data FragmentCompressAdd MACEncrypt Append SSL record header Figure 5.3 SSL Record Protocol Operation"}, {"id": "b05fb31dfd11d0b0a296f15fabd882315864bc13", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 161, "start_line": 1, "end_line": 26, "text": "146 CHAPTER 5 / TRANSPORT -LEVEL SECURITY Block Cipher Stream Cipher Algorithm Key Size Algorithm Key Size AES 128, 256 RC4-40 40 IDEA 128 RC4-128 128 RC2-40 40 DES-40 40 DES 56 3DES 168 Fortezza 80hash(MAC_write_secret | | pad_2| | hash(MAC_write_secret | | pad_1| |seq_num | | SSLCompressed.type | | SSLCompressed.length | | SSLCompressed.fragment)) where | | = concatenation MAC_write_secret = shared secret key hash = cryptographic hash algorithm; either MD5 or SHA-1 pad_1 = the byte 0x36 (0011 0110) repeated 48 times (384 bits) for MD5 and 40 times (320 bits) for SHA-1 pad_2 = the byte 0x5C (0101 1100) repeated 48 times for MD5 and 40 times for SHA-1 seq_num = the sequence number for this message SSLCompressed.type = the higher-level protocol used to process this fragment"}, {"id": "38026f1e5f8d64824f90631ee0c7b06bc5872b8a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 161, "start_line": 27, "end_line": 35, "text": "SSLCompressed.length = the length of the compressed fragment SSLCompressed.fragment = the compressed fragment (if compression is not used, this is the plaintext fragment) Note that this is very similar to the HMAC algorithm defined in Chapter 3. The difference is that the two pads are concatenated in SSLv3 and are XORed in HMAC.The SSLv3 MAC algorithm is based on the original Internet draft for HMAC, whichused concatenation.The final version of HMAC (defined in RFC 2104) uses the XOR. Next, the compressed message plus the MAC are encrypted using symmetric encryption. Encryption may not increase the content length by more than 1024bytes, so that the total length may not exceed 2 14+ 2048. The following encryption algorithms are permitted:"}, {"id": "30511276ad345d45ffa368c98e40ddd58b6148d1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 161, "start_line": 36, "end_line": 41, "text": "Fortezza can be used in a smart card encryption scheme. For stream encryption, the compressed message plus the MAC are encrypted. Note that the MAC is computed before encryption takes place and that the MAC is then encrypted along with the plaintext or compressed plaintext. For block encryption, padding may be added after the MAC prior to encryp- tion.The padding is in the form of a number of padding bytes followed by a one-byte"}, {"id": "4d290b088c89232c3d54401f99c8e2baee42ef41", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 162, "start_line": 1, "end_line": 7, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 147 indication of the length of the padding. The total amount of padding is the smallest amount such that the total size of the data to be encrypted (plaintext plus MAC pluspadding) is a multiple of the cipher\u2019s block length. An example is a plaintext (orcompressed text if compression is used) of 58 bytes, with a MAC of 20 bytes (usingSHA-1), that is encrypted using a block length of 8 bytes (e.g., DES). With thepadding-length byte, this yields a total of 79 bytes. To make the total an integermultiple of 8, one byte of padding is added. The final step of SSL Record Protocol processing is to prepare a header consisting of the following fields: \u2022Content Type (8 bits): The higher-layer protocol used to process the enclosed fragment."}, {"id": "c15063fc7286f2212f4ef88a71e47daec07cb544", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 162, "start_line": 8, "end_line": 18, "text": "\u2022Major Version (8 bits): Indicates major version of SSL in use. For SSLv3, the value is 3. \u2022Minor Version (8 bits): Indicates minor version in use. For SSLv3, the value is 0. \u2022Compressed Length (16 bits): The length in bytes of the plaintext fragment (or compressed fragment if compression is used). The maximum value is . The content types that have been defined are change_cipher_spec ,alert, handshake, and application_data . The first three are the SSL-specific proto- cols, discussed next. Note that no distinction is made among the various applications (e.g., HTTP) that might use SSL; the content of the data created by such applicationsis opaque to SSL. Figure 5.4 illustrates the SSL record format. Change Cipher Spec Protocol"}, {"id": "576dbfa41d2b6124cc0223499f3f06b4af48c37f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 162, "start_line": 19, "end_line": 30, "text": "The Change Cipher Spec Protocol is one of the three SSL-specific protocols that usethe SSL Record Protocol, and it is the simplest. This protocol consists of a singlemessage (Figure 5.5a), which consists of a single byte with the value 1. The sole pur-pose of this message is to cause the pending state to be copied into the current state,which updates the cipher suite to be used on this connection.2 14+2048 Content typeMajor versionMinor versionCompressed length Plaintext (optionally compressed) MAC (0, 16, or 20 bytes)Encrypted Figure 5.4 SSL Record Format"}, {"id": "47775651fe001717cd683d2cb558c008b7551db1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 163, "start_line": 1, "end_line": 16, "text": "148 CHAPTER 5 / TRANSPORT -LEVEL SECURITY 1 (a) Change Cipher Spec Protocol1 byte Type (c) Handshake Protocol1 byte Length3 bytes Content /H11350 0 bytes (d) Other Upper-Layer Protocol (e.g., HTTP)Opaque content/H11350 1 byte Level (b) Alert Protocol1 byte 1 byte Alert Figure 5.5 SSL Record Protocl Payload Alert Protocol The Alert Protocol is used to convey SSL-related alerts to the peer entity. As with other applications that use SSL, alert messages are compressed and encrypted, asspecified by the current state. Each message in this protocol consists of two bytes (Figure 5.5b).The first byte"}, {"id": "ec0a83748e61a332f6de610d7d5fbb05a47d1fff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 163, "start_line": 17, "end_line": 22, "text": "takes the value warning (1) or fatal (2) to convey the severity of the message. If thelevel is fatal, SSL immediately terminates the connection. Other connections on thesame session may continue, but no new connections on this session may be estab-lished. The second byte contains a code that indicates the specific alert. First, we listthose alerts that are always fatal (definitions from the SSL specification): \u2022unexpected_message: An inappropriate message was received. \u2022bad_record_mac: An incorrect MAC was received. \u2022decompression_failure: The decompression function received improper input (e.g., unable to decompress or decompress to greater than maximumallowable length). \u2022handshake_failure: Sender was unable to negotiate an acceptable set of"}, {"id": "515fc6b4d3039272334fad95c844d45b0161b63d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 163, "start_line": 23, "end_line": 36, "text": "security parameters given the options available. \u2022illegal_parameter: A field in a handshake message was out of range or inconsistent with other fields. The remaining alerts are the following. \u2022close_notify: Notifies the recipient that the sender will not send any more messages on this connection. Each party is required to send a close_notify alert before closing the write side of a connection. \u2022no_certificate: May be sent in response to a certificate request if no appropriate certificate is available. \u2022bad_certificate: A received certificate was corrupt (e.g., contained a signature that did not verify). \u2022unsupported_certificate: The type of the received certificate is not supported. \u2022certificate_revoked: A certificate has been revoked by its signer."}, {"id": "f186aafc3e8e0a5bbf0fa40bfb649282515547fa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 163, "start_line": 37, "end_line": 37, "text": "\u2022certificate_expired: A certificate has expired."}, {"id": "6aad0f41c2a1ce2d4d6b3be3d3f0b824dd2f0853", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 164, "start_line": 1, "end_line": 10, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 149 \u2022certificate_unknown: Some other unspecified issue arose in processing the certificate, rendering it unacceptable. Handshake Protocol The most complex part of SSL is the Handshake Protocol. This protocol allows the server and client to authenticate each other and to negotiate an encryption andMAC algorithm and cryptographic keys to be used to protect data sent in an SSLrecord. The Handshake Protocol is used before any application data is transmitted. The Handshake Protocol consists of a series of messages exchanged by client and server. All of these have the format shown in Figure 5.5c. Each message hasthree fields: \u2022Type (1 byte): Indicates one of 10 messages. Table 5.2 lists the defined message types."}, {"id": "c169f74198f1e24115cb0d0ed0d32ec599dd8e94", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 164, "start_line": 11, "end_line": 21, "text": "\u2022Length (3 bytes): The length of the message in bytes. \u2022Content ( bytes): The parameters associated with this message; these are listed in Table 5.2. Figure 5.6 shows the initial exchange needed to establish a logical connection between client and server. The exchange can be viewed as having four phases.P HASE 1. E STABLISH SECURITY CAPABILITIES This phase is used to initiate a logical connection and to establish the security capabilities that will be associated with it. The exchange is initiated by the client, which sends a client_hello message with the following parameters: \u2022Version: The highest SSL version understood by the client. \u2022Random: A client-generated random structure consisting of a 32-bit timestamp"}, {"id": "27976dc87a661fa4bb80ccd7307a7ece3ba1ad0a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 164, "start_line": 22, "end_line": 34, "text": "and 28 bytes generated by a secure random number generator. These valuesserve as nonces and are used during key exchange to prevent replay attacks.\u00da0 Table 5.2 SSL Handshake Protocol Message Types Message Type Parameters hello_request null client_hello version, random, session id, cipher suite, compression method server_hello version, random, session id, cipher suite, compression method certificate chain of X.509v3 certificates server_key_exchange parameters, signature certificate_request type, authorities server_done null certificate_verify signature client_key_exchange parameters, signature finished hash value"}, {"id": "a606a60baae41c175b2ef06adf02c8db2938cf37", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 165, "start_line": 1, "end_line": 10, "text": "150 CHAPTER 5 / TRANSPORT -LEVEL SECURITY \u2022Session ID: A variable-length session identifier. A nonzero value indicates that the client wishes to update the parameters of an existing connection or to create a new connection on this session. A zero value indicates that the clientwishes to establish a new connection on a new session. \u2022CipherSuite: This is a list that contains the combinations of cryptographic algorithms supported by the client, in decreasing order of preference. Eachelement of the list (each cipher suite) defines both a key exchange algorithmand a CipherSpec; these are discussed subsequently.Client Server Phase 1 Establish security capabilities, includingprotocol version, session ID, cipher suite, compression method, and initial random numbers."}, {"id": "ee54f1b8c3b57d774ad5252d9c057fa4245239bd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 165, "start_line": 11, "end_line": 19, "text": "Phase 2Server may send certificate, key exchange,and request certificate. Server signals end of hello message phase. Phase 3Client sends certificate if requested. Client sends key exchange. Client may sendcertificate verification. Phase 4Change cipher suite and finish handshake protocol. Note: Shaded transfers areoptional or situation-dependent messages that are not always sent.finishedchange_cipher_specfinishedchange_cipher_speccertificate_verifyclient_key_exchangecertificateserver_hello_donecertificate_requestserver_key_exchangecertificateserver_helloclient_helloTime Figure 5.6 Handshake Protocol Action"}, {"id": "eabb298712fc719ec2cbbb3305ca91aa4808df1e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 166, "start_line": 1, "end_line": 7, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 151 \u2022Compression Method: This is a list of the compression methods the client supports. After sending the client_hello message, the client waits for the server_hello message , which contains the same parameters as the client_hello message. For the server_hello message, the following conven- tions apply. The Version field contains the lower of the versions suggested by the"}, {"id": "daf5df5509089d8d4bf4aecee6fa6ae03afdee09", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 166, "start_line": 8, "end_line": 10, "text": "client and the highest supported by the server. The Random field is generated bythe server and is independent of the client\u2019s Random field. If the SessionID field ofthe client was nonzero, the same value is used by the server; otherwise the server\u2019sSessionID field contains the value for a new session. The CipherSuite field containsthe single cipher suite selected by the server from those proposed by the client. TheCompression field contains the compression method selected by the server fromthose proposed by the client. The first element of the CipherSuite parameter is the key exchange method (i.e., the means by which the cryptographic keys for conventional encryption andMAC are exchanged). The following key exchange methods are supported."}, {"id": "0f553ef1c3f3727b84835d38d7c4a69cc51809f8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 166, "start_line": 11, "end_line": 15, "text": "\u2022RSA: The secret key is encrypted with the receiver\u2019s RSA public key.A public- key certificate for the receiver\u2019s key must be made available. \u2022Fixed Diffie-Hellman: This is a Diffie-Hellman key exchange in which the server\u2019s certificate contains the Diffie-Hellman public parameters signed bythe certificate authority (CA). That is, the public-key certificate contains theDiffie-Hellman public-key parameters. The client provides its Diffie-Hellmanpublic-key parameters either in a certificate, if client authentication isrequired, or in a key exchange message. This method results in a fixed secretkey between two peers based on the Diffie-Hellman calculation using thefixed public keys. \u2022Ephemeral Diffie-Hellman: This technique is used to create ephemeral"}, {"id": "4b1aef878eabd8f3e276f06ff0dcdc566b0c46ba", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 166, "start_line": 16, "end_line": 19, "text": "(temporary, one-time) secret keys. In this case, the Diffie-Hellman publickeys are exchanged, signed using the sender\u2019s private RSA or DSS key.The receiver can use the corresponding public key to verify the signature.Certificates are used to authenticate the public keys. This would appear tobe the most secure of the three Diffie-Hellman options, because it results in atemporary, authenticated key. \u2022Anonymous Diffie-Hellman: The base Diffie-Hellman algorithm is used with no authentication.That is, each side sends its public Diffie-Hellman parametersto the other with no authentication. This approach is vulnerable to man-in-the-middle attacks, in which the attacker conducts anonymous Diffie-Hellman withboth parties. \u2022Fortezza: The technique defined for the Fortezza scheme."}, {"id": "4a66ee9f400a473df5d58503e3527bd27eea079d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 166, "start_line": 20, "end_line": 23, "text": "Following the definition of a key exchange method is the CipherSpec, which includes the following fields. \u2022CipherAlgorithm: Any of the algorithms mentioned earlier: RC4, RC2, DES, 3DES, DES40, IDEA, or Fortezza"}, {"id": "8e6dbc994ebeb1b1e20ca1a6e08db11bcf911284", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 167, "start_line": 1, "end_line": 12, "text": "152 CHAPTER 5 / TRANSPORT -LEVEL SECURITY \u2022MACAlgorithm: MD5 or SHA-1 \u2022CipherType: Stream or Block \u2022IsExportable: True or False \u2022HashSize: 0, 16 (for MD5), or 20 (for SHA-1) bytes \u2022Key Material: A sequence of bytes that contain data used in generating the write keys \u2022IV Size: The size of the Initialization Value for Cipher Block Chaining (CBC) encryption PHASE 2. SERVER AUTHENTICATION AND KEYEXCHANGE The server begins this phase by sending its certificate if it needs to be authenticated; the message contains one or a chain of X.509 certificates. The certificate message is required for any agreed-on"}, {"id": "a98238cca9f4acea773765624530224527af826d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 167, "start_line": 13, "end_line": 18, "text": "key exchange method except anonymous Diffie-Hellman. Note that if fixed Diffie-Hellman is used, this certificate message functions as the server\u2019s key exchangemessage because it contains the server\u2019s public Diffie-Hellman parameters. Next, a server_key_exchange message may be sent if it is required. It is not required in two instances: (1) The server has sent a certificate with fixedDiffie-Hellman parameters or (2) a RSA key exchange is to be used. Theserver_key_exchange message is needed for the following: \u2022Anonymous Diffie-Hellman: The message content consists of the two global Diffie-Hellman values (a prime number and a primitive root of that number)plus the server\u2019s public Diffie-Hellman key (see Figure 3.12). \u2022Ephemeral Diffie-Hellman: The message content includes the three Diffie-"}, {"id": "82125ba33edcc80b0742cffd592a2ef1267c7f1f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 167, "start_line": 19, "end_line": 26, "text": "Hellman parameters provided for anonymous Diffie-Hellman plus a signatureof those parameters. \u2022RSA key exchange (in which the server is using RSA but has a signature-onlyRSA key): Accordingly, the client cannot simply send a secret key encrypted with the server\u2019s public key. Instead, the server must create a temporary RSApublic/private key pair and use the server_key_exchange message to send the public key. The message content includes the two parameters of thetemporary RSA public key (exponent and modulus; see Figure 3.10) plus asignature of those parameters. \u2022Fortezza Some further details about the signatures are warranted. As usual, a signature is created by taking the hash of a message and encrypting it with the sender\u2019s private key. In this case, the hash is defined as"}, {"id": "5c49680a52e4c1cfa526d5ac74662576e62824a7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 167, "start_line": 27, "end_line": 29, "text": "hash(ClientHello.random | | ServerHello.random | | ServerParams) So the hash covers not only the Diffie-Hellman or RSA parameters but also the twononces from the initial hello messages. This ensures against replay attacks andmisrepresentation. In the case of a DSS signature, the hash is performed using the"}, {"id": "5f9a5a5a1c5c399c792c5698a26a78c360b412a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 168, "start_line": 1, "end_line": 11, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 153 SHA-1 algorithm. In the case of an RSA signature, both an MD5 and an SHA-1 hash are calculated, and the concatenation of the two hashes (36 bytes) is encryptedwith the server\u2019s private key. Next, a nonanonymous server (server not using anonymous Diffie-Hellman) can request a certificate from the client. The certificate_request message includes two parameters: certificate_type and certificate_authorities . The certificate type indicates the public-key algorithm and its use: \u2022RSA, signature only \u2022DSS, signature only \u2022RSA for fixed Diffie-Hellman; in this case the signature is used only forauthentication, by sending a certificate signed with RSA \u2022DSS for fixed Diffie-Hellman; again, used only for authentication"}, {"id": "610fe0a3f9f25db1204c4535157447f7e0cc99da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 168, "start_line": 12, "end_line": 23, "text": "\u2022RSA for ephemeral Diffie-Hellman \u2022DSS for ephemeral Diffie-Hellman \u2022Fortezza The second parameter in the certificate_request message is a list of the distinguished names of acceptable certificate authorities. The final message in phase 2, and one that is always required, is the server_done message, which is sent by the server to indicate the end of the server hello and associated messages. After sending this message, the server willwait for a client response. This message has no parameters. P HASE 3. C LIENT AUTHENTICATION AND KEYEXCHANGE Upon receipt of the server_done message, the client should verify that the server provided a valid certificate (if required) and check that the server_hello parameters are acceptable."}, {"id": "fc9f396bcc77a1ec93c783cfcde930636cc4caa9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 168, "start_line": 24, "end_line": 35, "text": "If all is satisfactory, the client sends one or more messages back to the server. If the server has requested a certificate, the client begins this phase by sending a certificate message . If no suitable certificate is available, the client sends a no_certificate alert instead. Next is the client_key_exchange message, which must be sent in this phase. The content of the message depends on the type of key exchange, as follows. \u2022RSA: The client generates a 48-byte pre-master secret and encrypts with the public key from the server\u2019s certificate or temporary RSA key from a server_key_exchange message. Its use to compute a master secret is explained later. \u2022Ephemeral or Anonymous Diffie-Hellman: The client\u2019s public Diffie-Hellman parameters are sent."}, {"id": "277537df1467f97d774002dcf8b6d8cbd77c4c8a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 168, "start_line": 36, "end_line": 40, "text": "\u2022Fixed Diffie-Hellman: The client\u2019s public Diffie-Hellman parameters were sent in a certificate message, so the content of this message is null. \u2022Fortezza: The client\u2019s Fortezza parameters are sent. Finally, in this phase, the client may send a certificate_verify message to provide explicit verification of a client certificate. This message is only sent fol-lowing any client certificate that has signing capability (i.e., all certificates except"}, {"id": "856a7604dbbef9963109b6ec42c8aac623b460a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 169, "start_line": 1, "end_line": 13, "text": "154 CHAPTER 5 / TRANSPORT -LEVEL SECURITY those containing fixed Diffie-Hellman parameters). This message signs a hash code based on the preceding messages, defined as CertificateVerify.signature.md5_hash= MD5(master_secret | | pad_2 | | MD5(handshake_messages | | master_secret | | pad_1) ) ; CertificateVerify.signature.sha_hash= SHA(master_secret | | pad_2 | | SHA(handshake_messages | | master_secret | | pad_1) ) ; where pad_1 and pad_2 are the values defined earlier for the MAC, handshake_messages refers to all Handshake Protocol messages sent or received starting at client_hello but not including this message, and master_secret is the calculated secret whose construction is explained later in"}, {"id": "caedb42ae1c13b4c295d4a67b87f446e4537dee0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 169, "start_line": 14, "end_line": 18, "text": "this section. If the user\u2019s private key is DSS, then it is used to encrypt the SHA-1hash. If the user\u2019s private key is RSA, it is used to encrypt the concatenation of theMD5 and SHA-1 hashes. In either case, the purpose is to verify the client\u2019s owner-ship of the private key for the client certificate. Even if someone is misusing theclient\u2019s certificate, he or she would be unable to send this message. P HASE 4. F INISH This phase completes the setting up of a secure connection. The client sends a change_cipher_spec message and copies the pending CipherSpec into the current CipherSpec. Note that this message is not considered part of the"}, {"id": "19c593a43318968373e493e8e0b4e9c9782e8441", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 169, "start_line": 19, "end_line": 28, "text": "Handshake Protocol but is sent using the Change Cipher Spec Protocol. The clientthen immediately sends the finished message under the new algorithms, keys, and secrets. The finished message verifies that the key exchange and authenticationprocesses were successful.The content of the finished message is the concatenation oftwo hash values: MD5(master_secret | | pad2 | | MD5(handshake_messages | | Sender | | master_secret | | pad1) ) SHA(master_secret | | pad2 | | SHA(handshake_messages | | Sender | | master_secret | | pad1) ) where Sender is a code that identifies that the sender is the client and handshake_messages is all of the data from all handshake messages up to but not including this message. In response to these two messages, the server sends its own"}, {"id": "5bc8d552f3c187176c95626574aa03a51e53587a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 169, "start_line": 29, "end_line": 32, "text": "change_cipher_spec message, transfers the pending to the current CipherSpec, and sends its finished message. At this point, the handshake is complete and theclient and server may begin to exchange application-layer data. Cryptographic Computations Two further items are of interest: (1) the creation of a shared master secret by meansof the key exchange and (2) the generation of cryptographic parameters from themaster secret."}, {"id": "d081e9a602521e2ed8f37dc30a5058be0611fcae", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 170, "start_line": 1, "end_line": 9, "text": "5.2 / SECURE SOCKET LAYER AND TRANSPORT LAYER SECURITY 155 MASTER SECRET CREATION The shared master secret is a one-time 48-byte value (384 bits) generated for this session by means of secure key exchange. The creation is in two stages. First, a pre_master_secret is exchanged. Second, the master_secret is calculated by both parties. For pre_master_secret exchange, there are two possibilities. \u2022RSA: A 48-byte pre_master_secret is generated by the client, encrypted with the server\u2019s public RSA key, and sent to the server. The server decryptsthe ciphertext using its private key to recover the pre_master_secret. \u2022Diffie-Hellman: Both client and server generate a Diffie-Hellman public key."}, {"id": "8e2412ba3e5265128957a8401d1c50a342136779", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 170, "start_line": 10, "end_line": 23, "text": "After these are exchanged, each side performs the Diffie-Hellman calculationto create the shared pre_master_secret . Both sides now compute the master_secret as master_secret = MD5(pre_master_secret | | SHA('A' | | pre_master_secret | | ClientHello.random | |ServerHello.random) )|| MD5(pre_master_secret | | SHA('BB' | | pre_master_secret | | ClientHello.random | |ServerHello.random) ) || MD5(pre_master_secret | | SHA('CCC' | | pre_master_secret | | ClientHello.random | | ServerHello.random) ) where ClientHello.random and ServerHello.random are the two nonce values exchanged in the initial hello messages. G ENERATION OF CRYPTOGRAPHIC PARAMETERS CipherSpecs require a client write MAC secret, a server write MAC secret, a client write key, a server write key, a client"}, {"id": "44cb41b0b1c8eb9932704d6e706051586b8ef3f2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 170, "start_line": 24, "end_line": 33, "text": "write IV , and a server write IV , which are generated from the master secret in thatorder.These parameters are generated from the master secret by hashing the mastersecret into a sequence of secure bytes of sufficient length for all needed parameters. The generation of the key material from the master secret uses the same format for generation of the master secret from the pre-master secret as key_block = MD5(master_secret | | SHA('A' | | master_secret | | ServerHello.random | | ClientHello.random) )|| MD5(master_secret | | SHA('BB' | | master_secret | | ServerHello.random | | ClientHello.random) )|| MD5(master_secret | | SHA('CCC' | | master_secret | | ServerHello.random | | ClientHello.random) )||... until enough output has been generated. The result of this algorithmic structure is a"}, {"id": "86787048e4b7ac150291a4458be4657a0082d04b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 170, "start_line": 34, "end_line": 35, "text": "pseudorandom function. We can view the master_secret as the pseudorandom seed value to the function. The client and server random numbers can be viewed assalt values to complicate cryptanalysis (see Chapter 9 for a discussion of the use of saltvalues)."}, {"id": "60b2d59e4a218fa47b7aa0fe3cd0010c32110607", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 171, "start_line": 1, "end_line": 7, "text": "156 CHAPTER 5 / TRANSPORT -LEVEL SECURITY 5.3 TRANSPORT LAYER SECURITY TLS is an IETF standardization initiative whose goal is to produce an Internet standard version of SSL. TLS is defined as a Proposed Internet Standard in RFC5246. RFC 5246 is very similar to SSLv3. In this section, we highlight thedifferences. Version Number The TLS Record Format is the same as that of the SSL Record Format (Figure 5.4),and the fields in the header have the same meanings. The one difference is in ver-sion values. For the current version of TLS, the major version is 3 and the minorversion is 3. Message Authentication Code"}, {"id": "30b9753046a6890ffcdc3034999761d9d5feadd4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 171, "start_line": 8, "end_line": 18, "text": "There are two differences between the SSLv3 and TLS MAC schemes: the actualalgorithm and the scope of the MAC calculation. TLS makes use of the HMACalgorithm defined in RFC 2104. Recall from Chapter 3 that HMAC is defined as HMAC K(M)= H[(K+opad)| |H[( K+ipad)| |M]] where H = embedded hash function (for TLS, either MD5 or SHA-1) M = message input to HMAC K+= secret key padded with zeros on the left so that the result is equal to the block length of the hash code (for MD5 and SHA-1, blocklength = 512 bits) ipad = 00110110 (36 in hexadecimal) repeated 64 times (512 bits) opad = 01011100 (5C in hexadecimal) repeated 64 times (512 bits) SSLv3 uses the same algorithm, except that the padding bytes are"}, {"id": "b3f3355b893c317519a5307b9964a3d8779563f0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 171, "start_line": 19, "end_line": 26, "text": "concatenated with the secret key rather than being XORed with the secret keypadded to the block length. The level of security should be about the same inboth cases. For TLS, the MAC calculation encompasses the fields indicated in the following expression: MAC(MAC_write_secret,seq_num | | TLSCompressed.type | | TLSCompressed.version | | TLSCompressed.length | | TLSCompressed.fragment) The MAC calculation covers all of the fields covered by the SSLv3 calculation, plus the field TLSCompressed.version, which is the version of the protocol being employed./H17053 /H17053"}, {"id": "189ea315ae81f6b88a68e5dda82fb55079b43b13", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 172, "start_line": 1, "end_line": 20, "text": "5.3 / TRANSPORT LAYER SECURITY 157 Pseudorandom Function TLS makes use of a pseudorandom function referred to as PRF to expand secrets into blocks of data for purposes of key generation or validation. The objective is tomake use of a relatively small shared secret value but to generate longer blocks ofdata in a way that is secure from the kinds of attacks made on hash functions andMACs. The PRF is based on the data expansion function (Figure 5.7) given as P_hash(secret, seed)= HMAC_hash(secret,A(1) | | seed) | | HMAC_hash(secret, A(2) | | seed) | | HMAC_hash(secret, A(3) | | seed) | |... where A() is defined as A(0) = seed A( i)= HMAC_hash(secret, A( i\u2013 1)) SecretSeed SeedA(1)HMAC Secret Secret Length /H11005 hash sizeSecret SeedA(2)HMAC HMAC Secret SeedA(3)HMAC HMACSecret HMAC"}, {"id": "bdbd9988bd97408aef5810562c4eefa70885147b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 172, "start_line": 21, "end_line": 21, "text": "Figure 5.7 TLS Function P_hash(secret,seed)"}, {"id": "f5b6affc94b8d8a492b864fec032f78ad11db10e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 173, "start_line": 1, "end_line": 7, "text": "158 CHAPTER 5 / TRANSPORT -LEVEL SECURITY The data expansion function makes use of the HMAC algorithm with either MD5 or SHA-1 as the underlying hash function. As can be seen, P_hash can be iterated as many times as necessary to produce the required quantity of data. Forexample, if P_SHA-1 was used to generate 64 bytes of data, it would have to be iterated four times, producing 80 bytes of data of which the last 16 would be dis-carded. In this case, P_MD5 would also have to be iterated four times, producing exactly 64 bytes of data. Note that each iteration involves two executions ofHMAC\u2014each of which in turn involves two executions of the underlying hashalgorithm. To make PRF as secure as possible, it uses two hash algorithms in a way"}, {"id": "1a38f378d0d78cb60b9a73bb8154f5a69cdd72cd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 173, "start_line": 8, "end_line": 17, "text": "that should guarantee its security if either algorithm remains secure. PRF isdefined as PRF(secret, label, seed)=P_hash(S1,label | | seed) PRF takes as input a secret value, an identifying label, and a seed value and produces an output of arbitrary length. Alert Codes TLS supports all of the alert codes defined in SSLv3 with the exception ofno_certificate . A number of additional codes are defined in TLS; of these, the following are always fatal. \u2022record_overflow: A TLS record was received with a payload (ciphertext) whose length exceeds bytes, or the ciphertext decrypted to a lengthof greater than bytes. \u2022unknown_ca: A valid certificate chain or partial chain was received, but the"}, {"id": "add35f29bf431ecff2002f48ead07269075aeec3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 173, "start_line": 18, "end_line": 27, "text": "certificate was not accepted because the CA certificate could not be located orcould not be matched with a known, trusted CA. \u2022access_denied: A valid certificate was received, but when access control was applied, the sender decided not to proceed with the negotiation. \u2022decode_error: A message could not be decoded, because either a field was out of its specified range or the length of the message was incorrect. \u2022protocol_version: The protocol version the client attempted to negoti- ate is recognized but not supported. \u2022insufficient_security: Returned instead of handshake_failure when a negotiation has failed specifically because the server requires ciphersmore secure than those supported by the client. \u2022unsupported_extension: Sent by clients that receive an extended server"}, {"id": "261d72f98350f6027e225ed203687693a583de89", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 173, "start_line": 28, "end_line": 33, "text": "hello containing an extension not in the corresponding client hello. \u2022internal_error: An internal error unrelated to the peer or the correct- ness of the protocol makes it impossible to continue. \u2022decrypt_error: A handshake cryptographic operation failed, including being unable to verify a signature, decrypt a key exchange, or validate a fin-ished message.2 14+1024214+2048"}, {"id": "221213bc78005e4f7dc021c190fe504d3c54cd06", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 174, "start_line": 1, "end_line": 12, "text": "5.3 / TRANSPORT LAYER SECURITY 159 The remaining alerts include the following. \u2022user_canceled: This handshake is being canceled for some reason unre- lated to a protocol failure. \u2022no_renegotiation: Sent by a client in response to a hello request or by the server in response to a client hello after initial handshaking. Either of these messages would normally result in renegotiation, but this alertindicates that the sender is not able to renegotiate. This message is always awarning. Cipher Suites There are several small differences between the cipher suites available under SSLv3and under TLS: \u2022Key Exchange: TLS supports all of the key exchange techniques of SSLv3 with the exception of Fortezza. \u2022Symmetric Encryption Algorithms: TLS includes all of the symmetric encryp-"}, {"id": "8cfd1ff3b088cc71b2623bcc695e4347d376683c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 174, "start_line": 13, "end_line": 20, "text": "tion algorithms found in SSLv3, with the exception of Fortezza. Client Certificate Types TLS defines the following certificate types to be requested in acertificate_request message:rsa_sign, dss_sign, rsa_fixed_dh, and dss_fixed_dh. These are all defined in SSLv3. In addition, SSLv3 includesrsa_ephemeral_dh ,dss_ephemeral_dh , and fortezza_kea. Ephemeral Diffie-Hellman involves signing the Diffie-Hellman parameters with either RSA orDSS. For TLS, the rsa_sign and dss_sign types are used for that function; a separate signing type is not needed to sign Diffie-Hellman parameters. TLS doesnot include the Fortezza scheme. Certificate_Verify and Finished Messages In the TLS certificate_verify message, the MD5 and SHA-1 hashes are"}, {"id": "fa143c60b133306cbfd2b79652949d98ddf7b485", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 174, "start_line": 21, "end_line": 29, "text": "calculated only over handshake_messages . Recall that for SSLv3, the hash calculation also included the master secret and pads. These extra fields were felt toadd no additional security. As with the finished message in SSLv3, the finished message in TLS is a hash based on the shared master_secret , the previous handshake messages, and a label that identifies client or server.The calculation is somewhat different. For TLS,we have PRF(master_secret,finished_label,MD5(handshake_messages) | | SHA-1(handshake_messages)) where finished_label is the string \u201cclient finished\u201d for the client and \u201cserver finished\u201d for the server."}, {"id": "980e46694c3f9ec075c71593774dc62c62753d4b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 175, "start_line": 1, "end_line": 12, "text": "160 CHAPTER 5 / TRANSPORT -LEVEL SECURITY Cryptographic Computations The pre_master_secret for TLS is calculated in the same way as in SSLv3.As in SSLv3, the master_secret in TLS is calculated as a hash function of the pre_master_secret and the two hello random numbers. The form of the TLS calculation is different from that of SSLv3 and is defined as master_secret= PRF(pre_master_secret,\"master secret\", ClientHello.random| |ServerHello.random) The algorithm is performed until 48 bytes of pseudorandom output are produced. The calculation of the key block material (MAC secret keys, session encryptionkeys, and IVs) is defined as key_block = PRF(master_secret, \"key expansion\", SecurityParameters.server_random| |SecurityParameters.client_random)"}, {"id": "d0047cae8743f3b8b5c3419577a48e7d74b9ce78", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 175, "start_line": 13, "end_line": 16, "text": "until enough output has been generated. As with SSLv3, the key_block is a func- tion of the master_secret and the client and server random numbers, but for TLS, the actual algorithm is different. Padding"}, {"id": "f7f2734856bd5c4b8557596137307ae7f2eed471", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 175, "start_line": 17, "end_line": 18, "text": "In SSL, the padding added prior to encryption of user data is the minimumamount required so that the total size of the data to be encrypted is a multipleof the cipher\u2019s block length. In TLS, the padding can be any amount that resultsin a total that is a multiple of the cipher\u2019s block length, up to a maximum of 255bytes. For example, if the plaintext (or compressed text if compression is used)plus MAC plus padding.length byte is 79 bytes long, then the padding length(in bytes) can be 1, 9, 17, and so on, up to 249. A variable padding length may beused to frustrate attacks based on an analysis of the lengths of exchangedmessages. 5.4 HTTPS"}, {"id": "0bcb148ee2e1e25c39ea419c80a362df6a3c9f3c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 175, "start_line": 19, "end_line": 21, "text": "HTTPS (HTTP over SSL) refers to the combination of HTTP and SSL to imple-ment secure communication between a Web browser and a Web server. The HTTPScapability is built into all modern Web browsers. Its use depends on the Web serversupporting HTTPS communication. For example, search engines do not supportHTTPS. The principal difference seen by a user of a Web browser is that URL (uni- form resource locator) addresses begin with https:// rather than http://. A normalHTTP connection uses port 80. If HTTPS is specified, port 443 is used, whichinvokes SSL."}, {"id": "5057ccce1011e1a7b6a5cf1a73b27dc61d0057d1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 176, "start_line": 1, "end_line": 12, "text": "5.4 / HTTPS 161 When HTTPS is used, the following elements of the communication are encrypted: \u2022URL of the requested document \u2022Contents of the document \u2022Contents of browser forms (filled in by browser user) \u2022Cookies sent from browser to server and from server to browser \u2022Contents of HTTP header HTTPS is documented in RFC 2818,HTTP Over TLS.There is no fundamen- tal change in using HTTP over either SSL or TLS, and both implementations are referred to as HTTPS. Connection Initiation"}, {"id": "c6e5f585fff7df6dd3c42352e848c7405e10f069", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 176, "start_line": 13, "end_line": 14, "text": "For HTTPS, the agent acting as the HTTP client also acts as the TLS client. Theclient initiates a connection to the server on the appropriate port and then sends theTLS ClientHello to begin the TLS handshake. When the TLS handshake has fin-ished, the client may then initiate the first HTTP request. All HTTP data is to besent as TLS application data. Normal HTTP behavior, including retained connec-tions, should be followed. We need to be clear that there are three levels of awareness of a connection in"}, {"id": "a6159227f7d354ad61167c11d63a3b216ef808fb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 176, "start_line": 15, "end_line": 18, "text": "HTTPS. At the HTTP level, an HTTP client requests a connection to an HTTPserver by sending a connection request to the next lowest layer. Typically, the nextlowest layer is TCP , but it also may be TLS/SSL. At the level of TLS, a session isestablished between a TLS client and a TLS server. This session can support one ormore connections at any time.As we have seen, a TLS request to establish a connec-tion begins with the establishment of a TCP connection between the TCP entity onthe client side and the TCP entity on the server side. Connection Closure An HTTP client or server can indicate the closing of a connection by including thefollowing line in an HTTP record: Connection: close . This indicates that the connection will be closed after this record is delivered."}, {"id": "aeac0d49c11b181f19761398548124cb88016633", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 176, "start_line": 19, "end_line": 20, "text": "The closure of an HTTPS connection requires that TLS close the connection with the peer TLS entity on the remote side, which will involve closing the underly-ing TCP connection. At the TLS level, the proper way to close a connection is foreach side to use the TLS alert protocol to send a close_notify alert. TLS imple-"}, {"id": "c9d2c4ad633d22ab43f4497660f186efe09d6aee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 176, "start_line": 21, "end_line": 24, "text": "mentations must initiate an exchange of closure alerts before closing a connection.A TLS implementation may, after sending a closure alert, close the connection with-out waiting for the peer to send its closure alert, generating an \u201cincomplete close\u201d.Note that an implementation that does this may choose to reuse the session. Thisshould only be done when the application knows (typically through detecting HTTPmessage boundaries) that it has received all the message data that it cares about. HTTP clients also must be able to cope with a situation in which the underlying TCP connection is terminated without a prior close_notify alert and without a Connection: close indicator. Such a situation could be due to a programming"}, {"id": "fa95c3b41078ead50f9ef85e8434608ee838221b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 177, "start_line": 1, "end_line": 4, "text": "162 CHAPTER 5 / TRANSPORT -LEVEL SECURITY error on the server or a communication error that causes the TCP connection to drop. However, the unannounced TCP closure could be evidence of some sort of attack. Sothe HTTPS client should issue some sort of security warning when this occurs. 5.5 SECURE SHELL (SSH)"}, {"id": "97b258a62d2cad1dd726b5f464cb35a392ca53d1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 177, "start_line": 5, "end_line": 6, "text": "Secure Shell (SSH) is a protocol for secure network communications designed to berelatively simple and inexpensive to implement.The initial version, SSH1 was focusedon providing a secure remote logon facility to replace TELNET and other remotelogon schemes that provided no security. SSH also provides a more generalclient/server capability and can be used for such network functions as file transfer ande-mail. A new version, SSH2, fixes a number of security flaws in the original scheme.SSH2 is documented as a proposed standard in IETF RFCs 4250 through 4256. SSH client and server applications are widely available for most operating sys-"}, {"id": "d953ecf410cba23375110692821605201a84f18c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 177, "start_line": 7, "end_line": 18, "text": "tems. It has become the method of choice for remote login and X tunneling and israpidly becoming one of the most pervasive applications for encryption technologyoutside of embedded systems. SSH is organized as three protocols that typically run on top of TCP (Figure 5.8): \u2022Transport Layer Protocol: Provides server authentication, data confidentiality, and data integrity with forward secrecy (i.e., if a key is compromised duringone session, the knowledge does not affect the security of earlier sessions).Thetransport layer may optionally provide compression. SSH User Authentication Protocol SSH Transport Layer Protocol TCP IP Internet protocol provides datagram deli very across multiple networks.Transmission control protocol provides reliable, connection-"}, {"id": "c0a27c8164c5d9a622c397cfb67c8969fe80d342", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 177, "start_line": 19, "end_line": 26, "text": "oriented end-to-end deli very.Provides server authentication, conf identiality, and integrity. It may optionally also provide compression.Authenticates the client-side user to the server.SSH Connection Protocol Multiplexes the encrypted tunnel into several logical channels. Figure 5.8 SSH Protocol Stack"}, {"id": "da0253f0c28d6d5a751be03e082e4497347d4c6f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 178, "start_line": 1, "end_line": 8, "text": "5.5 / SECURE SHELL (SSH) 163 \u2022User Authentication Protocol: Authenticates the user to the server. \u2022Connection Protocol: Multiplexes multiple logical communications channels over a single, underlying SSH connection. Transport Layer Protocol HOSTKEYS Server authentication occurs at the transport layer, based on the server possessing a public/private key pair. A server may have multiple host keys using multiple different asymmetric encryption algorithms. Multiple hosts may share thesame host key. In any case, the server host key is used during key exchange toauthenticate the identity of the host. For this to be possible, the client must have apriori knowledge of the server\u2019s public host key. RFC 4251 dictates two alternativetrust models that can be used:"}, {"id": "f1eda03e50add4967da6472c4393c516224bfdfa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 178, "start_line": 9, "end_line": 11, "text": "1.The client has a local database that associates each host name (as typed bythe user) with the corresponding public host key. This method requires nocentrally administered infrastructure and no third-party coordination. Thedownside is that the database of name-to-key associations may becomeburdensome to maintain. 2.The host name-to-key association is certified by a trusted certification author-ity (CA). The client only knows the CA root key and can verify the validity ofall host keys certified by accepted CAs.This alternative eases the maintenanceproblem, since ideally, only a single CA key needs to be securely stored on theclient. On the other hand, each host key must be appropriately certified by acentral authority before authorization is possible. P"}, {"id": "27d9661167f936ae199197e620802ec2c0f6e124", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 178, "start_line": 12, "end_line": 18, "text": "ACKET EXCHANGE Figure 5.9 illustrates the sequence of events in the SSH Transport Layer Protocol. First, the client establishes a TCP connection to theserver. This is done via the TCP protocol and is not part of the Transport LayerProtocol. Once the connection is established, the client and server exchange data,referred to as packets, in the data field of a TCP segment. Each packet is in thefollowing format (Figure 5.10). \u2022Packet length: Length of the packet in bytes, not including the packet length and MAC fields. \u2022Padding length: Length of the random padding field. \u2022Payload: Useful contents of the packet. Prior to algorithm negotiation, this field is uncompressed. If compression is negotiated, then in subsequent pack-ets, this field is compressed."}, {"id": "9e7dd7db72cc52ec9ac1ed37fd223da898c7cd29", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 178, "start_line": 19, "end_line": 22, "text": "\u2022Random padding: Once an encryption algorithm has been negotiated, this field is added. It contains random bytes of padding so that that total length ofthe packet (excluding the MAC field) is a multiple of the cipher block size, or8 bytes for a stream cipher. \u2022Message authentication code (MAC): If message authentication has been negotiated, this field contains the MAC value. The MAC value is computedover the entire packet plus a sequence number, excluding the MAC field. Thesequence number is an implicit 32-bit packet sequence that is initialized to"}, {"id": "a415ddfc43cea227c153c0193d3bd13dbd68588f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 179, "start_line": 1, "end_line": 11, "text": "164 CHAPTER 5 / TRANSPORT -LEVEL SECURITY zero for the first packet and incremented for every packet.The sequence num- ber is not included in the packet sent over the TCP connection. Once an encryption algorithm has been negotiated, the entire packet (exclud- ing the MAC field) is encrypted after the MAC value is calculated. The SSH Transport Layer packet exchange consists of a sequence of steps (Figure 5.9). The first step, the identification string exchange , begins with the client sending a packet with an identification string of the form: SSH-protoversion-softwareversion SP comments CR LF where SP,CR, and LFare space character, carriage return, and line feed, respectively. An example of a valid string is SSH-2.0-billsSSH_3.6.3q3<CR><LF> .T h e"}, {"id": "46e4e0f25f766a3372d907ada3e8038dfe2faaa0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 179, "start_line": 12, "end_line": 25, "text": "server responds with its own identification string.These strings are used in the Diffie- Hellman key exchange. Next comes algorithm negotiation. Each side sends an SSH_MSG_KEXINIT con- taining lists of supported algorithms in the order of preference to the sender. There isone list for each type of cryptographic algorithm.The algorithms include key exchange,encryption, MAC algorithm, and compression algorithm.Table 5.3 shows the allowableoptions for encryption, MAC, and compression. For each category, the algorithm cho-sen is the first algorithm on the client\u2019s list that is also supported by the server.ClientServer SSH-protoversion-softwareversion Identification string exchange Algorithm negotiation End of key exchange Service requestSSH-protoversion-softwareversion SSH_MSG_KEXINIT"}, {"id": "2ed86993d49ee2f67440ac38e6d2a05a050158b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 179, "start_line": 26, "end_line": 31, "text": "SSH_MSG_KEXINIT SSH_MSG_NEWKEYS SSH_MSG_NEWKEYS SSH_MSG_SERVICE_REQUESTEstablish TCP Connection Key Exchange Figure 5.9 SSH Transport Layer Protocol Packet Exchanges"}, {"id": "7af9ce2dfc5119f52d8f64650ffdc4a3ac7926fa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 180, "start_line": 1, "end_line": 6, "text": "5.5 / SECURE SHELL (SSH) 165 The next step is key exchange . The specification allows for alternative methods of key exchange, but at present, only two versions of Diffie-Hellman key exchange are specified. Both versions are defined in RFC 2409 and require only one packet in eachdirection. The following steps are involved in the exchange. In this, C is the client; S isthe server; is a large safe prime; is a generator for a subgroup of GF( ); is theorder of the subgroup; V_S is S\u2019s identification string; V_C is C\u2019s identification string; K_S is S\u2019s public host key; I_C is C\u2019sSSH_MSG_KEXINIT message and I_S is S\u2019s SSH_MSG_KEXINIT message that have been exchanged before this part begins. The"}, {"id": "d8d8033b66a673a83bedf00b35c4120d48639b9f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 180, "start_line": 7, "end_line": 19, "text": "values of , , and are known to both client and server as a result of the algorithmselection negotiation. The hash function hash() is also decided during algorithm negotiation. 1.C generates a random number and computes . Csends to S. 2.S generates a random number and computes .S receives . It computes mod , , and signature on with its private host key. S sends to C.The signing operation may involve a second hashing operation. (K_S || f || s)H s K_S || e || f || K)H=hash(V_C || V_S || I_C || I_S || p K=e yef=gy mod p y(06y6q)ee=gx mod p x(16x6q)q g pq p g ppdl pktl pktl = packet length pdl = padding lengthg n i d d a p # q e sPayload SSH PacketCompressed payload CiphertextCOMPRESS ENCRYPT MAC Figure 5.10 SSH Transport Layer Protocol Packet Formation"}, {"id": "73789081dc755ee577bfa0e6859ebcca49ced92b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 181, "start_line": 1, "end_line": 5, "text": "166 CHAPTER 5 / TRANSPORT -LEVEL SECURITY 3.C verifies that really is the host key for S (e.g., using certificates or a local database). C is also allowed to accept the key without verification;however, doing so will render the protocol insecure against active attacks(but may be desirable for practical reasons in the short term in manyenvironments). C then computes , , and verifies the signature on . As a result of these steps, the two sides now share a master key K. In addition,"}, {"id": "1d23e577fa9af598ed23a71f8ca4ffe0dc98285d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 181, "start_line": 6, "end_line": 12, "text": "the server has been authenticated to the client, because the server has used its pri-vate key to sign its half of the Diffie-Hellman exchange. Finally, the hash value Hserves as a session identifier for this connection. Once computed, the session identi-fier is not changed, even if the key exchange is performed again for this connectionto obtain fresh keys. The end of key exchange is signaled by the exchange of SSH_MSG_NEWKEYS packets. At this point, both sides may start using the keys generated from , as dis-cussed subsequently.KH s I_C || I_S || K_S || e || f || K)H=hash(V_C || V_S || K=f x mod pK_STable 5.3 SSH Transport Layer Cryptographic Algorithms Cipher MAC algorithm 3des-cbc * Three-key 3DES in CBC modehmac-sha1 * HMAC-SHA1; digest length =key length = 20"}, {"id": "359c7f6bc61859e91ce752f33a75d4eb7c14d81f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 181, "start_line": 13, "end_line": 27, "text": "blowfish-cbc Blowfish in CBC mode hmac-sha1-96 ** First 96 bits of HMAC-SHA1;digest length = 12; key length = 20 twofish256-cbc Twofish in CBC modewith a 256-bit keyhmac-md5 HMAC-SHA1; digest length =key length = 16 twofish192-cbc Twofish with a 192-bit key hmac-md5-96 First 96 bits of HMAC-SHA1;digest length = 12; key length = 16 twofish128-cbc Twofish with a 128-bit key aes256-cbc AES in CBC mode with a256-bit key Compression algorithm aes192-cbc AES with a 192-bit key none * No compression aes128-cbc ** AES with a 128-bit key zlib Defined in RFC 1950 and RFC 1951 Serpent256-cbc Serpent in CBC modewith a 256-bit key Serpent192-cbc Serpent with a 192-bit key Serpent128-cbc Serpent with a 128-bit key arcfour RC4 with a 128-bit key cast128-cbc CAST-128 in CBC mode * = Required"}, {"id": "99d42ccc4add0fe3607599a06092be45133ccef9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 181, "start_line": 28, "end_line": 28, "text": "** = Recommended"}, {"id": "4fbc0e599716985513818e48be4197d7462386d3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 182, "start_line": 1, "end_line": 13, "text": "5.5 / SECURE SHELL (SSH) 167 The final step is service request. The client sends an SSH_MSG_ SERVICE_REQUEST packet to request either the User Authentication or the Connection Protocol. Subsequent to this, all data is exchanged as the payload of an SSH Transport Layer packet, protected by encryption and MAC. KEYGENERATION The keys used for encryption and MAC (and any needed IVs) are generated from the shared secret key , the hash value from the key exchange , and the session identifier, which is equal to unless there has been a subsequent key exchange after the initial key exchange. The values are computed as follows. \u2022Initial IV client to server: \"\" \u2022Initial IV server to client: \"\" \u2022Encryption key client to server: \"\" \u2022Encryption key server to client: \"\""}, {"id": "4a96eed215a4439ec7a2b4e8bc2ef6db32aff0c1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 182, "start_line": 14, "end_line": 25, "text": "\u2022Integrity key client to server: \"\" \u2022Integrity key server to client: \"\" where HASH() is the hash function determined during algorithm negotiation. User Authentication Protocol The User Authentication Protocol provides the means by which the client is authen- ticated to the server. MESSAGE TYPES AND FORMATS Three types of messages are always used in the User Authentication Protocol. Authentication requests from the client have the format: byteSSH_MSG_USERAUTH_REQUEST (50) string user name string service namestring method name... method specific fields where user name is the authorization identity the client is claiming, service name"}, {"id": "bee74e29be4e44d19e4e9599a069fa37bec236ea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 182, "start_line": 26, "end_line": 33, "text": "is the facility to which the client is requesting access (typically the SSHConnection Protocol), and method name is the authentication method being usedin this request. The first byte has decimal value 50, which is interpreted asSSH_MSG_USERAUTH_REQUEST. If the server either (1) rejects the authentication request or (2) accepts the request but requires one or more additional authentication methods, the serversends a message with the format: byte SSH_MSG_USERAUTH_FAILURE (51) name-list authentications that can continue boolean partial success where the name-list is a list of methods that may productively continue the dialog. If the server accepts authentication, it sends a single byte message: SSH_MSG_"}, {"id": "55aafe0e26f912da2facd86f38c9500b9078b6ea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 182, "start_line": 34, "end_line": 34, "text": "USERAUTH_SUCCESS (52) . || session_id)F HASH( K || H || || session_id)E HASH( K || H || || session_id)D HASH( K || H || || session_id)C HASH( K || H || || session_id)B HASH( K || H || || session_id)A HASH( K || H || H HK"}, {"id": "52b29e97add19f892f7ce5421b3c5248d1773d2e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 183, "start_line": 1, "end_line": 11, "text": "168 CHAPTER 5 / TRANSPORT -LEVEL SECURITY MESSAGE EXCHANGE The message exchange involves the following steps. 1.The client sends a SSH_MSG_USERAUTH_REQUEST with a requested method of none. 2.The server checks to determine if the user name is valid. If not, the server returns SSH_MSG_USERAUTH_FAILURE with the partial success value of false. If the user name is valid, the server proceeds to step 3. 3.The server returns SSH_MSG_USERAUTH_FAILURE with a list of one or more authentication methods to be used. 4.The client selects one of the acceptable authentication methods and sends aSSH_MSG_USERAUTH_REQUEST with that method name and the required method-specific fields. At this point, there may be a sequence of exchanges toperform the method."}, {"id": "0ba45218f979b19b3d2acfcc7da791af9c0dc938", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 183, "start_line": 12, "end_line": 18, "text": "5.If the authentication succeeds and more authentication methods are required, theserver proceeds to step 3, using a partial success value of true. If the authenticationfails, the server proceeds to step 3, using a partial success value of false. 6.When all required authentication methods succeed, the server sends aSSH_MSG_USERAUTH_SUCCESS message, and the Authentication Protocol is over. A UTHENTICATION METHODS The server may require one or more of the following authentication methods. \u2022publickey: The details of this method depend on the public-key algorithm"}, {"id": "937dfd94463f0606b23a50ed2e3c9351d050cba3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 183, "start_line": 19, "end_line": 22, "text": "chosen. In essence, the client sends a message to the server that contains theclient\u2019s public key, with the message signed by the client\u2019s private key. Whenthe server receives this message, it checks whether the supplied key is accept-able for authentication and, if so, it checks whether the signature is correct. \u2022password: The client sends a message containing a plaintext password, which is protected by encryption by the Transport Layer Protocol. \u2022hostbased: Authentication is performed on the client\u2019s host rather than the"}, {"id": "8944f3540a1a3cffcd3ea6091e024f95e19a5382", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 183, "start_line": 23, "end_line": 27, "text": "client itself. Thus, a host that supports multiple clients would provide authenti-cation for all its clients. This method works by having the client send a signa-ture created with the private key of the client host. Thus, rather than directlyverifying the user\u2019s identity, the SSH server verifies the identity of the clienthost\u2014and then believes the host when it says the user has already authenti-cated on the client side. Connection Protocol The SSH Connection Protocol runs on top of the SSH Transport Layer Protocol andassumes that a secure authentication connection is in use. 2 That secure authentication 2RFC 4254, The Secure Shell (SSH) Connection Protocol , states that the Connection Protocol runs on top"}, {"id": "f46c7875bf0fd3cd342eca4c56cbb062c5a96cbe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 183, "start_line": 28, "end_line": 30, "text": "of the Transport Layer Protocol and the User Authentication Protocol. RFC 4251, SSH Protocol Architecture, states that the Connection Protocol runs over the User Authentication Protocol. In fact, the Connection Protocol runs over the Transport Layer Protocol, but assumes that the User AuthenticationProtocol has been previously invoked."}, {"id": "8b920a85a4bd03f0815dbc758e9c47d275f2cf3d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 184, "start_line": 1, "end_line": 9, "text": "5.5 / SECURE SHELL (SSH) 169 connection, referred to as a tunnel, is used by the Connection Protocol to multiplex a number of logical channels. CHANNEL MECHANISM All types of communication using SSH, such as a terminal session, are supported using separate channels. Either side may open a channel. For each channel, each side associates a unique channel number, which need not be thesame on both ends. Channels are flow controlled using a window mechanism. Nodata may be sent to a channel until a message is received to indicate that windowspace is available. The life of a channel progresses through three stages: opening a channel, data transfer, and closing a channel. When either side wishes to open a new channel , it allocates a local number for"}, {"id": "e772cd45341f9519ff099e6fb2958c97276a084b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 184, "start_line": 10, "end_line": 15, "text": "the channel and then sends a message of the form: byte SSH_MSG_CHANNEL_OPEN string channel type uint32 sender channeluint32 initial window sizeuint32 maximum packet size.... channel type specific data follows where uint32 means unsigned 32-bit integer.The channel type identifies the applica- tion for this channel, as described subsequently. The sender channel is the localchannel number. The initial window size specifies how many bytes of channel datacan be sent to the sender of this message without adjusting the window. The maxi-mum packet size specifies the maximum size of an individual data packet that canbe sent to the sender. For example, one might want to use smaller packets for inter-active connections to get better interactive response on slow links."}, {"id": "f68faedc1ff6ad337dac0a43964bddfcfa678803", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 184, "start_line": 16, "end_line": 25, "text": "If the remote side is able to open the channel, it returns a SSH_MSG_ CHANNEL_OPEN_CONFIRMATION message, which includes the sender channel number, the recipient channel number, and window and packet size values forincoming traffic. Otherwise, the remote side returns a SSH_MSG_CHANNEL_ OPEN_FAILURE message with a reason code indicating the reason for failure. Once a channel is open, data transfer is performed using a SSH_MSG_ CHANNEL_DATA message, which includes the recipient channel number and a block of data. These messages, in both directions, may continue as long as the channelis open. When either side wishes to close a channel, it sends a SSH_MSG_ CHANNEL_CLOSE message, which includes the recipient channel number. Figure 5.11 provides an example of Connection Protocol Message Exchange."}, {"id": "36384cee1d6cdf54eda789707ea6ada3fde8042a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 184, "start_line": 26, "end_line": 30, "text": "C HANNEL TYPES Four channel types are recognized in the SSH Connection Protocol specification. \u2022session: The remote execution of a program. The program may be a shell, an application such as file transfer or e-mail, a system command, or some built-insubsystem. Once a session channel is opened, subsequent requests are used tostart the remote program."}, {"id": "6b0174d75dba20dd73e9734b6319b84050dd0f41", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 185, "start_line": 1, "end_line": 23, "text": "170 CHAPTER 5 / TRANSPORT -LEVEL SECURITY ClientServer SSH_MSG_CHANNEL_OPEN Open a channel Data transfer Close a channelSSH_MSG_CHANNEL_OPEN_CONFIRMATION SSH_MSG_CHANNEL_DATA SSH_MSG_CHANNEL_DATA SSH_MSG_CHANNEL_DATA SSH_MSG_CHANNEL_DATA SSH_MSG_CHANNEL_CLOSEEstablish Authenticated Transport Layer Connection Figure 5.11 Example SSH Connection Protocol Message Exchange \u2022x11: This refers to the X Window System, a computer software system and net- work protocol that provides a graphical user interface (GUI) for networked computers. X allows applications to run on a network server but to be displayedon a desktop machine. \u2022forwarded-tcpip: This is remote port forwarding, as explained in the next sub- section. \u2022direct-tcpip: This is local port forwarding, as explained in the next subsection. P"}, {"id": "d1ba63c472c92a5d2ac90b0b041807c7a636793b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 185, "start_line": 24, "end_line": 25, "text": "ORTFORW ARDING One of the most useful features of SSH is port forwarding. In essence, port forwarding provides the ability to convert any insecure TCP connectioninto a secure SSH connection. This is also referred to as SSH tunneling. We need toknow what a port is in this context. A port is an identifier of a user of TCP . So, any"}, {"id": "2bf32561731380b52fd3ecec4bb6463038c9ecaf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 185, "start_line": 26, "end_line": 26, "text": "application that runs on top of TCP has a port number. Incoming TCP traffic isdelivered to the appropriate application on the basis of the port number.An applicationmay employ multiple port numbers. For example, for the Simple Mail Transfer Protocol(SMTP), the server side generally listens on port 25, so an incoming SMTP request usesTCP and addresses the data to destination port 25.TCP recognizes that this is the SMTPserver address and routes the data to the SMTP server application."}, {"id": "03753d5dec30cf0d0198a5b4d1acd165702ed521", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 186, "start_line": 1, "end_line": 6, "text": "5.5 / SECURE SHELL (SSH) 171 Figure 5.12 illustrates the basic concept behind port forwarding. We have a client application that is identified by port number and a server application identi- fied by port number . At some point, the client application invokes the local TCPentity and requests a connection to the remote server on port .The local TCP entitynegotiates a TCP connection with the remote TCP entity, such that the connectionlinks local port to remote port . To secure this connection, SSH is configured so that the SSH Transport Layer Protocol establishes a TCP connection between the SSH client and server entitieswith TCP port numbers and , respectively. A secure SSH tunnel is establishedover this TCP connection. Traffic from the client at port is redirected to the local xb ay xyyx"}, {"id": "98ae43118863bc45575311f7702a949fae6f9c41", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 186, "start_line": 7, "end_line": 28, "text": "ClientServer Client application Unsecure TCP connection (a) Connection via TCPTCP entityx yServer application TCP entity Client application Secure SSH Tunnel (b) Connection via SSH tunnelSSH entityx yServer application SSH entity Unsecure TCP connectionTCP entitya b TCP entity Figure 5.12 SSH Transport Layer Packet Exchanges"}, {"id": "78e5c76ae2aacba027a9c4061884ede0b01cb511", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 187, "start_line": 1, "end_line": 6, "text": "172 CHAPTER 5 / TRANSPORT -LEVEL SECURITY SSH entity and travels through the tunnel where the remote SSH entity delivers the data to the server application on port . Traffic in the other direction is similarlyredirected. SSH supports two types of port forwarding: local forwarding and remote for- warding. Local forwarding allows the client to set up a \u201chijacker\u201d process. This will intercept selected application-level traffic and redirect it from an unsecured TCPconnection to a secure SSH tunnel. SSH is configured to listen on selected ports.SSH grabs all traffic using a selected port and sends it through an SSH tunnel. Onthe other end, the SSH server sends the incoming traffic to the destination port dic-tated by the client application."}, {"id": "8b2e8e7a4b8368643c71db978182337311a4826b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 187, "start_line": 7, "end_line": 12, "text": "The following example should help clarify local forwarding. Suppose you have an e-mail client on your desktop and use it to get e-mail from your mail server viathe Post Office Protocol (POP). The assigned port number for POP3 is port 110. Wecan secure this traffic in the following way: 1.The SSH client sets up a connection to the remote server. 2.Select an unused local port number, say 9999, and configure SSH to accepttraffic from this port destined for port 110 on the server. 3.The SSH client informs the SSH server to create a connection to the destina-tion, in this case mailserver port 110. 4.The client takes any bits sent to local port 9999 and sends them to the serverinside the encrypted SSH session. The SSH server decrypts the incoming bitsand sends the plaintext to port 110."}, {"id": "8b6189df6d5ef6925aa9eba75bb8e894ce80bde1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 187, "start_line": 13, "end_line": 15, "text": "5.In the other direction, the SSH server takes any bits received on port 110and sends them inside the SSH session back to the client, who decrypts andsends them to the process connected to port 9999. With remote forwarding, the user\u2019s SSH client acts on the server\u2019s behalf. The client receives traffic with a given destination port number, places the trafficon the correct port and sends it to the destination the user chooses. A typicalexample of remote forwarding is the following. You wish to access a server atwork from your home computer. Because the work server is behind a firewall, itwill not accept an SSH request from your home computer. However, from workyou can set up an SSH tunnel using remote forwarding. This involves the follow-ing steps."}, {"id": "fc26f54157561c872cc959cb71bd66c6ededcaa4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 187, "start_line": 16, "end_line": 19, "text": "1.From the work computer, set up an SSH connection to your homecomputer. The firewall will allow this, because it is a protected outgoingconnection. 2.Configure the SSH server to listen on a local port, say 22, and to deliver dataacross the SSH connection addressed to remote port, say 2222. 3.You can now go to your home computer, and configure SSH to accept trafficon port 2222. 4.You now have an SSH tunnel that can be used for remote logon to the workserver.y"}, {"id": "8c454ad93dbdb5da3e1ad1408192a6c5ef005b1a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 188, "start_line": 1, "end_line": 13, "text": "5.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 173 5.6 RECOMMENDED READING AND WEB SITES [RESC01] is a good detailed treatment of SSL and TLS. [BARR05] provides a thorough treatment of SSH. The original version (SSH-1) of SSH was introduced in [YLON96]. BARR05 Barrett, D.; Silverman, R.; and Byrnes, R. SSH The Secure Shell: The Definitive Guide. Sebastopol, CA: O\u2019Reilly, 2005. RESC01 Rescorla, E. SSL and TLS: Designing and Building Secure Systems. Reading, MA: Addison-Wesley, 2001. YLON96 Ylonen, T. \u201cSSH - Secure Login Connections over the Internet.\u201d Proceedings, Sixth USENIX Security Symposium,July 1996. Recommended Web Sites: \u2022Transport Layer Security Charter: Latest RFCs and Internet drafts for TLS. \u2022OpenSSL Project: Project to develop open-source SSL and TLS software. Site includes"}, {"id": "b418c4f72d6487f6c903116771e313d8406242c4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 188, "start_line": 14, "end_line": 27, "text": "documents and links. 5.7 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms Alert protocolChange Cipher Spec protocolHandshake protocolHTTPS (HTTP over SSL)Master SecretSecure Shell (SSH)Secure Socket Layer (SSL)Transport Layer Security (TLS) Review Questions 5.1 What are the advantages of each of the three approaches shown in Figure 5.1? 5.2 What protocols comprise SSL? 5.3 What is the difference between an SSL connection and an SSL session? 5.4 List and briefly define the parameters that define an SSL session state. 5.5 List and briefly define the parameters that define an SSL session connection. 5.6 What services are provided by the SSL Record Protocol? 5.7 What steps are involved in the SSL Record Protocol transmission? 5.8 What is the purpose of HTTPS?"}, {"id": "c134a46636441635030f418ae254700ed4151fc0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 188, "start_line": 28, "end_line": 29, "text": "5.9 For what applications is SSH useful? 5.10 List and briefly define the SSH protocols."}, {"id": "ce68757b3580331c74598641acb47e84dd8ce9c9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 189, "start_line": 1, "end_line": 6, "text": "174 CHAPTER 5 / TRANSPORT -LEVEL SECURITY Problems 5.1 In SSL and TLS, why is there a separate Change Cipher Spec Protocol rather than including a change_cipher_spec message in the Handshake Protocol? 5.2 What purpose does the MAC serve during the change cipher spec SSL exchange? 5.3 Consider the following threats to Web security and describe how each is countered bya particular feature of SSL.a.Brute-Force Cryptanalytic Attack: An exhaustive search of the key space for aconventional encryption algorithm."}, {"id": "b1e100f47fe2f1e7c2a101db20eff24765ce7dfb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 189, "start_line": 7, "end_line": 8, "text": "b.Known Plaintext Dictionary Attack: Many messages will contain predictableplaintext, such as the HTTP GET command. An attacker constructs a dictionarycontaining every possible encryption of the known-plaintext message. When anencrypted message is intercepted, the attacker takes the portion containing theencrypted known plaintext and looks up the ciphertext in the dictionary. Theciphertext should match against an entry that was encrypted with the same secretkey. If there are several matches, each of these can be tried against the full cipher-text to determine the right one.This attack is especially effective against small keysizes (e.g., 40-bit keys). c.Replay Attack: Earlier SSL handshake messages are replayed."}, {"id": "e7d8f3f63a9bada222a41c6fe29db082c2fa6b5c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 189, "start_line": 9, "end_line": 13, "text": "d.Man-in-the-Middle Attack: An attacker interposes during key exchange, acting asthe client to the server and as the server to the client. e.Password Sniffing: Passwords in HTTP or other application traffic are eaves-dropped. f.IP Spoofing: Uses forged IP addresses to fool a host into accepting bogus data. g.IP Hijacking: An active, authenticated connection between two hosts is disruptedand the attacker takes the place of one of the hosts. h.SYN Flooding:An attacker sends TCP SYN messages to request a connection butdoes not respond to the final message to establish the connection fully. Theattacked TCP module typically leaves the \u201chalf-open connection\u201d around for afew minutes. Repeated SYN messages can clog the TCP module."}, {"id": "f9da10d603d0ff6fa932368178372f7e09b33a68", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 189, "start_line": 14, "end_line": 15, "text": "5.4 Based on what you have learned in this chapter, is it possible in SSL for the receiverto reorder SSL record blocks that arrive out of order? If so, explain how it can bedone. If not, why not? 5.5 For SSH packets, what is the advantage, if any, of not including the MAC in the scopeof the packet encryption?"}, {"id": "5fa761de396f700f798e4118ccc2f13892429f73", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 190, "start_line": 1, "end_line": 13, "text": "WIRELESS NETWORK SECURITY 6.1 IEEE 802.11 Wireless LAN Overview The Wi-Fi Alliance IEEE 802 Protocol ArchitectureIEEE 802.11 Network Components and Architectural ModelIEEE 802.11 Services 6.2 IEEE 802.11i Wireless LAN Security IEEE 802.11i ServicesIEEE 802.11i Phases of OperationDiscovery PhaseAuthentication PhaseKey Management PhaseProtected Data Transfer PhaseThe IEEE 802.11i Pseudorandom Function 6.3 Wireless Application Protocol Overview Operational OverviewWireless Markup LanguageWAP ArchitectureWireless Application EnvironmentWAP Protocol Architecture 6.4 Wireless Transport Layer Security WTLS Sessions and ConnectionsWTLS Protocol ArchitectureCryptographic Algorithms 6.5 WAP End-to-End Security 6.6 Recommended Reading and Web Sites 6.7 Key Terms, Review Questions, and Problems"}, {"id": "c9d01dd6ae1465fff864bbfcd901a6d6008d1a37", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 190, "start_line": 14, "end_line": 14, "text": "175CHAPTER"}, {"id": "f7fdc972e5461efcc2f487c91a5fb439a71d66cd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 191, "start_line": 1, "end_line": 8, "text": "176 CHAPTER 6 / WIRELESS NETWORK SECURITY Investigators have published numerous reports of birds taking turns vocalizing; the bird spoken to gave its full attention to the speaker and never vocalized at thesame time, as if the two were holding a conversation. Researchers and scholars who have studied the data on avian communication carefully write (a) the communication code of birds, such as crows, has not beenbroken by any means; (b) probably all birds have wider vocabularies than any-one realizes; and (c) greater complexity and depth are recognized in avian com-munication as research progresses. \u2014The Human Nature of Birds, Theodore Barber KEY POINTS \u25c6IEEE 802.11 is a standard for wireless LANs. Interoperable standards-compliant implementations are referred to as Wi-Fi."}, {"id": "8f702995d5b81fc99985843542c2bc7aba05dde6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 191, "start_line": 9, "end_line": 12, "text": "\u25c6IEEE 802.11i specifies security standards for IEEE 802.11 LANs, includingauthentication, data integrity, data confidentiality, and key management.Interoperable implementations are also referred to as Wi-Fi ProtectedAccess (WPA). \u25c6The Wireless Application Protocol (WAP) is a standard to provide mobileusers of wireless phones and other wireless terminals access to telephonyand information services, including the Internet and the Web. \u25c6WAP security is primarily provided by the Wireless Transport Layer Secu-rity (WTLS), which provides security services between the mobile deviceand the WAP gateway to the Internet. \u25c6There are several approaches to WAP end-to-end security. One notableapproach assumes that the mobile device implements TLS over TCP/IP"}, {"id": "3c12d9b354655530964bfd337f2330613438b0ba", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 191, "start_line": 13, "end_line": 15, "text": "and the wireless network supports transfer of IP packets. This chapter looks at two important wireless network security schemes. First, we lookat the IEEE 802.11i standard for wireless LAN security. This standard is part of IEEE802.11, also referred to as Wi-Fi. We begin the discussion with an overview of IEEE802.11, and we then look in some detail at IEEE 802.11i. The remainder of the chapter is devoted to security standards for Web access"}, {"id": "a62ba4d0ecb5116160766955a7e2eeb4c11f3213", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 191, "start_line": 16, "end_line": 16, "text": "from mobile wireless devices, such as cell phones.We begin this part of the chapter withan overview of the Wireless Application Protocol (WAP), which is a set of standardsfor communication between mobile devices attached to a cellular network and a Webserver. Then we examine the Wireless Transport Layer Security (WTLS) protocol,which provides security between the mobile device and a gateway that operatesbetween the cellular network and the Internet. Finally, we cover end-to-end securityservices between WAP devices and Web servers."}, {"id": "5840c39180fb09c559663d6f0b68ef6fca5ad98c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 192, "start_line": 1, "end_line": 8, "text": "6.1 / IEEE 802.11 WIRELESS LAN OVERVIEW 177 Table 6.1 IEEE 802.11 Terminology Access point (AP) Any entity that has station functionality and provides access to the distribution system via the wireless medium for associated stations. Basic service set (BSS) A set of stations controlled by a single coordination function. Coordination function The logical function that determines when a station operating within a BSS is per-mitted to transmit and may be able to receive PDUs. Distribution system(DS) A system used to interconnect a set of BSSs and integrated LANs to create anESS. Extended service set(ESS) A set of one or more interconnected BSSs and integrated LANs that appear as asingle BSS to the LLC layer at any station associated with one of these BSSs."}, {"id": "fa1022defd0adfcab76e754496b1aab60a698dfd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 192, "start_line": 9, "end_line": 12, "text": "MAC protocol data unit(MPDU) The unit of data exchanged between two peer MAC entities using the services ofthe physical layer. MAC service data unit(MSDU) Information that is delivered as a unit between MAC users. Station Any device that contains an IEEE 802.11 conformant MAC and physical layer.6.1 IEEE 802.11 WIRELESS LAN OVERVIEW IEEE 802 is a committee that has developed standards for a wide range of local area"}, {"id": "324dbf01593bf22d8525413904b4c8332c5b39a7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 192, "start_line": 13, "end_line": 14, "text": "networks (LANs). In 1990, the IEEE 802 Committee formed a new working group,IEEE 802.11, with a charter to develop a protocol and transmission specificationsfor wireless LANs (WLANs). Since that time, the demand for WLANs at differentfrequencies and data rates has exploded. Keeping pace with this demand, the IEEE802.11 working group has issued an ever-expanding list of standards. Table 6.1briefly defines key terms used in the IEEE 802.11 standard. The Wi-Fi Alliance"}, {"id": "0f55d92c11759cd61dee10a23092ff85c2b0e0bf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 192, "start_line": 15, "end_line": 16, "text": "The first 802.11 standard to gain broad industry acceptance was 802.11b. Although802.11b products are all based on the same standard, there is always a concernwhether products from different vendors will successfully interoperate. To meet thisconcern, the Wireless Ethernet Compatibility Alliance (WECA), an industry con-sortium, was formed in 1999. This organization, subsequently renamed the Wi-Fi(Wireless Fidelity) Alliance, created a test suite to certify interoperability for802.11b products. The term used for certified 802.11b products is Wi-Fi. Wi-Fi certi- fication has been extended to 802.11g products. The Wi-Fi Alliance has also devel-oped a certification process for 802.11a products, called Wi-Fi5. The Wi-Fi Alliance"}, {"id": "a88c0cc854c98b00b84f8d6e8d4844df47424b98", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 192, "start_line": 17, "end_line": 19, "text": "is concerned with a range of market areas for WLANs, including enterprise, home,and hot spots. More recently, the Wi-Fi Alliance has developed certification procedures for IEEE 802.11 security standards, referred to as Wi-Fi Protected Access (WPA). Themost recent version of WPA, known as WPA2, incorporates all of the features of theIEEE 802.11i WLAN security specification."}, {"id": "65d568285a4fda968798493b1d6dcd206d58dd73", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 193, "start_line": 1, "end_line": 19, "text": "178 CHAPTER 6 / WIRELESS NETWORK SECURITY Logical Link Control Medium Access Control PhysicalEncoding/decoding of signals Bit transmission/receptionTransmission mediumAssemble data into frame Addressing Error detectionMedium accessFlow control Error controlGeneral IEEE 802 functionsSpecific IEEE 802.11 functions Frequency band definition Wireless signal encodingReliable data delivery Wireless access control protocols Figure 6.1 IEEE 802.11 Protocol StackIEEE 802 Protocol Architecture Before proceeding, we need to briefly preview the IEEE 802 protocol architecture. IEEE 802.11 standards are defined within the structure of a layered set of protocols.This structure, used for all IEEE 802 standards, is illustrated in Figure 6.1. P"}, {"id": "65a3907d43abc31af7c065068c1e838b596d630d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 193, "start_line": 20, "end_line": 27, "text": "HYSICAL LAYER The lowest layer of the IEEE 802 reference model is the physical layer , which includes such functions as encoding/decoding of signals and bit transmission/reception. In addition, the physical layer includes a specification of the transmission medium. In the case of IEEE 802.11, the physical layer also definesfrequency bands and antenna characteristics. M EDIA ACCESS CONTROL All LANs consist of collections of devices that share the network\u2019s transmission capacity. Some means of controlling access to the transmission medium is needed to provide an orderly and efficient use of thatcapacity.This is the function of a media access control (MAC) layer.The MAC layer"}, {"id": "31cbdb0fc4db13de4682020e95e47bb9436bfc94", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 193, "start_line": 28, "end_line": 33, "text": "receives data from a higher-layer protocol, typically the Logical Link Control (LLC)layer, in the form of a block of data known as the MAC service data unit (MSDU) . In general, the MAC layer performs the following functions: \u2022On transmission, assemble data into a frame, known as a MAC protocol data unit (MPDU) with address and error-detection fields. \u2022On reception, disassemble frame, and perform address recognition and errordetection. \u2022Govern access to the LAN transmission medium."}, {"id": "2e026c25444c9b8b92445c831f3fef6116ebe95a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 194, "start_line": 1, "end_line": 17, "text": "6.1 / IEEE 802.11 WIRELESS LAN OVERVIEW 179 MAC Control r e l i a r t C A M r e d a e h C A MDestination MAC AddressSource MAC AddressMAC Service Data Unit (MSDU) CRC Figure 6.2 General IEEE 802 MPDU Format The exact format of the MPDU differs somewhat for the various MAC proto- cols in use. In general, all of the MPDUs have a format similar to that of Figure 6.2. The fields of this frame are as follows. \u2022MAC Control: This field contains any protocol control information needed for the functioning of the MAC protocol. For example, a priority level could beindicated here. \u2022Destination MAC Address: The destination physical address on the LAN for this MPDU. \u2022Source MAC Address: The source physical address on the LAN for this MPDU. \u2022MAC Service Data Unit: The data from the next higher layer."}, {"id": "0ddd67d0aa561727faa01dcc62abc1de8442d378", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 194, "start_line": 18, "end_line": 24, "text": "\u2022CRC: The cyclic redundancy check field; also known as the Frame Check Sequence (FCS) field. This is an error-detecting code, such as that which isused in other data-link control protocols. The CRC is calculated based on thebits in the entire MPDU. The sender calculates the CRC and adds it to theframe. The receiver performs the same calculation on the incoming MPDUand compares that calculation to the CRC field in that incoming MPDU. If thetwo values don\u2019t match, then one or more bits have been altered in transit. The fields preceding the MSDU field are referred to as the MAC header , and the field following the MSDU field is referred to as the MAC trailer .The header and trailer contain control information that accompany the data field and that are used by the MAC protocol. L"}, {"id": "7188d09594e35bd6b2d000ae423907006860e04c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 194, "start_line": 25, "end_line": 29, "text": "OGICAL LINKCONTROL In most data-link control protocols, the data-link protocol entity is responsible not only for detecting errors using the CRC, but for recovering from those errors by retransmitting damaged frames. In the LAN protocolarchitecture, these two functions are split between the MAC and LLC layers. TheMAC layer is responsible for detecting errors and discarding any frames thatcontain errors. The LLC layer optionally keeps track of which frames have beensuccessfully received and retransmits unsuccessful frames. IEEE 802.11 Network Components and Architectural Model Figure 6.3 illustrates the model developed by the 802.11 working group. The smallestbuilding block of a wireless LAN is a basic service set (BSS), which consists of wireless"}, {"id": "a5040039b4348419bc34ad9bd0025c4fa69bfa96", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 194, "start_line": 30, "end_line": 30, "text": "stations executing the same MAC protocol and competing for access to the sameshared wireless medium. A BSS may be isolated, or it may connect to a backbone"}, {"id": "2f34ab24cfff75db274eb675435fd64256efe54a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 195, "start_line": 1, "end_line": 11, "text": "180 CHAPTER 6 / WIRELESS NETWORK SECURITY STA 2 STA 3STA4 STA 1 STA 6STA 7STA 8AP 2 AP 1 Basic Service Set (BSS)Basic Service Set (BSS)Distribution System Figure 6.3 IEEE 802.11 Extended Service Set distribution system (DS) through an access point (AP). The AP functions as a bridge and a relay point. In a BSS, client stations do not communicate directly with one"}, {"id": "09e4bd073d01fab7f53449f8a8a160d175c24299", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 195, "start_line": 12, "end_line": 14, "text": "another. Rather, if one station in the BSS wants to communicate with another stationin the same BSS, the MAC frame is first sent from the originating station to the APand then from the AP to the destination station. Similarly, a MAC frame from a sta-tion in the BSS to a remote station is sent from the local station to the AP and thenrelayed by the AP over the DS on its way to the destination station.The BSS generallycorresponds to what is referred to as a cell in the literature. The DS can be a switch, awired network, or a wireless network. When all the stations in the BSS are mobile stations that communicate directly with one another (not using an AP), the BSS is called an independent BSS (IBSS) ."}, {"id": "96465939641e8bc6879846d3398fe85fcfae7315", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 195, "start_line": 15, "end_line": 19, "text": "An IBSS is typically an ad hoc network. In an IBSS, the stations all communicatedirectly, and no AP is involved. A simple configuration is shown in Figure 6.3, in which each station belongs to a single BSS; that is, each station is within wireless range only of other stationswithin the same BSS. It is also possible for two BSSs to overlap geographically, sothat a single station could participate in more than one BSS. Furthermore, the asso-ciation between a station and a BSS is dynamic. Stations may turn off, come withinrange, and go out of range. An extended service set (ESS) consists of two or more basic service sets interconnected by a distribution system.The extended service set appears as a singlelogical LAN to the logical link control (LLC) level."}, {"id": "8963627151e108eb9d9c9a735254b98823b34886", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 196, "start_line": 1, "end_line": 14, "text": "6.1 / IEEE 802.11 WIRELESS LAN OVERVIEW 181 Table 6.2 IEEE 802.11 Services Service Provider Used to support Association Distribution system MSDU delivery Authentication Station LAN access and security Deauthentication Station LAN access and security Disassociation Distribution system MSDU delivery Distribution Distribution system MSDU delivery Integration Distribution system MSDU delivery MSDU delivery Station MSDU delivery Privacy Station LAN access and security Reassociation Distribution system MSDU deliveryIEEE 802.11 Services IEEE 802.11 defines nine services that need to be provided by the wireless LAN to achieve functionality equivalent to that which is inherent to wired LANs. Table 6.2lists the services and indicates two ways of categorizing them."}, {"id": "9aebf622a3953916aebfb1bc2e36271179213d7d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 196, "start_line": 15, "end_line": 18, "text": "1.The service provider can be either the station or the DS. Station services areimplemented in every 802.11 station, including AP stations. Distribution ser-vices are provided between BSSs; these services may be implemented in an APor in another special-purpose device attached to the distribution system. 2.Three of the services are used to control IEEE 802.11 LAN access and confi-dentiality. Six of the services are used to support delivery of MSDUs betweenstations. If the MSDU is too large to be transmitted in a single MPDU, it maybe fragmented and transmitted in a series of MPDUs. Following the IEEE 802.11 document, we next discuss the services in an order designed to clarify the operation of an IEEE 802.11 ESS network. MSDU delivery ,"}, {"id": "424fab8389f08fec668f245e7679208fffe49689", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 196, "start_line": 19, "end_line": 24, "text": "which is the basic service, already has been mentioned. Services related to security are introduced in Section 6.2. D ISTRIBUTION OF MESSAGES WITHIN A DS The two services involved with the distribution of messages within a DS are distribution and integration. Distribution is the primary service used by stations to exchange MPDUs when the MPDUs must"}, {"id": "a2ea0f3f2851eec89e8d8dd8e218f5eade39d260", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 196, "start_line": 25, "end_line": 27, "text": "traverse the DS to get from a station in one BSS to a station in another BSS. Forexample, suppose a frame is to be sent from station 2 (STA 2) to station 7 (STA 7) inFigure 6.3. The frame is sent from STA 2 to AP 1, which is the AP for this BSS. TheAP gives the frame to the DS, which has the job of directing the frame to the APassociated with STA 7 in the target BSS. AP 2 receives the frame and forwards it toSTA 7. How the message is transported through the DS is beyond the scope of theIEEE 802.11 standard. If the two stations that are communicating are within the same BSS, then the distribution service logically goes through the single AP of that BSS."}, {"id": "d22b3cc8008cb4809729f6834b6bd21022a49f64", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 197, "start_line": 1, "end_line": 8, "text": "182 CHAPTER 6 / WIRELESS NETWORK SECURITY The integration service enables transfer of data between a station on an IEEE 802.11 LAN and a station on an integrated IEEE 802.x LAN. The term integrated refers to a wired LAN that is physically connected to the DS and whose stations may be logically connected to an IEEE 802.11 LAN via the integration service. Theintegration service takes care of any address translation and media conversion logicrequired for the exchange of data. A SSOCIATION -RELATED SERVICES The primary purpose of the MAC layer is to transfer MSDUs between MAC entities; this purpose is fulfilled by the"}, {"id": "fa7de6a6b1b9393c3adfbe82f89819d96ea581a5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 197, "start_line": 9, "end_line": 13, "text": "distribution service. For that service to function, it requires information aboutstations within the ESS that is provided by the association-related services. Beforethe distribution service can deliver data to or accept data from a station, thatstation must be associated. Before looking at the concept of association, we need to describe the concept of mobility. The standard defines three transition types,based on mobility: \u2022No transition: A station of this type is either stationary or moves only within the direct communication range of the communicating stations of a single BSS. \u2022BSS transition: This is defined as a station movement from one BSS to"}, {"id": "77604bb4ac72109646120fa7ed600bef83897eca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 197, "start_line": 14, "end_line": 18, "text": "another BSS within the same ESS. In this case, delivery of data to the stationrequires that the addressing capability be able to recognize the new locationof the station. \u2022ESS transition: This is defined as a station movement from a BSS in one ESS to a BSS within another ESS. This case is supported only in the sense that thestation can move. Maintenance of upper-layer connections supported by802.11 cannot be guaranteed. In fact, disruption of service is likely to occur. To deliver a message within a DS, the distribution service needs to know where the destination station is located. Specifically, the DS needs to know the"}, {"id": "6d817bae7b7e132e5ee71b7b0de2a68e68d749f0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 197, "start_line": 19, "end_line": 22, "text": "identity of the AP to which the message should be delivered in order for that mes-sage to reach the destination station. To meet this requirement, a station mustmaintain an association with the AP within its current BSS. Three services relate tothis requirement: \u2022Association: Establishes an initial association between a station and an AP . Before a station can transmit or receive frames on a wireless LAN, its identityand address must be known. For this purpose, a station must establish an asso-ciation with an AP within a particular BSS. The AP can then communicate thisinformation to other APs within the ESS to facilitate routing and delivery ofaddressed frames. \u2022Reassociation: Enables an established association to be transferred from one"}, {"id": "5b96d719600e9b81feeb00cf61c4fd21bb05d9c0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 197, "start_line": 23, "end_line": 25, "text": "AP to another, allowing a mobile station to move from one BSS to another. \u2022Disassociation: A notification from either a station or an AP that an existing association is terminated.A station should give this notification before leavingan ESS or shutting down. However, the MAC management facility protectsitself against stations that disappear without notification."}, {"id": "9c296b5b26e269e48fb5490d694546095d9d8645", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 198, "start_line": 1, "end_line": 5, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 183 6.2 IEEE 802.11i WIRELESS LAN SECURITY There are two characteristics of a wired LAN that are not inherent in a wireless LAN. 1.In order to transmit over a wired LAN, a station must be physically connected to the LAN. On the other hand, with a wireless LAN, any station within radiorange of the other devices on the LAN can transmit. In a sense, there is a formof authentication with a wired LAN in that it requires some positive andpresumably observable action to connect a station to a wired LAN."}, {"id": "1bc94203dc2eb0ffca341e2502b46af7e7bf9fb3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 198, "start_line": 6, "end_line": 10, "text": "2.Similarly, in order to receive a transmission from a station that is part of awired LAN, the receiving station also must be attached to the wired LAN. Onthe other hand, with a wireless LAN, any station within radio range canreceive. Thus, a wired LAN provides a degree of privacy, limiting reception ofdata to stations connected to the LAN. These differences between wired and wireless LANs suggest the increased need for robust security services and mechanisms for wireless LANs. The original 802.11 specification included a set of security features for privacy and authenticationthat were quite weak. For privacy, 802.11 defined the Wired Equivalent Privacy (WEP) algorithm.The privacy portion of the 802.11 standard contained major weak-"}, {"id": "da67dfe2924b36cc529c805639cf564d536d7209", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 198, "start_line": 11, "end_line": 16, "text": "nesses. Subsequent to the development of WEP , the 802.11i task group has developeda set of capabilities to address the WLAN security issues. In order to accelerate theintroduction of strong security into WLANs, the Wi-Fi Alliance promulgated Wi-FiProtected Access (WPA) as a Wi-Fi standard. WPA is a set of security mechanisms that eliminates most 802.11 security issues and was based on the current state of the802.11i standard. The final form of the 802.11i standard is referred to as Robust Security Network (RSN).The Wi-Fi Alliance certifies vendors in compliance with thefull 802.11i specification under the WPA2 program. IEEE 802.11i Services The 802.11i RSN security specification defines the following services. \u2022Authentication: A protocol is used to define an exchange between a user and"}, {"id": "624af5fce52300a4fd3c23fc5eb64141614f25fe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 198, "start_line": 17, "end_line": 25, "text": "an AS that provides mutual authentication and generates temporary keys tobe used between the client and the AP over the wireless link. \u2022Access control: 1This function enforces the use of the authentication function, routes the messages properly, and facilitates key exchange. It can work with avariety of authentication protocols. \u2022Privacy with message integrity: MAC-level data (e.g., an LLC PDU) are encrypted along with a message integrity code that ensures that the data havenot been altered. Figure 6.4a indicates the security protocols used to support these services, while Figure 6.4b lists the cryptographic algorithms used for these services. 1In this context, we are discussing access control as a security function. This is a different function than"}, {"id": "aa6441f9a496dadb963ac7d08c7b59ffe5700dcc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 198, "start_line": 26, "end_line": 27, "text": "media access control (MAC) as described in Section 6.1. Unfortunately, the literature and the standards use the term access control in both contexts."}, {"id": "bc4f79fe24a3fe6d3bbfbdc8d8b1ebb819608461", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 199, "start_line": 1, "end_line": 9, "text": "184 CHAPTER 6 / WIRELESS NETWORK SECURITY IEEE 802.11i Phases of Operation The operation of an IEEE 802.11i RSN can be broken down into five distinct phases of operation. The exact nature of the phases will depend on the configuration andthe end points of the communication. Possibilities include (see Figure 6.3): 1.Two wireless stations in the same BSS communicating via the access point(AP) for that BSS. 2.Two wireless stations (STAs) in the same ad hoc IBSS communicating directlywith each other. 3.Two wireless stations in different BSSs communicating via their respective APsacross a distribution system. 4.A wireless station communicating with an end station on a wired network viaits AP and the distribution system.Access ControlServices Protocols Services AlgorithmsIEEE 802.1 Port-based"}, {"id": "8c9f7f891858444547f6d7bde50f4211b248a1c6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 199, "start_line": 10, "end_line": 46, "text": "Access ControlExtensible Authentication Protocol (EAP)Authentication and Key Generation (a) Services and protocolsConfidentiality, Data Origin Authentication and Integrity and Replay Protection TKIP CCMPRobust Security Network (RSN) Confidentiality TKIP (Michael MIC)CCM (AES- CBC- MAC)CCM (AES- CTR)NIST Key WrapHMAC- MD5HMAC- SHA-1Integrity and Data Origin Authentication (b) Cryptographic algorithmsKey Generation TKIP (RC4)Robust Security Network (RSN) HMAC- SHA-1RFC 1750 CBC-MAC = Cipher Block Block Chaining Message Authentication Code (MAC) CCM = Counter Mode with Cipher Block Chaining Message Authentication Code CCMP = Counter Mode with Cipher Block Chaining MAC Protocol TKIP = Temporal Key Integrity Protocol Figure 6.4 Elements of IEEE 802.11i"}, {"id": "84f4857b4dce4a56da0e0e5d76850157e96a34d4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 200, "start_line": 1, "end_line": 5, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 185 IEEE 802.11i security is concerned only with secure communication between the STA and its AP . In case 1 in the preceding list, secure communication is assured if each STA establishes secure communications with the AP . Case 2 is similar, withthe AP functionality residing in the STA. For case 3, security is not provided acrossthe distribution system at the level of IEEE 802.11, but only within each BSS. End-to-end security (if required) must be provided at a higher layer. Similarly, in case 4,security is only provided between the STA and its AP . With these considerations in mind, Figure 6.5 depicts the five phases of opera-"}, {"id": "1ded4fdd6faf5ed6ba52652f7c104114c70356b8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 200, "start_line": 6, "end_line": 9, "text": "tion for an RSN and maps them to the network components involved. One newcomponent is the authentication server (AS). The rectangles indicate the exchangeof sequences of MPDUs. The five phases are defined as follows. \u2022Discovery: An AP uses messages called Beacons and Probe Responses to advertise its IEEE 802.11i security policy. The STA uses these to identify anAP for a WLAN with which it wishes to communicate. The STA associateswith the AP , which it uses to select the cipher suite and authentication mecha-nism when the Beacons and Probe Responses present a choice. \u2022Authentication: During this phase, the STA and AS prove their identities to"}, {"id": "293927c410240c6b8bc00e34c7db45c1eddf1e8d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 200, "start_line": 10, "end_line": 14, "text": "each other.The AP blocks non-authentication traffic between the STA and ASuntil the authentication transaction is successful. The AP does not participatein the authentication transaction other than forwarding traffic between theSTA and AS. Phase 1 - Discoveryn o i t a t S d n E S A P A A T S Phase 5 - Connection TerminationPhase 3 - Key Management Phase 4 - Protected Data TransferPhase 2 - Authentication Figure 6.5 IEEE 802.11i Phases of Operation"}, {"id": "ec6e691a6cc4a3e09619b2cbd8ba31b19ddefeee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 201, "start_line": 1, "end_line": 9, "text": "186 CHAPTER 6 / WIRELESS NETWORK SECURITY \u2022Key generation and distribution: The AP and the STA perform several opera- tions that cause cryptographic keys to be generated and placed on the AP and the STA. Frames are exchanged between the AP and STA only. \u2022Protected data transfer: Frames are exchanged between the STA and the end station through the AP . As denoted by the shading and the encryption moduleicon, secure data transfer occurs between the STA and the AP only; security isnot provided end-to-end. \u2022Connection termination: The AP and STA exchange frames. During this phase, the secure connection is torn down and the connection is restored to theoriginal state. Discovery Phase"}, {"id": "3528a3912811fc4f1be06ee281e5b95fd5614979", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 201, "start_line": 10, "end_line": 18, "text": "We now look in more detail at the RSN phases of operation, beginning with thediscovery phase, which is illustrated in the upper portion of Figure 6.6. The purposeof this phase is for an STA and an AP to recognize each other, agree on a set of secu-rity capabilities, and establish an association for future communication using thosesecurity capabilities. S ECURITY CAPABILITIES During this phase, the STA and AP decide on specific techniques in the following areas: \u2022Confidentiality and MPDU integrity protocols for protecting unicast traffic (traffic only between this STA and AP) \u2022Authentication method \u2022Cryptography key management approach Confidentiality and integrity protocols for protecting multicast/broadcast traf-"}, {"id": "29ba50b8d9e66f1e9564c93a9ccf6560965302fd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 201, "start_line": 19, "end_line": 29, "text": "fic are dictated by the AP , since all STAs in a multicast group must use the same pro- tocols and ciphers. The specification of a protocol, along with the chosen key length(if variable) is known as a cipher suite. The options for the confidentiality and integrity cipher suite are \u2022WEP , with either a 40-bit or 104-bit key, which allows backward compatibilitywith older IEEE 802.11 implementations \u2022TKIP \u2022CCMP \u2022Vendor-specific methods The other negotiable suite is the authentication and key management (AKM) suite, which defines (1) the means by which the AP and STA perform mutual authentication and (2) the means for deriving a root key from which other keys maybe generated. The possible AKM suites are \u2022IEEE 802.1X"}, {"id": "1f8df50a430a8de89dfa61a99d3dec34ef16b320", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 201, "start_line": 30, "end_line": 31, "text": "\u2022Pre-shared key (no explicit authentication takes place and mutual authentica-tion is implied if the STA and AP share a unique secret key) \u2022Vendor-specific methods"}, {"id": "97c97db6b9fb2a267c8cfd141b25ea6e6207135e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 202, "start_line": 1, "end_line": 28, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 187 STA AP AS Probe requestStation sends a request to join network. AP sends possible security parameter(security capabilities set per the security policy). AP performs null authentication. AP sends the associated security parameters.Station sends a request to perform null authentication. Station sends a request to associate with AP with security parameters. Station sets selected security parameters.Open system authentication requestProbe response 802.1x EAP request Access request (EAP request)802.1x EAP response Accept/EAP-success key material 802.1x EAP successAssociation request Association response Open system authentication response 802.1X controlled port blocked 802.1X controlled port blockedExtensible Authentication Protocol Exchange"}, {"id": "933d5350aa60c07dae7c2711dcf15b7858e4a45f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 202, "start_line": 29, "end_line": 34, "text": "Figure 6.6 IEEE 802.11i Phases of Operation: Capability Discovery, Authentication, and Association MPDU E XCHANGE The discovery phase consists of three exchanges. \u2022Network and security capability discovery: During this exchange, STAs dis- cover the existence of a network with which to communicate. The AP either periodically broadcasts its security capabilities (not shown in figure), indicatedby RSN IE (Robust Security Network Information Element), in a specificchannel through the Beacon frame; or responds to a station\u2019s Probe Requestthrough a Probe Response frame. A wireless station may discover availableaccess points and corresponding security capabilities by either passively mon-itoring the Beacon frames or actively probing every channel."}, {"id": "ce79a2eb20abb330c5bf7efbb2a7e4bb928b2e46", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 202, "start_line": 35, "end_line": 36, "text": "\u2022Open system authentication: The purpose of this frame sequence, which pro- vides no security, is simply to maintain backward compatibility with the"}, {"id": "4b2da9bfc193c1d2e10f608b996fa1a49299fc1f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 203, "start_line": 1, "end_line": 4, "text": "188 CHAPTER 6 / WIRELESS NETWORK SECURITY IEEE 802.11 state machine, as implemented in existing IEEE 802.11 hard- ware. In essence, the two devices (STA and AP) simply exchange identifiers. \u2022Association: The purpose of this stage is to agree on a set of security capabili-"}, {"id": "e2f625c0e20d0393e9c323e30fbb02615f2e219a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 203, "start_line": 5, "end_line": 6, "text": "ties to be used. The STA then sends an Association Request frame to the AP .In this frame, the STA specifies one set of matching capabilities (one authenti-cation and key management suite, one pairwise cipher suite, and one group-key cipher suite) from among those advertised by the AP . If there is no matchin capabilities between the AP and the STA, the AP refuses the AssociationRequest. The STA blocks it too, in case it has associated with a rogue AP orsomeone is inserting frames illicitly on its channel. As shown in Figure 6.6, theIEEE 802.1X controlled ports are blocked, and no user traffic goes beyond theAP . The concept of blocked ports is explained subsequently. Authentication Phase"}, {"id": "529f1c89f3c1ccfd0094656d46170094821a4f5b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 203, "start_line": 7, "end_line": 12, "text": "As was mentioned, the authentication phase enables mutual authentication betweenan STA and an authentication server (AS) located in the DS. Authentication isdesigned to allow only authorized stations to use the network and to provide theSTA with assurance that it is communicating with a legitimate network. IEEE 802.1X A CCESS CONTROL APPROACH IEEE 802.11i makes use of another standard that was designed to provide access control functions for LANs. The standard is IEEE 802.1X, Port-Based Network Access Control. The authenticationprotocol that is used, the Extensible Authentication Protocol (EAP), is defined inthe IEEE 802.1X standard. IEEE 802.1X uses the terms supplicant ,authenticator, and authentication server (AS). In the context of an 802.11 WLAN, the first two"}, {"id": "7b03020918a807ce8dd92ed578676399cd54d890", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 203, "start_line": 13, "end_line": 16, "text": "terms correspond to the wireless station and the AP . The AS is typically a separatedevice on the wired side of the network (i.e., accessible over the DS) but could alsoreside directly on the authenticator. Before a supplicant is authenticated by the AS using an authentication proto- col, the authenticator only passes control or authentication messages between thesupplicant and the AS; the 802.1X control channel is unblocked, but the 802.11 datachannel is blocked. Once a supplicant is authenticated and keys are provided, theauthenticator can forward data from the supplicant, subject to predefined accesscontrol limitations for the supplicant to the network. Under these circumstances, thedata channel is unblocked. As indicated in Figure 6.7, 802.1X uses the concepts of controlled and uncon-"}, {"id": "2132190cd07e5e94d474f1bd092336d6abff269f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 203, "start_line": 17, "end_line": 18, "text": "trolled ports. Ports are logical entities defined within the authenticator and refer tophysical network connections. For a WLAN, the authenticator (the AP) may haveonly two physical ports: one connecting to the DS and one for wireless communica-tion within its BSS. Each logical port is mapped to one of these two physical ports.An uncontrolled port allows the exchange of PDUs between the supplicant and theother AS, regardless of the authentication state of the supplicant. A controlled portallows the exchange of PDUs between a supplicant and other systems on the LANonly if the current state of the supplicant authorizes such an exchange. The 802.1X framework, with an upper-layer authentication protocol, fits nicely"}, {"id": "55b87eed6b339cca118052bdc67eaebcb36c784a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 203, "start_line": 19, "end_line": 19, "text": "with a BSS architecture that includes a number of wireless stations and an AP ."}, {"id": "f883bc7cbf06a6f4ee5eff53f9211d20dcaf03b5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 204, "start_line": 1, "end_line": 12, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 189 Figure 6.7 802.1X Access Control However, for an IBSS, there is no AP . For an IBSS, 802.11i provides a more complex solution that, in essence, involves pairwise authentication between stations on theIBSS. MPDU E XCHANGE The lower part of Figure 6.6 shows the MPDU exchange dictated by IEEE 802.11 for the authentication phase. We can think of authentication phase as consisting of the following three phases. \u2022Connect to AS: The STA sends a request to its AP (the one with which it has an association) for connection to the AS. The AP acknowledges this requestand sends an access request to the AS. \u2022EAP exchange: This exchange authenticates the STA and AS to each other. A number of alternative exchanges are possible, as explained subsequently."}, {"id": "801143a45a653cf04d3a15039d4b4e532f517e67", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 204, "start_line": 13, "end_line": 17, "text": "\u2022Secure key delivery: Once authentication is established, the AS generates a master session key (MSK), also known as the Authentication,Authorization, and Accounting (AAA) key and sends it to the STA.As explained subsequently, all the cryptographic keys needed by the STAfor secure communication with its AP are generated from this MSK. IEEE802.11i does not prescribe a method for secure delivery of the MSK butrelies on EAP for this. Whatever method is used, it involves the transmis-sion of an MPDU containing an encrypted MSK from the AS, via the AP , tothe AS. EAP E XCHANGE As mentioned, there are a number of possible EAP exchanges that can be used during the authentication phase. Typically, the message flow"}, {"id": "9d0fd02202d82873a75fefac1a5f6805c3dc687c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 205, "start_line": 1, "end_line": 5, "text": "190 CHAPTER 6 / WIRELESS NETWORK SECURITY between STA and AP employs the EAP over LAN (EAPOL) protocol, and the message flow between the AP and AS uses the Remote Authentication Dial In UserService (RADIUS) protocol, although other options are available for both STA-to-AP and AP-to-AS exchanges. [FRAN07] provides the following summary of theauthentication exchange using EAPOL and RADIUS. 1.The EAP exchange begins with the AP issuing an EAP-Request/Identityframe to the STA. 2.The STA replies with an EAP-Response/Identity frame, which theAP receives over the uncontrolled port. The packet is then encapsulatedin RADIUS over EAP and passed on to the RADIUS server as a RADIUS-Access-Request packet."}, {"id": "4b1f3f306bf997267796c88752ca54419a4af17c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 205, "start_line": 6, "end_line": 7, "text": "3.The AAA server replies with a RADIUS-Access-Challenge packet, which ispassed on to the STA as an EAP-Request. This request is of the appropriateauthentication type and contains relevant challenge information. 4.The STA formulates an EAP-Response message and sends it to the AS.The response is translated by the AP into a Radius-Access-Request withthe response to the challenge as a data field. Steps 3 and 4 may berepeated multiple times, depending on the EAP method in use. For TLStunneling methods, it is common for authentication to require 10 to 20round trips."}, {"id": "ccc09d61692e31dbe8794e1d4909e00383f11272", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 205, "start_line": 8, "end_line": 11, "text": "5.The AAA server grants access with a Radius-Access-Accept packet. TheAP issues an EAP-Success frame. (Some protocols require confirmation ofthe EAP success inside the TLS tunnel for authenticity validation.) Thecontrolled port is authorized, and the user may begin to access thenetwork. Note from Figure 6.6 that the AP controlled port is still blocked to general user traffic.Although the authentication is successful, the ports remain blocked untilthe temporal keys are installed in the STA and AP , which occurs during the 4-WayHandshake. Key Management Phase"}, {"id": "1226130526a8e853641eab5e95581008fec00c0b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 205, "start_line": 12, "end_line": 17, "text": "During the key management phase, a variety of cryptographic keys are generatedand distributed to STAs. There are two types of keys: pairwise keys used for commu-nication between an STA and an AP and group keys used for multicast communica-tion. Figure 6.8, based on [FRAN07], shows the two key hierarchies, and Table 6.3defines the individual keys. P AIRWISE KEYS Pairwise keys are used for communication between a pair of devices, typically between an STA and an AP . These keys form a hierarchy beginning with a master key from which other keys are derived dynamically andused for a limited period of time. At the top level of the hierarchy are two possibilities.A pre-shared key (PSK)"}, {"id": "9e8bf1996ec9b4de7b5cba674e1e83d06242d135", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 205, "start_line": 18, "end_line": 19, "text": "is a secret key shared by the AP and a STA and installed in some fashion outsidethe scope of IEEE 802.11i. The other alternative is the master session key (MSK), also known as the AAAK, which is generated using the IEEE 802.1X protocol"}, {"id": "27e88b571922ba9875d6e41d1c2ce27bfefd3848", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 206, "start_line": 1, "end_line": 34, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 191 Out-of-band path EAP method path Pre-shared key EAPOL key confirmation key EAPOL key encryption key Temporal keyPSK 256 bits 384 bits (CCMP) 512 bits (TKIP) 128 bits (CCMP) 256 bits (TKIP) 40 bits, 104 bits (WEP) 128 bits (CCMP) 256 bits (TKIP)256 bits 128 bitsNo modificationLegend Possible truncation PRF (pseudo-random function) usingHMAC-SHA-1 128 bitsUser-defined cryptoidEAP authentication Following EAP authentication or PSK During 4-way handshake These keys are components of the PTK\u2265 256 bits PMK KCKPTK K T K E KAAAK or MSK Pairwise master key (b) Group key hierarchy(a) Pairwise key hierarchyAAA key Pairwise transient key 256 bits Changes periodically or if compromised Changes based on policy (dissaciation,"}, {"id": "1f1ccf2b4bc0dd79434e8c044ed094ef2b56a048", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 206, "start_line": 35, "end_line": 41, "text": "deauthentication)GMK (generated by AS) GTK Group master key Group temporal key Figure 6.8 IEEE 802.11i Key Hierarchies during the authentication phase, as described previously. The actual method of key generation depends on the details of the authentication protocol used. In eithercase (PSK or MSK), there is a unique key shared by the AP with each STA withwhich it communicates. All the other keys derived from this master key are alsounique between an AP and an STA. Thus, each STA, at any time, has one set ofkeys, as depicted in the hierarchy of Figure 6.8a, while the AP has one set of suchkeys for each of its STAs. The pairwise master key (PMK) is derived from the master key. If a PSK is"}, {"id": "fb7381be5e6e1b735e1444cbacab5d11c9e75164", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 206, "start_line": 42, "end_line": 42, "text": "used, then the PSK is used as the PMK; if a MSK is used, then the PMK is derivedfrom the MSK by truncation (if necessary). By the end of the authentication phase,"}, {"id": "7ee4296f5eb9fa5a7ff8ddf4196304da067f6b95", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 207, "start_line": 1, "end_line": 11, "text": "192 CHAPTER 6 / WIRELESS NETWORK SECURITY Table 6.3 IEEE 802.11i Keys for Data Confidentiality and Integrity Protocols Abbrev- iationName Description / Purpose Size (bits) Type AAA KeyAuthentication,Accounting, andAuthorization KeyUsed to derive the PMK. Used withthe IEEE 802.1X authentication andkey management approach. Same asMMSK.256\u00da Key generationkey, root key PSK Pre-shared Key Becomes the PMK in pre-sharedkey environments. 256 Key generationkey, root key PMK Pairwise Master Key Used with other inputs to derive thePTK. 256 Key generationkey GMK Group Master Key Used with other inputs to derive theGTK. 128 Key generationkey PTK Pair-wise TransientKey Derived from the PMK. Comprisesthe EAPOL-KCK, EAPOL-KEK,and TK and (for TKIP) the MICkey.512 (TKIP) 384 (CCMP)Composite key"}, {"id": "143f63bf0f6a9da646de469d52460ec9e53b235c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 207, "start_line": 12, "end_line": 19, "text": "TK Temporal Key Used with TKIP or CCMP to pro-vide confidentiality and integrityprotection for unicast user traffic.256 (TKIP) 128 (CCMP)Traffic key GTK Group TemporalKey Derived from the GMK. Used toprovide confidentiality and integrityprotection for multicast/broadcastuser traffic.256 (TKIP) 128 (CCMP) 40, 104 (WEP)Traffic key MICKey Message IntegrityCode Key Used by TKIP\u2019s Michael MIC toprovide integrity protection of messages.64 Messageintegrity key EAPOL-KCK EAPOL-KeyConfirmation Key Used to provide integrity protectionfor key material distributed duringthe 4-Way Handshake.128 Messageintegrity key EAPOL-KEK EAPOL-KeyEncryption Key Used to ensure the confidentiality ofthe GTK and other key material inthe 4-Way Handshake.128 Traffic key /key encryptionkey"}, {"id": "0962646eb2870fe09685e674679ee3e1ba3cc730", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 207, "start_line": 20, "end_line": 24, "text": "WEPKey Wired EquivalentPrivacy Key Used with WEP . 40, 104 Traffic key marked by the 802.1x EAP Success message (Figure 6.6), both the AP and the STA have a copy of their shared PMK. The PMK is used to generate the pairwise transient key (PTK) , which in fact consists of three keys to be used for communication between an STA and AP afterthey have been mutually authenticated. To derive the PTK, the HMAC-SHA-1function is applied to the PMK, the MAC addresses of the STA and AP , and noncesgenerated when needed. Using the STA and AP addresses in the generation of thePTK provides protection against session hijacking and impersonation; using noncesprovides additional random keying material."}, {"id": "192ac8262d405bd4133b48c01e019620b4de9c43", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 208, "start_line": 1, "end_line": 10, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 193 The three parts of the PTK are as follows. \u2022EAP Over LAN (EAPOL) Key Confirmation Key (EAPOL-KCK): Supports the integrity and data origin authenticity of STA-to-AP control frames during operational setup of an RSN. It also performs an access control function:proof-of-possession of the PMK. An entity that possesses the PMK is autho-rized to use the link. \u2022EAPOL Key Encryption Key (EAPOL-KEK): Protects the confidentiality of keys and other data during some RSN association procedures. \u2022Temporal Key (TK): Provides the actual protection for user traffic. G ROUP KEYS Group keys are used for multicast communication in which one STA"}, {"id": "ebca2c6ca97c2915cead291b1f2549bc36c11bce", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 208, "start_line": 11, "end_line": 16, "text": "sends MPDU\u2019s to multiple STAs. At the top level of the group key hierarchy is thegroup master key (GMK) . The GMK is a key-generating key used with other inputs to derive the group temporal key (GTK) . Unlike the PTK, which is generated using material from both AP and STA, the GTK is generated by the AP and transmittedto its associated STAs. Exactly how this GTK is generated is undefined. IEEE802.11i, however, requires that its value is computationally indistinguishable fromrandom. The GTK is distributed securely using the pairwise keys that are alreadyestablished. The GTK is changed every time a device leaves the network. P AIRWISE KEYDISTRIBUTION The upper part of Figure 6.9 shows the MPDU exchange for distributing pairwise keys. This exchange is known as the 4-way"}, {"id": "ee0821621fec99ba1ba658df702ecf76e8711116", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 208, "start_line": 17, "end_line": 25, "text": "handshake. The STA and SP use this handshake to confirm the existence of the PMK, verify the selection of the cipher suite, and derive a fresh PTK for thefollowing data session. The four parts of the exchange are as follows. \u2022 :Message includes the MAC address of the AP and a nonce (Anonce) \u2022 :The STA generates its own nonce (Snonce) and uses both nonces and both MAC addresses, plus the PMK, to generate a PTK. The STA thensends a message containing its MAC address and Snonce, enabling the AP togenerate the same PTK. This message includes a message integrity code (MIC) 2 using HMAC-MD5 or HMAC-SHA-1-128. The key used with the MIC is KCK. \u2022 :The AP is now able to generate the PTK. The AP then sends a"}, {"id": "c3690d1fcdac940b71499afad6b7e8d12266430b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 208, "start_line": 26, "end_line": 36, "text": "message to the STA, containing the same information as in the first message,but this time including a MIC. \u2022 :This is merely an acknowledgment message, again protected by a MIC. G ROUP KEYDISTRIBUTION For group key distribution, the AP generates a GTK and distributes it to each STA in a multicast group.The two-message exchange with eachSTA consists of the following: \u2022 :This message includes the GTK, encrypted either with RC4 or with AES. The key used for encryption is KEK. A MIC value is appended.AP:STASTA:APAP:STASTA:APAP:STA 2While MAC is commonly used in cryptography to refer to a Message Authentication Code, the term MIC is used instead in connection with 802.11i because MAC has another standard meaning, Media Access Control, in networking."}, {"id": "6dc79caee7747f70a388b5358918f66af6034b05", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 209, "start_line": 1, "end_line": 7, "text": "194 CHAPTER 6 / WIRELESS NETWORK SECURITY Figure 6.9 IEEE 802.11i Phases of Operation: Four-Way Handshake and Group Key Handshake \u2022 :The STA acknowledges receipt of the GTK. This message includes a MIC value. Protected Data Transfer Phase IEEE 802.11i defines two schemes for protecting data transmitted in 802.11 MPDUs: the Temporal Key Integrity Protocol (TKIP), and the Counter Mode-CBCMAC Protocol (CCMP).STA:AP"}, {"id": "6cefab01f2d62ce6cf1267cb26b2e396f2fca2cd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 210, "start_line": 1, "end_line": 10, "text": "6.2 / IEEE 802.11i WIRELESS LAN SECURITY 195 TKIP TKIP is designed to require only software changes to devices that are implemented with the older wireless LAN security approach called Wired Equivalent Privacy (WEP). TKIP provides two services: \u2022Message integrity: TKIP adds a message integrity code (MIC) to the 802.11 MAC frame after the data field. The MIC is generated by an algorithm, calledMichael, that computes a 64-bit value using as input the source and destinationMAC address values and the Data field, plus key material. \u2022Data confidentiality: Data confidentiality is provided by encrypting the MPDU plus MIC value using RC4. The 256-bit TK (Figure 6.8) is employed as follows. Two 64-bit keys are used with the Michael message digest algorithm to produce a message integrity code."}, {"id": "453577afeca9bb94a5b92db0ef50bcc8a2de54e6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 210, "start_line": 11, "end_line": 15, "text": "One key is used to protect STA-to-AP messages, and the other key is used to protectAP-to-STA messages.The remaining 128 bits are truncated to generate the RC4 keyused to encrypt the transmitted data. For additional protection, a monotonically increasing TKIP sequence counter (TSC) is assigned to each frame. The TSC serves two purposes. First, the TSC isincluded with each MPDU and is protected by the MIC to protect against replayattacks. Second, the TSC is combined with the session TK to produce a dynamicencryption key that changes with each transmitted MPDU, thus making cryptanaly-sis more difficult. CCMP CCMP is intended for newer IEEE 802.11 devices that are equipped with the hardware to support this scheme. As with TKIP , CCMP provides two services:"}, {"id": "2a7f9cd98a2db673414eec9cb95853c0681da8b7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 210, "start_line": 16, "end_line": 22, "text": "\u2022Message integrity: CCMP uses the cipher-block-chaining message authentica- tion code (CBC-MAC), described in Chapter 3. \u2022Data confidentiality: CCMP uses the CTR block cipher mode of operation with AES for encryption. CTR is described in Chapter 2.The same 128-bit AES key is used for both integrity and confidentiality. The scheme uses a 48-bit packet number to construct a nonce to prevent replay attacks. The IEEE 802.11i Pseudorandom Function"}, {"id": "54226fd5a0d953ba920104c741586a01c4c40849", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 210, "start_line": 23, "end_line": 24, "text": "At a number of places in the IEEE 802.11i scheme, a pseudorandom function(PRF) is used. For example, it is used to generate nonces, to expand pairwise keys,and to generate the GTK. Best security practice dictates that different pseudoran-dom number streams be used for these different purposes. However, for implemen-tation efficiency, we would like to rely on a single pseudorandom numbergenerator function. The PRF is built on the use of HMAC-SHA-1 to generate a pseudorandom bit"}, {"id": "6dde917b5f525ce06bac90b3b763fcefcc336d19", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 210, "start_line": 25, "end_line": 25, "text": "stream. Recall that HMAC-SHA-1 takes a message (block of data) and a key oflength at least 160 bits and produces a 160-bit hash value. SHA-1 has the propertythat the change of a single bit of the input produces a new hash value with no appar-ent connection to the preceding hash value.This property is the basis for pseudoran-dom number generation."}, {"id": "7f424e840a32fd79dc3c5d0b768b00271a036636", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 211, "start_line": 1, "end_line": 18, "text": "196 CHAPTER 6 / WIRELESS NETWORK SECURITY The IEEE 802.11i PRF takes four parameters as input and produces the desired number of random bits.The function is of the form PRF( , , , Len), where = a secret key = a text string specific to the application (e.g., nonce generation or pair- wise key expansion) = some data specific to each case Len = desired number of pseudorandom bits For example, for the pairwise transient key for CCMP: PTK = PRF(PMK, \"Pairwise keyexpansion\",min(AP\u2013 Addr,STA\u2013Addr)| |max(AP\u2013Addr,STA\u2013Addr)| | min (Anonce,Snonce)| |max(Anonce,Snonce),384) So, in this case, the parameters are = PMK= the text string \"Pairwise key expansion \" = a sequence of bytes formed by concatenating the two MAC addresses and the two nonces Len = 384 bits Similarly, a nonce is generated by"}, {"id": "b4b5300bc36f7f61e20cdf6e2b4252ffd09372e8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 211, "start_line": 19, "end_line": 30, "text": "Nonce=PRF(RandomNumber,\"InitCounter\",MAC| |Time, 256) where Time is a measure of the network time known to the nonce generator. The group temporal key is generated by GTK = PRF(GMK,\"Groupkeyexpansion\", MAC| |Gnonce, 256) Figure 6.10 illustrates the function PRF( , , , Len). The parameter serves as the key input to HMAC. The message input consists of four items concatenated together: the parameter , a byte with value 0, the parameter , and a counter . Thecounter is initialized to 0.The HMAC algorithm is run once, producing a 160-bit hashvalue. If more bits are required, HMAC is run again with the same inputs, except that is incremented each time until the necessary number of bits is generated. We can express the logic as PRF( K, A, B, Len) R\u2039 - - null string"}, {"id": "638d9cb85c10127fecd4b8e30c480242813d78c8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 211, "start_line": 31, "end_line": 33, "text": "fori\u2039 - - 0 to((Len+ 159)/160 \u2013 1) do R\u2039 -- R| |HMAC\u2013SHA\u20131( K, A| |0 | |B| |i) ReturnTruncate\u2013to\u2013Len( R, Len)ii B AK B A KBAKBAKB A K"}, {"id": "c78832295a7d6f468584faefdb89632fe55ad36c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 212, "start_line": 1, "end_line": 7, "text": "6.3 / WIRELESS APPLICATION PROTOCOL OVERVIEW 197 6.3 WIRELESS APPLICATION PROTOCOL OVERVIEW The Wireless Application Protocol (WAP) is a universal, open standard developed by the WAP Forum to provide mobile users of wireless phones and other wirelessterminals such as pagers and personal digital assistants (PDAs) access to telephonyand information services, including the Internet and the Web. WAP is designed towork with all wireless network technologies (e.g., GSM, CDMA, and TDMA).WAPis based on existing Internet standards, such as IP , XML, HTML, and HTTP , as much as possible. It also includes security facilities. At the time of this writing, the current release of the WAP specification is version 2.0. Strongly affecting the use of mobile phones and terminals for data services are"}, {"id": "6d5133e364fa93608585d9d84515ff4195371bf0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 212, "start_line": 8, "end_line": 9, "text": "the significant limitations of the devices and the networks that connect them. Thedevices have limited processors, memory, and battery life. The user interface is alsolimited, and the displays small. The wireless networks are characterized by relativelylow bandwidth, high latency, and unpredictable availability and stability compared towired connections. Moreover, all of these features vary widely from terminal deviceto terminal device and from network to network. Finally, mobile, wireless users havedifferent expectations and needs from other information systems users. For instance,mobile terminals must be extremely easy to use \u2014 much easier than workstationsand personal computers. WAP is designed to deal with these challenges. The WAP specification includes:"}, {"id": "6596a6254a39e7c3b27db35a54aa13cb1ac8e3e7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 212, "start_line": 10, "end_line": 19, "text": "\u2022A programming model based on the WWW Programming Model \u2022A markup language, the Wireless Markup Language, adhering to XML \u2022A specification of a small browser suitable for a mobile, wireless terminal \u2022A lightweight communications protocol stack \u2022A framework for wireless telephony applications (WTAs) HMAC-SHA-1| | KA0Bi R = HMAC-SHA-1( K, A || 0 || B || i) + 1 Figure 6.10 IEEE 802.11i Pseudorandom Function"}, {"id": "d4518a321a004248a392a46a6596d3271971d97b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 213, "start_line": 1, "end_line": 5, "text": "198 CHAPTER 6 / WIRELESS NETWORK SECURITY Operational Overview The WAP Programming Model is based on three elements: the client, the gateway, and the original server (Figure 6.11). HTTP is used between the gateway and the original server to transfer content. The gateway acts as a proxy server for the wireless domain."}, {"id": "315ed6b2f17f0c951f1434047e6453a38c8c30b3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 213, "start_line": 6, "end_line": 7, "text": "Its processor(s) provide services that offload the limited capabilities of the hand-held,mobile, wireless terminals. For example, the gateway provides DNS services, convertsbetween WAP protocol stack and the WWW stack (HTTP and TCP/IP), encodesinformation from the Web into a more compact form that minimizes wireless commu-nication, and in the other direction, decodes the compacted form into standard Webcommunication conventions.The gateway also caches frequently requested information. Figure 6.12 illustrates key components in a WAP environment. Using WAP , a"}, {"id": "59c175c92d4909fb6a0438a5f7060b20b55b82da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 213, "start_line": 8, "end_line": 9, "text": "mobile user can browse Web content on an ordinary Web server. The Web serverprovides content in the form of HTML-coded pages that are transmitted using thestandard Web protocol stack (HTTP/TCP/IP). The HTML content must go throughan HTML filter, which either may be colocated with the WAP proxy or in a separatephysical module.The filter translates the HTML content into WML content. If the fil-ter is separate from the proxy, HTTP/TCP/IP is used to deliver the WML to the proxy.The proxy converts the WML to a more compact form known as binary WML anddelivers it to the mobile user over a wireless network using the WAP protocol stack. If the Web server is capable of directly generating WML content, then the"}, {"id": "28ad051ec9a11eff8e11b6982695d15d1c191dfa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 213, "start_line": 10, "end_line": 13, "text": "WML is delivered using HTTP/TCP/IP to the proxy, which converts the WML tobinary WML and then delivers it to the mobile node using WAP protocols. The WAP architecture is designed to cope with the two principal limitations of wireless Web access: the limitations of the mobile node (small screen size, limitedinput capability) and the low data rates of wireless digital networks. Even with theintroduction of 3G wireless networks, which provide broadband data rates, the smallhand-held mobile nodes continue to have limited input and display capabilities.Thus, WAP or a similar capability will be needed for the indefinite future. Wireless Markup Language"}, {"id": "d67ce520a1be2297e147e37fc4d21924b416dc74", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 213, "start_line": 14, "end_line": 24, "text": "WML was designed to describe content and format for presenting data on devices withlimited bandwidth, limited screen size, and limited user input capability. It is designed towork with telephone keypads, styluses, and other input devices common to mobile,wireless communication. WML permits the scaling of displays for use on two-linescreens found in some small devices, as well as the larger screens found on smart phones. WAE User AgentEncoders and DecodersCGI Scripts etc.Encoded requestsClient Gateway Original Server Requests Response (content) Encoded response Content Figure 6.11 The WAP Programming Model"}, {"id": "80867b58df6b76a40c8ed681fed91ad739b4a617", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 214, "start_line": 1, "end_line": 21, "text": "6.3 / WIRELESS APPLICATION PROTOCOL OVERVIEW 199 Ordinary Web serverHTML over HTTP/TCP/IP WML over HTTP/TCP/IPWML-capableWeb server MobileterminalHTML filter WAP proxyInternet Wireless Network Wireless palmtopWML over HTTP/TCP/IP Binary WML over WAPBinary WML over WAP Figure 6.12 WAP Infrastructure For an ordinary PC, a Web browser provides content in the form of Web pages coded with the Hypertext Markup Language (HTML). To translate an HTML-coded Web page into WML with content and format suitable for wireless devices,much of the information, especially graphics and animation, must be stripped away.WML presents mainly text-based information that attempts to capture the essenceof the Web page and that is organized for easy access for users of mobile devices."}, {"id": "e2f90ff8a2904f1fbd57c140cf059bf82ec0dc85", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 214, "start_line": 22, "end_line": 27, "text": "Important features of WML include: \u2022Text and image support: Formatting and layout commands are provided for text and limited image capability. \u2022Deck/card organizational metaphor: WML documents are subdivided into small, well-defined units of user interaction called cards. Users navigate by moving back and forth between cards. A card specifies one or more units ofinteraction (a menu, a screen of text, or a text-entry field). A WML deck issimilar to an HTML page in that it is identified by a Web address (URL) andis the unit of content transmission."}, {"id": "9cd90471cb66cfd3de700a6cd8e955dcadbad5f6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 215, "start_line": 1, "end_line": 7, "text": "200 CHAPTER 6 / WIRELESS NETWORK SECURITY \u2022Support for navigation among cards and decks: WML includes provisions for event handling, which is used for navigation or executing scripts. In an HTML-based Web browser, a user navigates by clicking on links. At a WML-capable mobile device, a user interacts with cards, moving forward and back through the deck. WAP Architecture"}, {"id": "16fb3e9eede6d4999a942ede0615c32b12591621", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 215, "start_line": 8, "end_line": 17, "text": "Figure 6.13, from the WAP architecture document, illustrates the overall stack archi-tecture implemented in a WAP client. In essence, this is a five-layer model. Eachlayer provides a set of functions and/or services to other services and applicationsthrough a set of well-defined interfaces. Each of the layers of the architecture isaccessible by the layers above, as well as by other services and applications. Many ofthe services in the stack may be provided by more than one protocol. For example,either HTTP or WSP may provide the Hypermedia Transfer service. Common to all five layers are sets of services that are accessible by multiple layers. These common services fall into two categories: security services and servicediscovery. Service DiscoverySecurity Crypto libraries Auth. Identity PKI"}, {"id": "55798c81e39735866e25b6c7e9e249d241d8f326", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 215, "start_line": 18, "end_line": 44, "text": "Secure transport Secure bearerEFI Pro- visioning Navigation Discovery Service lookupPushContent Formats WEA/WTA user agent(s)Multimedia messaging Push-OTASynchronisation CookiesCapability negotiationSession ServicesApplication FrameworkProtocol Framework IPv6IPv4 MPAKSOS ReFLEXFLEX GUTSGHOST USSDSMSBearer NetworksDatagramsTransport ServicesHypermedia transferStreamingMessage transferTransfer Services Connections Figure 6.13 WAP Architecture"}, {"id": "ddc4e7fe909d5ad820a959fe41c8ffa490419c3a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 216, "start_line": 1, "end_line": 9, "text": "6.3 / WIRELESS APPLICATION PROTOCOL OVERVIEW 201 SECURITY SERVICES The WAP specification includes mechanisms to provide confidentiality, integrity, authentication, and nonrepudiation. The security services include the following. \u2022Cryptographic libraries: This application framework level library provides ser- vices for signing of data for integrity and non-repudiation purposes. \u2022Authentication: WAP provides various mechanisms for client and server authentication. At the Session Services layer, HTTP Client Authentication(RFC2617) may be used to authenticate clients to proxies and applicationservers. At the Transport Services layer, WTLS and TLS handshakes may beused to authenticate clients and servers. \u2022Identity: The WAP Identity Module (WIM) provides the functions"}, {"id": "e3f0961caba8aab9078db8fba8481fbf8d292b08", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 216, "start_line": 10, "end_line": 18, "text": "that store and process information needed for user identification andauthentication. \u2022PKI: The set of security services that enable the use and management of public-key cryptography and certificates. \u2022Secure transport: The Transport Services layer protocols are defined for secure transport over datagrams and connections. WTLS is defined for securetransport over datagrams and TLS is defined for secure transport overconnections (i.e., TCP). \u2022Secure bearer: Some bearer networks provide bearer-level security. For example, IP networks (especially in the context of IPv6) provide bearer-levelsecurity with IPsec. S ERVICE DISCOVERY There is a collection of service discovery services that enable"}, {"id": "aeedc882311dccfdb7b6d6a7de82865bff1527b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 216, "start_line": 19, "end_line": 25, "text": "the WAP client and the Web server to determine capabilities and services. Examplesof service discovery services include the following. \u2022EFI: The External Functionality Interface (EFI) allows applications to discover what external functions/services are available on the device. \u2022Provisioning: This service allows a device to be provisioned with the parame- ters necessary to access network services. \u2022Navigation discovery: This service allows a device to discover new network services (e.g., secure pull proxies) during the course of navigation such aswhen downloading resources from a hypermedia server. The WAP Transport-Level End-to-End Security specification, described in Section 6.5, defines onenavigation discovery protocol."}, {"id": "b115ecaa95b92ee3dae60ecd3d52f80b93635e84", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 216, "start_line": 26, "end_line": 29, "text": "\u2022Service lookup: This service provides for the discovery of a service\u2019s parame- ters through a directory lookup by name. One example of this is the DomainName System (DNS). Wireless Application Environment The WAE specifies an application framework for wireless devices such as mobiletelephones, pagers, and PDAs. In essence, the WAE consists of tools and formats"}, {"id": "5046eced3b5cf3bc95f05ce3c4b478a5c2fc19c9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 217, "start_line": 1, "end_line": 8, "text": "202 CHAPTER 6 / WIRELESS NETWORK SECURITY that are intended to ease the task of developing applications and devices supported by WAP . The major elements of the WAE model (Figure 6.13) are \u2022WAE user agents: Software that executes in the user\u2019s wireless device and that provides specific functionality (e.g., display content) to the end user. \u2022Wireless telephony applications (WTA): A collection of telephony-specific extensions for call and feature control mechanisms that provide authorsadvanced mobile network services. Using WTA, applications developers canuse the microbrowser to originate telephone calls and to respond to eventsfrom the telephone network. \u2022Standard content encoding: Defined to allow a WAE user agent (e.g., a"}, {"id": "3d574581217e09da84779246c63ff3c10576e869", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 217, "start_line": 9, "end_line": 12, "text": "browser) to conveniently navigate Web content. On the server side are contentgenerators. These are applications (or services) on origin servers (e.g., CGIscripts) that produce standard content formats in response to requests fromuser agents in the mobile terminal. WAE does not specify any standardcontent generators but expects that there will be a variety available runningon typical HTTP origin servers commonly used in WWW today. \u2022Push: A service to receive push transmissions from the server, i.e., transmis- sions that are not in response to a Web client request but are sent on theinitiative of the server. This service is supported by the Push-OTA (Push OverThe Air) session service. \u2022Multimedia messaging: Provides for the transfer and processing of multimedia"}, {"id": "78590b7e64bc44403c7e35c0466ae321d4ddfc1c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 217, "start_line": 13, "end_line": 17, "text": "messages, such as e-mail and instant messages, to WAP devices. WAP Protocol Architecture The WAP architecture illustrated in Figure 6.13 dictates a collection of services ateach level and provides interface specifications at the boundary between each pairof layers. Because several of the services in the WAP stack can be provided usingdifferent protocols based on the circumstances, there are more than one possiblestack configurations. Figure 6.14 depicts a common protocol stack configuration inwhich a WAP client device connects to a Web server via a WAP gateway. This con-figuration is common with devices that implement version 1 of the WAP specifica-tion but is also used in version 2 devices (WAP2) if the bearer network does notsupport TCP/IP . BearerWDPWTLSWTPWSP IPTCPTLSHTTPWAP Gateway"}, {"id": "94084868fea916af70da8639f79ce1d6f5534a6c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 217, "start_line": 18, "end_line": 21, "text": "BearerWDPWTLSWTPWSPWAEWAP Device IPTCPTLSWAEWeb Server HTTP Figure 6.14 WTP 1.x Gateway"}, {"id": "69c9439ce2a06ffe5258fa98d583362409be49a7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 218, "start_line": 1, "end_line": 7, "text": "6.3 / WIRELESS APPLICATION PROTOCOL OVERVIEW 203 In the remainder of this subsection, we provide an overview of the WAP protocols, with the exception of WTLS, which is treated in Section 6.4. WIRELESS SESSION PROTOCOL WSP provides applications with an interface for two session services.The connection-oriented session service operates above WTP , and the connectionless session service operates above the unreliable transport protocol WDP .In essence,WSP is based on HTTP with some additions and modifications to optimizeits use over wireless channels. The principal limitations addressed are low data rateand susceptibility to loss of connection due to poor coverage or cell overloading. WSP is a transaction-oriented protocol based on the concept of a request and"}, {"id": "e84b0bee79f1c436e9e99e988be0eb4465708a15", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 218, "start_line": 8, "end_line": 11, "text": "a reply. Each WSP protocol data unit (PDU) consists of a body, which may containWML, WMLScript, or images; and a header, which contains information about thedata in the body and about the transaction. WSP also defines a server push opera-tion, in which the server sends unrequested content to a client device. This may beused for broadcast messages or for services, such as news headlines or stock quotes,that may be tailored to each client device. W IRELESS TRANSACTION PROTOCOL WTP manages transactions by conveying requests and responses between a user agent (such as a WAP browser) and an"}, {"id": "837e53828a3187ed7dacd59074857d7a88f345d8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 218, "start_line": 12, "end_line": 18, "text": "application server for such activities as browsing and e-commerce transactions.WTP provides a reliable transport service but dispenses with much of the overheadof TCP , resulting in a lightweight protocol that is suitable for implementation in\u201cthin\u201d clients (e.g., mobile nodes) and suitable for use over low-bandwidth wirelesslinks. WTP includes the following features. \u2022Three classes of transaction service. \u2022Optional user-to-user reliability: WTP user triggers the confirmation of eachreceived message. \u2022Optional out-of-band data on acknowledgments. \u2022PDU concatenation and delayed acknowledgment to reduce the number ofmessages sent. \u2022Asynchronous transactions. WTP is transaction oriented rather than connection oriented.With WTP , there is"}, {"id": "7b37251c60ab7c9bcfb0b69c7e907766833855c2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 218, "start_line": 19, "end_line": 27, "text": "no explicit connection setup or teardown but rather a reliable connectionless service. WTP provides three transaction classes that may be invoked by WSP or another higher layer protocol: \u2022Class 0: Unreliable invoke message with no result message \u2022Class 1: Reliable invoke message with no result message \u2022Class 2: Unreliable invoke message with one reliable result message Class 0 provides an unreliable datagram service, which can be used for an unre- liable push operation. Data from a WTP user are encapsulated by WTP (the initiator, or client) in an invoke PDU and transmitted to the target WTP (the responder, orserver) with no acknowledgment. The responder WTP delivers the data to the targetWTP user."}, {"id": "5284e5eb7d1100034db178edfc53142c07d089ec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 219, "start_line": 1, "end_line": 5, "text": "204 CHAPTER 6 / WIRELESS NETWORK SECURITY Class 1 provides a reliable datagram service, which can be used for a reliable push operation. Data from an initiator are encapsulated in an invoke PDU and transmitted to the responder. The responder delivers the data to the target WTPuser and acknowledges receipt of the data by sending back an ACK PDU to theWTP entity on the initiator side, which confirms the transaction to the source WTPuser. The responder WTP maintains state information for some time after the ACKhas been sent to handle possible retransmission of the ACK if it gets lost and/or theinitiator retransmits the invoke PDU. Class 2 provides a request/response transaction service and supports the execu-"}, {"id": "3d8a464913da60f947d4cbb823f21441801c751d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 219, "start_line": 6, "end_line": 9, "text": "tion of multiple transactions during one WSP session. Data from an initiator areencapsulated in an invoke PDU and transmitted to the responder, which deliversthe data to the target WTP user. The target WTP user prepares response data, whichare handed down to the local WTP entity. The responder WTP entity sends these databack in a result PDU. If there is a delay in generating the response data beyond a timerthreshold, the responder may send an ACK PDU before sending the result PDU. Thisprevents the initiator from unnecessarily retransmitting the invoke message. W IRELESS DATAGRAM PROTOCOL WDP is used to adapt a higher-layer WAP protocol to the communication mechanism (called the bearer) used between the"}, {"id": "3e328d5e2b40847f719ec80e6e02d3666987c31e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 219, "start_line": 10, "end_line": 13, "text": "mobile node and the WAP gateway. Adaptation may include partitioning data intosegments of appropriate size for the bearer and interfacing with the bearer network.WDP hides details of the various bearer networks from the other layers of WAP . Insome instances, WAP is implemented on top of IP . 6.4 WIRELESS TRANSPORT LAYER SECURITY WTLS provides security services between the mobile device (client) and the WAPgateway. WTLS is based on the industry-standard Transport Layer Security (TLS)Protocol, 3which is a refinement of the Secure Sockets Layer (SSL) protocol. TLS is"}, {"id": "efa724d99ccbda31a8dd6beba5a857261b11ad29", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 219, "start_line": 14, "end_line": 19, "text": "the standard security protocol used between Web browsers and Web servers. WTLSis more efficient that TLS, requiring fewer message exchanges. To provide end-to-end security, WTLS is used between the client and the gateway, and TLS is usedbetween the gateway and the target server (Figure 6.14). WAP systems translatebetween WTLS and TLS within the WAP gateway. Thus, the gateway is a point ofvulnerability and must be given a high level of security from external attacks. WTLS provides the following features. \u2022Data integrity: Uses message authentication to ensure that data sent between the client and the gateway are not modified. \u2022Privacy: Uses encryption to ensure that the data cannot be read by a third party. \u2022Authentication: Uses digital certificates to authenticate the two parties."}, {"id": "8e1e3497e4353db50ade1b2ccaee8e56b7300900", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 219, "start_line": 20, "end_line": 23, "text": "\u2022Denial-of-service protection: Detects and rejects messages that are replayed or not successfully verified. 3See Chapter 5 for a discussion of SSL/TLS. However, the discussion in this section is self-contained; you do not need to read a description of TLS first."}, {"id": "59dbce2ab126daf6ad918c369159ea8245af4267", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 220, "start_line": 1, "end_line": 8, "text": "6.4 / WIRELESS TRANSPORT LAYER SECURITY 205 WTLS Sessions and Connections Two important WTLS concepts are the secure session and the secure connection, which are defined in the specification as: \u2022Secure connection: A connection is a transport (in the OSI layering model def- inition) that provides a suitable type of service. For SSL, such connections arepeer-to-peer relationships. The connections are transient. Every connection isassociated with one session. \u2022Secure session: An SSL session is an association between a client and a server. Sessions are created by the Handshake Protocol. Sessions define a set of cryp-tographic security parameters, which can be shared among multiple connec-tions. Sessions are used to avoid the expensive negotiation of new securityparameters for each connection."}, {"id": "a6f844f311f07bc86ece13db79d06e758e1ee3f6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 220, "start_line": 9, "end_line": 16, "text": "Between any pair of parties (applications such as HTTP on client and server), there may be multiple secure connections. In theory, there may also be multiple simultaneous sessions between parties, but this feature is not used in practice. There are a number of states associated with each session. Once a session is established, there is a current operating state for both read and write (i.e., receiveand send). In addition, during the Handshake Protocol, pending read and writestates are created. Upon successful conclusion of the Handshake Protocol, thepending states become the current states. A session state is defined by the following parameters: \u2022Session identifier: An arbitrary byte sequence chosen by the server to identify an active or resumable session state."}, {"id": "5ddbc53a5b363fcd3c1d81875b1954f45f4242c5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 220, "start_line": 17, "end_line": 27, "text": "\u2022Protocol version: WTLS protocol version number. \u2022Peer certificate: Certificate of the peer. This element of the state may be null. \u2022Compression method: The algorithm used to compress data prior to encryption. \u2022Cipher spec: Specifies the bulk data encryption algorithm (such as null, RC5, DES, etc.) and a hash algorithm (such as MD5 or SHA-1) used forMAC calculation. It also defines cryptographic attributes such as thehash_size. \u2022Master secret: A 20-byte secret shared between the client and server. \u2022Sequence number: Which sequence numbering scheme (off, implicit, or explicit) is used in this secure connection. \u2022Key refresh: Defines how often some connection state values (encryption key, MAC secret, and IV) calculations are performed."}, {"id": "01c1e58a18bdd55c8460c36e06fd8afa3c383f2f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 220, "start_line": 28, "end_line": 32, "text": "\u2022Is resumable: A flag indicating whether the session can be used to initiate new connections. The connection state is the operating environment of the record protocol. It includes all parameters that are needed for the cryptographic operations (encryp- tion/decryption and MAC calculation/verification). Each secure connection has aconnection state, which is defined by the following parameters."}, {"id": "b88599bf4f17eabe54d74543f24975e28dd2b304", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 221, "start_line": 1, "end_line": 13, "text": "206 CHAPTER 6 / WIRELESS NETWORK SECURITY \u2022Connection end: Whether this entity is considered a client or a server in this secure session. \u2022Bulk cipher algorithm: Includes the key size of this algorithm, how much of that key is secret, whether it is a block or stream cipher, and the block size of the cipher (if appropriate). \u2022MAC algorithm: Includes the size of the key used for MAC calculation and the size of the hash which is returned by the MAC algorithm. \u2022Compression algorithm: Includes all information the algorithm requires to do compression. \u2022Master secret: A 20-byte secret shared between the client and server. \u2022Client random: A 16-byte value provided by the client. \u2022Server random: A 16-byte value provided by the server."}, {"id": "61d10f4d1a6b4bd87e31c2022a3d8e942f60c7a2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 221, "start_line": 14, "end_line": 19, "text": "\u2022Sequence number mode: Which scheme is used to communicate sequence numbers in this secure connection. \u2022Key refresh: Defines how often some connection state parameters (encryption key, MAC secret, and IV) are updated. New keys are calculated at every messages, that is, when the sequence number is 0, , , etc. WTLS Protocol Architecture"}, {"id": "7fa32e65136d927875610fb7fd72bd0e831eb285", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 221, "start_line": 20, "end_line": 23, "text": "WTLS is not a single protocol but rather two layers of protocols, as illustrated inFigure 6.15. The WTLS Record Protocol provides basic security services to varioushigher-layer protocols. In particular, the Hypertext Transfer Protocol (HTTP),which provides the transfer service for Web client/server interaction, can operate ontop of WTLS. Three higher-layer protocols are defined as part of WTLS: theHandshake Protocol, The Change Cipher Spec Protocol, and the Alert Protocol.These WTLS-specific protocols are used in the management of WTLS exchangesand are examined subsequently in this section. WTLS R ECORD PROTOCOL The WTLS Record Protocol takes user data from the next higher layer (WTP , WTLS Handshake Protocol, WTLS Alert Protocol, and"}, {"id": "8306c25081f0784ea77bfe0be3ba5644de443cb5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 221, "start_line": 24, "end_line": 32, "text": "WTLS Change Cipher Spec Protocol) and encapsulates these data in a PDU. Thefollowing steps occur (Figure 6.16).3 n2nn=2key_refresh WDP or UDP/IPWTLS Record ProtocolWTLS Handshake ProtocolWTLS Change Cipher Spec ProtocolWTLS Alert ProtocolWTP Figure 6.15 WTLS Protocol Stack"}, {"id": "85a5bc791a43086148e782a5e255cf6a1bc02321", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 222, "start_line": 1, "end_line": 8, "text": "6.4 / WIRELESS TRANSPORT LAYER SECURITY 207 Step 1. The payload is compressed using a lossless compression algorithm. Step 2. A message authentication code (MAC) is computed over the compressed data, using HMAC. One of several hash algorithms can be used with HMAC,including MD-5 and SHA-1. The length of the hash code is 0, 5, or 10 bytes.The MAC is added after the compressed data. Step 3. The compressed message plus the MAC code are encrypted using a symmetricencryption algorithm. The allowable encryption algorithms are DES, tripleDES, RC5, and IDEA. Step 4. The Record Protocol prepends a header to the encrypted payload. The Record Protocol header consists of the following fields (Figure 6.17). \u2022Record type (8 bits): Consisting of the subfields:"}, {"id": "183d5e62fcfb36794318c26f6036085cd99d947d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 222, "start_line": 9, "end_line": 22, "text": "\u2013Record length field indicator (1 bit): Indicates whether a record length field is present. \u2013Sequence number field indicator (1 bit): Indicates whether a sequence number field is present. \u2013Cipher spec indicator (1 bit): If this bit is zero, it indicates that no compression, MAC protection, or encryption is used. \u2013Content type (4 bits): The higher-layer protocol above the WTLS Record Protocol. \u2022Sequence number (16 bits): A sequence number associated with this record. This provides reliability over an unreliable transport service. \u2022Record length (16 bits):The length in bytes of the plaintext data (or compressed data if compression is used). C HANGE CIPHER SPECPROTOCOL Associated with the current transaction is a"}, {"id": "333a6e4b2cff50bfce5e045e39155d7bded55c6b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 222, "start_line": 23, "end_line": 27, "text": "cipher spec, which specifies the encryption algorithm, the hash algorithm used asUser Data CompressAdd MACEncrypt Append WTLS Record Header Figure 6.16 WTLS Record Protocol Operation"}, {"id": "10dba7176604c196ce03a66ef7cd58fcd978e5e4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 223, "start_line": 1, "end_line": 4, "text": "208 CHAPTER 6 / WIRELESS NETWORK SECURITY part of HMAC, and cryptographic attributes, such as MAC code size. There are two states associated with each session. Once a session is established, there is acurrent operating state for both read and write (i.e., receive and send). In addition,during the Handshake Protocol, pending read and write states are created. The Change Cipher Spec Protocol is one of the three WTLS-specific protocols"}, {"id": "2aa39432053f0ce5d5d5d3847f41d45627eace02", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 223, "start_line": 5, "end_line": 8, "text": "that use the WTLS Record Protocol, and it is the simplest. This protocol consists ofa single message, which consists of a single byte with the value 1.The sole purpose ofthis message is to cause the pending state to be copied into the current state, whichupdates the cipher suite to be used on this connection. Thus, when the ChangeCipher Spec message arrives, the sender of the message sets the current write stateto the pending state and the receiver sets the current read state to the pending state. A LERT PROTOCOL The Alert Protocol is used to convey WTLS-related alerts to the peer entity. As with other applications that use WTLS, alert messages are"}, {"id": "389f404783e571030cde1cb360e4252caa78aa90", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 223, "start_line": 9, "end_line": 18, "text": "compressed and encrypted, as specified by the current state.r = reservedC = cipher spec indicatorS = sequence number field indicatorL = record length field indicator MAC = message authentication codeContent type Sequence number Record lengthr C S L Plaintext (optionally compressed) MAC (0, 16, or 20 bytes)Encrypted Scope of MAC Figure 6.17 WTLS Record Format"}, {"id": "21dafb9139a3fcc9e7011da8fe7834b20198dfce", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 224, "start_line": 1, "end_line": 5, "text": "6.4 / WIRELESS TRANSPORT LAYER SECURITY 209 Each message in this protocol consists of 2 bytes. The first byte takes the value warning(1), critical(2), or fatal(3) to convey the severity of the message. The second byte contains a code that indicates the specific alert. If the level is fatal, WTLSimmediately terminates the connection. Other connections on the same session maycontinue, but no new connections on this session may be established. A critical alertmessage results in termination of the current secure connection. Other connectionsusing the secure session may continue and the secure identifier may also be used forestablishing new secure connections. The connection is closed using the alert messages. Either party may initiate the"}, {"id": "c9a8aca8bb984e83c45adf3e5d82cd376f148edb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 224, "start_line": 6, "end_line": 14, "text": "exchange of the closing messages. If a closing message is received, then any data afterthis message is ignored. It is also required that the notified party verifies terminationof the session by responding to the closing message. Error handling in the WTLS is based on the alert messages. When an error is detected, the detecting party sends an alert message containing the occurred error.Further procedures depend on the level of the error that occurred. Examples of fatal alerts: \u2022session_close_notify: notifies the recipient that the sender will not send any more messages using this connection state or the securesession. \u2022unexpected_message: An inappropriate message was received. \u2022bad_record_mac: An incorrect MAC was received. \u2022decompression_failure: The decompression function received"}, {"id": "6f49f27be1a5b6cbbf6fe335f5cd7f2a96245320", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 224, "start_line": 15, "end_line": 28, "text": "improper input (e.g., unable to decompress or decompress to greater thanmaximum allowable length). \u2022handshake_failure: Sender was unable to negotiate an acceptable set of security parameters given the options available. \u2022illegal_parameter: A field in a handshake message was out of range or inconsistent with other fields. Examples of nonfatal alerts: \u2022connection_close_notify: Notifies the recipient that the sender will not send any more messages using this connection state. \u2022bad_certificate: A received certificate was corrupt (e.g., contained a sig- nature that did not verify). \u2022unsupported_certificate: The type of the received certificate is not supported. \u2022certificate_revoked: A certificate has been revoked by its signer. \u2022certificate_expired: A certificate has expired."}, {"id": "9bbc176f333e302827713a11d57c07ce829daace", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 224, "start_line": 29, "end_line": 34, "text": "\u2022certificate_unknown: Some other unspecified issue arose in processing the certificate, rendering it unacceptable. H ANDSHAKE PROTOCOL The most complex part of WTLS is the Handshake Protocol. This protocol allows the server and client to authenticate each other and to negotiate an encryption and MAC algorithms and cryptographic keys to be"}, {"id": "dd2065e1b0f71a3fdb1ebabfa6f6eff593897201", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 225, "start_line": 1, "end_line": 16, "text": "210 CHAPTER 6 / WIRELESS NETWORK SECURITY used to protect data sent in a WTLS record. The Handshake Protocol is used before any application data are transmitted. An important function of theHandshake Protocol is the generation of a pre-master secret, which in turn is usedto generate a master secret. The master secret is then used to generate variouscryptographic keys. The Handshake Protocol consists of a series of messages exchanged by client and server. Figure 6.18 shows the initial exchange needed to establish a logical server_key_exchangeClient ServerTimeclient_hello certificate client_key_exchange certificate_verify change_cipher_spec finishedserver_hello certificate certificate_request server_hello_done change_cipher_spec finishedEstablish security capabilities, including"}, {"id": "c1e2e41413b45bf9b4cbf5b8956ced955f39262a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 225, "start_line": 17, "end_line": 29, "text": "protocol version, session ID, cipher suite, compression method, and initial random numbers. Server may send certif icate, key exchange, and request certif icate. Server signals end of hello message phase. Client sends certif icate if requested. Client sends key exchange. Client may sendcertif icate verif ication. Change cipher suite and f inish handshake protocol. Note: Shaded transfers areoptional or situation-dependent messages that are not always sent. Figure 6.18 WTLS Handshake Protocol Action"}, {"id": "76c3dcf6abc7f15be96aab8774a6d8f1bdb733d9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 226, "start_line": 1, "end_line": 8, "text": "6.4 / WIRELESS TRANSPORT LAYER SECURITY 211 connection between client and server. The exchange can be viewed as having four phases. The first phase is used to initiate a logical connection and to establish the security capabilities that will be associated with it. The exchange is initiated by theclient. The client sends a client_hello message that includes a session ID and a list of cryptographic and compression algorithms supported by the client (indecreasing order of preference for each algorithm type). After sending theclient_hello message, the client waits for the server_hello message. This message indicates which cryptographic and compression algorithms will be usedfor the exchange. The second phase is used for server authentication and key exchange. The"}, {"id": "9b7f1da64fc0ad46125129f0c0c87ccfebc167a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 226, "start_line": 9, "end_line": 14, "text": "server begins this phase by sending its public-key certificate if it needs to beauthenticated. Next, a server_key_exchange message may be sent if it is required. This message is needed for certain public-key algorithms used forsymmetric key exchange. Next, the server can request a public-key certificate fromthe client, using the certificate_request message. The final message in phase 2 (and one that is always required) is the server_hello_done message, which is sent by the server to indicate the end of the server hello and associated messages.After sending this message, the server will wait for a client response. This messagehas no parameters. The third phase is used for client authentication and key exchange. Upon receipt of the server_hello_done message, the client should verify that the"}, {"id": "5d7d25eab66ba9299c11f22593ed7153eea224ff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 226, "start_line": 15, "end_line": 19, "text": "server provided a valid certificate if required and check that the server_helloparameters are acceptable. If all is satisfactory, the client sends one or more mes-sages back to the server. If the server has requested a certificate, the client sends acertificate message. Next is the client_key_exchange message, which must be sent in this phase. The content of the message depends on the type of key exchange.Finally, in this phase, the client may send a certificate_verify message to pro- vide explicit verification of a client certificate. The fourth phase completes the setting up of a secure connection. The client sends a change_cipher_spec message and copies the pending CipherSpec"}, {"id": "cf16c8c1bd3a96bbb19faa70752b74673a75a8d2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 226, "start_line": 20, "end_line": 23, "text": "into the current CipherSpec. Note that this message is not considered part of theHandshake Protocol but is sent using the Change Cipher Spec Protocol. Theclient then immediately sends the finished message under the new algorithms,keys, and secrets. The finished message verifies that the key exchange andauthentication processes were successful. In response to these two messages, theserver sends its own change_cipher_spec message, transfers the pending to the current CipherSpec, and sends its finished message. At this point, the hand-shake is complete, and the client and server may begin to exchange applicationlayer data. Cryptographic Algorithms AUTHENTICATION Authentication in the WTLS is carried out with certificates."}, {"id": "214150178b8855f4bf092e92c09dc30bc9a38139", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 226, "start_line": 24, "end_line": 24, "text": "Authentication can occur either between the client and the server or when the clientonly authenticates the server. The latter procedure can happen only if the serverallows it to occur. The server can require the client to authenticate itself to the server."}, {"id": "c5da23273d364fddd37119036e1c98f9b4de5a72", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 227, "start_line": 1, "end_line": 10, "text": "212 CHAPTER 6 / WIRELESS NETWORK SECURITY However, the WTLS specification defines that authentication is an optional procedure. Currently, X.509v3, X9.68, and WTLS certificates are supported. TheWTLS certificate is optimized for size, and consists of the following elements(compare with Figure 4.4). \u2022Certificate_version: Version of the certificate. \u2022Signature_algorithm: Algorithm used to sign the certificate. \u2022Issuer: Defines the party who has signed the certificate, usually some CA. \u2022Valid_not_before: The beginning of validity period of the certificate. \u2022Valid_not_after: The point of time after the certificate is no longer valid. \u2022Subject: Owner of the key, associated with the public key being certified. \u2022Public_key_type: Type (algorithm) of the public key."}, {"id": "a7741a86c1952164ce7a52b04394c352ae21d37b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 227, "start_line": 11, "end_line": 18, "text": "\u2022Parameter_specifier: Specifies parameter relevant for the public key. \u2022Public key: The public key being certified. \u2022Signature: Signed with the CA\u2019s private key. K EYEXCHANGE The purpose of the WTLS protocol is for the client and server to generate a mutually shared pre-master key. This key is then used to generate asmaster key, as explained subsequently. A number of key exchange protocols aresupported by WTLS. They can be grouped into those protocols that includeaserver_key_exchange message as part of the Handshake Protocol (Figure 6.18) and those that don\u2019t. The server_key_exchange message is sent by the server only when the"}, {"id": "0a27dc963e379752a8b29a5ac43b7b0765597a1b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 227, "start_line": 19, "end_line": 24, "text": "server certificate message (if sent) does not contain enough data to allow the clientto exchange a pre-master secret. The following three methods require the use of theserver_key_exchange message. \u2022DH_anon: The conventional Diffie-Hellman computation is performed anonymously (without authentication). The negotiated key (Z) is used as thepre_master_secret. \u2022ECDH_anon: The elliptic curve Diffie-Hellman computation is performed. The negotiated key (Z) is used as the pre_master_secret . \u2022RSA_anon: This is an RSA key exchange without authentication. The server"}, {"id": "99d1e4f676a0876489981a1438fb897256122634", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 227, "start_line": 25, "end_line": 31, "text": "sends its RSA public key. In this method, a 20-byte secret value is generatedby the client, encrypted under the server\u2019s public key, and sent to theserver. The server uses its private key to decrypt the secret value. Thepre_master_secret is the secret value appended with the server\u2019s public key. The server key exchange message is not sent for the following key exchange methods. \u2022ECDH_ECDSA: Elliptic curve Diffie-Hellman key exchange with ECDSA- based certificates. The server sends a certificate that contains its ECDH public key. The server certificate is signed with ECDSA by a third party"}, {"id": "4f87968527ba052a9c225e7a7bc5547df2d2ad9e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 228, "start_line": 1, "end_line": 4, "text": "6.4 / WIRELESS TRANSPORT LAYER SECURITY 213 trusted by the client. Depending whether the client is to be authenticated or not, it sends its certificate containing its ECDH public key signed withECDSA by a third party trusted by the server or just its (temporary) ECDHpublic key. Each party calculates the pre-master secret based on one\u2019s ownprivate key and counterpart\u2019s public key received as such or contained in acertificate. \u2022RSA: RSA key exchange with RSA-based certificates. The server sends a"}, {"id": "49a753928b1c2ea8766f2db87939bcc86b3eba61", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 228, "start_line": 5, "end_line": 7, "text": "certificate that contains its RSA public key. The server certificate is signedwith RSA by a third party trusted by the client. The client extracts theserver\u2019s public key from the received certificate, generates a secret value,encrypts it with the server\u2019s public key, and sends it to the server. The pre-master secret is the secret value appended with the server\u2019s public key. If theclient is to be authenticated, it signs some data (messages sent during thehandshake) with its RSA private key and sends its certificate and the signeddata. P SEUDORANDOM FUNCTION (PRF) The PRF is used for a number of purposes in"}, {"id": "60514b854ac89ad7fe77af7e56c23775785e98b0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 228, "start_line": 8, "end_line": 18, "text": "WTLS. The PRF takes as input a secret value, a seed, and an identifying label andproduces an output of arbitrary length. In the TLS standard, two hash algorithmswere used in order to make the PRF as secure as possible. In order to saveresources, WTLS can be implemented using only one hash algorithm. Which hashalgorithm is actually used is agreed on during the handshake as a part of thecipher spec. The PRF is based on the data expansion function P_hash(secret, seed) = HMAC_hash(secret,A(1)| |seed)| | HMAC_hash(secret,A(2)| |seed)| | HMAC_hash(secret,A(3)| |seed)||... where| |indicates concatenation and A() is defined as A(0) = seed A( i) = HMAC_hash(secret, A( i\u2013 1)) Then, PRF(secret, label, seed) = P_hash(secret, label| |seed)"}, {"id": "c872ca9938136a892c05fdf36c26b4594c8e3879", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 228, "start_line": 19, "end_line": 22, "text": "MASTER KEYGENERATION The shared master secret is a one-time 20-byte value (160 bits) generated for this session by means of secure key exchange.The creation is in two stages. First, a pre_master_secret is exchanged. Second, the master_secret is calculated by both parties, using the function"}, {"id": "31ca2a7fe1da7d05e0c5965613c8b2fd8ae08313", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 229, "start_line": 1, "end_line": 22, "text": "214 CHAPTER 6 / WIRELESS NETWORK SECURITY Wireless network WAP deviceWAP gatewayWeb serverWired IP network WTLS protection domain TLS protection domain Figure 6.19 Security Zones Using Standard Security ServicesAlgorithm Key Size (bits) RC5 40, 56, 64, 128 DES 192 3DES 40 IDEA 40, 56master_secret = PRF(pre_master_secret, \"master secret\", ClientHello.random | | ServerHello.random) where ClientHello.random and ServerHello.random are the random numbers exchanged during the first phase of the handshake protocol. The MAC and encryption keys are then derived from the master key. The MAC calculation uses the HMAC algorithm (Chapter 3) and encompasses the fields indicated in the expression HMAC_hash (MAC_secret, seq_number| |WTLSCompressed. record_type| |WTLSCompressed.length| |WTLS"}, {"id": "d968edd3a17474abc0aa0c97ba8a2147f13339c7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 229, "start_line": 23, "end_line": 29, "text": "Compressed.fragment) where WTLSCompressed.fragment refers to the (optionally) compressed plain- text data field. Either MD5 or SHA-1 may be used for the HMAC hash function.Encryption is applied to all of the WTLS record, except the header. The following encryption algorithms are permitted. 6.5 WAP END-TO-END SECURITY The basic WAP transmission model involving a WAP client, a WAP gateway, anda Web server results in a security gap, as illustrated in Figure 6.19. This figure corre-sponds to the protocol architecture shown in Figure 6.14. The mobile device estab-lishes a secure WTLS session with the WAP gateway. The WAP gateway, in turn,"}, {"id": "28c874e89d792f269fc136275c59fea406857552", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 230, "start_line": 1, "end_line": 6, "text": "6.5 / WAP END-TO-END SECURITY 215 establishes a secure SSL or TLS session with the Web server. Within the gateway, data are not encrypted during the translation process. The gateway is thus a point atwhich the data may be compromised. There are a number of approaches to providing end-to-end security between the mobile client and the Web server. In the WAP version 2 (known asWAP2) architecture document, the WAP forum defines several protocol arrange-ments that allow for end-to-end security. Version 1 of WAP assumed a simplified set of protocols over the wireless"}, {"id": "a3104b8e97d4ffa2e2a043567b22c872b037fe1e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 230, "start_line": 7, "end_line": 10, "text": "network and assumed that the wireless network did not support IP . WAP2provides the option for the mobile device to implement full TCP/IP-basedprotocols and operate over an IP-capable wireless network. Figure 6.20 showstwo ways in which this IP capability can be exploited to provide end-to-endsecurity. In both approaches, the mobile client implements TCP/IP and HTTP . The first approach (Figure 6.20a) is to make use of TLS between client and server. A secure TLS session is set up between the endpoints. The WAP gatewayacts as a TCP-level gateway and splices together two TCP connections to carry thetraffic between the endpoints. However, the TCP user data field (TLS records)remains encrypted as it passes through the gateway, so end-to-end security ismaintained. WirelessIPTCP"}, {"id": "d9855425c832c6252574aa587ccb74fd47c8579c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 230, "start_line": 11, "end_line": 20, "text": "WiredIPTCPWAP Gateway (a) TLS-based securityWirelessIPTCPTLSHTTP IPTCPTLSHTTPWAEWAP Device WiredWAEWeb Server WirelessIP WiredIPWAP Gateway (b) IPSec-based securityWirelessIPTCPHTTP IPTCPHTTPWAEWAP Device WiredWAEWeb Server Figure 6.20 WAP2 End-to-End Security Approaches"}, {"id": "817e283a7a6983d108da8ceae986c36e9a63effa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 231, "start_line": 1, "end_line": 5, "text": "216 CHAPTER 6 / WIRELESS NETWORK SECURITY Another possible approach is shown in Figure 6.20b. Here we assume that the WAP gateway acts as a simple Internet router. In this case, end-to-end security can be provided at the IP level using IPsec (discussed in Chapter 8). Yet another, somewhat more complicated, approach has been defined in"}, {"id": "f493936e08e2616ffa1562e00133886da50ccb45", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 231, "start_line": 6, "end_line": 6, "text": "more specific terms by the WAP forum in specification entitled \u201cWAP TransportLayer End-to-End Security.\u201d This approach is illustrated in Figure 6.21, which isbased on a figure in [ASHL01]. In this scenario, the WAP client connects to itsusual WAP gateway and attempts to send a request through the gateway to asecure domain. The secure content server determines the need for security thatrequires that the mobile client connect to its local WAP gateway rather than itsdefault WAP gateway. The Web server responds to the initial client request with anHTTP redirect message that redirects the client to a WAP gateway that is part ofthe enterprise network. This message passes back through the default gateway,which validates the redirect and sends it to the client. The client caches the redirectinformation and establishes a secure session with the enterprise WAP gatewayusing WTLS. After the connection is terminated, the default gateway is reselectedand used for subsequent communication to other Web servers. Note that thisapproach requires that the enterprise maintain a WAP gateway on the wireless net-work that the client is using."}, {"id": "08c41fc875e3c3a2ef27847179309fe4144a8924", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 231, "start_line": 7, "end_line": 17, "text": "Figure 6.22, from the WAP specification, illustrates the dialogue. WAP Service Provider 1 2Default WAP GW Web serverApplication server EnterpriseSubordinate WAP GW Figure 6.21 WAP2 End-to-End Security Scheme"}, {"id": "33f068eac4eb7d2907076aa64729903b93130725", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 232, "start_line": 1, "end_line": 16, "text": "6.6 / RECOMMENDED READING AND WEB SITES 217 CHEN05 Chen, J.; Jiang, M.; and Liu, Y. \u201cWireless LAN Security and IEEE 802.11i.\u201d IEEE Wireless Communications , February 2005. FRAN07 Frankel, S.; Eydt, B.; Owens, L.; and Scarfone, K. Establishing Wireless Robust Security Networks: A Guide to IEEE 802.11i. NIST Special Publication SP 800-97, February 2007. ROSH04 Roshan, P ., and Leary, J. 802.11 Wireless LAN Fundamentals. Indianapolis: Cisco Press, 2004. STAL07 Stallings, W. Data and Computer Communications, Eighth Edition. Upper Saddle River, NJ: Prentice Hall, 2007.User Validation CACHE: URL set to secure proxy mappingClick: Bank Establish Secure WTLS session (if not present)Error 300: Body= XML Navigation Document Error 300: Body= XML Navigation DocumentGET: http://bank.com/... GET:"}, {"id": "2d593f29217517bae97c5c077c50b42211500e69", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 232, "start_line": 17, "end_line": 28, "text": "http://bank.com/... GET: http://bank.com/...GET: http://bank.com/... Display wml decksecure.bank.com/xx.wmlUser-AgentTrusted Master/Default Pull Proxy OSSecure Subordinate Pull ProxyOS (Secure Domain) Figure 6.22 WAP Transport Layer End-to-End Security Example 6.6 RECOMMENDED READING AND WEB SITES The IEEE 802.11 and WiFi specifications are covered in more detail in [STAL07]. A good book-length treatment is [ROSH04]. [FRAN07] is an excellent, detailed treatment of IEEE802.11i. [CHEN05] provides an overview of IEEE 802.11i."}, {"id": "706320ba19cf14dac2448c84a819d66409e85922", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 233, "start_line": 1, "end_line": 13, "text": "218 CHAPTER 6 / WIRELESS NETWORK SECURITY Review Questions 6.1 What is the basic building block of an 802.11 WLAN? 6.2 Define an extended service set. 6.3 List and briefly define IEEE 802.11 services. 6.4 Is a distribution system a wireless network? 6.5 How is the concept of an association related to that of mobility?Recommended Web Sites: \u2022The IEEE 802.11 Wireless LAN Working Group: Contains working group documents plus discussion archives. \u2022Wi-Fi Alliance: An industry group promoting the interoperability of 802.11 products with each other and with Ethernet. \u2022Wireless LAN Association: Gives an introduction to the technology, including a discus- sion of implementation considerations and case studies from users. Links to related sites."}, {"id": "f6dbb08d17d3e2fe347de6c3c0f7da400f1ed3b3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 233, "start_line": 14, "end_line": 38, "text": "\u2022Extensible Authentication Protocol (EAP) Working Group: IETF working group responsible for EAP and related issues. Site includes RFCs and Internet drafts. \u2022Open Mobile Alliance: Consolidation of the WAP Forum and the Open Mobile Architecture Initiative. Provides WAP technical specifications and industry links. 6.7 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms Wireless Application Protocol (WAP) Wireless Datagram Protocol (WDP) wireless LAN (WLAN) Wireless Markup Language (WML) Wireless Session Protocol (WSP) Wireless Transaction Protocol (WTP) Wireless Transport Layer Security (WTLS) Wi-FiWi-Fi Protected Access (WPA) WTLS Record Protocolmedia access control (MAC)MAC protocol data unit (MPDU) MAC service data unit (MSDU)"}, {"id": "f6ed053a0c23c105ccba72190b9ffffa9ca5843b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 233, "start_line": 39, "end_line": 50, "text": "message integrity code (MIC)Michaelpairwise keyspseudorandom functionRobust Security Network (RSN) Temporal Key Integrity Protocol (TKIP) Wired Equivalent Privacy (WEP) Wireless Application Environment (WAE)4-way handshakeaccess point (AP)Alert Protocolbasic service set (BSS)Change Cipher Spec Protocol Counter Mode-CBC MAC Protocol (CCMP) distribution system (DS)extended service set (ESS)group keysHandshake ProtocolIEEE 802.1XIEEE 802.11IEEE 802.11iindependent BSS (IBSS)logical link control (LLC)"}, {"id": "51df1d23d82b65aa6b84971cd9d9f48902d88839", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 234, "start_line": 1, "end_line": 18, "text": "6.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 219 P A A T S RequestStation sends a request for authentication. AP sends challenge message containing 128-bit randomnumber. AP decrypts challenge response. If match, send authenticationsuccess message.Station responds with encrypted version of challenge number. ResponseChallenge Success Figure 6.23 WEP Authentication6.6 What security areas are addressed by IEEE 802.11i? 6.7 Briefly describe the four IEEE 802.11i phases of operation. 6.8 What is the difference between TKIP and CCMP? 6.9 What is the difference between an HTML filter and a WAP proxy? 6.10 What services are provided by WSP? 6.11 When would each of the three WTP transaction classes be used? 6.12 List and briefly define the security services provided by WTLS."}, {"id": "b73c5231639610d59b44112041a1fda281430897", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 234, "start_line": 19, "end_line": 25, "text": "6.13 Briefly describe the four protocol elements of WTLS. 6.14 List and briefly define all of the keys used in WTLS. 6.15 Describe three alternative approaches to providing WAP end-to-end security. Problems 6.1 In IEEE 802.11, open system authentication simply consists of two commu- nications. An authentication is requested by the client, which contains thestation ID (typically the MAC address). This is followed by an authentica-tion response from the AP/router containing a success or failure message.An example of when a failure may occur is if the client\u2019s MAC address isexplicitly excluded in the AP/router configuration.a.What are the benefits of this authentication scheme? b.What are the security vulnerabilities of this authentication scheme?"}, {"id": "6ade5a9d7f7a96f4f9bda14ba0de532cdf3d0279", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 234, "start_line": 26, "end_line": 26, "text": "6.2 Prior to the introduction of IEEE 802.11i, the security scheme for IEEE802.11 was Wired Equivalent Privacy (WEP). WEP assumed all devices inthe network share a secret key.The purpose of the authentication scenario isfor the STA to prove that it possesses the secret key. Authentication pro-ceeds as shown in Figure 6.23. The STA sends a message to the AP request-ing authentication. The AP issues a challenge, which is a sequence of 128random bytes sent as plaintext. The STA encrypts the challenge with theshared key and returns it to the AP .The AP decrypts the incoming value andcompares it to the challenge that it sent. If there is a match, the AP confirmsthat authentication has succeeded."}, {"id": "cc17cfb6fafed220dd7f2c3c3f101265767de7cf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 235, "start_line": 1, "end_line": 10, "text": "220 CHAPTER 6 / WIRELESS NETWORK SECURITY a.What are the benefits of this authentication scheme? b.This authentication scheme is incomplete. What is missing and why is this impor- tant? Hint: The addition of one or two messages would fix the problem. c.What is a cryptographic weakness of this scheme? 6.3 For WEP , data integrity and data confidentiality are achieved using the RC4 streamencryption algorithm. The transmitter of an MPDU performs the following steps,referred to as encapsulation: 1.The transmitter selects an initial vector (IV) value. 2.The IV value is concatenated with the WEP key shared by transmitter and receiver to form the seed, or key input, to RC4. 3.A 32-bit cyclic redundancy check (CRC) is computed over all the bits of the"}, {"id": "09e471636860da51770580166b8ad417158abcac", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 235, "start_line": 11, "end_line": 17, "text": "MAC data field and appended to the data field. The CRC is a commonerror-detection code used in data link control protocols. In this case, theCRC serves as a integrity check value (ICV). 4.The result of step 3 is encrypted using RC4 to form the ciphertext block. 5.The plaintext IV is prepended to the ciphertext block to form the encapsu- lated MPDU for transmission. a.Draw a block diagram that illustrates the encapsulation process. b.Describe the steps at the receiver end to recover the plaintext and per-form the integrity check. c.Draw a block diagram that illustrates part b."}, {"id": "75c0ecac72b1847585cff7dfbd1803e2f7852fa5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 235, "start_line": 18, "end_line": 18, "text": "6.4 A potential weakness of the CRC as an integrity check is that it is a linear function.This means that you can predict which bits of the CRC are changed if a single bit ofthe message is changed. Furthermore, it is possible to determine which combinationof bits could be flipped in the message so that the net result is no change in the CRC.Thus, there are a number of combinations of bit flippings of the plaintext messagethat leave the CRC unchanged, so message integrity is defeated. However, in WEP , ifan attacker does not know the encryption key, the attacker does not have access tothe plaintext, only to the ciphertext block. Does this mean that the ICV is protectedfrom the bit flipping attack? Explain."}, {"id": "fb17ca3a3fe75c302c9c57904de580ea61b52ee9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 235, "start_line": 19, "end_line": 22, "text": "6.5 One potential weakness in WTLS is the use of CBC mode cipher encryption. Thestandard states that for CBC mode block ciphers, the IV (initialization vector) foreach record is calculated in the following way: , where IV is theoriginal IV and S is obtained by concatenating the 2-byte sequence number of therecord the needed number of times to obtain as many bytes as in IV . Thus, if the IV is8 bytes long, the sequence number of the record is concatenated with itself four times.Now, in CBC mode, the first block of plaintext for a record with sequence number would be encrypted as (Figure 2.10) where P s,1is the first block of plaintext of a record with sequence number and is the concatenated version of . Consider a terminal application (such as telnet), where"}, {"id": "f5f45d872a6700130a3f809db5b2259ed649ea7e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 235, "start_line": 23, "end_line": 24, "text": "each keypress is sent as an individual record. Alice enters her password into thisapplication, and Eve captures these encrypted records. Note that the sequencenumber is known to Eve, because this portion of the record is not encrypted(Figure 6.17). Now somehow Eve gets hold of Alice\u2019s channel, perhaps through anecho feature in some application. This means that Eve can present unencryptedrecords to the channel and view the encrypted result. Suggest a brute-force methodby which Eve can guess password letters in Alice\u2019s password. Hint: Exploit these properties of exclusive-OR: ."}, {"id": "8c1b593755cc252137ada23c66b871b064518999", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 235, "start_line": 25, "end_line": 26, "text": "6.6 An earlier version of WTLS supported a 40-bit XOR MAC and also supported RC4stream encryption. The XOR MAC works by padding the message with zeros, divid-ing it into 5-byte blocks and XORing these blocks together. Show that this schemedoes not provide message integrity protection.x/H17053x=1; x/H170531=xsS sC 1=E(K, [IV /H17053S/H17053Ps, 1])irecord_IV =IV/H17053S"}, {"id": "5508e0fc59095c6e0e14f27852c77905d5fdfeba", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 236, "start_line": 1, "end_line": 12, "text": "ELECTRONIC MAILSECURITY 7.1 Pretty Good Privacy Notation Operational DescriptionCryptographic Keys and Key RingsPublic-Key Management 7.2 S/MIME RFC 5322Multipurpose Internet Mail ExtensionsS/MIME FunctionalityS/MIME MessagesS/MIME Certificate ProcessingEnhanced Security Services 7.3 DomainKeys Identified Mail Internet Mail ArchitectureE-mail ThreatsDKIM StrategyDKIM Functional Flow 7.4 Recommended Reading and Web Sites 7.5 Key Terms, Review Questions, and Problems Appendix 7A Radix-64 Conversion 221CHAPTER"}, {"id": "3e6d3a509c9d2258a1a9f1204fa374e1003bb9a0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 237, "start_line": 1, "end_line": 6, "text": "222 CHAPTER 7 / ELECTRONIC MAIL SECURITY Despite the refusal of VADM Poindexter and LtCol North to appear, the Board\u2019s access to other sources of information filled much of this gap. The FBI provideddocuments taken from the files of the National Security Advisor and relevantNSC staff members, including messages from the PROF system between VADMPoindexter and LtCol North. The PROF messages were conversations by com-puter, written at the time events occurred and presumed by the writers to be pro-tected from disclosure. In this sense, they provide a first-hand, contemporaneousaccount of events. \u2014The Tower Commission Report to President Reagan on the Iran-Contra Affair, 1987 KEY POINTS"}, {"id": "6ad6a5b43e198d56dcbc91cf88c483d199ab6769", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 237, "start_line": 7, "end_line": 11, "text": "\u25c6PGP is an open-source, freely available software package for e-mail secu-rity. It provides authentication through the use of digital signature, confi-dentiality through the use of symmetric block encryption, compressionusing the ZIP algorithm, and e-mail compatibility using the radix-64encoding scheme. \u25c6PGP incorporates tools for developing a public-key trust model andpublic-key certificate management. \u25c6S/MIME is an Internet standard approach to e-mail security that incorporatesthe same functionality as PGP . \u25c6DKIM is a specification used by e-mail providers for cryptographically signing e-mail messages on behalf of the source domain."}, {"id": "4c8a12073b706336a2791a8e321cb549969bde4f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 237, "start_line": 12, "end_line": 13, "text": "In virtually all distributed environments, electronic mail is the most heavilyused network-based application. Users expect to be able to, and do, send e-mail to others who are connected directly or indirectly to the Internet,regardless of host operating system or communications suite. With the explo-sively growing reliance on e-mail, there grows a demand for authenticationand confidentiality services. Two schemes stand out as approaches that enjoywidespread use: Pretty Good Privacy (PGP) and S/MIME. Both are examinedin this chapter. The chapter closes with a discussion of DomainKeys IdentifiedMail. 7.1 PRETTY GOOD PRIVACY"}, {"id": "8e27b13022a11c93bc06500f9154f37d2da5e37d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 237, "start_line": 14, "end_line": 14, "text": "PGP is a remarkable phenomenon. Largely the effort of a single person, PhilZimmermann, PGP provides a confidentiality and authentication service that canbe used for electronic mail and file storage applications. In essence, Zimmermannhas done the following:"}, {"id": "6fbcdc77da24af2ce2af196c8a15f15e1217cfcc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 238, "start_line": 1, "end_line": 9, "text": "7.1 / PRETTY GOOD PRIVACY 223 1.Selected the best available cryptographic algorithms as building blocks. 2.Integrated these algorithms into a general-purpose application that is inde- pendent of operating system and processor and that is based on a small set ofeasy-to-use commands. 3.Made the package and its documentation, including the source code, freelyavailable via the Internet, bulletin boards, and commercial networks such asAOL (America On Line). 4.Entered into an agreement with a company (Viacrypt, now NetworkAssociates) to provide a fully compatible, low-cost commercial version of PGP . PGP has grown explosively and is now widely used. A number of reasons can be cited for this growth. 1.It is available free worldwide in versions that run on a variety of platforms,"}, {"id": "353bc32ba930c9fa780977e8a270c5c7e3c24354", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 238, "start_line": 10, "end_line": 12, "text": "including Windows, UNIX, Macintosh, and many more. In addition, the commer-cial version satisfies users who want a product that comes with vendor support. 2.It is based on algorithms that have survived extensive public review and are con-sidered extremely secure. Specifically, the package includes RSA, DSS, andDiffie-Hellman for public-key encryption; CAST-128, IDEA, and 3DES for sym-metric encryption; and SHA-1 for hash coding. 3.It has a wide range of applicability, from corporations that wish to select andenforce a standardized scheme for encrypting files and messages to individualswho wish to communicate securely with others worldwide over the Internet andother networks."}, {"id": "c2b386988e6a5728bb1eddd9d90c1fa24248ed00", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 238, "start_line": 13, "end_line": 21, "text": "4.It was not developed by, nor is it controlled by, any governmental or standardsorganization. For those with an instinctive distrust of \u201cthe establishment,\u201d thismakes PGP attractive. 5.PGP is now on an Internet standards track (RFC 3156; MIME Security with OpenPGP). Nevertheless, PGP still has an aura of an antiestablishmentendeavor. We begin with an overall look at the operation of PGP . Next, we examine how cryptographic keys are created and stored. Then, we address the vital issue of public-key management. Notation Most of the notation used in this chapter has been used before, but a few terms are new.It is perhaps best to summarize those at the beginning.The following symbols are used. session key used in symmetric encryption scheme"}, {"id": "049f2a413f2775e71d15e17948cf62239910db9f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 238, "start_line": 22, "end_line": 28, "text": "private key of user A, used in public-key encryption scheme public key of user A, used in public-key encryption scheme public-key encryption public-key decryption symmetric encryption symmetric decryption DC =EC =DP =EP =PU a=PR a=Ks ="}, {"id": "0d6fd01cc6e6d12f504aa5399051977a1c595900", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 239, "start_line": 1, "end_line": 12, "text": "224 CHAPTER 7 / ELECTRONIC MAIL SECURITY hash function concatenation compression using ZIP algorithm conversion to radix 64 ASCII format1 The PGP documentation often uses the term secret key to refer to a key paired with a public key in a public-key encryption scheme. As was mentioned earlier, this practice risks confusion with a secret key used for symmetric encryption. Hence, weuse the term private key instead. Operational Description The actual operation of PGP , as opposed to the management of keys, consists of fourservices: authentication, confidentiality, compression, and e-mail compatibility(Table 7.1). We examine each of these in turn. A UTHENTICATION Figure 7.1a illustrates the digital signature service provided by"}, {"id": "331f952d4953133d78d2979184da1d1f0cecc475", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 239, "start_line": 13, "end_line": 22, "text": "PGP . This is the digital signature scheme discussed in Chapter 3 and illustrated in Figure 4.5. The sequence is as follows. 1.The sender creates a message. 2.SHA-1 is used to generate a 160-bit hash code of the message. 3.The hash code is encrypted with RSA using the sender\u2019s private key, and theresult is prepended to the message. 4.The receiver uses RSA with the sender\u2019s public key to decrypt and recover thehash code. 5.The receiver generates a new hash code for the message and compares it withthe decrypted hash code. If the two match, the message is accepted as authentic.R64 =Z =\u0192\u0192 =H = Table 7.1 Summary of PGP Services Function Algorithms Used Description Digital"}, {"id": "ed0e70beadb0c987c47a03efa00d4fd90d8a1675", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 239, "start_line": 23, "end_line": 28, "text": "signatureDSS/SHA or RSA/SHAA hash code of a message is created using SHA-1. This message digest is encrypted usingDSS or RSA with the sender\u2019s private key andincluded with the message. MessageencryptionCAST or IDEA or Three-key Triple DES with Diffie-Hellman or RSAA message is encrypted using CAST-128 orIDEA or 3DES with a one-time session keygenerated by the sender. The session key isencrypted using Diffie-Hellman or RSA withthe recipient\u2019s public key and included withthe message. Compression ZIPA message may be compressed for storage ortransmission using ZIP . E-mail compatibilityRadix-64 conversionTo provide transparency for e-mail applica-tions, an encrypted message may be convertedto an ASCII string using radix-64 conversion."}, {"id": "ec8dbb0d42d4e672f0268096cf1818b72fc7c938", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 239, "start_line": 29, "end_line": 29, "text": "1The American Standard Code for Information Interchange (ASCII) is described in Appendix I."}, {"id": "667109bbd45df8bb272a79c02dcc240440caa56f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 240, "start_line": 1, "end_line": 23, "text": "225M (c) Conf identiality and authenticationH M HDP ComparePU a | |PRa EP ZEPPU b | | ECKs DCDPPRb Z/H110021M (b) Conf identiality onlyDPPRb DCMEPPU b EC | |Ks Z Z/H110021H ||PRa EPM (a) Authentication onlyZ Z/H110021 HDP ComparePU a ME[PR a, H(M)] E[PR a, H(M)]Source A Destination B E[PU b, Ks]E[PU b, Ks] Figure 7.1 PGP Cryptographic Functions"}, {"id": "75aecf69c264279e36ce2cc33f8f42250734de39", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 241, "start_line": 1, "end_line": 5, "text": "226 CHAPTER 7 / ELECTRONIC MAIL SECURITY The combination of SHA-1 and RSA provides an effective digital signature scheme. Because of the strength of RSA, the recipient is assured that only the pos- sessor of the matching private key can generate the signature. Because of thestrength of SHA-1, the recipient is assured that no one else could generate a newmessage that matches the hash code and, hence, the signature of the originalmessage. As an alternative, signatures can be generated using DSS/SHA-1.Although signatures normally are found attached to the message or file that"}, {"id": "74950263dc07ef1c87facc7ee073a8fce5a02205", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 241, "start_line": 6, "end_line": 8, "text": "they sign, this is not always the case: Detached signatures are supported.A detachedsignature may be stored and transmitted separately from the message it signs.This isuseful in several contexts.A user may wish to maintain a separate signature log of allmessages sent or received. A detached signature of an executable program candetect subsequent virus infection. Finally, detached signatures can be used whenmore than one party must sign a document, such as a legal contract. Each person\u2019ssignature is independent and therefore is applied only to the document. Otherwise,signatures would have to be nested, with the second signer signing both the docu-ment and the first signature, and so on. C ONFIDENTIALITY Another basic service provided by PGP is confidentiality, which"}, {"id": "0c3be4c7752c3586f3024853910e05ecf95075e6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 241, "start_line": 9, "end_line": 12, "text": "is provided by encrypting messages to be transmitted or to be stored locally as files. In both cases, the symmetric encryption algorithm CAST-128 may be used.Alternatively, IDEA or 3DES may be used.The 64-bit cipher feedback (CFB) modeis used. As always, one must address the problem of key distribution. In PGP , each symmetric key is used only once. That is, a new key is generated as a random 128-bitnumber for each message. Thus, although this is referred to in the documentation asa session key, it is in reality a one-time key. Because it is to be used only once, thesession key is bound to the message and transmitted with it. To protect the key, it isencrypted with the receiver\u2019s public key. Figure 7.1b illustrates the sequence, whichcan be described as follows."}, {"id": "5807c29ae04c657303178616e14100c0463552ce", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 241, "start_line": 13, "end_line": 20, "text": "1.The sender generates a message and a random 128-bit number to be used asa session key for this message only. 2.The message is encrypted using CAST-128 (or IDEA or 3DES) with the ses-sion key. 3.The session key is encrypted with RSA using the recipient\u2019s public key and isprepended to the message. 4.The receiver uses RSA with its private key to decrypt and recover the sessionkey. 5.The session key is used to decrypt the message. As an alternative to the use of RSA for key encryption, PGP provides an option referred to as Diffie-Hellman . As was explained in Chapter 3, Diffie- Hellman is a key exchange algorithm. In fact, PGP uses a variant of Diffie-Hellmanthat does provide encryption/decryption, known as ElGamal."}, {"id": "46d2bf1b4c3cb6101e7e3f3648d03f3f1001da7a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 241, "start_line": 21, "end_line": 22, "text": "Several observations may be made. First, to reduce encryption time, the combi- nation of symmetric and public-key encryption is used in preference to simply using"}, {"id": "6e0fb0fa50cb2bf7a26e48eb727759103f8983fd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 242, "start_line": 1, "end_line": 3, "text": "7.1 / PRETTY GOOD PRIVACY 227 RSA or ElGamal to encrypt the message directly: CAST-128 and the other symmet- ric algorithms are substantially faster than RSA or ElGamal. Second, the use of thepublic-key algorithm solves the session-key distribution problem, because only therecipient is able to recover the session key that is bound to the message. Note thatwe do not need a session-key exchange protocol of the type discussed in Chapter 14, because"}, {"id": "6fb394e9e60225d787073dae5e9f30c0d20248e1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 242, "start_line": 4, "end_line": 6, "text": "we are not beginning an ongoing session. Rather, each message is a one-time inde-pendent event with its own key. Furthermore, given the store-and-forward nature ofelectronic mail, the use of handshaking to assure that both sides have the samesession key is not practical. Finally, the use of one-time symmetric keys strengthenswhat is already a strong symmetric encryption approach. Only a small amount ofplaintext is encrypted with each key, and there is no relationship among the keys.Thus, to the extent that the public-key algorithm is secure, the entire scheme issecure. To this end, PGP provides the user with a range of key size options from 768to 3072 bits (the DSS key for signatures is limited to 1024 bits). C ONFIDENTIALITY AND AUTHENTICATION As Figure 7.1c illustrates, both services"}, {"id": "2a4159de7f865803779f474d3a76a8daa6fab08c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 242, "start_line": 7, "end_line": 9, "text": "may be used for the same message. First, a signature is generated for the plaintext message and prepended to the message.Then the plaintext message plus signature isencrypted using CAST-128 (or IDEA or 3DES), and the session key is encryptedusing RSA (or ElGamal). This sequence is preferable to the opposite: encryptingthe message and then generating a signature for the encrypted message. It isgenerally more convenient to store a signature with a plaintext version of a message.Furthermore, for purposes of third-party verification, if the signature is performedfirst, a third party need not be concerned with the symmetric key when verifying thesignature. In summary, when both services are used, the sender first signs the message"}, {"id": "55ee5f226cb58a366158c4ca5e426dabec0c7762", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 242, "start_line": 10, "end_line": 17, "text": "with its own private key, then encrypts the message with a session key, and finallyencrypts the session key with the recipient\u2019s public key. C OMPRESSION As a default, PGP compresses the message after applying the signature but before encryption. This has the benefit of saving space both for e-mail transmission and for file storage. The placement of the compression algorithm, indicated by Z for compression and Z\u20131for decompression in Figure 7.1, is critical. 1.The signature is generated before compression for two reasons:"}, {"id": "7f06385c850c92bcfda0780ea9efd58198b5723b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 242, "start_line": 18, "end_line": 18, "text": "a.It is preferable to sign an uncompressed message so that one can store onlythe uncompressed message together with the signature for future verifica-tion. If one signed a compressed document, then it would be necessary eitherto store a compressed version of the message for later verification or torecompress the message when verification is required."}, {"id": "58df9ad1e4e03bdb882abf70746803cbaa297515", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 242, "start_line": 19, "end_line": 19, "text": "b.Even if one were willing to generate dynamically a recompressed messagefor verification, PGP\u2019s compression algorithm presents a difficulty. The algo-rithm is not deterministic; various implementations of the algorithm achievedifferent tradeoffs in running speed versus compression ratio and, as a result,produce different compressed forms. However, these different compressionalgorithms are interoperable because any version of the algorithm cancorrectly decompress the output of any other version. Applying the hash"}, {"id": "e57fd38e34300955701f90548872744687fab244", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 243, "start_line": 1, "end_line": 8, "text": "228 CHAPTER 7 / ELECTRONIC MAIL SECURITY function and signature after compression would constrain all PGP imple- mentations to the same version of the compression algorithm. 2.Message encryption is applied after compression to strengthen cryptographicsecurity. Because the compressed message has less redundancy than theoriginal plaintext, cryptanalysis is more difficult. The compression algorithm used is ZIP , which is described in Appendix G. E- MAIL COMPATIBILITY When PGP is used, at least part of the block to be transmitted is encrypted. If only the signature service is used, then the message digest is"}, {"id": "3dc31be91a956c241cc218a5ed4412b181e0cf30", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 243, "start_line": 9, "end_line": 12, "text": "encrypted (with the sender\u2019s private key). If the confidentiality service is used, themessage plus signature (if present) are encrypted (with a one-time symmetric key).Thus, part or all of the resulting block consists of a stream of arbitrary 8-bit octets.However, many electronic mail systems only permit the use of blocks consisting ofASCII text. To accommodate this restriction, PGP provides the service of convertingthe raw 8-bit binary stream to a stream of printable ASCII characters. The scheme used for this purpose is radix-64 conversion. Each group of three octets of binary data is mapped into four ASCII characters. This format alsoappends a CRC to detect transmission errors. See Appendix 7A for a description. The use of radix 64 expands a message by 33%. Fortunately, the session key"}, {"id": "9ae4e6f13c6ec6d092729239e2a4d5dd3a7edba3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 243, "start_line": 13, "end_line": 14, "text": "and signature portions of the message are relatively compact, and the plaintext mes-sage has been compressed. In fact, the compression should be more than enough tocompensate for the radix-64 expansion. For example, [HELD96] reports an averagecompression ratio of about 2.0 using ZIP . If we ignore the relatively small signatureand key components, the typical overall effect of compression and expansion of afile of length would be .Thus, there is still an overallcompression of about one-third. One noteworthy aspect of the radix-64 algorithm is that it blindly converts the"}, {"id": "1faaaef7bb1da40d6c0e3ab39694c23ab2a2d5f2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 243, "start_line": 15, "end_line": 16, "text": "input stream to radix-64 format regardless of content, even if the input happens tobe ASCII text. Thus, if a message is signed but not encrypted and the conversion isapplied to the entire block, the output will be unreadable to the casual observer,which provides a certain level of confidentiality. As an option, PGP can be config-ured to convert to radix-64 format only the signature portion of signed plaintextmessages. This enables the human recipient to read the message without using PGP .PGP would still have to be used to verify the signature. Figure 7.2 shows the relationship among the four services so far discussed. On"}, {"id": "5983853f5391859fd411a6b51f7d16c1a105af9d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 243, "start_line": 17, "end_line": 18, "text": "transmission (if it is required), a signature is generated using a hash code of theuncompressed plaintext. Then the plaintext (plus signature if present) is com-pressed. Next, if confidentiality is required, the block (compressed plaintext or com-pressed signature plus plaintext) is encrypted and prepended with the public-key-encrypted symmetric encryption key. Finally, the entire block is converted toradix-64 format. On reception, the incoming block is first converted back from radix-64 format"}, {"id": "76447c29145ff4508cebff5cb3553c7d256f2ce7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 243, "start_line": 19, "end_line": 19, "text": "to binary. Then, if the message is encrypted, the recipient recovers the session keyand decrypts the message. The resulting block is then decompressed. If the messageis signed, the recipient recovers the transmitted hash code and compares it to itsown calculation of the hash code.1.33 *0.5*X=0.665 *X X"}, {"id": "e36aa020ac3f18497b61fbd39798efc8e35c77b6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 244, "start_line": 1, "end_line": 24, "text": "229(a) Generic transmission diagram (from A) (b) Generic reception diagram (to B)Conf identiality required?Conf identiality required? Yes NoYes NoX file Convert to radix 64 X R64[X]Encrypt key, X X E(PU b, Ks) || E(K s, X)Generate signature X signature || X Compress XZ (X)Decrypt key, XYes No Signature required?Signature required? Decompress X Z/H110021(X) Strip signature from X ver ify signatureYes NoKs D(PR b, E(PU b, Ks)) X D(K s, E(K s, X))Convert from radix 64 X R64/H110021[X] Figure 7.2 Transmission and Reception of PGP Messages"}, {"id": "f86b840db491c43793bc343f145e06ea1c86f960", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 245, "start_line": 1, "end_line": 5, "text": "230 CHAPTER 7 / ELECTRONIC MAIL SECURITY Cryptographic Keys and Key Rings PGP makes use of four types of keys: one-time session symmetric keys, public keys, private keys, and passphrase-based symmetric keys (explained subsequently).Threeseparate requirements can be identified with respect to these keys. 1.A means of generating unpredictable session keys is needed."}, {"id": "17f544815a2766d80405e37a162a628797484d1f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 245, "start_line": 6, "end_line": 6, "text": "2.We would like to allow a user to have multiple public-key/private-key pairs. Onereason is that the user may wish to change his or her key pair from time to time.When this happens, any messages in the pipeline will be constructed with anobsolete key. Furthermore, recipients will know only the old public key until anupdate reaches them. In addition to the need to change keys over time, a usermay wish to have multiple key pairs at a given time to interact with differentgroups of correspondents or simply to enhance security by limiting the amount ofmaterial encrypted with any one key. The upshot of all this is that there is not aone-to-one correspondence between users and their public keys. Thus, somemeans is needed for identifying particular keys."}, {"id": "26be88ecc037bec13bc4b6964ea1c8027e37245b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 245, "start_line": 7, "end_line": 13, "text": "3.Each PGP entity must maintain a file of its own public/private key pairs aswell as a file of public keys of correspondents. We examine each of these requirements in turn. S ESSION KEYGENERATION Each session key is associated with a single message and is used only for the purpose of encrypting and decrypting that message. Recall that message encryption/decryption is done with a symmetric encryption algorithm.CAST-128 and IDEA use 128-bit keys; 3DES uses a 168-bit key. For the followingdiscussion, we assume CAST-128. Random 128-bit numbers are generated using CAST-128 itself. The input to"}, {"id": "e19d9165d38dc4e18e1759997ffeedc1484e0314", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 245, "start_line": 14, "end_line": 15, "text": "the random number generator consists of a 128-bit key and two 64-bit blocks thatare treated as plaintext to be encrypted. Using cipher feedback mode, the CAST-128encrypter produces two 64-bit cipher text blocks, which are concatenated to formthe 128-bit session key. The algorithm that is used is based on the one specified inANSI X12.17. The \u201cplaintext\u201d input to the random number generator, consisting of two"}, {"id": "62fe8737c4fa2ccd0c5bc32e4bf3643676c7a284", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 245, "start_line": 16, "end_line": 20, "text": "64-bit blocks, is itself derived from a stream of 128-bit randomized numbers. Thesenumbers are based on keystroke input from the user. Both the keystroke timing andthe actual keys struck are used to generate the randomized stream. Thus, if the userhits arbitrary keys at his or her normal pace, a reasonably \u201crandom\u201d input will be generated. This random input is also combined with previous session key outputfrom CAST-128 to form the key input to the generator. The result, given the effective scrambling of CAST-128, is to produce a sequence of session keys that iseffectively unpredictable. Appendix H discusses PGP random number generation techniques in more detail. K EYIDENTIFIERS As we have discussed, an encrypted message is accompanied by"}, {"id": "7ff6aab9dac428e5939e3498159b69ceca5154a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 245, "start_line": 21, "end_line": 21, "text": "an encrypted form of the session key that was used for message encryption. The"}, {"id": "9e48bfde996e082473f55ee8bfac1c66913b450e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 246, "start_line": 1, "end_line": 4, "text": "7.1 / PRETTY GOOD PRIVACY 231 session key itself is encrypted with the recipient\u2019s public key. Hence, only the recipient will be able to recover the session key and therefore recover the message.If each user employed a single public/private key pair, then the recipient wouldautomatically know which key to use to decrypt the session key: the recipient\u2019sunique private key. However, we have stated a requirement that any given user mayhave multiple public/private key pairs. How, then, does the recipient know which of its public keys was used to"}, {"id": "7c2f2d6546947b3f6140c75f258ca0c7db25b3b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 246, "start_line": 5, "end_line": 5, "text": "encrypt the session key? One simple solution would be to transmit the public keywith the message. The recipient could then verify that this is indeed one of itspublic keys, and proceed. This scheme would work, but it is unnecessarily waste-ful of space. An RSA public key may be hundreds of decimal digits in length.Another solution would be to associate an identifier with each public key that isunique at least within one user. That is, the combination of user ID and keyID would be sufficient to identify a key uniquely. Then only the much shorter keyID would need to be transmitted. This solution, however, raises a managementand overhead problem: Key IDs must be assigned and stored so that both senderand recipient could map from key ID to public key. This seems unnecessarilyburdensome."}, {"id": "71b8b689dfe9120c85d8f6fa6bd416451e9e35a8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 246, "start_line": 6, "end_line": 10, "text": "The solution adopted by PGP is to assign a key ID to each public key that is, with very high probability, unique within a user ID. The key ID associated with eachpublic key consists of its least significant 64 bits. That is, the key ID of public key is ( mod ). This is a sufficient length that the probability of duplicate key IDs is very small. A key ID is also required for the PGP digital signature. Because a sender"}, {"id": "bd0235852bc98a2597f0aab4f412e89c63485883", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 246, "start_line": 11, "end_line": 14, "text": "may use one of a number of private keys to encrypt the message digest, therecipient must know which public key is intended for use. Accordingly, thedigital signature component of a message includes the 64-bit key ID of therequired public key. When the message is received, the recipient verifies thatthe key ID is for a public key that it knows for that sender and then proceeds toverify the signature. Now that the concept of key ID has been introduced, we can take a more detailed look at the format of a transmitted message, which is shown in Figure 7.3.A message consists of three components: the message component, a signature(optional), and a session key component (optional). The message component includes the actual data to be stored or transmitted,"}, {"id": "312b07e625fc5b818a4fee1099862d6b9dcc9d76", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 246, "start_line": 15, "end_line": 20, "text": "as well as a filename and a timestamp that specifies the time of creation. The signature component includes the following. \u2022Timestamp: The time at which the signature was made. \u2022Message digest: The 160-bit SHA-1 digest encrypted with the sender\u2019s pri- vate signature key. The digest is calculated over the signature timestampconcatenated with the data portion of the message component. The inclu-sion of the signature timestamp in the digest insures against replay types ofattacks. The exclusion of the filename and timestamp portions of themessage component ensures that detached signatures are exactly the sameas attached signatures prefixed to the message. Detached signatures are2 64PU a PU a"}, {"id": "7f118f0ae9f3171818880bfa2077a418a5df5eb3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 247, "start_line": 1, "end_line": 28, "text": "232 CHAPTER 7 / ELECTRONIC MAIL SECURITY Content Session key component Signature MessageLeading two octets of message digestKey ID of sender's public key (PU a)Key ID of recipient's public key (PU b) Session key (K s) Timestamp Message Digest Filename Timestamp DataOperation E(PU b, \u2022) E(PR a, \u2022) E(K s, \u2022) Notation: E(PU b, \u2022) /H11005 encryption with user b's public key E(PR a, \u2022) /H11005 encryption with user a's pri vate key E(K s, \u2022) /H11005 encryption with session key ZIP /H11005 Z ip compression function R64 /H11005 Radix-64 conversion functionZIPR64 Figure 7.3 General Format PGP Message (from A to B) calculated on a separate file that has none of the message component header fields. \u2022Leading two octets of message digest: Enables the recipient to determine if"}, {"id": "dbe4d58eba42517b3b42c1fdc71cb2eff78f60c9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 247, "start_line": 29, "end_line": 33, "text": "the correct public key was used to decrypt the message digest for authentica-tion by comparing this plaintext copy of the first two octets with the first twooctets of the decrypted digest. These octets also serve as a 16-bit frame checksequence for the message. \u2022Key ID of sender\u2019s public key: Identifies the public key that should be used to decrypt the message digest and, hence, identifies the private key that was usedto encrypt the message digest. The message component and optional signature component may be com- pressed using ZIP and may be encrypted using a session key."}, {"id": "b8a5fdaba7e8340091d6d9ceb0ccea5fcd491ae6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 248, "start_line": 1, "end_line": 6, "text": "7.1 / PRETTY GOOD PRIVACY 233 The session key component includes the session key and the identifier of the recipient\u2019s public key that was used by the sender to encrypt the session key. The entire block is usually encoded with radix-64 encoding. KEYRINGS We have seen how key IDs are critical to the operation of PGP and that two key IDs are included in any PGP message that provides both confidentiality"}, {"id": "e681eebfbfb0412623e171ad58baf19a08df9be3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 248, "start_line": 7, "end_line": 11, "text": "and authentication. These keys need to be stored and organized in a systematic wayfor efficient and effective use by all parties. The scheme used in PGP is to provide apair of data structures at each node, one to store the public/private key pairs ownedby that node and one to store the public keys of other users known at this node.These data structures are referred to, respectively, as the private-key ring and thepublic-key ring. Figure 7.4 shows the general structure of a private-key ring. We can view the ring as a table in which each row represents one of the public/private key pairsowned by this user. Each row contains the entries: \u2022Timestamp: The date/time when this key pair was generated. \u2022Key ID: The least significant 64 bits of the public key for this entry."}, {"id": "cb9b8e743b0c762444220347adb5f9eb9ccd49a5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 248, "start_line": 12, "end_line": 55, "text": "\u2022Public key: The public-key portion of the pair. \u2022Private key: The private-key portion of the pair; this field is encrypted. Key ID* Encrypted Private Key \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 Ti PU i mod 264E(H(P i), PR i) \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 Key ID* Public Key Owner Trust Key LegitimacySignature(s) Signature Trust(s) \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 PU i mod 264PU i trust_flag i trust_flag i \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022 \u2022 \u2022\u2022\u2022 \u2022\u2022\u2022 \u2022\u2022\u2022Private-Key Ring Public-Key Ring * /H11005 f ield used to index tableTimestamp Timestamp \u2022 \u2022\u2022 T i \u2022 \u2022\u2022User ID* \u2022 \u2022 \u2022 User i \u2022\u2022\u2022Public Key \u2022 \u2022\u2022 PU i \u2022\u2022\u2022User ID* \u2022\u2022\u2022 User i \u2022\u2022\u2022 Figure 7.4 General Structure of Private- and Public-Key Rings"}, {"id": "0d0c2832a50529c2dab07f39f29cf949ba16e79a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 249, "start_line": 1, "end_line": 8, "text": "234 CHAPTER 7 / ELECTRONIC MAIL SECURITY \u2022User ID: Typically, this will be the user\u2019s e-mail address (e.g., stallings@acm.org). However, the user may choose to associate a different name with each pair (e.g., Stallings, WStallings, WilliamStallings, etc.) or to reuse the same User IDmore than once. The private-key ring can be indexed by either User ID or Key ID; later we will see the need for both means of indexing. Although it is intended that the private-key ring be stored only on the machine of the user that created and owns the key pairs and that it be accessible"}, {"id": "c5c0d752effacd15d94231fcb45c158ca0aebf04", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 249, "start_line": 9, "end_line": 13, "text": "only to that user, it makes sense to make the value of the private key as secure aspossible. Accordingly, the private key itself is not stored in the key ring. Rather, thiskey is encrypted using CAST-128 (or IDEA or 3DES). The procedure is as follows: 1.The user selects a passphrase to be used for encrypting private keys. 2.When the system generates a new public/private key pair using RSA, it asksthe user for the passphrase. Using SHA-1, a 160-bit hash code is generatedfrom the passphrase, and the passphrase is discarded. 3.The system encrypts the private key using CAST-128 with the 128 bits ofthe hash code as the key.The hash code is then discarded, and the encryptedprivate key is stored in the private-key ring. Subsequently, when a user accesses the private-key ring to retrieve a pri-"}, {"id": "0603ca422b3382361d953bec5d7e2cc698abb6cf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 249, "start_line": 14, "end_line": 18, "text": "vate key, he or she must supply the passphrase. PGP will retrieve the encrypted private key, generate the hash code of the passphrase, and decrypt the encryptedprivate key using CAST-128 with the hash code. This is a very compact and effective scheme. As in any system based on pass- words, the security of this system depends on the security of the password. To avoidthe temptation to write it down, the user should use a passphrase that is not easilyguessed but that is easily remembered. Figure 7.4 also shows the general structure of a public-key ring. This data structure is used to store public keys of other users that are known to this user. Forthe moment, let us ignore some fields shown in the figure and describe the followingfields."}, {"id": "f0d8c30db30410a700e5434c8b607fe0ecdf762c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 249, "start_line": 19, "end_line": 28, "text": "\u2022Timestamp: The date/time when this entry was generated. \u2022Key ID: The least significant 64 bits of the public key for this entry. \u2022Public Key: The public key for this entry. \u2022User ID: Identifies the owner of this key. Multiple user IDs may be associated with a single public key. The public-key ring can be indexed by either User ID or Key ID; we will see the need for both means of indexing later. We are now in a position to show how these key rings are used in message transmission and reception. For simplicity, we ignore compression and radix-64 con- version in the following discussion. First consider message transmission (Figure 7.5)and assume that the message is to be both signed and encrypted. The sending PGPentity performs the following steps."}, {"id": "c7142f508d5c3143265ef18d5bf3045b87abf0cf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 250, "start_line": 1, "end_line": 33, "text": "7.1 / PRETTY GOOD PRIVACY 235 Private-key ring Select Encrypted private key DC Message MKey ID MessageIDA HMessage digest EP | |Private key PRa ECRNG Session key Ks Signature /H11001 messageEPPublic-key ring IDBSelect Public key PU b | | Encrypted signature /H11001 messageKey ID OutputH Passphrase Figure 7.5 PGP Message Generation (from User A to User B: no compression or radix-64 conversion) 1.Signing the message: a.PGP retrieves the sender\u2019s private key from the private-key ring usingyour_userid as an index. If your_userid was not provided in the command, the first private key on the ring is retrieved. b.PGP prompts the user for the passphrase to recover the unencrypted privatekey. c.The signature component of the message is constructed. 2.Encrypting the message:"}, {"id": "f67961603039ca629f6f805793ec72a2c790f0e4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 250, "start_line": 34, "end_line": 41, "text": "a.PGP generates a session key and encrypts the message. b.PGP retrieves the recipient\u2019s public key from the public-key ring usingher_userid as an index. c.The session key component of the message is constructed. The receiving PGP entity performs the following steps (Figure 7.6). 1.Decrypting the message: a.PGP retrieves the receiver\u2019s private key from the private-key ring using theKey ID field in the session key component of the message as an index. b.PGP prompts the user for the passphrase to recover the unencryptedprivate key. c.PGP then recovers the session key and decrypts the message."}, {"id": "1bf5c2d03b830cdb7cd083013cbd92463500c4a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 251, "start_line": 1, "end_line": 26, "text": "236 CHAPTER 7 / ELECTRONIC MAIL SECURITY Public-key ringH Private key PRbSelectPassphrase Private-key ring Select Encrypted private keyDC Encryptedmessage /H11001signatureEncryptedsession keyRecei ver's Key ID DP Session key Ks DCEncrypted digestSender's Key ID MessageCompare HPublic key PU a DP Figure 7.6 PGP Message Reception (from User A to User B; no compression or radix-64 conversion) 2.Authenticating the message: a.PGP retrieves the sender\u2019s public key from the public-key ring using the Key ID field in the signature key component of the message as an index. b.PGP recovers the transmitted message digest. c.PGP computes the message digest for the received message and compares itto the transmitted message digest to authenticate. Public-Key Management"}, {"id": "86dc65194525ba1da6e90ab77986a1efd41f1c0b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 251, "start_line": 27, "end_line": 28, "text": "As can be seen from the discussion so far, PGP contains a clever, efficient, interlock-ing set of functions and formats to provide an effective confidentiality and authenti-cation service. To complete the system, one final area needs to be addressed, thatof public-key management. The PGP documentation captures the importance ofthis area: This whole business of protecting public keys from tampering is thesingle most difficult problem in practical public key applications. Itis the \u201cAchilles heel\u201d of public key cryptography, and a lot of soft-ware complexity is tied up in solving this one problem."}, {"id": "30af04f5204655df50a91979104ae461b06d060c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 252, "start_line": 1, "end_line": 7, "text": "7.1 / PRETTY GOOD PRIVACY 237 PGP provides a structure for solving this problem with several suggested options that may be used. Because PGP is intended for use in a variety of formal and informal environments, no rigid public-key management scheme is set up, suchas we will see in our discussion of S/MIME later in this chapter. A PPROACHES TO PUBLIC -KEYMANAGEMENT The essence of the problem is this: User A must build up a public-key ring containing the public keys of other users to"}, {"id": "7206b8261d06dae33c9d8dfc6ebdec20f2ccf341", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 252, "start_line": 8, "end_line": 10, "text": "interoperate with them using PGP . Suppose that A\u2019s key ring contains a public keyattributed to B, but in fact the key is owned by C. This could happen, for example, ifA got the key from a bulletin board system (BBS) that was used by B to post thepublic key but that has been compromised by C. The result is that two threats nowexist. First, C can send messages to A and forge B\u2019s signature so that A will acceptthe message as coming from B. Second, any encrypted message from A to B can beread by C. A number of approaches are possible for minimizing the risk that a user\u2019s public-key ring contains false public keys. Suppose that A wishes to obtain a reliablepublic key for B. The following are some approaches that could be used."}, {"id": "5b50fdb9ea22e9c091ba41e168437f9df84e5f3c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 252, "start_line": 11, "end_line": 12, "text": "1.Physically get the key from B. B could store her public key on a floppydisk and hand it to A. A could then load the key into his system from thefloppy disk.This is a very secure method but has obvious practical limitations. 2.Verify a key by telephone. If A can recognize B on the phone,A could call B andask her to dictate the key, in radix-64 format, over the phone.As a more practicalalternative, B could transmit her key in an e-mail message to A. A could havePGP generate a 160-bit SHA-1 digest of the key and display it in hexadecimalformat; this is referred to as the \u201cfingerprint\u201d of the key. A could then call B andask her to dictate the fingerprint over the phone. If the two fingerprints match,the key is verified."}, {"id": "c42371c6fc8e22e4150871ca18a778e6d041544c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 252, "start_line": 13, "end_line": 13, "text": "3.Obtain B\u2019s public key from a mutual trusted individual D. For this purpose, theintroducer, D, creates a signed certificate. The certificate includes B\u2019s public key,the time of creation of the key, and a validity period for the key. D generates anSHA-1 digest of this certificate, encrypts it with her private key, and attaches thesignature to the certificate. Because only D could have created the signature, noone else can create a false public key and pretend that it is signed by D. Thesigned certificate could be sent directly to A by B or D, or it could be posted on abulletin board."}, {"id": "ac9c8d3593672d3bc4f53e347fc1a2f48fff5ba9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 252, "start_line": 14, "end_line": 21, "text": "4.Obtain B\u2019s public key from a trusted certifying authority. Again, a public-keycertificate is created and signed by the authority. A could then access theauthority, providing a user name and receiving a signed certificate. For cases 3 and 4, A already would have to have a copy of the introducer\u2019s public key and trust that this key is valid. Ultimately, it is up to A to assign a level of trust to anyone who is to act as an introducer. T HEUSE OF TRUST Although PGP does not include any specification for establishing certifying authorities or for establishing trust, it does provide a convenient means of using trust, associating trust with public keys, and exploiting trust information.(PU b)"}, {"id": "f2ace0780127fd3a060c63114292e8532bd93d87", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 253, "start_line": 1, "end_line": 6, "text": "238 CHAPTER 7 / ELECTRONIC MAIL SECURITY The basic structure is as follows. Each entry in the public-key ring is a public- key certificate, as described in the preceding subsection. Associated with each such entry is a key legitimacy field that indicates the extent to which PGP will trust that this is a valid public key for this user; the higher the level of trust, the stronger is thebinding of this user ID to this key. This field is computed by PGP . Also associatedwith the entry are zero or more signatures that the key ring owner has collected thatsign this certificate. In turn, each signature has associated with it a signature trust field that indicates the degree to which this PGP user trusts the signer to certify pub-"}, {"id": "106c215561f2f8bc53f98841378f96ad2bbe36b5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 253, "start_line": 7, "end_line": 9, "text": "lic keys. The key legitimacy field is derived from the collection of signature trustfields in the entry. Finally, each entry defines a public key associated with a particu-lar owner, and an owner trust field is included that indicates the degree to which this public key is trusted to sign other public-key certificates; this level of trust isassigned by the user. We can think of the signature trust fields as cached copies ofthe owner trust field from another entry. The three fields mentioned in the previous paragraph are each contained in a"}, {"id": "182813a8c8a80fefdb32232e342b500c6f1e783d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 253, "start_line": 10, "end_line": 13, "text": "structure referred to as a trust flag byte. The content of this trust flag for each ofthese three uses is shown in Table 7.2. Suppose that we are dealing with the public-key ring of user A. We can describe the operation of the trust processing as follows. 1.When A inserts a new public key on the public-key ring, PGP must assign a value to the trust flag that is associated with the owner of this public key. Ifthe owner is A, and therefore this public key also appears in the private-keyring, then a value of ultimate trust is automatically assigned to the trust field. Table 7.2 Contents of Trust Flag Byte (a) Trust Assigned to"}, {"id": "409abdc07cada2202214cdc4f969cbe25632403a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 253, "start_line": 14, "end_line": 30, "text": "Public-Key Owner(appears after key packet;user defined)(b) Trust Assigned to PublicKey/User ID Pair (appears afterUser ID packet; computed by PGP)(c) Trust Assigned to Signature(appears after signature packet;cached copy of OWNERTRUSTfor this signator) OWNERTRUST Field \u2014undefined trust \u2014unknown user\u2014usually not trusted to sign other keys \u2014usually trusted to sign other keys \u2014always trusted to sign other keys \u2014this key is present in secret key ring (ultimate trust)KEYLEGIT Field \u2014unknown or undefined trust \u2014key ownership not trusted\u2014marginal trust in key ownership\u2014complete trust in key ownershipSIGTRUST Field \u2014undefined trust\u2014unknown user\u2014usually not trusted to sign other keys \u2014usually trusted to sign other keys\u2014always trusted to sign other keys\u2014this key is present in secret key"}, {"id": "e0d7fb107c1a53474c140ed338ad7e209eccbbed", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 253, "start_line": 31, "end_line": 39, "text": "ring (ultimate trust) BUCKSTOP bit \u2014set if this key appears in secret key ringWARNONL Y bit \u2014set if user wants only to be warned when key that is not fully validated is used for encryptionCONTIG bit \u2014set if signature leads up a contiguous trusted certification path back to the ultimatelytrusted key ring owner"}, {"id": "2ab34a6d669f286480f6e3e068c480511587b080", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 254, "start_line": 1, "end_line": 5, "text": "7.1 / PRETTY GOOD PRIVACY 239 Otherwise, PGP asks A for his assessment of the trust to be assigned to the owner of this key, and A must enter the desired level. The user can specifythat this owner is unknown, untrusted, marginally trusted, or completelytrusted. 2.When the new public key is entered, one or more signatures may be attached toit. More signatures may be added later. When a signature is inserted into theentry, PGP searches the public-key ring to see if the author of this signature isamong the known public-key owners. If so, the OWNERTRUST value for thisowner is assigned to the SIGTRUST field for this signature. If not, an unknown user value is assigned."}, {"id": "bf5c3daf7ca6d0f97ac01c0b649601ed91badf7e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 254, "start_line": 6, "end_line": 8, "text": "3.The value of the key legitimacy field is calculated on the basis of the signaturetrust fields present in this entry. If at least one signature has a signature trustvalue of ultimate, then the key legitimacy value is set to complete. Otherwise, PGP computes a weighted sum of the trust values. A weight of 1/ Xis given to signatures that are always trusted and to signatures that are usuallytrusted, where and are user-configurable parameters. When the total ofweights of the introducers of a Key/UserID combination reaches 1, the bind-ing is considered to be trustworthy, and the key legitimacy value is set to com-plete. Thus, in the absence of ultimate trust, at least signatures that arealways trusted, signatures that are usually trusted, or some combination isneeded."}, {"id": "f470f77fe486233622d849e38c50dc8ebcd19956", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 254, "start_line": 9, "end_line": 16, "text": "Periodically, PGP processes the public-key ring to achieve consistency. In essence, this is a top-down process. For each OWNERTRUST field, PGP scans the ring for all signatures authored by that owner and updates the SIGTRUST field toequal the OWNERTRUST field.This process starts with keys for which there is ulti-mate trust. Then all KEYLEGIT fields are computed on the basis of the attachedsignatures. Figure 7.7 provides an example of the way in which signature trust and key legitimacy are related. 2The figure shows the structure of a public-key ring. The user has acquired a number of public keys\u2014some directly from their owners and somefrom a third party such as a key server. The node labeled \u201cYou\u201d refers to the entry in the public-key ring correspond-"}, {"id": "764da33ca751f95608822180de1456ceb411338d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 254, "start_line": 17, "end_line": 18, "text": "ing to this user. This key is legitimate, and the OWNERTRUST value is ultimatetrust. Each other node in the key ring has an OWNERTRUST value of undefinedunless some other value is assigned by the user. In this example, this user has speci-fied that it always trusts the following users to sign other keys: D, E, F, L. This userpartially trusts users A and B to sign other keys. So the shading, or lack thereof, of the nodes in Figure 7.7 indicates the level of"}, {"id": "12242d4165ad67a0a1f6024e733503a3d7a78c33", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 254, "start_line": 19, "end_line": 20, "text": "trust assigned by this user. The tree structure indicates which keys have been signedby which other users. If a key is signed by a user whose key is also in this key ring,the arrow joins the signed key to the signatory. If the key is signed by a user whosekey is not present in this key ring, the arrow joins the signed key to a question mark,indicating that the signatory is unknown to this user.YXY X1/Y 2Figure provided to the author by Phil Zimmermann."}, {"id": "c849d03aa7b59473754f52544f8b0684d0929c1f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 255, "start_line": 1, "end_line": 15, "text": "240 CHAPTER 7 / ELECTRONIC MAIL SECURITY You ABCDEF GHI J K L M NO P Q R S? ?? ?? ?? ? X Y/H11005 X is signed by Y /H11005 key's owner is trusted by you to sign keys /H11005 key's owner is partly trusted by you to sign keys/H11005 key is deemed legitimate by you/H11005 unknown signatory Figure 7.7 PGP Trust Model Example Several points are illustrated in Figure 7.7. 1.Note that all keys whose owners are fully or partially trusted by this user have been signed by this user, with the exception of node L. Such a user signature isnot always necessary, as the presence of node L indicates, but in practice, mostusers are likely to sign the keys for most owners that they trust. So, for exam-ple, even though E\u2019s key is already signed by trusted introducer F, the userchose to sign E\u2019s key directly."}, {"id": "4fafe0d534da83993eeb018e38c6c3a59f2cb4c2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 255, "start_line": 16, "end_line": 16, "text": "2.We assume that two partially trusted signatures are sufficient to certify a key.Hence, the key for user H is deemed legitimate by PGP because it is signed by Aand B, both of whom are partially trusted."}, {"id": "3d37006d0abea8f8ba391f47c51c8e3574f0b927", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 255, "start_line": 17, "end_line": 17, "text": "3.A key may be determined to be legitimate because it is signed by one fullytrusted or two partially trusted signatories, but its user may not be trusted to signother keys. For example, N\u2019s key is legitimate because it is signed by E, whom thisuser trusts, but N is not trusted to sign other keys because this user has notassigned N that trust value.Therefore, although R\u2019s key is signed by N, PGP doesnot consider R\u2019s key legitimate.This situation makes perfect sense. If you wish tosend a private message to some individual, it is not necessary that you trust thatindividual in any respect. It is only necessary that you are sure that you have thecorrect public key for that individual."}, {"id": "769f14ed6bf0d9b84eef64f9806dd462ff95596f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 255, "start_line": 18, "end_line": 18, "text": "4.Figure 7.7 also shows an example of a detached \u201corphan\u201d node S, with twounknown signatures. Such a key may have been acquired from a key server."}, {"id": "c486278dc0cdaae6d0b4dba96517d78f73daa990", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 256, "start_line": 1, "end_line": 5, "text": "7.2 / S/MIME 241 PGP cannot assume that this key is legitimate simply because it came from a reputable server. The user must declare the key legitimate by signing it or bytelling PGP that it is willing to trust fully one of the key\u2019s signatories. A final point: Earlier it was mentioned that multiple user IDs may be associ- ated with a single public key on the public-key ring. This could be because a person"}, {"id": "42953e329eb9c163265d9e7c8e7a1d131c096600", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 256, "start_line": 6, "end_line": 9, "text": "has changed names or has been introduced via signature under multiple names, indi-cating different e-mail addresses for the same person, for example. So we can think ofa public key as the root of a tree. A public key has a number of user IDs associatingwith it, with a number of signatures below each user ID. The binding of a particularuser ID to a key depends on the signatures associated with that user ID and that key,whereas the level of trust in this key (for use in signing other keys) is a function of allthe dependent signatures. R EVOKING PUBLIC KEYS A user may wish to revoke his or her current public key either because compromise is suspected or simply to avoid the use of the same key for"}, {"id": "11ed59d773769f37b7e581fad7dd7934b594b0f9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 256, "start_line": 10, "end_line": 12, "text": "an extended period. Note that a compromise would require that an opponentsomehow had obtained a copy of your unencrypted private key or that the opponenthad obtained both the private key from your private-key ring and your passphrase. The convention for revoking a public key is for the owner to issue a key revo- cation certificate, signed by the owner. This certificate has the same form as a nor-mal signature certificate but includes an indicator that the purpose of this certificateis to revoke the use of this public key. Note that the corresponding private key mustbe used to sign a certificate that revokes a public key. The owner should thenattempt to disseminate this certificate as widely and as quickly as possible to enablepotential correspondents to update their public-key rings."}, {"id": "7e581b4da9b827d1c4a46ecb783732ff22e8f246", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 256, "start_line": 13, "end_line": 15, "text": "Note that an opponent who has compromised the private key of an owner can also issue such a certificate. However, this would deny the opponent as well as thelegitimate owner the use of the public key, and therefore, it seems a much less likelythreat than the malicious use of a stolen private key. 7.2 S/MIME"}, {"id": "fdecaf0c06c8f968e0e18d4984c0e12e4f5d1276", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 256, "start_line": 16, "end_line": 17, "text": "Secure/Multipurpose Internet Mail Extension (S/MIME) is a security enhancementto the MIME Internet e-mail format standard based on technology from RSA DataSecurity. Although both PGP and S/MIME are on an IETF standards track, itappears likely that S/MIME will emerge as the industry standard for commercial andorganizational use, while PGP will remain the choice for personal e-mail security formany users. S/MIME is defined in a number of documents\u2014most importantly RFCs3370, 3850, 3851, and 3852. To understand S/MIME, we need first to have a general understanding of the"}, {"id": "913707268b0a6ef5ad6e627c3005f2c007634a65", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 256, "start_line": 18, "end_line": 19, "text": "underlying e-mail format that it uses, namely MIME. But to understand the signifi-cance of MIME, we need to go back to the traditional e-mail format standard, RFC822, which is still in common use. The most recent version of this format specifica-tion is RFC 5322 ( Internet Message Format ). Accordingly, this section first provides an introduction to these two earlier standards and then moves on to a discussion ofS/MIME."}, {"id": "618e9d0ad3bdbd46246591d739420034ecd0398e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 257, "start_line": 1, "end_line": 5, "text": "242 CHAPTER 7 / ELECTRONIC MAIL SECURITY RFC 5322 RFC 5322 defines a format for text messages that are sent using electronic mail. It has been the standard for Internet-based text mail messages and remains in common use.In the RFC 5322 context, messages are viewed as having an envelope and contents.Theenvelope contains whatever information is needed to accomplish transmission anddelivery. The contents compose the object to be delivered to the recipient. The RFC5322 standard applies only to the contents. However, the content standard includes aset of header fields that may be used by the mail system to create the envelope, and thestandard is intended to facilitate the acquisition of such information by programs. The overall structure of a message that conforms to RFC 5322 is very simple."}, {"id": "a6e3181cb03636314a2a26e24e9b71b7f1f967fe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 257, "start_line": 6, "end_line": 14, "text": "A message consists of some number of header lines ( the header ) followed by unre- stricted text ( the body ). The header is separated from the body by a blank line. Put differently, a message is ASCII text, and all lines up to the first blank line areassumed to be header lines used by the user agent part of the mail system. A header line usually consists of a keyword, followed by a colon, followed by the keyword\u2019s arguments; the format allows a long line to be broken up into severallines.The most frequently used keywords are From, To,Subject , and Date. Here is an example message: Date: October 8, 2009 2:15:49 PM EDT From: William Stallings <ws@shore.net>Subject: The Syntax in RFC 5322To: Smith@Other-host.comCc: Jones@Yet-Another-Host.com Hello. This section begins the actual"}, {"id": "d060884d4675e49e2f483cb0b1e964ab31b84da6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 257, "start_line": 15, "end_line": 20, "text": "message body, which is delimited from themessage heading by a blank line. Another field that is commonly found in RFC 5322 headers is Message-ID . This field contains a unique identifier associated with this message. Multipurpose Internet Mail Extensions Multipurpose Internet Mail Extension (MIME) is an extension to the RFC 5322 framework that is intended to address some of the problems and limitations of theuse of Simple Mail Transfer Protocol (SMTP), defined in RFC 821, or some othermail transfer protocol and RFC 5322 for electronic mail. [PARZ06] lists the follow-ing limitations of the SMTP/5322 scheme."}, {"id": "6de987ceee311d3cb7bbab45200b0233104b7ec7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 257, "start_line": 21, "end_line": 22, "text": "1.SMTP cannot transmit executable files or other binary objects. A number ofschemes are in use for converting binary files into a text form that can be usedby SMTP mail systems, including the popular UNIX UUencode/UUdecodescheme. However, none of these is a standard or even a de facto standard. 2.SMTP cannot transmit text data that includes national language characters,because these are represented by 8-bit codes with values of 128 decimal orhigher, and SMTP is limited to 7-bit ASCII.\" \""}, {"id": "58985db26474bd9e728fe81bd7fd23f917df6ec4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 258, "start_line": 1, "end_line": 11, "text": "7.2 / S/MIME 243 3.SMTP servers may reject mail message over a certain size. 4.SMTP gateways that translate between ASCII and the character code EBCDIC do not use a consistent set of mappings, resulting in translation problems. 5.SMTP gateways to X.400 electronic mail networks cannot handle nontextualdata included in X.400 messages. 6.Some SMTP implementations do not adhere completely to the SMTP standardsdefined in RFC 821. Common problems include: \u2022Deletion, addition, or reordering of carriage return and linefeed \u2022Truncating or wrapping lines longer than 76 characters \u2022Removal of trailing white space (tab and space characters) \u2022Padding of lines in a message to the same length \u2022Conversion of tab characters into multiple space characters"}, {"id": "013df068cd92fdd75cce5026ca84ebf50da4d853", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 258, "start_line": 12, "end_line": 21, "text": "MIME is intended to resolve these problems in a manner that is compatible with existing RFC 5322 implementations. The specification is provided in RFCs2045 through 2049. O VERVIEW The MIME specification includes the following elements. 1.Five new message header fields are defined, which may be included in an RFC 5322 header. These fields provide information about the body of the message. 2.A number of content formats are defined, thus standardizing representationsthat support multimedia electronic mail. 3.Transfer encodings are defined that enable the conversion of any content for-mat into a form that is protected from alteration by the mail system. In this subsection, we introduce the five message header fields. The next two subsections deal with content formats and transfer encodings."}, {"id": "5493b77197318097f26b3d08f7752ef0b457639a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 258, "start_line": 22, "end_line": 32, "text": "The five header fields defined in MIME are \u2022MIME-Version: Must have the parameter value 1.0. This field indicates that the message conforms to RFCs 2045 and 2046. \u2022Content-Type: Describes the data contained in the body with sufficient detail that the receiving user agent can pick an appropriate agent or mechanism to represent the data to the user or otherwise deal with the data in an appropri-ate manner. \u2022Content-Transfer-Encoding: Indicates the type of transformation that has been used to represent the body of the message in a way that is acceptable formail transport. \u2022Content-ID: Used to identify MIME entities uniquely in multiple contexts. \u2022Content-Description: A text description of the object with the body; this is useful when the object is not readable (e.g., audio data)."}, {"id": "3322ffc107437ff90ec9c272cf540c080406a2ca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 258, "start_line": 33, "end_line": 35, "text": "Any or all of these fields may appear in a normal RFC 5322 header.A compliant implementation must support the MIME-Version, Content-Type, and Content- Transfer-Encoding fields; the Content-ID and Content-Description fields are optionaland may be ignored by the recipient implementation."}, {"id": "fc6cfb63eaec3f7c286788bed552eb7aaae29186", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 259, "start_line": 1, "end_line": 7, "text": "244 CHAPTER 7 / ELECTRONIC MAIL SECURITY MIME C ONTENT TYPES The bulk of the MIME specification is concerned with the definition of a variety of content types. This reflects the need to provide standardized ways of dealing with a wide variety of information representations in amultimedia environment. Table 7.3 lists the content types specified in RFC 2046. There are seven different major types of content and a total of 15 subtypes. In general, a content type declares thegeneral type of data, and the subtype specifies a particular format for that type of data. For the text type of body, no special software is required to get the full meaning"}, {"id": "07e023f772502dedfacb5e34dc0a885ef33d11a0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 259, "start_line": 8, "end_line": 12, "text": "of the text aside from support of the indicated character set. The primary subtype isplain text, which is simply a string of ASCII characters or ISO 8859 characters. Theenriched subtype allows greater formatting flexibility. The multipart type indicates that the body contains multiple, independent parts. The Content-Type header field includes a parameter (called a boundary) thatdefines the delimiter between body parts. This boundary should not appear in anyparts of the message. Each boundary starts on a new line and consists of twohyphens followed by the boundary value. The final boundary, which indicates theend of the last part, also has a suffix of two hyphens. Within each part, there may bean optional ordinary MIME header. Table 7.3 MIME Content Types Type Subtype Description"}, {"id": "b70996797b091d8fb4972a9153edba4faaad9490", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 259, "start_line": 13, "end_line": 20, "text": "Text Plain Unformatted text; may be ASCII or ISO 8859. Enriched Provides greater format flexibility. Multipart Mixed The different parts are independent but are to be transmitted together. They should be presented to the receiver in the order that they appear in the mailmessage. Parallel Differs from Mixed only in that no order is defined for delivering the parts tothe receiver. Alternative The different parts are alternative versions of the same information. They areordered in increasing faithfulness to the original, and the recipient\u2019s mailsystem should display the \u201cbest\u201d version to the user. Digest Similar to Mixed, but the default type/subtype of each part is message/rfc822. Message rfc822 The body is itself an encapsulated message that conforms to RFC 822."}, {"id": "64003e8fa8ee5049d88ee3c97bc14f5a99e61306", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 259, "start_line": 21, "end_line": 28, "text": "Partial Used to allow fragmentation of large mail items, in a way that is transparentto the recipient. External-body Contains a pointer to an object that exists elsewhere. Image jpeg The image is in JPEG format, JFIF encoding. gif The image is in GIF format. Video mpeg MPEG format. Audio Basic Single-channel 8-bit ISDN mu-law encoding at a sample rate of 8 kHz. Application PostScript Adobe Postscript format. octet-stream General binary data consisting of 8-bit bytes."}, {"id": "e25f01e8e63d8c7f42182883c76fe7f8f90febbe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 260, "start_line": 1, "end_line": 16, "text": "7.2 / S/MIME 245 Here is a simple example of a multipart message containing two parts\u2014both consisting of simple text (taken from RFC 2046). From: Nathaniel Borenstein <nsb@bellcore.com> To: Ned Freed <ned@innosoft.com>Subject: Sample messageMIME-Version: 1.0Content-type: multipart/mixed; boundary=\"simple boundary\" This is the preamble. It is to be ignored, though it is a handy place for mail composers to include anexplanatory note to non-MIME conformant readers. \u2014simple boundary This is implicitly typed plain ASCII text. It does NOT end with a linebreak. \u2014simple boundaryContent-type: text/plain; charset=us-ascii This is explicitly typed plain ASCII text. It DOES end with a linebreak. \u2014simple boundary\u2014 This is the epilogue. It is also to be ignored."}, {"id": "d43ad7b22d0dea00b56bf1e76269afb2a5f62fd5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 260, "start_line": 17, "end_line": 24, "text": "There are four subtypes of the multipart type, all of which have the same over- all syntax. The multipart/mixed subtype is used when there are multiple indepen- dent body parts that need to be bundled in a particular order. For the multipart/parallel subtype, the order of the parts is not significant. If the recipient\u2019s system is appropriate, the multiple parts can be presented in parallel. For example, apicture or text part could be accompanied by a voice commentary that is playedwhile the picture or text is displayed. For the multipart/alternative subtype, the various parts are different represen- tations of the same information. The following is an example: From: Nathaniel Borenstein <nsb@bellcore.com>"}, {"id": "b177e77396aa528297084a4d9ec3e70e8c452963", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 260, "start_line": 25, "end_line": 29, "text": "To: Ned Freed <ned@innosoft.com>Subject: Formatted text mailMIME-Version: 1.0Content-Type: multipart/alternative; boundary=boundary42 \u2014boundary42 Content-Type: text/plain; charset=us-ascii ...plain text version of message goes here...."}, {"id": "2f9631db7e3b72d45de7bfccbe124db3a6090a22", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 261, "start_line": 1, "end_line": 11, "text": "246 CHAPTER 7 / ELECTRONIC MAIL SECURITY \u2014boundary42 Content-Type: text/enriched .... RFC 1896 text/enriched version of same message goes here ... \u2014boundary42\u2014 In this subtype, the body parts are ordered in terms of increasing preference. For this example, if the recipient system is capable of displaying the message in the text/enriched format, this is done; otherwise, the plain text format is used. The multipart/digest subtype is used when each of the body parts is inter- preted as an RFC 5322 message with headers. This subtype enables the constructionof a message whose parts are individual messages. For example, the moderator of agroup might collect e-mail messages from participants, bundle these messages, andsend them out in one encapsulating MIME message."}, {"id": "a4a7fe0ed1202b2563ed79120bc7bfde8d05e083", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 261, "start_line": 12, "end_line": 19, "text": "The message type provides a number of important capabilities in MIME. The message/rfc822 subtype indicates that the body is an entire message, including header and body. Despite the name of this subtype, the encapsulated message maybe not only a simple RFC 5322 message but also any MIME message. The message/partial subtype enables fragmentation of a large message into a number of parts, which must be reassembled at the destination. For this subtype,three parameters are specified in the Content-Type: Message/Partial field: an id common to all fragments of the same message, a sequence number unique to each fragment, and the total number of fragments. The message/external-body subtype indicates that the actual data to be con-"}, {"id": "0a728778f8743fcb769e45eed4f8c09768248d16", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 261, "start_line": 20, "end_line": 23, "text": "veyed in this message are not contained in the body. Instead, the body contains theinformation needed to access the data. As with the other message types, the mes-sage/external-body subtype has an outer header and an encapsulated message withits own header. The only necessary field in the outer header is the Content-Typefield, which identifies this as a message/external-body subtype. The inner header isthe message header for the encapsulated message. The Content-Type field in theouter header must include an access-type parameter, which indicates the method ofaccess, such as FTP (file transfer protocol). The application type refers to other kinds of data, typically either uninter- preted binary data or information to be processed by a mail-based application. MIME T"}, {"id": "d80101f704a435e9fa20df530d4f645582b14829", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 261, "start_line": 24, "end_line": 28, "text": "RANSFER ENCODINGS The other major component of the MIME specification, in addition to content type specification, is a definition of transfer encodings for message bodies. The objective is to provide reliable delivery acrossthe largest range of environments. The MIME standard defines two methods of encoding data. The Content- Transfer-Encoding field can actually take on six values, as listed in Table 7.4.However, three of these values (7bit, 8bit, and binary) indicate that no encoding hasbeen done but provide some information about the nature of the data. For SMTPtransfer, it is safe to use the 7bit form. The 8bit and binary forms may be usable inother mail transport contexts. Another Content-Transfer-Encoding value is x-token,"}, {"id": "ef663d5d8879128de97e4929f9c47502fb9b1c13", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 262, "start_line": 1, "end_line": 5, "text": "7.2 / S/MIME 247 which indicates that some other encoding scheme is used for which a name is to be supplied. This could be a vendor-specific or application-specific scheme. The twoactual encoding schemes defined are quoted-printable and base64. Two schemes aredefined to provide a choice between a transfer technique that is essentially humanreadable and one that is safe for all types of data in a way that is reasonably compact. The quoted-printable transfer encoding is useful when the data consists largely of octets that correspond to printable ASCII characters. In essence, itrepresents nonsafe characters by the hexadecimal representation of their code andintroduces reversible (soft) line breaks to limit message lines to 76 characters."}, {"id": "3094069109b22be489de57f153bd6dc861a870e7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 262, "start_line": 6, "end_line": 13, "text": "The base64 transfer encoding, also known as radix-64 encoding, is a common one for encoding arbitrary binary data in such a way as to be invulnerable to theprocessing by mail-transport programs. It is also used in PGP and is described inAppendix 7A. A M ULTIPART EXAMPLE Figure 7.8, taken from RFC 2045, is the outline of a complex multipart message. The message has five parts to be displayed serially: two introductory plain text parts, an embedded multipart message, a richtext part, and aclosing encapsulated text message in a non-ASCII character set. The embeddedmultipart message has two parts to be displayed in parallel: a picture and an audiofragment. C ANONICAL FORM An important concept in MIME and S/MIME is that of"}, {"id": "a15baa66b007f96a07960b06b37301a4051fa0c7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 262, "start_line": 14, "end_line": 20, "text": "canonical form. Canonical form is a format, appropriate to the content type, that is standardized for use between systems. This is in contrast to native form, which is aformat that may be peculiar to a particular system. Table 7.5, from RFC 2049, shouldhelp clarify this matter. S/MIME Functionality In terms of general functionality, S/MIME is very similar to PGP . Both offer theability to sign and/or encrypt messages. In this subsection, we briefly summarizeS/MIME capability.We then look in more detail at this capability by examining mes-sage formats and message preparation.Table 7.4 MIME Transfer Encodings 7bit The data are all represented by short lines of ASCII characters. 8bit The lines are short, but there may be non-ASCII characters (octets with the high-order bit set)."}, {"id": "74bbf570391c170b1afeb4b8f52b89ac59d1f0f1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 262, "start_line": 21, "end_line": 24, "text": "binary Not only may non-ASCII characters be present, but the lines are not necessar-ily short enough for SMTP transport. quoted-printable Encodes the data in such a way that if the data being encoded are mostlyASCII text, the encoded form of the data remains largely recognizable byhumans. base64 Encodes data by mapping 6-bit blocks of input to 8-bit blocks of output, all ofwhich are printable ASCII characters. x-token A named nonstandard encoding."}, {"id": "62b5ba26db30185267855b2fdc90412458eb3a6c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 263, "start_line": 1, "end_line": 14, "text": "248 CHAPTER 7 / ELECTRONIC MAIL SECURITY MIME-Version: 1.0 From: Nathaniel Borenstein <nsb@bellcore.com> To: Ned Freed <ned@innosoft.com>Subject: A multipart exampleContent-Type: multipart/mixed; boundary=unique-boundary-1 This is the preamble area of a multipart message. Mail readers that understand multipart format should ignore this preamble. If you are reading this text, you might want to consider changing to a mail reader that understands how to properly display multipart messages. --unique-boundary-1 ...Some text appears here... [Note that the preceding blank line means no header f ields were gi ven and this is text, with charset US ASCII. It could have been done with explicit typing as in the next part.] --unique-boundary-1 Content-type: text/plain; charset=US-ASCII"}, {"id": "e0baf95bf08dd6c8ffa16f62a831fb31fecd61c3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 263, "start_line": 15, "end_line": 31, "text": "This could have been part of the previous part, but illustrates explici t versus implicit typing of body parts. --unique-boundary-1 Content-T ype: multipart/parallel; boundary=unique-boundary-2 --unique-boundary-2Content-Type: audio/basic Content-Transfer-Encoding: base64 ... base64-encoded 8000 Hz single-channel mu-law-format audio data goes here.... --unique-boundary-2Content-Type: image/jpegContent-Transfer-Encoding: base64 ... base64-encoded image data goes here.... --unique-boundary-2-- --unique-boundary-1 Content-type: text/enriched This is <bold><italic>richtext.</italic></bold> <smaller>as def ined in RFC 1896</smaller> Isn't it <bigger><bigger>cool?</bigger></bigger> --unique-boundary-1 Content-Type: message/rfc822 From: (mailbox in US-ASCII)"}, {"id": "08e169cc839b83bdfc28d609d9a2daca72f5b3f5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 263, "start_line": 32, "end_line": 38, "text": "To: (address in US-ASCII)Subject: (subject in US-ASCII) Content-Type: Text/plai n; charset=ISO-8859-1 Content-T ransfer-Encoding: Quoted-printable ... Additional text in ISO-8859-1 goes here ... --unique-boundar y-1-- Figure 7.8 Example MIME Message Structure"}, {"id": "24f720beb1f31c8837e845b71fbb780543e02845", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 264, "start_line": 1, "end_line": 9, "text": "7.2 / S/MIME 249 FUNCTIONS S/MIME provides the following functions. \u2022Enveloped data: This consists of encrypted content of any type and encrypted- content encryption keys for one or more recipients. \u2022Signed data: A digital signature is formed by taking the message digest of the content to be signed and then encrypting that with the private key of the signer. The content plus signature are then encoded using base64 encoding. A signeddata message can only be viewed by a recipient with S/MIME capability. \u2022Clear-signed data: As with signed data, a digital signature of the content is formed. However, in this case, only the digital signature is encoded usingbase64.As a result, recipients without S/MIME capability can view the messagecontent, although they cannot verify the signature."}, {"id": "cff8ed0c579edf02ce0e9132b2dfb4d8cd8e42dc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 264, "start_line": 10, "end_line": 18, "text": "\u2022Signed and enveloped data: Signed-only and encrypted-only entities may be nested, so that encrypted data may be signed and signed data or clear-signeddata may be encrypted. C RYPTOGRAPHIC ALGORITHMS Table 7.6 summarizes the cryptographic algorithms used in S/MIME. S/MIME uses the following terminology taken from RFC 2119 (Key Wordsfor use in RFCs to Indicate Requirement Levels ) to specify the requirement level: \u2022MUST: The definition is an absolute requirement of the specification. An implementation must include this feature or function to be in conformancewith the specification. \u2022SHOULD: There may exist valid reasons in particular circumstances to ignore this feature or function, but it is recommended that an implementation includethe feature or function."}, {"id": "67e6f94bed68bddc5a109cd0ebc4c2b0c2c69d36", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 264, "start_line": 19, "end_line": 22, "text": "S/MIME incorporates three public-key algorithms. The Digital Signature Standard (DSS) described in Chapter 3 is the preferred algorithm for digital signature. S/MIME lists Diffie-Hellman as the preferred algorithm for encryptingsession keys; in fact, S/MIME uses a variant of Diffie-Hellman that does provideTable 7.5 Native and Canonical Form Native"}, {"id": "721e3d11eb3643b5724bb3bf6364248b45ae6f36", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 264, "start_line": 23, "end_line": 23, "text": "FormThe body to be transmitted is created in the system\u2019s native format. The native char-acter set is used and, where appropriate, local end-of-line conventions are used aswell. The body may be a UNIX-style text file, or a Sun raster image, or a VMSindexed file, or audio data in a system-dependent format stored only in memory, oranything else that corresponds to the local model for the representation of someform of information. Fundamentally, the data is created in the \u201cnative\u201d form thatcorresponds to the type specified by the media type."}, {"id": "7275ee5a93ecfb5761bbd48644990d9591307715", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 264, "start_line": 24, "end_line": 24, "text": "CanonicalForm The entire body, including \u201cout-of-band\u201d information such as record lengths and pos-sibly file attribute information, is converted to a universal canonical form. The spe-cific media type of the body as well as its associated attributes dictate the nature ofthe canonical form that is used. Conversion to the proper canonical form mayinvolve character set conversion, transformation of audio data, compression, or vari-ous other operations specific to the various media types. If character set conversionis involved, however, care must be taken to understand the semantics of the mediatype, which may have strong implications for any character set conversion (e.g., withregard to syntactically meaningful characters in a text subtype other than \u201cplain\u201d)."}, {"id": "8e820a4cd111d90b90c12e4a9e2af1a22c14a5eb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 265, "start_line": 1, "end_line": 13, "text": "250 CHAPTER 7 / ELECTRONIC MAIL SECURITY Table 7.6 Cryptographic Algorithms Used in S/MIME Function Requirement Create a message digest to be used in forming a digital signature.MUST support SHA-1. Receiver SHOULD support MD5 for backward compatibility. Encrypt message digest to form a digital signature.Sending and receiving agents MUST support DSS. Sending agents SHOULD support RSA encryption.Receiving agents SHOULD support verification of RSA signatures with key sizes 512 bits to 1024 bits. Encrypt session key for transmission witha message. Sending and receiving agents SHOULD support Diffie-Hellman. Sending and receiving agents MUST support RSA encryption with key sizes 512 bits to 1024 bits."}, {"id": "9279ba722729ac7d4f87f0b632b276ff909c087a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 265, "start_line": 14, "end_line": 17, "text": "Encrypt message for transmission with aone-time session key. Sending and receiving agents MUST support encryption withtripleDES. Sending agents SHOULD support encryption with AES.Sending agents SHOULD support encryption with RC2/40. Create a message authentication code. Receiving agents MUST support HMAC with SHA-1.Sending agents SHOULD support HMAC with SHA-1. encryption/decryption, known as ElGamal. As an alternative, RSA, described in"}, {"id": "c27099ae4a44e4d11cefe6194ef9a73024934070", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 265, "start_line": 18, "end_line": 21, "text": "Chapter 3, can be used for both signatures and session key encryption.These are thesame algorithms used in PGP and provide a high level of security. For the hashfunction used to create the digital signature, the specification requires the 160-bitSHA-1 but recommends receiver support for the 128-bit MD5 for backward com-patibility with older versions of S/MIME. As we discussed in Chapter 3, there isjustifiable concern about the security of MD5, so SHA-1 is clearly the preferredalternative. For message encryption, three-key triple DES (tripleDES) is recommended, but compliant implementations must support 40-bit RC2. The latter is a weakencryption algorithm but allows compliance with U.S. export controls. The S/MIME specification includes a discussion of the procedure for deciding"}, {"id": "18fbe5d475b9f6076c3be13897a5a43255b4634a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 265, "start_line": 22, "end_line": 24, "text": "which content encryption algorithm to use. In essence, a sending agent has two deci-sions to make. First, the sending agent must determine if the receiving agent is capa-ble of decrypting using a given encryption algorithm. Second, if the receiving agentis only capable of accepting weakly encrypted content, the sending agent mustdecide if it is acceptable to send using weak encryption. To support this decisionprocess, a sending agent may announce its decrypting capabilities in order of prefer-ence for any message that it sends out.A receiving agent may store that informationfor future use. The following rules, in the following order, should be followed by a sending agent."}, {"id": "8baf23fb57705a80d6aca1eee47076547ca8ad81", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 265, "start_line": 25, "end_line": 25, "text": "1.If the sending agent has a list of preferred decrypting capabilities from anintended recipient, it SHOULD choose the first (highest preference) capabil-ity on the list that it is capable of using."}, {"id": "f5144b76166334df6eac0ff50826ef128197434b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 266, "start_line": 1, "end_line": 5, "text": "7.2 / S/MIME 251 2.If the sending agent has no such list of capabilities from an intended recipient but has received one or more messages from the recipient, then the outgoing mes-sage SHOULD use the same encryption algorithm as was used on the last signedand encrypted message received from that intended recipient. 3.If the sending agent has no knowledge about the decryption capabilities of theintended recipient and is willing to risk that the recipient may not be able todecrypt the message, then the sending agent SHOULD use triple DES. 4.If the sending agent has no knowledge about the decryption capabilities of theintended recipient and is not willing to risk that the recipient may not be ableto decrypt the message, then the sending agent MUST use RC2/40."}, {"id": "f0614bf5f7218acf05238a57aa51bb4a68c293e4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 266, "start_line": 6, "end_line": 14, "text": "If a message is to be sent to multiple recipients and a common encryption algorithm cannot be selected for all, then the sending agent will need to send two messages. However, in that case, it is important to note that the security of the mes-sage is made vulnerable by the transmission of one copy with lower security. S/MIME Messages S/MIME makes use of a number of new MIME content types, which are shown inTable 7.7. All of the new application types use the designation PKCS. This refers toa set of public-key cryptography specifications issued by RSA Laboratories andmade available for the S/MIME effort. We examine each of these in turn after first looking at the general procedures for S/MIME message preparation. S ECURING A MIME E NTITY S/MIME secures a MIME entity with a signature,"}, {"id": "479d5e12b4f4a464c787d7bfc6bf29b27fe8236e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 266, "start_line": 15, "end_line": 17, "text": "encryption, or both. A MIME entity may be an entire message (except for the RFC 5322 headers), or if the MIME content type is multipart, then a MIME entity isone or more of the subparts of the message.The MIME entity is prepared accordingto the normal rules for MIME message preparation. Then the MIME entity plussome security-related data, such as algorithm identifiers and certificates, areprocessed by S/MIME to produce what is known as a PKCS object. A PKCS objectis then treated as message content and wrapped in MIME (provided withappropriate MIME headers). This process should become clear as we look atspecific objects and provide examples. In all cases, the message to be sent is converted to canonical form. In particu-"}, {"id": "a6803d40d66ef99b8d45e374d5276cfa96dc810b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 266, "start_line": 18, "end_line": 19, "text": "lar, for a given type and subtype, the appropriate canonical form is used for the mes-sage content. For a multipart message, the appropriate canonical form is used foreach subpart. The use of transfer encoding requires special attention. For most cases, the result"}, {"id": "c657bc9913ab7ed7cc60e40c0796938fbb257e23", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 266, "start_line": 20, "end_line": 21, "text": "of applying the security algorithm will be to produce an object that is partially or totallyrepresented in arbitrary binary data. This will then be wrapped in an outer MIME message, and transfer encoding can be applied at that point, typically base64. However,in the case of a multipart signed message (described in more detail later), the messagecontent in one of the subparts is unchanged by the security process. Unless that contentis 7bit, it should be transfer encoded using base64 or quoted-printable so that there isno danger of altering the content to which the signature was applied. We now look at each of the S/MIME content types."}, {"id": "cc8628a1e5458bc9e9c3db4c4c9863aa504d6f3f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 267, "start_line": 1, "end_line": 11, "text": "Table 7.7 S/MIME Content Types Type Subtype smime Parameter Description Multipart Signed A clear-signed message in two parts: one is the message and the other is the signature. Application pkcs7-mime signedData A signed S/MIME entity. pkcs7-mime envelopedData An encrypted S/MIME entity. pkcs7-mime degeneratesignedData An entity containing only public-key certificates. pkcs7-mime CompressedData A compressed S/MIME entity. pkcs7-signature signedData The content type of the signature subpart of amultipart/signed message.252 CHAPTER 7 / ELECTRONIC MAIL SECURITY ENVELOPED DATA An application/pkcs7-mime subtype is used for one of four categories of S/MIME processing, each with a unique smime-type parameter. In all"}, {"id": "118e286b2bb0136f719210fffd25506e65c48e7c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 267, "start_line": 12, "end_line": 19, "text": "cases, the resulting entity (referred to as an object ) is represented in a form known as Basic Encoding Rules (BER), which is defined in ITU-T RecommendationX.209. The BER format consists of arbitrary octet strings and is therefore binarydata. Such an object should be transfer encoded with base64 in the outer MIMEmessage. We first look at envelopedData. The steps for preparing an envelopedData MIME entity are 1.Generate a pseudorandom session key for a particular symmetric encryp-tion algorithm (RC2/40 or triple DES). 2.For each recipient, encrypt the session key with the recipient\u2019s public RSA key. 3.For each recipient, prepare a block known as RecipientInfo that contains an identifier of the recipient\u2019s public-key certificate, 3an identifier of the algo-"}, {"id": "9e52180714671b91dfde69abc5acf52c80663fec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 267, "start_line": 20, "end_line": 31, "text": "rithm used to encrypt the session key, and the encrypted session key. 4.Encrypt the message content with the session key. The RecipientInfo blocks followed by the encrypted content constitute the envelopedData . This information is then encoded into base64. A sample message (excluding the RFC 5322 headers) is Content-Type: application/pkcs7-mime; smime-type=enveloped- data; name=smime.p7m Content-Transfer-Encoding: base64 Content-Disposition: attachment; filename=smime.p7m rfvbnj756tbBghyHhHUujhJhjH77n8HHGT9HG4VQpfyF467GhIGfHfYT6 7n8HHGghyHhHUujhJh4VQpfyF467GhIGfHfYGTrfvbnjT6jH7756tbB9Hf8HHGTrfvhJhjH776tbB9HG4VQbnj7567GhIGfHfYT6ghyHhHUujpfyF40GhIGfHfQbnj756YT64V 3This is an X.509 certificate, discussed later in this section."}, {"id": "6d72dd2dfba9416417038255e3a8df1867414844", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 268, "start_line": 1, "end_line": 11, "text": "7.2 / S/MIME 253 To recover the encrypted message, the recipient first strips off the base64 encoding. Then the recipient\u2019s private key is used to recover the session key. Finally, the message content is decrypted with the session key. SIGNED DATA The signedData smime-type can be used with one or more signers. For clarity, we confine our description to the case of a single digital signature. The steps for preparing a signedData MIME entity are 1.Select a message digest algorithm (SHA or MD5). 2.Compute the message digest (hash function) of the content to be signed. 3.Encrypt the message digest with the signer\u2019s private key. 4.Prepare a block known as SignerInfo that contains the signer\u2019s public-"}, {"id": "7e8341aea9bc90e9bb4dfe4908bbbe76fb2b0a25", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 268, "start_line": 12, "end_line": 20, "text": "key certificate, an identifier of the message digest algorithm, an identifier ofthe algorithm used to encrypt the message digest, and the encrypted mes-sage digest. The signedData entity consists of a series of blocks, including a message digest algorithm identifier, the message being signed, and SignerInfo .T h e signedData entity may also include a set of public-key certificates sufficient to constitute a chain from a recognized root or top-level certification authority to thesigner. This information is then encoded into base64. A sample message (excludingthe RFC 5322 headers) is Content-Type: application/pkcs7-mime; smime-type=signed- data; name=smime.p7m Content-Transfer-Encoding: base64 Content-Disposition: attachment; filename=smime.p7m"}, {"id": "bb9d2ffb2dd77c319269c204f7d95b2d98253f9d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 268, "start_line": 21, "end_line": 28, "text": "567GhIGfHfYT6ghyHhHUujpfyF4f8HHGTrfvhJhjH776tbB9HG4VQbnj7 77n8HHGT9HG4VQpfyF467GhIGfHfYT6rfvbnj756tbBghyHhHUujhJhjHHUujhJh4VQpfyF467GhIGfHfYGTrfvbnjT6jH7756tbB9H7n8HHGghyHh6YT64V0GhIGfHfQbnj75 To recover the signed message and verify the signature, the recipient first strips off the base64 encoding. Then the signer\u2019s public key is used to decrypt the message digest. The recipient independently computes the message digest and com-pares it to the decrypted message digest to verify the signature. C LEAR SIGNING Clear signing is achieved using the multipart content type with a signed subtype. As was mentioned, this signing process does not involve"}, {"id": "b66f382f21c297466211545e63176476993b3722", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 268, "start_line": 29, "end_line": 31, "text": "transforming the message to be signed, so that the message is sent \u201cin the clear.\u201dThus, recipients with MIME capability but not S/MIME capability are able to readthe incoming message. A multipart/signed message has two parts. The first part can be any MIME type but must be prepared so that it will not be altered during transfer from sourceto destination.This means that if the first part is not 7bit, then it needs to be encoded"}, {"id": "eb676acdffb81c52ebc764d8dd652b0c68b7c538", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 269, "start_line": 1, "end_line": 9, "text": "254 CHAPTER 7 / ELECTRONIC MAIL SECURITY using base64 or quoted-printable. Then this part is processed in the same manner as signedData, but in this case an object with signedData format is created that has an empty message content field. This object is a detached signature. It is thentransfer encoded using base64 to become the second part of the multipart/signedmessage. This second part has a MIME content type of application and a subtype ofpkcs7-signature. Here is a sample message: Content-Type: multipart/signed; protocol=\"application/pkcs7-signature\"; micalg=sha1; boundary=boundary42 \u2014boundary42Content-Type: text/plain This is a clear-signed message.\u2014boundary42"}, {"id": "9966f80edc2303ed17ac332a4afe80757b097210", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 269, "start_line": 10, "end_line": 18, "text": "Content-Type: application/pkcs7-signature; name=smime.p7sContent-Transfer-Encoding: base64Content-Disposition: attachment; filename=smime.p7s ghyHhHUujhJhjH77n8HHGTrfvbnj756tbB9HG4VQpfyF467GhIGfHfYT6 4VQpfyF467GhIGfHfYT6jH77n8HHGghyHhHUujhJh756tbB9HGTrfvbnjn8HHGTrfvhJhjH776tbB9HG4VQbnj7567GhIGfHfYT6ghyHhHUujpfyF47GhIGfHfYT64VQbnj756\u2014boundary42\u2014 The protocol parameter indicates that this is a two-part clear-signed entity. The micalg parameter indicates the type of message digest used. The receiver can verify the signature by taking the message digest of the first part and comparing this to the message digest recovered from the signature in the second part. R EGISTRATION REQUEST Typically, an application or user will apply to a certification"}, {"id": "8adaee21fbb05150262c208805a8d500bd9f34cc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 269, "start_line": 19, "end_line": 27, "text": "authority for a public-key certificate.The application/pkcs10 S/MIME entity is used to transfer a certification request. The certification request includes certification RequestInfo block, followed by an identifier of the public-key encryption algorithm, followed by the signature of the certificationRequestInfo block made using the sender\u2019s private key. The certificationRequestInfo block includes a name of the certificate subject (the entity whose public key is to becertified) and a bit-string representation of the user\u2019s public key. C ERTIFICATES -ONLYMESSAGE A message containing only certificates or a certificate revocation list (CRL) can be sent in response to a registration request. The message"}, {"id": "9f9bdf70a10e89f2db626ffeef0bf6b9384c6511", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 269, "start_line": 28, "end_line": 30, "text": "is an application/pkcs7-mime type/subtype with an smime-type parameter ofdegenerate. The steps involved are the same as those for creating a signedData message, except that there is no message content and the signerInfo field is empty."}, {"id": "80f5a7788455397e873e142ff805775c6f52a7da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 270, "start_line": 1, "end_line": 8, "text": "7.2 / S/MIME 255 S/MIME Certificate Processing S/MIME uses public-key certificates that conform to version 3 of X.509 (see Chapter 4). The key-management scheme used by S/MIME is in some ways ahybrid between a strict X.509 certification hierarchy and PGP\u2019s web of trust.As with the PGP model, S/MIME managers and/or users must configure each clientwith a list of trusted keys and with certificate revocation lists. That is, the responsi-bility is local for maintaining the certificates needed to verify incoming signaturesand to encrypt outgoing messages. On the other hand, the certificates are signed bycertification authorities. U SERAGENT ROLE An S/MIME user has several key-management functions to perform. \u2022Key generation: The user of some related administrative utility (e.g., one asso-"}, {"id": "e34efd312dd7bb832934babed306540cd020f34e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 270, "start_line": 9, "end_line": 13, "text": "ciated with LAN management) MUST be capable of generating separate Diffie-Hellman and DSS key pairs and SHOULD be capable of generatingRSA key pairs. Each key pair MUST be generated from a good source of non-deterministic random input and be protected in a secure fashion. A user agentSHOULD generate RSA key pairs with a length in the range of 768 to 1024 bitsand MUST NOT generate a length of less than 512 bits. \u2022Registration: A user\u2019s public key must be registered with a certification authority in order to receive an X.509 public-key certificate. \u2022Certificate storage and retrieval: A user requires access to a local list of certifi-"}, {"id": "0d582f6b2961c89862cbae7ea26de9009caa4aa0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 270, "start_line": 14, "end_line": 18, "text": "cates in order to verify incoming signatures and to encrypt outgoing messages.Such a list could be maintained by the user or by some local administrativeentity on behalf of a number of users. V ERISIGNCERTIFICATES There are several companies that provide certification authority (CA) services. For example, Nortel has designed an enterprise CA solution and canprovide S/MIME support within an organization.There are a number of Internet-basedCAs, including VeriSign, GTE, and the U.S. Postal Service. Of these, the most widelyused is the VeriSign CA service, a brief description of which we now provide. VeriSign provides a CA service that is intended to be compatible with S/MIME"}, {"id": "0e39e0ea34e4dfd5adeeb931eba8a193c0f0364c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 270, "start_line": 19, "end_line": 27, "text": "and a variety of other applications.VeriSign issues X.509 certificates with the productname VeriSign Digital ID. As of early 1998, over 35,000 commercial Web sites wereusing VeriSign Server Digital IDs, and over a million consumer Digital IDs had beenissued to users of Netscape and Microsoft browsers. The information contained in a Digital ID depends on the type of Digital ID and its use. At a minimum, each Digital ID contains \u2022Owner\u2019s public key \u2022Owner\u2019s name or alias \u2022Expiration date of the Digital ID \u2022Serial number of the Digital ID \u2022Name of the certification authority that issued the Digital ID \u2022Digital signature of the certification authority that issued the Digital ID"}, {"id": "ac27103ae0e0411086e703f70f9cfd368f3fc281", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 271, "start_line": 1, "end_line": 9, "text": "256 CHAPTER 7 / ELECTRONIC MAIL SECURITY Digital IDs can also contain other user-supplied information, including \u2022Address \u2022E-mail address \u2022Basic registration information (country, zip code, age, and gender) VeriSign provides three levels, or classes, of security for public-key certificates, as summarized in Table 7.8. A user requests a certificate online at VeriSign\u2019s Web site or other participating Web sites. Class 1 and Class 2 requests are processed on line, and in most cases take only a few seconds to approve. Briefly, the followingprocedures are used. \u2022For Class 1 Digital IDs, VeriSign confirms the user\u2019s e-mail address by sendinga PIN and Digital ID pick-up information to the e-mail address provided inthe application."}, {"id": "02099d623955bb41945bc34ce04bef73b5ba7704", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 271, "start_line": 10, "end_line": 16, "text": "\u2022For Class 2 Digital IDs, VeriSign verifies the information in the applicationthrough an automated comparison with a consumer database in addition to Table 7.8 Verisign Public-Key Certificate Classes Class 1 Class 2 Class 3 Summary of Confirmationof IdentityAutomated unam-biguous name and e-mail address search.Same as Class 1, plusautomated enrollment infor-mation check and automatedaddress check.Same as Class 1, plus personalpresence and ID documentsplus Class 2 automated IDcheck for individuals; businessrecords (or filings) fororganizations. IA Private KeyProtection PCA: trustworthyhardware; CA: trust-worthy software ortrustworthy hardware.PCA and CA: trustworthyhardware. PCA and CA: trustworthyhardware."}, {"id": "547f4e3c27a711651578356ec5c887bbafb3df49", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 271, "start_line": 17, "end_line": 20, "text": "CertificateApplicant andSubscriberPrivate KeyProtectionEncryption software(PIN protected)recommended but notrequired.Encryption software (PINprotected) required. Encryption software (PINprotected) required; hardwaretoken recommended but notrequired. ApplicationsImplemented orContemplatedby Users Web-browsing andcertain e-mail usage. Individual and intra- and inter-company e-mail, onlinesubscriptions, passwordreplacement, and software validation.E-banking, corp. databaseaccess, personal banking,membership-based onlineservices, content integrityservices, e-commerce server,software validation; authenti-cation of LRAAs; and strongencryption for certain servers. IA = Issuing Authority"}, {"id": "c8470a82d59c1f208049622a4d129a9b2a465fe7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 271, "start_line": 21, "end_line": 21, "text": "CA = Certification AuthorityPCA = VeriSign public primary certification authorityPIN = Personal Identification NumberLRAA = Local Registration Authority Administrator"}, {"id": "b8a45a604933da4c74375bf261c20592092cbf25", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 272, "start_line": 1, "end_line": 7, "text": "7.3 / DOMAINKEYS IDENTIFIED MAIL 257 performing all of the checking associated with a Class 1 Digital ID. Finally, confirmation is sent to the specified postal address alerting the user that aDigital ID has been issued in his or her name. \u2022For Class 3 Digital IDs, VeriSign requires a higher level of identity assurance.An individual must prove his or her identity by providing notarized creden-tials or applying in person. Enhanced Security Services As of this writing, three enhanced security services have been proposed in anInternet draft. The details of these may change, and additional services may beadded. The three services are \u2022Signed receipts: A signed receipt may be requested in a SignedData object."}, {"id": "1706f1df1ead11fd0bace448b5bfc13119e9e1f2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 272, "start_line": 8, "end_line": 10, "text": "Returning a signed receipt provides proof of delivery to the originator of amessage and allows the originator to demonstrate to a third party that therecipient received the message. In essence, the recipient signs the entire origi-nal message plus the original (sender\u2019s) signature and appends the new signa-ture to form a new S/MIME message. \u2022Security labels: A security label may be included in the authenticated attrib- utes of a SignedData object. A security label is a set of security information"}, {"id": "f4e3f5a1ae223340be4ec13f207ece57fa305c69", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 272, "start_line": 11, "end_line": 12, "text": "regarding the sensitivity of the content that is protected by S/MIME encapsu-lation. The labels may be used for access control, by indicating which users arepermitted access to an object. Other uses include priority (secret, confidential,restricted, and so on) or role based, describing which kind of people can seethe information (e.g., patient\u2019s health-care team, medical billing agents, etc.). \u2022Secure mailing lists: When a user sends a message to multiple recipients, a cer-"}, {"id": "2e98792d2623668ef84e0a06bd3952dcaef7ff3d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 272, "start_line": 13, "end_line": 14, "text": "tain amount of per-recipient processing is required, including the use of eachrecipient\u2019s public key. The user can be relieved of this work by employing theservices of an S/MIME Mail List Agent (MLA). An MLA can take a singleincoming message, perform the recipient-specific encryption for each recipi-ent, and forward the message. The originator of a message need only send themessage to the MLA with encryption performed using the MLA\u2019s public key. 7.3 DOMAINKEYS IDENTIFIED MAIL"}, {"id": "cea402eb5e8662d8d4d68ce1291d5a5267675419", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 272, "start_line": 15, "end_line": 16, "text": "DomainKeys Identified Mail (DKIM) is a specification for cryptographically signinge-mail messages, permitting a signing domain to claim responsibility for a message inthe mail stream. Message recipients (or agents acting in their behalf) can verify thesignature by querying the signer\u2019s domain directly to retrieve the appropriate publickey and thereby can confirm that the message was attested to by a party in posses-sion of the private key for the signing domain. DKIM is a proposed InternetStandard (RFC 4871: DomainKeys Identified Mail (DKIM) Signatures ). DKIM has been widely adopted by a range of e-mail providers, including corporations, govern-ment agencies, gmail, yahoo, and many Internet Service Providers (ISPs)."}, {"id": "7d1cb9ca751b2e7152e367936ef5df9fd882ddf0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 273, "start_line": 1, "end_line": 7, "text": "258 CHAPTER 7 / ELECTRONIC MAIL SECURITY This section provides an overview of DKIM. Before beginning our discussion of DKIM, we introduce the standard Internet mail architecture.Then we look at the threat that DKIM is intended to address, and finally provide an overview of DKIMoperation. Internet Mail Architecture To understand the operation of DKIM, it is useful to have a basic grasp of theInternet mail architecture, which is currently defined in [CROC09]. This subsectionprovides an overview of the basic concepts. At its most fundamental level, the Internet mail architecture consists of a user"}, {"id": "1b68daacd369dbaad421ca36e81d063696533b8d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 273, "start_line": 8, "end_line": 8, "text": "world in the form of Message User Agents (MUA), and the transfer world, in theform of the Message Handling Service (MHS), which is composed of MessageTransfer Agents (MTA). The MHS accepts a message from one user and delivers itto one or more other users, creating a virtual MUA-to-MUA exchange environ-ment. This architecture involves three types of interoperability. One is directlybetween users: messages must be formatted by the MUA on behalf of the messageauthor so that the message can be displayed to the message recipient by the destina-tion MUA. There are also interoperability requirements between the MUA and theMHS\u2014first when a message is posted from an MUA to the MHS and later when itis delivered from the MHS to the destination MUA. Interoperability is requiredamong the MTA components along the transfer path through the MHS."}, {"id": "8d17f5cd336130644618c13b2ceee2197c1f34ac", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 273, "start_line": 9, "end_line": 13, "text": "Figure 7.9 illustrates the key components of the Internet mail architecture, which include the following. \u2022Message User Agent (MUA): Works on behalf of user actors and user applica- tions. It is their representative within the e-mail service.Typically, this function ishoused in the user\u2019s computer and is referred to as a client e-mail program or alocal network e-mail server. The author MUA formats a message and performsinitial submission into the MHS via a MSA. The recipient MUA processesreceived mail for storage and/or display to the recipient user. \u2022Mail Submission Agent (MSA): Accepts the message submitted by an MUA"}, {"id": "995d5a1881e714ba01d0af2edb011afedf7633a0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 273, "start_line": 14, "end_line": 18, "text": "and enforces the policies of the hosting domain and the requirements ofInternet standards. This function may be located together with the MUA or asa separate functional model. In the latter case, the Simple Mail TransferProtocol (SMTP) is used between the MUA and the MSA. \u2022Message Transfer Agent (MTA): Relays mail for one application-level hop. It is like a packet switch or IP router in that its job is to make routing assess-ments and to move the message closer to the recipients. Relaying is performedby a sequence of MTAs until the message reaches a destination MDA. AnMTA also adds trace information to the message header. SMTP is usedbetween MTAs and between an MTA and an MSA or MDA. \u2022Mail Delivery Agent (MDA): Responsible for transferring the message from the MHS to the MS."}, {"id": "fc7aa832697949239260deadce5be7ceefbe2f2f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 273, "start_line": 19, "end_line": 20, "text": "\u2022Message Store (MS): An MUA can employ a long-term MS. An MS can be located on a remote server or on the same machine as the MUA. Typically, anMUA retrieves messages from a remote server using POP (Post OfficeProtocol) or IMAP (Internet Message Access Protocol)."}, {"id": "6b6ed2f509fb5486c000347f3eb6844eea21e304", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 274, "start_line": 1, "end_line": 7, "text": "7.3 / DOMAINKEYS IDENTIFIED MAIL 259 Two other concepts need to be defined. An administrative management domain (ADMD) is an Internet e-mail provider. Examples include a department that operates a local mail relay (MTA), an IT department that operates an enterprise mail relay, and an ISP that operates a public shared e-mail service. Each ADMD canhave different operating policies and trust-based decision making. One obviousexample is the distinction between mail that is exchanged within an organization andmail that is exchanged between independent organizations. The rules for handlingthe two types of traffic tend to be quite different. The Domain Name System (DNS) is a directory lookup service that provides a mapping between the name of a host on the Internet and its numerical address."}, {"id": "06c15005a1ae82d63993cf8300a03345c7ca8978", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 274, "start_line": 8, "end_line": 24, "text": "E-mail Threats RFC 4684 (Analysis of Threats Motivating DomainKeys Identified Mail ) describes the threats being addressed by DKIM in terms of the characteristics, capabilities,and location of potential attackers. C HARACTERISTICS RFC characterizes the range of attackers on a spectrum of three levels of threat. 1.At the low end are attackers who simply want to send e-mail that a recipient does not want to receive.The attacker can use one of a number of commerciallyavailable tools that allow the sender to falsify the origin address of messages.This makes it difficult for the receiver to filter spam on the basis of originatingaddress or domain.Message User Agent (MUA)Message author Message recipientSMTPSMTPP T M S P T M S (SMTP, local)(SMTP, local) (IMAP, POP, local)Mail Submission"}, {"id": "a1e14b5f924031e37fa33eb6fafd52bdc7ba0f43", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 274, "start_line": 25, "end_line": 37, "text": "Agent (MSA)Message Transfer Agent (MTA)Message Transfer Agent (MTA) Message handling system (MHS)Message Transfer Agent (MTA) Mail Delivery Agent (MDA) Message Store (MS) Message User Agent (MUA) Figure 7.9 Function Modules and Standardized Protocols for the Internet"}, {"id": "1fb2ce5ca94b5120593397a3f0bcd50594e299d7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 275, "start_line": 1, "end_line": 3, "text": "260 CHAPTER 7 / ELECTRONIC MAIL SECURITY 2.At the next level are professional senders of bulk spam mail. These attackers often operate as commercial enterprises and send messages on behalf of thirdparties. They employ more comprehensive tools for attack, including MailTransfer Agents (MTAs) and registered domains and networks of compromisedcomputers (zombies) to send messages and (in some cases) to harvest addressesto which to send."}, {"id": "aee20475110c85701349ede20dafc41a6e090121", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 275, "start_line": 4, "end_line": 10, "text": "3.The most sophisticated and financially motivated senders of messages are thosewho stand to receive substantial financial benefit, such as from an e-mail-basedfraud scheme. These attackers can be expected to employ all of the abovemechanisms and additionally may attack the Internet infrastructure itself,including DNS cache-poisoning attacks and IP routing attacks. C APABILITIES RFC 4686 lists the following as capabilities that an attacker might have. 1.Submit messages to MTAs and Message Submission Agents (MSAs) atmultiple locations in the Internet. 2.Construct arbitrary Message Header fields, including those claiming to bemailing lists, resenders, and other mail agents. 3.Sign messages on behalf of domains under their control."}, {"id": "2c4b842a009f9c762ab773bb22a773788fa38bea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 275, "start_line": 11, "end_line": 16, "text": "4.Generate substantial numbers of either unsigned or apparently signed messagesthat might be used to attempt a denial-of-service attack. 5.Resend messages that may have been previously signed by the domain. 6.Transmit messages using any envelope information desired. 7.Act as an authorized submitter for messages from a compromised computer. 8.Manipulation of IP routing. This could be used to submit messages from specificIP addresses or difficult-to-trace addresses, or to cause diversion of messages to aspecific domain. 9.Limited influence over portions of DNS using mechanisms such as cachepoisoning. This might be used to influence message routing or to falsify adver-tisements of DNS-based keys or signing practices."}, {"id": "d0a5bcc78f5ebf4ead0a137aa7421ac7b3be2ba9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 275, "start_line": 17, "end_line": 20, "text": "10.Access to significant computing resources, for example, through the conscription ofworm-infected \u201czombie\u201d computers. This could allow the \u201cbad actor\u201d to performvarious types of brute-force attacks. 11.Ability to eavesdrop on existing traffic, perhaps from a wireless network. L OCATION DKIM focuses primarily on attackers located outside of the administrative"}, {"id": "fceb76b8b3478566818f9405531ba42d4414e501", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 275, "start_line": 21, "end_line": 21, "text": "units of the claimed originator and the recipient.These administrative units frequentlycorrespond to the protected portions of the network adjacent to the originator andrecipient. It is in this area that the trust relationships required for authenticatedmessage submission do not exist and do not scale adequately to be practical.Conversely, within these administrative units, there are other mechanisms (such asauthenticated message submission) that are easier to deploy and more likely to beused than DKIM. External \u201cbad actors\u201d are usually attempting to exploit the \u201cany-to-any\u201d nature of e-mail that motivates most recipient MTAs to accept messages fromanywhere for delivery to their local domain. They may generate messages without"}, {"id": "c0c87caa1661dec27d7a3938ce3871c5e9f47b2a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 276, "start_line": 1, "end_line": 4, "text": "7.3 / DOMAINKEYS IDENTIFIED MAIL 261 signatures, with incorrect signatures, or with correct signatures from domains with little traceability. They may also pose as mailing lists, greeting cards, or other agentsthat legitimately send or resend messages on behalf of others. DKIM Strategy"}, {"id": "e3c5a60af668ab272d38190a89adb44026f46b49", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 276, "start_line": 5, "end_line": 5, "text": "DKIM is designed to provide an e-mail authentication technique that is transparentto the end user. In essence, a user\u2019s e-mail message is signed by a private key of theadministrative domain from which the e-mail originates. The signature covers all ofthe content of the message and some of the RFC 5322 message headers. At thereceiving end, the MDA can access the corresponding public key via a DNS and ver-ify the signature, thus authenticating that the message comes from the claimedadministrative domain.Thus, mail that originates from somewhere else but claims tocome from a given domain will not pass the authentication test and can be rejected.This approach differs from that of S/MIME and PGP , which use the originator\u2019s pri-vate key to sign the content of the message. The motivation for DKIM is based onthe following reasoning."}, {"id": "51d2e3f5e087aeea7e820b612742dbd6bc8424b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 276, "start_line": 6, "end_line": 12, "text": "4 1.S/MIME depends on both the sending and receiving users employing S/MIME.For almost all users, the bulk of incoming mail does not use S/MIME, and thebulk of the mail the user wants to send is to recipients not using S/MIME. 2.S/MIME signs only the message content. Thus, RFC 5322 header informationconcerning origin can be compromised. 3.DKIM is not implemented in client programs (MUAs) and is therefore transpar-ent to the user; the user need take no action. 4.DKIM applies to all mail from cooperating domains. 5.DKIM allows good senders to prove that they did send a particular messageand to prevent forgers from masquerading as good senders. Figure 7.10 is a simple example of the operation of DKIM. We begin with a"}, {"id": "79d262f839e72e0a7d8ef448a2eb46030fd79ad6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 276, "start_line": 13, "end_line": 15, "text": "message generated by a user and transmitted into the MHS to an MSA that is within the users administrative domain.An e-mail message is generated by an e-mail clientprogram. The content of the message, plus selected RFC 5322 headers, is signed bythe e-mail provider using the provider\u2019s private key. The signer is associated with adomain, which could be a corporate local network, an ISP , or a public e-mail facilitysuch as gmail. The signed message then passes through the Internet via a sequenceof MTAs. At the destination, the MDA retrieves the public key for the incoming signature and verifies the signature before passing the message on to the destinatione-mail client. The default signing algorithm is RSA with SHA-256. RSA with SHA-1 also may be used. DKIM Functional Flow"}, {"id": "cb44f080321c30014abd7cf75143a5af34438ea3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 276, "start_line": 16, "end_line": 17, "text": "Figure 7.11 provides a more detailed look at the elements of DKIM operation. Basicmessage processing is divided between a signing Administrative ManagementDomain (ADMD) and a verifying ADMD. At its simplest, this is between the 4The reasoning is expressed in terms of the use of S/MIME. The same argument applies to PGP ."}, {"id": "942f7dcc0efe8989294c66566650a695fc919c5c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 277, "start_line": 1, "end_line": 18, "text": "262 CHAPTER 7 / ELECTRONIC MAIL SECURITY Mail origination networkMail delivery networkDNS public-key query/response DNS = Domain Name System MDA = Mail Delivery Agent MSA = Mail Submission Agent MTA = Message Transfer Agent MUA = Message User AgentSMTP MUAMUASMTP SMTP Signer Verifier SMTPPOP, IMAPMTA MSA MTA MDADNS Figure 7.10 Simple Example of DKIM Deployment originating ADMD and the delivering ADMD, but it can involve other ADMDs in the handling path. Signing is performed by an authorized module within the signing ADMD and"}, {"id": "a0e209fac0a0d0a35d18649b0228c79d4911ecbd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 277, "start_line": 19, "end_line": 19, "text": "uses private information from a Key Store. Within the originating ADMD, this mightbe performed by the MUA, MSA, or an MTA. Verifying is performed by an autho-rized module within the verifying ADMD. Within a delivering ADMD, verifyingmight be performed by an MTA, MDA, or MUA. The module verifies the signatureor determines whether a particular signature was required. Verifying the signatureuses public information from the Key Store. If the signature passes, reputation infor-mation is used to assess the signer and that information is passed to the messagefiltering system. If the signature fails or there is no signature using the author\u2019sdomain, information about signing practices related to the author can be retrievedremotely and/or locally, and that information is passed to the message filteringsystem. For example, if the sender (e.g., gmail) uses DKIM but no DKIM signature ispresent, then the message may be considered fraudulent."}, {"id": "62b2acc2178568278db61177c6afae4483de618f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 277, "start_line": 20, "end_line": 22, "text": "The signature is inserted into the RFC 5322 message as an additional header entry, starting with the keyword Dkim-Signature. You can view examples from your own incoming mail by using the View Long Headers (or similar wording)option for an incoming message. Here is an example:"}, {"id": "13efcacdc5fbe167761007d122e63f51ed2a57da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 278, "start_line": 1, "end_line": 30, "text": "7.3 / DOMAINKEYS IDENTIFIED MAIL 263 Originating or Relaying ADMD: Sign Message with SDIDRFC 5322 Message Yes Pass FailNoRelaying or Delivering ADMD Message signed?Relaying or Delivering ADMD: Message signed? Verify signaturePrivate key store (paired) Public key storeRemote sender practices Local info on sender practicesReputation/ accreditation informationAssessments Message filtering engineCheck signing practicesInternet Figure 7.11 DKIM Functional Flow Dkim-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=gamma; h=domainkey-signa-"}, {"id": "d986f79743ba6f6f7c71182ac7a7d5ca5db219e0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 278, "start_line": 31, "end_line": 31, "text": "ture:mime-version:received:date:message-id:subject :from:to:content-type:con-tent-transfer-encoding;bh=5mZvQDyCRuyLb1Y28K4zgS2MPOemFToDBgvbJ7GO90s=;b=PcUvPSDygb4ya5Dyj1rbZGp/VyRiScuaz7TTGJ5qW5slM+klzv6kcfYdGDHzEVJW+ZFetuPfF1ETOVhELtwH0zjSccOyPkEiblOf6gILObm3DDRm3Ys1/FVrbhVOlA+/jH9AeiuIIw/5iFnRbSH6qPDVv/beDQqAWQfA/wF7O5k="}, {"id": "c12a2aca3e2800fea48f94525b08e18a9a8764eb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 279, "start_line": 1, "end_line": 3, "text": "264 CHAPTER 7 / ELECTRONIC MAIL SECURITY Before a message is signed, a process known as canonicalization is per- formed on both the header and body of the RFC 5322 message. Canonicalization"}, {"id": "18202a66def24992bfa728924a9aef72bde7524c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 279, "start_line": 4, "end_line": 4, "text": "is necessary to deal with the possibility of minor changes in the message made enroute, including character encoding, treatment of trailing white space in messagelines, and the \u201cfolding\u201d and \u201cunfolding\u201d of header lines. The intent of canonical-ization is to make a minimal transformation of the message (for the purpose ofsigning; the message itself is not changed, so the canonicalization must be per-formed again by the verifier) that will give it its best chance of producing thesame canonical value at the receiving end. DKIM defines two header canonical-ization algorithms (\u201csimple\u201d and \u201crelaxed\u201d) and two for the body (with the samenames). The simple algorithm tolerates almost no modification, while the relaxedtolerates common modifications."}, {"id": "12a087ba3b30d606f9f4a4775bffab574cb3649b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 279, "start_line": 5, "end_line": 13, "text": "The signature includes a number of fields. Each field begins with a tag consist- ing of a tag code followed by an equals sign and ends with a semicolon. The fieldsinclude the following: \u2022 DKIM version. \u2022 Algorithm used to generate the signature; must be either rsa-sha1 or rsa-sha256. \u2022 Canonicalization method used on the header and the body. \u2022 A domain name used as an identifier to refer to the identity of a respon- sible person or organization. In DKIM, this identifier is called the SigningDomain IDentifier (SDID). In our example, this field indicates that the senderis using a gmail address. \u2022 In order that different keys may be used in different circumstances for"}, {"id": "4e7b04bfd0a707eaf3b647b459beccdfe3c7cf41", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 279, "start_line": 14, "end_line": 20, "text": "the same signing domain (allowing expiration of old keys, separate depart-mental signing, or the like), DKIM defines a selector (a name associated witha key), which is used by the verifier to retrieve the proper key during signatureverification. \u2022 Signed Header fields. A colon-separated list of header field names that identify the header fields presented to the signing algorithm. Note that in ourexample above, the signature covers the domainkey-signature field.This refersto an older algorithm (since replaced by DKIM) that is still in use. \u2022 The hash of the canonicalized body part of the message. This provides additional information for diagnosing signature verification failures. \u2022 The signature data in base64 format; this is the encrypted hash code. 7.4 RECOMMENDED READING AND WEB SITES"}, {"id": "829212be0c720b28da000c515b8dcdbb1337f70f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 279, "start_line": 21, "end_line": 24, "text": "[LEIB07] provides an overview of DKIM.b=bh=h=s=d=c=a=v= LEIB07 Leiba, B., and Fenton, J. \u201cDomainKeys Identified Mail (DKIM): Using Digital Signatures for Domain Verification.\u201d Proceedings of Fourth Conference on E-mail and Anti-Spam (CEAS 07) , 2007."}, {"id": "9bc92b1fd0673ed5bfba36f3a1afcb85073de510", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 280, "start_line": 1, "end_line": 17, "text": "7.5 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 265 Recommended Web Sites: \u2022PGP Home Page: PGP Web site by PGP Corp., the leading PGP commercial vendor. \u2022International PGP Home Page: Designed to promote worldwide use of PGP . Contains documents and links of interest. \u2022PGP Charter: Latest RFCs and Internet drafts for Open Specification PGP . \u2022S/MIME Charter: Latest RFCs and Internet drafts for S/MIME. \u2022DKIM: Website hosted by Mutual Internet Practices Association, this site contains a wide range of documents and information related to DKIM. \u2022DKIM Charter: Latest RFCs and Internet drafts for DKIM. 7.5 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms detached signature DomainKeys Identified Mail (DKIM) electronic mailMultipurpose Internet Mail Extensions (MIME)"}, {"id": "33fa546ba8e0d299a84b3bf221079cffdc46bcc7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 280, "start_line": 18, "end_line": 34, "text": "Pretty Good Privacy (PGP)radix 64session keyS/MIMEtrustZIP Review Questions 7.1 What are the five principal services provided by PGP? 7.2 What is the utility of a detached signature? 7.3 Why does PGP generate a signature before applying compression? 7.4 What is R64 conversion? 7.5 Why is R64 conversion useful for an e-mail application? 7.6 How does PGP use the concept of trust? 7.7 What is RFC 5322? 7.8 What is MIME? 7.9 What is S/MIME? 7.10 What is DKIM? Problems 7.1 PGP makes use of the cipher feedback (CFB) mode of CAST-128, whereas most sym- metric encryption applications (other than key encryption) use the cipher blockchaining (CBC) mode. We have CFB: C i =Pi/H17053E(K, C i-1); P i=Ci/H17053E(K, C i-1)CBC: C i =E(K, [C i-1/H17053Pi]); P i=Ci-1/H17053D(K, C i)"}, {"id": "c49f12de724fd1e5c348a7d8cf6d35b5e752e9ee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 281, "start_line": 1, "end_line": 7, "text": "266 CHAPTER 7 / ELECTRONIC MAIL SECURITY These two appear to provide equal security. Suggest a reason why PGP uses the CFB mode. 7.2 In the PGP scheme, what is the expected number of session keys generated before apreviously created key is produced? 7.3 In PGP , what is the probability that a user with public keys will have at least oneduplicate key ID? 7.4 The first 16 bits of the message digest in a PGP signature are translated in the clear.a.To what extent does this compromise the security of the hash algorithm? b.To what extent does it in fact perform its intended function, namely, to help deter-mine if the correct RSA key was used to decrypt the digest?"}, {"id": "116cc7e9bbcb08fc531220af63cc8c89b6f45180", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 281, "start_line": 8, "end_line": 10, "text": "7.5 In Figure 7.4, each entry in the public-key ring contains an Owner Trust field that indi-cates the degree of trust associated with this public-key owner. Why is that notenough? That is, if this owner is trusted and this is supposed to be the owner\u2019s publickey, why is that trust not enough to permit PGP to use this public key? 7.6 What is the basic difference between X.509 and PGP in terms of key hierarchies andkey trust? 7.7 Phil Zimmermann chose IDEA, three-key triple DES, and CAST-128 as symmetricencryption algorithms for PGP . Give reasons why each of the following symmetricencryption algorithms described in this book is suitable or unsuitable for PGP: DES,two-key triple DES, and AES."}, {"id": "db61f667303b6c18edb505c311ff3b535b11e9a2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 281, "start_line": 11, "end_line": 17, "text": "7.8 Consider radix-64 conversion as a form of encryption. In this case, there is no key. Butsuppose that an opponent knew only that some form of substitution algorithm wasbeing used to encrypt English text and did not guess that it was R64. How effectivewould this algorithm be against cryptanalysis? 7.9 Encode the text \u201cplaintext\u201d using the following techniques. Assume characters arestored in 8-bit ASCII with zero parity.a.Radix-64 b.Quoted-printable APPENDIX 7A RADIX-64 CONVERSION Both PGP and S/MIME make use of an encoding technique referred to as radix-64 conver- sion. This technique maps arbitrary binary input into printable character output. The form ofencoding has the following relevant characteristics: 1."}, {"id": "33468c5447ac9fb2e61595f60fe16ccf15d26a72", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 281, "start_line": 18, "end_line": 21, "text": "The range of the function is a character set that is universally representable at all sites, not a specific binary encoding of that character set.Thus, the charactersthemselves can be encoded into whatever form is needed by a specific system.For example, the character \u201cE\u201d is represented in an ASCII-based system ashexadecimal 45 and in an EBCDIC-based system as hexadecimal C5. 2.The character set consists of 65 printable characters, one of which is used forpadding. With available characters, each character can be used to rep-resent 6 bits of input. 3.No control characters are included in the set. Thus, a message encoded in radix 64can traverse mail-handling systems that scan the data stream for control characters."}, {"id": "c07744926e40bc7ecf54366b2b17b9adde371d01", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 281, "start_line": 22, "end_line": 23, "text": "4.The hyphen character \u201c-\u201d is not used. This character has significance in the RFC 5322 format and should therefore be avoided.26=64N"}, {"id": "aa2a408c5494fd82705b73c2c35ebaf65da02805", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 282, "start_line": 1, "end_line": 24, "text": "APPENDIX 7A / RADIX-64 CONVERSION 267 Table 7.9 Radix-64 Encoding 6-bit ValueCharacterEncoding6-bitValueCharacterEncoding6-bitValueCharacterEncoding6-bitValueCharacterEncoding 0 A 16 Q 32 g 48 w 1 B 17 R 33 h 49 x 2 C 18 S 34 i 50 y 3 D 19 T 35 j 51 z 4 E 20 U 36 k 52 0 5 F 21 V 37 l 53 1 6 G 22 W 38 m 54 2 7 H 23 X 39 n 55 3 8 I 24 Y 40 o 56 4 9 J 25 Z 41 p 57 5 10 K 26 a 42 q 58 6 11 L 27 b 43 r 59 7 12 M 28 c 44 s 60 8 13 N 29 d 45 t 61 9 14 O 30 e 46 u 62 /H11001 15 P 31 f 47 v 63 / (pad)/H11005 Table 7.9 shows the mapping of 6-bit input values to characters. The character set con- sists of the alphanumeric characters plus \u201c \u201d and \u201c/\u201d. The \u201c \u201d character is used as thepadding character. Figure 7.12 illustrates the simple mapping scheme. Binary input is processed in blocks"}, {"id": "45bf502dc15899a713403d543e8281d45ff74020", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 282, "start_line": 25, "end_line": 30, "text": "of 3 octets (24 bits). Each set of 6 bits in the 24-bit block is mapped into a character. In the fig-ure, the characters are shown encoded as 8-bit quantities. In this typical case, each 24-bit inputis expanded to 32 bits of output. For example, consider the 24-bit raw text sequence 00100011 01011100 10010001, which can be expressed in hexadecimal as 235C91. We arrange this input in blocks of 6 bits: The extracted 6-bit decimal values are 8, 53, 50, and 17. Looking these up in Table 7.9 yields the radix-64 encoding as the following characters: I1yR. If these characters are storedin 8-bit ASCII format with parity bit set to zero, we have 01001001 00110001 01111001 01010010001000 110101 110010 010001= +"}, {"id": "a53bb11e8cfdc76e13defe3679f1325be1ae4dd8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 283, "start_line": 1, "end_line": 13, "text": "268 CHAPTER 7 / ELECTRONIC MAIL SECURITY Input Data Binary representation 00100011 01011100 10010001 Hexadecimal representation 235C91 Radix-64 Encoding of Input Data Character representation I1yR ASCII code (8 bit, zero parity) 01001001 00110001 01111001 01010010 Hexadecimal representation 4931795224 bits R64 R64 R64 R64 4 characters = 32 bits Figure 7.12 Printable Encoding of Binary Data into Radix-64 Format In hexadecimal, this is 49317952. To summarize:"}, {"id": "56e40af0401addefa981455f88f86471574eb6d4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 284, "start_line": 1, "end_line": 16, "text": "IP SECURITY 8.1 IP Security Overview Applications of IPsec Benefits of IPsecRouting ApplicationsIPsec DocumentsIPsec ServicesTransport and Tunnel Modes 8.2 IP Security Policy Security AssociationsSecurity Association DatabaseSecurity Policy DatabaseIP Traffic Processing 8.3 Encapsulating Security Payload ESP FormatEncryption and Authentication AlgorithmsPaddingAnti-Replay ServiceTransport and Tunnel Modes 8.4 Combining Security Associations Authentication Plus ConfidentialityBasic Combinations of Security Associations 8.5 Internet Key Exchange Key Determination ProtocolHeader and Payload Formats 8.6 Cryptographic Suites 8.7 Recommended Reading and Web Sites 8.8 Key Terms, Review Questions, and Problems 269CHAPTER"}, {"id": "d1e7fddb789dd32186d00c76a29c6be1719d06c5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 285, "start_line": 1, "end_line": 8, "text": "270 CHAPTER 8 / IP SECURITY If a secret piece of news is divulged by a spy before the time is ripe, he must be put to death, together with the man to whom the secret was told. \u2014The Art of War , Sun Tzu KEY POINTS \u25c6IP security (IPsec) is a capability that can be added to either current versionof the Internet Protocol (IPv4 or IPv6) by means of additional headers. \u25c6IPsec encompasses three functional areas: authentication, confidentiality,and key management. \u25c6Authentication makes use of the HMAC message authentication code.Authentication can be applied to the entire original IP packet (tunnelmode) or to all of the packet except for the IP header (transport mode)."}, {"id": "e8d44c7644e670d8767411c2acea20aec093444c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 285, "start_line": 9, "end_line": 10, "text": "\u25c6Confidentiality is provided by an encryption format known as encapsulatingsecurity payload. Both tunnel and transport modes can be accommodated. \u25c6IKE defines a number of techniques for key management."}, {"id": "9311a81b1d0edfc0676746174e4086ea1054bb2a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 285, "start_line": 11, "end_line": 12, "text": "There are application-specific security mechanisms for a number of applicationareas, including electronic mail (S/MIME, PGP), client/server (Kerberos), Webaccess (Secure Sockets Layer), and others. However, users have security concernsthat cut across protocol layers. For example, an enterprise can run a secure, privateIP network by disallowing links to untrusted sites, encrypting packets that leave thepremises, and authenticating packets that enter the premises. By implementingsecurity at the IP level, an organization can ensure secure networking not only forapplications that have security mechanisms but also for the many security-ignorantapplications. IP-level security encompasses three functional areas: authentication, confiden-"}, {"id": "c5bda9c6b8fb92ba7d7de3c0fdbb4ab77c1ef91c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 285, "start_line": 13, "end_line": 16, "text": "tiality, and key management. The authentication mechanism assures that a receivedpacket was, in fact, transmitted by the party identified as the source in the packetheader. In addition, this mechanism assures that the packet has not been altered intransit.The confidentiality facility enables communicating nodes to encrypt messagesto prevent eavesdropping by third parties. The key management facility is concernedwith the secure exchange of keys. We begin this chapter with an overview of IP security (IPsec) and an introduction to the IPsec architecture. We then look at each of the three functional areas in detail.Appendix D reviews Internet protocols. 8.1 IP SECURITY OVERVIEW"}, {"id": "3870c793453cee40c07429146c337a4339c27e0f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 285, "start_line": 17, "end_line": 17, "text": "In 1994, the Internet Architecture Board (IAB) issued a report titled \u201cSecurity inthe Internet Architecture\u201d (RFC 1636). The report identified key areas forsecurity mechanisms. Among these were the need to secure the network"}, {"id": "858fb0fed20a36ed99f2318f9d1c67ae1bee0149", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 286, "start_line": 1, "end_line": 6, "text": "8.1 / IP SECURITY OVERVIEW 271 infrastructure from unauthorized monitoring and control of network traffic and the need to secure end-user-to-end-user traffic using authentication andencryption mechanisms. To provide security, the IAB included authentication and encryption as necessary security features in the next-generation IP , which has been issued asIPv6. Fortunately, these security capabilities were designed to be usable bothwith the current IPv4 and the future IPv6. This means that vendors can beginoffering these features now, and many vendors now do have some IPsec capabil-ity in their products. The IPsec specification now exists as a set of Internetstandards. Applications of IPsec"}, {"id": "42fed6d0baf6d9dbe8813bece795061c170007eb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 286, "start_line": 7, "end_line": 11, "text": "IPsec provides the capability to secure communications across a LAN, across privateand public WANs, and across the Internet. Examples of its use include: \u2022Secure branch office connectivity over the Internet: A company can build a secure virtual private network over the Internet or over a public WAN. Thisenables a business to rely heavily on the Internet and reduce its need forprivate networks, saving costs and network management overhead. \u2022Secure remote access over the Internet: An end user whose system is equipped with IP security protocols can make a local call to an Internet Service Provider(ISP) and gain secure access to a company network.This reduces the cost of tollcharges for traveling employees and telecommuters."}, {"id": "ed2af6df9557d122e74446250e2e346cf553fac0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 286, "start_line": 12, "end_line": 17, "text": "\u2022Establishing extranet and intranet connectivity with partners: IPsec can be used to secure communication with other organizations, ensuring authentica-tion and confidentiality and providing a key exchange mechanism. \u2022Enhancing electronic commerce security: Even though some Web and electronic commerce applications have built-in security protocols, the use of IPsec enhancesthat security. IPsec guarantees that all traffic designated by the network adminis-trator is both encrypted and authenticated, adding an additional layer of securityto whatever is provided at the application layer. The principal feature of IPsec that enables it to support these varied applica- tions is that it can encrypt and/or authenticate all traffic at the IP level. Thus, all dis-"}, {"id": "8054f4f73cf73a4bef110829452b26933ddbaefa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 286, "start_line": 18, "end_line": 20, "text": "tributed applications (including remote logon, client/server, e-mail, file transfer, Web access, and so on) can be secured. Figure 8.1 is a typical scenario of IPsec usage. An organization maintains"}, {"id": "8526cc1172b6086a828179b7fdd5574f69dbf9d9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 286, "start_line": 21, "end_line": 21, "text": "LANs at dispersed locations. Nonsecure IP traffic is conducted on each LAN. Fortraffic offsite, through some sort of private or public WAN, IPsec protocols are used.These protocols operate in networking devices, such as a router or firewall, that con-nect each LAN to the outside world. The IPsec networking device will typicallyencrypt and compress all traffic going into the WAN and decrypt and decompresstraffic coming from the WAN; these operations are transparent to workstations andservers on the LAN. Secure transmission is also possible with individual users whodial into the WAN. Such user workstations must implement the IPsec protocols toprovide security."}, {"id": "5ef4f692fa52d0013f717e51e0b1bd29561e819b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 287, "start_line": 1, "end_line": 26, "text": "272 IP HeaderIP PayloadIP HeaderIPsec HeaderSecure IP PayloadIP HeaderIPsec HeaderSecure IP PayloadIPHeader IPsecHeader Secure IP Payload IP HeaderIP Payload Networking device with IPsecEthernet switchEthernet switchUser system with IPsec Networking device with IPsecPublic (Internet) or Private Network Figure 8.1 An IP Security Scenario"}, {"id": "8e0679f288411010ec8904272d2f2a26594a48f6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 288, "start_line": 1, "end_line": 7, "text": "8.1 / IP SECURITY OVERVIEW 273 Benefits of IPsec Some of the benefits of IPsec: \u2022When IPsec is implemented in a firewall or router, it provides strong security that can be applied to all traffic crossing the perimeter.Traffic within a companyor workgroup does not incur the overhead of security-related processing. \u2022IPsec in a firewall is resistant to bypass if all traffic from the outside must useIP and the firewall is the only means of entrance from the Internet into theorganization. \u2022IPsec is below the transport layer (TCP , UDP) and so is transparent toapplications. There is no need to change software on a user or server systemwhen IPsec is implemented in the firewall or router. Even if IPsec isimplemented in end systems, upper-layer software, including applications, isnot affected."}, {"id": "5c217abcf156e3e4dc19c847b44bb5ec816e06a3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 288, "start_line": 8, "end_line": 12, "text": "\u2022IPsec can be transparent to end users.There is no need to train users on securitymechanisms, issue keying material on a per-user basis, or revoke keying materialwhen users leave the organization. \u2022IPsec can provide security for individual users if needed.This is useful for offsiteworkers and for setting up a secure virtual subnetwork within an organizationfor sensitive applications. Routing Applications In addition to supporting end users and protecting premises systems and networks,IPsec can play a vital role in the routing architecture required for internetworking.[HUIT98] lists the following examples of the use of IPsec. IPsec can assure that \u2022A router advertisement (a new router advertises its presence) comes from anauthorized router."}, {"id": "0cd0ee757459793786e1f2dfe508f848502ce48f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 288, "start_line": 13, "end_line": 19, "text": "\u2022A neighbor advertisement (a router seeks to establish or maintain a neighborrelationship with a router in another routing domain) comes from an autho-rized router. \u2022A redirect message comes from the router to which the initial IP packet was sent. \u2022A routing update is not forged. Without such security measures, an opponent can disrupt communications or divert some traffic. Routing protocols such as Open Shortest Path First (OSPF) should be run on top of security associations between routers that are definedby IPsec. IPsec Documents"}, {"id": "5d75c4693a4291353bacf7178399555de20ad441", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 288, "start_line": 20, "end_line": 20, "text": "IPsec encompasses three functional areas: authentication, confidentiality, and keymanagement. The totality of the IPsec specification is scattered across dozens ofRFCs and draft IETF documents, making this the most complex and difficult to graspof all IETF specifications. The best way to grasp the scope of IPsec is to consult the"}, {"id": "fb70462d1b03c32eadef635db62d33ed857527e0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 289, "start_line": 1, "end_line": 9, "text": "274 CHAPTER 8 / IP SECURITY latest version of the IPsec document roadmap, which as of this writing is [FRAN09]. The documents can be categorized into the following groups. \u2022Architecture: Covers the general concepts, security requirements, definitions, and mechanisms defining IPsec technology. The current specification is RFC4301, Security Architecture for the Internet Protocol . \u2022Authentication Header (AH): AH is an extension header to provide message authentication. The current specification is RFC 4302, IP Authentication Header . Because message authentication is provided by ESP , the use of AH is deprecated. It is included in IPsecv3 for backward compatibility but shouldnot be used in new applications. We do not discuss AH in this chapter."}, {"id": "9ced1a36f084f024349adfd2b42f9636377e4fb2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 289, "start_line": 10, "end_line": 17, "text": "\u2022Encapsulating Security Payload (ESP): ESP consists of an encapsulating header and trailer used to provide encryption or combined encryption/authentication.The current specification is RFC 4303, IP Encapsulating Security Payload (ESP) . \u2022Internet Key Exchange (IKE): This is a collection of documents describing the key management schemes for use with IPsec. The main specification isRFC 4306, Internet Key Exchange (IKEv2) Protocol , but there are a number of related RFCs. \u2022Cryptographic algorithms: This category encompasses a large set of docu- ments that define and describe cryptographic algorithms for encryption, mes-sage authentication, pseudorandom functions (PRFs), and cryptographic keyexchange. \u2022Other: There are a variety of other IPsec-related RFCs, including those deal-"}, {"id": "7caf158ddadf41435b1d953b0991f64a44ba2207", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 289, "start_line": 18, "end_line": 24, "text": "ing with security policy and management information base (MIB) content. IPsec Services IPsec provides security services at the IP layer by enabling a system to selectrequired security protocols, determine the algorithm(s) to use for the service(s), andput in place any cryptographic keys required to provide the requested services. Twoprotocols are used to provide security: an authentication protocol designated by theheader of the protocol, Authentication Header (AH); and a combined encryption/authentication protocol designated by the format of the packet for that protocol,Encapsulating Security Payload (ESP). RFC 4301 lists the following services: \u2022Access control \u2022Connectionless integrity \u2022Data origin authentication \u2022Rejection of replayed packets (a form of partial sequence integrity)"}, {"id": "8dd1852460370a90f31006b69e698900009e85e0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 289, "start_line": 25, "end_line": 28, "text": "\u2022Confidentiality (encryption) \u2022Limited traffic flow confidentiality Transport and Tunnel Modes Both AH and ESP support two modes of use: transport and tunnel mode. The oper-ation of these two modes is best understood in the context of a description of ESP ,which is covered in Section 8.3. Here we provide a brief overview."}, {"id": "f9cec5ec311a70cd5ad6ab95a3f5d2b69956e747", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 290, "start_line": 1, "end_line": 5, "text": "8.1 / IP SECURITY OVERVIEW 275 TRANSPORT MODE Transport mode provides protection primarily for upper-layer protocols. That is, transport mode protection extends to the payload of an IP packet.1Examples include a TCP or UDP segment or an ICMP packet, all of which operate directly above IP in a host protocol stack. Typically, transport mode is usedfor end-to-end communication between two hosts (e.g., a client and a server, or twoworkstations). When a host runs AH or ESP over IPv4, the payload is the data thatnormally follow the IP header. For IPv6, the payload is the data that normally followboth the IP header and any IPv6 extensions headers that are present, with thepossible exception of the destination options header, which may be included inthe protection."}, {"id": "5cc915f4443a4749a99d81bc1b39eee314c7bec9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 290, "start_line": 6, "end_line": 10, "text": "ESP in transport mode encrypts and optionally authenticates the IP payload but not the IP header. AH in transport mode authenticates the IP payload andselected portions of the IP header. T UNNEL MODE Tunnel mode provides protection to the entire IP packet. To achieve this, after the AH or ESP fields are added to the IP packet, the entire"}, {"id": "0fecf9246447cec7612d9ba570815e92094d337d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 290, "start_line": 11, "end_line": 11, "text": "packet plus security fields is treated as the payload of new outer IP packet with anew outer IP header. The entire original, inner, packet travels through a tunnelfrom one point of an IP network to another; no routers along the way are able toexamine the inner IP header. Because the original packet is encapsulated, the new,larger packet may have totally different source and destination addresses, addingto the security.Tunnel mode is used when one or both ends of a security association(SA) are a security gateway, such as a firewall or router that implements IPsec.With tunnel mode, a number of hosts on networks behind firewalls may engage insecure communications without implementing IPsec. The unprotected packetsgenerated by such hosts are tunneled through external networks by tunnel modeSAs set up by the IPsec software in the firewall or secure router at the boundary ofthe local network."}, {"id": "278e244b71c9b4197a21960f937b8708116670aa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 290, "start_line": 12, "end_line": 12, "text": "Here is an example of how tunnel mode IPsec operates. Host A on a network"}, {"id": "c7b1d8d08fac89567242128757c0b041112b5b5f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 290, "start_line": 13, "end_line": 13, "text": "generates an IP packet with the destination address of host B on another network.This packet is routed from the originating host to a firewall or secure router at theboundary of A\u2019s network. The firewall filters all outgoing packets to determine theneed for IPsec processing. If this packet from A to B requires IPsec, the firewallperforms IPsec processing and encapsulates the packet with an outer IP header.Thesource IP address of this outer IP packet is this firewall, and the destination addressmay be a firewall that forms the boundary to B\u2019s local network. This packet is nowrouted to B\u2019s firewall, with intermediate routers examining only the outer IPheader. At B\u2019s firewall, the outer IP header is stripped off, and the inner packet isdelivered to B."}, {"id": "762530606532ab65bd8427f6249a9d33eeffd229", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 290, "start_line": 14, "end_line": 17, "text": "ESP in tunnel mode encrypts and optionally authenticates the entire inner IP packet, including the inner IP header. AH in tunnel mode authenticates the entireinner IP packet and selected portions of the outer IP header. Table 8.1 summarizes transport and tunnel mode functionality. 1In this chapter, the term IP packet refers to either an IPv4 datagram or an IPv6 packet."}, {"id": "0d94170d31ba1717b9becf3da678f052da74c91b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 291, "start_line": 1, "end_line": 23, "text": "276 CHAPTER 8 / IP SECURITY SPD SPD SADIKEv2 IKEv2 IPsecv3 IPsecv3 Security association databaseKey exchange IKE SA IPsec SA Pair ESP protects dataSecurity association databaseSecurity policy databaseSecurity policy database SAD Figure 8.2 IPsec Architecture8.2 IP SECURITY POLICY Fundamental to the operation of IPsec is the concept of a security policy applied to each IP packet that transits from a source to a destination. IPsec policy isdetermined primarily by the interaction of two databases, the security association database (SAD) and the security policy database (SPD). This section provides an overview of these two databases and then summarizes their use during IPsecoperation. Figure 8.2 illustrates the relevant relationships. Security Associations"}, {"id": "c0376e84561a23b5ff762618442a014dad002fec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 291, "start_line": 24, "end_line": 28, "text": "A key concept that appears in both the authentication and confidentiality mecha-nisms for IP is the security association (SA).An association is a one-way logical con-nection between a sender and a receiver that affords security services to the trafficcarried on it. If a peer relationship is needed for two-way secure exchange, then twosecurity associations are required. Security services are afforded to an SA for theuse of AH or ESP , but not both.Table 8.1 Tunnel Mode and Transport Mode Functionality Transport Mode SA Tunnel Mode SA AH Authenticates IP payload and selected portions of IP header and IPv6 extension headers.Authenticates entire inner IP packet (innerheader plus IP payload) plus selected portionsof outer IP header and outer IPv6 extensionheaders. ESP"}, {"id": "4047c51ff6c3b37c4b59dad3c95d01aeffde6022", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 291, "start_line": 29, "end_line": 30, "text": "Encrypts IP payload and any IPv6 exten-sion headers following the ESP header. Encrypts entire inner IP packet. ESP withAuthentication Encrypts IP payload and any IPv6 extension headers following the ESPheader. Authenticates IP payload but not IP header.Encrypts entire inner IP packet. Authenticatesinner IP packet."}, {"id": "32ed9414a15a909c8333d31d591bda5c50815206", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 292, "start_line": 1, "end_line": 11, "text": "8.2 / IP SECURITY POLICY 277 A security association is uniquely identified by three parameters. \u2022Security Parameters Index (SPI): A bit string assigned to this SA and having local significance only.The SPI is carried in AH and ESP headers to enable the receiving system to select the SA under which a received packet will beprocessed. \u2022IP Destination Address: This is the address of the destination endpoint of the SA, which may be an end-user system or a network system such as a firewall orrouter. \u2022Security Protocol Identifier: This field from the outer IP header indicates whether the association is an AH or ESP security association. Hence, in any IP packet, the security association is uniquely identified by the Destination Address in the IPv4 or IPv6 header and the SPI in the enclosed exten-"}, {"id": "52c64c393e101b2156559769ff7831c7e5839395", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 292, "start_line": 12, "end_line": 19, "text": "sion header (AH or ESP). Security Association Database In each IPsec implementation, there is a nominal2Security Association Database that defines the parameters associated with each SA. A security association is nor-mally defined by the following parameters in an SAD entry. \u2022Security Parameter Index: A 32-bit value selected by the receiving end of an SA to uniquely identify the SA. In an SAD entry for an outbound SA, the SPIis used to construct the packet\u2019s AH or ESP header. In an SAD entry for aninbound SA, the SPI is used to map traffic to the appropriate SA. \u2022Sequence Number Counter: A 32-bit value used to generate the Sequence Number field in AH or ESP headers, described in Section 8.3 (required for allimplementations)."}, {"id": "977cfec7859d12f248b7ef1bcff540b8a4f3747f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 292, "start_line": 20, "end_line": 28, "text": "\u2022Sequence Counter Overflow: A flag indicating whether overflow of the Sequence Number Counter should generate an auditable event and preventfurther transmission of packets on this SA (required for all implementations). \u2022Anti-Replay Window: Used to determine whether an inbound AH or ESP packet is a replay, described in Section 8.3 (required for all implementations). \u2022AH Information: Authentication algorithm, keys, key lifetimes, and related parameters being used with AH (required for AH implementations). \u2022ESP Information: Encryption and authentication algorithm, keys, initializa- tion values, key lifetimes, and related parameters being used with ESP(required for ESP implementations). \u2022Lifetime of this Security Association: A time interval or byte count after"}, {"id": "e0d0ac093bafecd5961f9cccc8caca51bca7c616", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 292, "start_line": 29, "end_line": 32, "text": "which an SA must be replaced with a new SA (and new SPI) or terminated,plus an indication of which of these actions should occur (required for allimplementations). 2Nominal in the sense that the functionality provided by a Security Association Database must be present in any IPsec implementation, but the way in which that functionality is provided is up to the implementer."}, {"id": "4263334395d52d95adde73c75886c8f84706d992", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 293, "start_line": 1, "end_line": 9, "text": "278 CHAPTER 8 / IP SECURITY \u2022IPsec Protocol Mode: Tunnel, transport, or wildcard. \u2022Path MTU: Any observed path maximum transmission unit (maximum size of a packet that can be transmitted without fragmentation) and aging variables (required for all implementations). The key management mechanism that is used to distribute keys is coupled to the authentication and privacy mechanisms only by way of the Security Parameters Index (SPI). Hence, authentication and privacy have been specified independent ofany specific key management mechanism. IPsec provides the user with considerable flexibility in the way in which IPsec"}, {"id": "04b15a1ddaa0e083f940b0cf134004109f9074da", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 293, "start_line": 10, "end_line": 11, "text": "services are applied to IP traffic. As we will see later, SAs can be combined in anumber of ways to yield the desired user configuration. Furthermore, IPsec providesa high degree of granularity in discriminating between traffic that is afforded IPsecprotection and traffic that is allowed to bypass IPsec, as in the former case relatingIP traffic to specific SAs. Security Policy Database"}, {"id": "a6240cbdf617ddd369848199441950fea8f92ea3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 293, "start_line": 12, "end_line": 15, "text": "The means by which IP traffic is related to specific SAs (or no SA in the case of trafficallowed to bypass IPsec) is the nominal Security Policy Database (SPD). In its sim-plest form, an SPD contains entries, each of which defines a subset of IP traffic andpoints to an SA for that traffic. In more complex environments, there may be multipleentries that potentially relate to a single SA or multiple SAs associated with a singleSPD entry.The reader is referred to the relevant IPsec documents for a full discussion. Each SPD entry is defined by a set of IP and upper-layer protocol field values, called selectors . In effect, these selectors are used to filter outgoing traffic in order to map it into a particular SA. Outbound processing obeys the following generalsequence for each IP packet."}, {"id": "1c4e10621ce2d78bf4f258210664ffd650b8046b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 293, "start_line": 16, "end_line": 23, "text": "1.Compare the values of the appropriate fields in the packet (the selector fields)against the SPD to find a matching SPD entry, which will point to zero ormore SAs. 2.Determine the SA if any for this packet and its associated SPI. 3.Do the required IPsec processing (i.e., AH or ESP processing). The following selectors determine an SPD entry: \u2022Remote IP Address: This may be a single IP address, an enumerated list or range of addresses, or a wildcard (mask) address.The latter two are required to support more than one destination system sharing the same SA (e.g., behind a firewall). \u2022Local IP Address: This may be a single IP address, an enumerated list or range"}, {"id": "ac0a1a9608d333ce57424d948b40f45ac206170c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 293, "start_line": 24, "end_line": 26, "text": "of addresses, or a wildcard (mask) address. The latter two are required to sup-port more than one source system sharing the same SA (e.g., behind a firewall). \u2022Next Layer Protocol: The IP protocol header (IPv4, IPv6, or IPv6 Extension) includes a field (Protocol for IPv4, Next Header for IPv6 or IPv6 Extension)that designates the protocol operating over IP . This is an individual protocolnumber, ANY, or for IPv6 only, OPAQUE. If AH or ESP is used, then this IPprotocol header immediately precedes the AH or ESP header in the packet."}, {"id": "d753f5a9062ec7d43d6044ce4e790071aaf9a7ea", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 294, "start_line": 1, "end_line": 8, "text": "8.2 / IP SECURITY POLICY 279 \u2022Name: A user identifier from the operating system.This is not a field in the IP or upper-layer headers but is available if IPsec is running on the same operat- ing system as the user. \u2022Local and Remote Ports: These may be individual TCP or UDP port values, an enumerated list of ports, or a wildcard port. Table 8.2 provides an example of an SPD on a host system (as opposed to a network system such as a firewall or router).This table reflects the following config-"}, {"id": "16eef93ebc363a124dafc70ba3df2367419e736e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 294, "start_line": 9, "end_line": 12, "text": "uration:A local network configuration consists of two networks.The basic corporatenetwork configuration has the IP network number 1.2.3.0/24. The local configura-tion also includes a secure LAN, often known as a DMZ, that is identified as1.2.4.0/24. The DMZ is protected from both the outside world and the rest of thecorporate LAN by firewalls. The host in this example has the IP address 1.2.3.10,and it is authorized to connect to the server 1.2.4.10 in the DMZ. The entries in the SPD should be self-explanatory. For example, UDP port 500 is the designated port for IKE. Any traffic from the local host to a remote host forpurposes of an IKE exchange bypasses the IPsec processing. IP Traffic Processing"}, {"id": "4ad0cf590fcb72f96a21fe6047b1a83911d2f608", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 294, "start_line": 13, "end_line": 18, "text": "IPsec is executed on a packet-by-packet basis. When IPsec is implemented, eachoutbound IP packet is processed by the IPsec logic before transmission, and eachinbound packet is processed by the IPsec logic after reception and before passingthe packet contents on to the next higher layer (e.g., TCP or UDP). We look at thelogic of these two situations in turn. O UTBOUND PACKETS Figure 8.3 highlights the main elements of IPsec processing for outbound traffic.A block of data from a higher layer, such as TCP , is passed down to the IP layer and an IP packet is formed, consisting of an IP header and an IP body.Then the following steps occur: 1.IPsec searches the SPD for a match to this packet."}, {"id": "b01609f35f609b7d4cc992ca7ceae47badeab2f0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 294, "start_line": 19, "end_line": 28, "text": "2.If no match is found, then the packet is discarded and an error message isgenerated.Table 8.2 Host SPD Example Protocol Local IP Port Remote IP Port Action Comment UDP 1.2.3.101 500 * 500 BYPASS IKE ICMP 1.2.3.101 * * * BYPASS Error messages * 1.2.3.101 * 1.2.3.0/24 * PROTECT: ESP intransport-modeEncrypt intranet traffic TCP 1.2.3.101 * 1.2.4.10 80 PROTECT: ESP intransport-mode Encrypt to server TCP 1.2.3.101 * 1.2.4.10 443 BYPASS TLS: avoid double encryption * 1.2.3.101 * 1.2.4.0/24 * DISCARD Others in DMZ * 1.2.3.101 * * * BYPASS Internet"}, {"id": "5626be3ea537a644514515ed3af3a1b20fe02247", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 295, "start_line": 1, "end_line": 26, "text": "280 CHAPTER 8 / IP SECURITY Search security policy database Search security association databaseDetermine policyOutbound IP packet (e.g., from TCP or UDP) Discard packetNo match found No match foundMatch found Match foundDISCARD PROTECT BYPASS Forward packet via IPInternet key exchangeProcess (AH/ESP) Figure 8.3 Processing Model for Outbound Packets 3.If a match is found, further processing is determined by the first matching entry in the SPD. If the policy for this packet is DISCARD, then the packet isdiscarded. If the policy is BYPASS, then there is no further IPsec processing;the packet is forwarded to the network for transmission."}, {"id": "29e6eee8f5dc20f7eb60e743f9c142e8c5d813a8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 295, "start_line": 27, "end_line": 32, "text": "4.If the policy is PROTECT, then a search is made of the SAD for a matchingentry. If no entry is found, then IKE is invoked to create an SA with the appro-priate keys and an entry is made in the SA. 5.The matching entry in the SAD determines the processing for this packet.Either encryption, authentication, or both can be performed, and eithertransport or tunnel mode can be used. The packet is then forwarded to thenetwork for transmission. I NBOUND PACKETS Figure 8.4 highlights the main elements of IPsec processing for inbound traffic. An incoming IP packet triggers the IPsec processing. The followingsteps occur: 1.IPsec determines whether this is an unsecured IP packet or one that hasESP or AH headers/trailers, by examining the IP Protocol field (IPv4) orNext Header field (IPv6)."}, {"id": "9216a9d2aded8ce9f6f1454ab66d1973085732d8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 296, "start_line": 1, "end_line": 22, "text": "8.3 / ENCAPSULATING SECURITY PAYLOAD 281 Search security policy databaseSearch security association database Packet type Inbound IP packet (from Internet)Discard packetNo match found c e s P I P INot BYPASSMatch found BYPASSDeliver packet to higher layer (e.g. TCP, UDP) Process (AH/ESP) Figure 8.4 Processing Model for Inbound Packets 2.If the packet is unsecured, IPsec searches the SPD for a match to this packet. If the first matching entry has a policy of BYPASS, the IP header is processedand stripped off and the packet body is delivered to the next higher layer, suchas TCP . If the first matching entry has a policy of PROTECT or DISCARD, orif there is no matching entry, the packet is discarded."}, {"id": "4da1397e07f31c2851084c08c2038d991a77cfff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 296, "start_line": 23, "end_line": 26, "text": "3.For a secured packet, IPsec searches the SAD. If no match is found, thepacket is discarded. Otherwise, IPsec applies the appropriate ESP or AHprocessing.Then, the IP header is processed and stripped off and the packetbody is delivered to the next higher layer, such as TCP . 8.3 ENCAPSULATING SECURITY PAYLOAD ESP can be used to provide confidentiality, data origin authentication, connection-less integrity, an anti-replay service (a form of partial sequence integrity), and (lim-ited) traffic flow confidentiality. The set of services provided depends on optionsselected at the time of Security Association (SA) establishment and on the locationof the implementation in a network topology. ESP can work with a variety of encryption and authentication algorithms,"}, {"id": "cb2b2bcf5f0f9188e66cbb1690ca7e3d8cf0b9ab", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 296, "start_line": 27, "end_line": 27, "text": "including authenticated encryption algorithms such as GCM."}, {"id": "6688a6f062d69f12409d8edc9a8d7c40f5f10c15", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 297, "start_line": 1, "end_line": 13, "text": "282 CHAPTER 8 / IP SECURITY ESP Format Figure 8.5a shows the top-level format of an ESP packet. It contains the following fields. \u2022Security Parameters Index (32 bits): Identifies a security association. \u2022Sequence Number (32 bits): A monotonically increasing counter value; this provides an anti-replay function, as discussed for AH. \u2022Payload Data (variable): This is a transport-level segment (transport mode) or IP packet (tunnel mode) that is protected by encryption. \u2022Padding (0\u2013255 bytes): The purpose of this field is discussed later. \u2022Pad Length (8 bits): Indicates the number of pad bytes immediately preceding this field. \u2022Next Header (8 bits): Identifies the type of data contained in the payload data field by identifying the first header in that payload (for example, an extension"}, {"id": "1ffa6401f7803bc104037b8a3cc92b0eb00cea64", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 297, "start_line": 14, "end_line": 28, "text": "header in IPv6, or an upper-layer protocol such as TCP). Security parameters index (SPI)32 bits Sequence number Padding (0 - 255 bytes) Pad length Next headerPayload data (variable) Integrity check value - ICV (variable)ICV coverageEncrypted (a) Top-level format of an ESP PacketEncrypted (b) Substructure of payload dataSecurity parameters index (SPI) Sequence number Initialization value - IV (optional) Padding (0 - 255 bytes)TFC padding (optional, variable) Pad length Next headerRest of payload data (variable) Integrity check value - ICV (variable)ICV coverage Payload Figure 8.5 ESP Packet Format"}, {"id": "712e8055784dfc89e829703a1d8e8c60dc061d56", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 298, "start_line": 1, "end_line": 7, "text": "8.3 / ENCAPSULATING SECURITY PAYLOAD 283 \u2022Integrity Check Value (variable): A variable-length field (must be an integral number of 32-bit words) that contains the Integrity Check Value computed over the ESP packet minus the Authentication Data field. When any combined mode algorithm is employed, the algorithm itself is expected to return both decrypted plaintext and a pass/fail indication for the integrity check. For combined mode algorithms, the ICV that would normallyappear at the end of the ESP packet (when integrity is selected) may be omitted.When the ICV is omitted and integrity is selected, it is the responsibility of the com-bined mode algorithm to encode within the Payload Data an ICV-equivalent meansof verifying the integrity of the packet."}, {"id": "07ffd4aaef8d1f1897451ada6eaae383b34f062d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 298, "start_line": 8, "end_line": 12, "text": "Two additional fields may be present in the payload (Figure 8.5b). An initialization value (IV) , or nonce, is present if this is required by the encryption or authenticated encryption algorithm used for ESP . If tunnel mode is being used, thenthe IPsec implementation may add traffic flow confidentiality (TFC) padding after the Payload Data and before the Padding field, as explained subsequently. Encryption and Authentication Algorithms"}, {"id": "59f45c67e62b35511cebf7382a331a0704f8c9d4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 298, "start_line": 13, "end_line": 14, "text": "The Payload Data, Padding, Pad Length, and Next Header fields are encrypted bythe ESP service. If the algorithm used to encrypt the payload requires crypto-graphic synchronization data, such as an initialization vector (IV), then these datamay be carried explicitly at the beginning of the Payload Data field. If included,an IV is usually not encrypted, although it is often referred to as being part ofthe ciphertext. The ICV field is optional. It is present only if the integrity service is selected"}, {"id": "a7d485fe553af137a79906294c972fc316fb5d03", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 298, "start_line": 15, "end_line": 17, "text": "and is provided by either a separate integrity algorithm or a combined mode algo-rithm that uses an ICV .The ICV is computed after the encryption is performed.Thisorder of processing facilitates rapid detection and rejection of replayed or boguspackets by the receiver prior to decrypting the packet, hence potentially reducingthe impact of denial of service (DoS) attacks. It also allows for the possibility of par-allel processing of packets at the receiver, i.e., decryption can take place in parallelwith integrity checking. Note that because the ICV is not protected by encryption, akeyed integrity algorithm must be employed to compute the ICV . Padding The Padding field serves several purposes:"}, {"id": "262928359055ecab5f37535075c43fb7e28982c1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 298, "start_line": 18, "end_line": 20, "text": "\u2022If an encryption algorithm requires the plaintext to be a multiple of somenumber of bytes (e.g., the multiple of a single block for a block cipher), thePadding field is used to expand the plaintext (consisting of the Payload Data,Padding, Pad Length, and Next Header fields) to the required length. \u2022The ESP format requires that the Pad Length and Next Header fields be rightaligned within a 32-bit word. Equivalently, the ciphertext must be an integermultiple of 32 bits. The Padding field is used to assure this alignment. \u2022Additional padding may be added to provide partial traffic-flow confidential-ity by concealing the actual length of the payload."}, {"id": "6d8f426b80859c91b555b49b8e971a9f00e7277b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 299, "start_line": 1, "end_line": 6, "text": "284 CHAPTER 8 / IP SECURITY Anti-Replay Service A replay attack is one in which an attacker obtains a copy of an authenticated packet and later transmits it to the intended destination. The receipt of duplicate, authenticated IP packets may disrupt service in some way or may have some otherundesired consequence. The Sequence Number field is designed to thwart suchattacks. First, we discuss sequence number generation by the sender, and then welook at how it is processed by the recipient. When a new SA is established, the sender initializes a sequence number"}, {"id": "f84545a53022a4c2fd275f44227affcd7f07381e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 299, "start_line": 7, "end_line": 11, "text": "counter to 0. Each time that a packet is sent on this SA, the sender increments thecounter and places the value in the Sequence Number field. Thus, the first value tobe used is 1. If anti-replay is enabled (the default), the sender must not allow thesequence number to cycle past 2 32\u2013 1 back to zero. Otherwise, there would be multiple valid packets with the same sequence number. If the limit of 232\u2013 1 is reached, the sender should terminate this SA and negotiate a new SA with a new key. Because IP is a connectionless, unreliable service, the protocol does not guar-"}, {"id": "0c4076ee11fe243782868528f709356d59be4c8e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 299, "start_line": 12, "end_line": 16, "text": "antee that packets will be delivered in order and does not guarantee that all packetswill be delivered. Therefore, the IPsec authentication document dictates that thereceiver should implement a window of size , with a default of . The right edge of the window represents the highest sequence number, , so far received fora valid packet. For any packet with a sequence number in the range from to that has been correctly received (i.e., properly authenticated), the corresponding slot in the window is marked (Figure 8.6). Inbound processingproceeds as follows when a packet is received: 1.If the received packet falls within the window and is new, the MAC is checked.If the packet is authenticated, the corresponding slot in the window is marked."}, {"id": "1a7d4d714b3dd53ba1e45b4f4593c66be8a92067", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 299, "start_line": 17, "end_line": 27, "text": "2.If the received packet is to the right of the window and is new, the MAC ischecked. If the packet is authenticated, the window is advanced so that thissequence number is the right edge of the window, and the corresponding slot inthe window is marked. 3.If the received packet is to the left of the window or if authentication fails, thepacket is discarded; this is an auditable event.N N-W+1NW=64 W Fixed window size W N N /H11001 1 N /H11002 W Marked if valid packet recei vedUnmarked if valid packet not yet recei ved\u2022 \u2022 \u2022Advance window if val id packet to the right is recei ved Figure 8.6 Anti-replay Mechanism"}, {"id": "3ed2364151e9da05515eb23808d3acf5f835c2fc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 300, "start_line": 1, "end_line": 4, "text": "8.3 / ENCAPSULATING SECURITY PAYLOAD 285 Transport and Tunnel Modes Figure 8.7 shows two ways in which the IPsec ESP service can be used. In the upper part of the figure, encryption (and optionally authentication) is provided directlybetween two hosts. Figure 8.7b shows how tunnel mode operation can be used to setup a virtual private network . In this example, an organization has four private"}, {"id": "a4ced945dd21f678db89e7093dfd4d4472592822", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 300, "start_line": 5, "end_line": 10, "text": "networks interconnected across the Internet. Hosts on the internal networks use theInternet for transport of data but do not interact with other Internet-based hosts. Byterminating the tunnels at the security gateway to each internal network, the configu-ration allows the hosts to avoid implementing the security capability. The formertechnique is supported by a transport mode SA, while the latter technique uses atunnel mode SA. In this section, we look at the scope of ESP for the two modes. The consid- erations are somewhat different for IPv4 and IPv6. We use the packet formats ofFigure 8.8a as a starting point. T RANSPORT MODE ESP Transport mode ESP is used to encrypt and optionally authenticate the data carried by IP (e.g., a TCP segment), as shown in Figure 8.8b."}, {"id": "40bf6634dc6b870adf61e7b0e9b5452540895110", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 300, "start_line": 11, "end_line": 23, "text": "(a) Transport-level security (b) A virtual pri vate network via tunnel modeInternal networkExternal networkEncrypted TCP session InternetCorporate networkCorporate network Corporate networkCorporate networkEncrypted tunnels carrying IP traff ic Figure 8.7 Transport-Mode versus Tunnel-Mode Encryption"}, {"id": "61f6be0cfb10928975287e5d55d416ca61d1594d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 301, "start_line": 1, "end_line": 22, "text": "286 CHAPTER 8 / IP SECURITY For this mode using IPv4, the ESP header is inserted into the IP packet immediately prior to the transport-layer header (e.g., TCP , UDP , ICMP), and an ESP trailer(Padding, Pad Length, and Next Header fields) is placed after the IP packet. Ifauthentication is selected, the ESP Authentication Data field is added after the ESPtrailer. The entire transport-level segment plus the ESP trailer are encrypted.Authentication covers all of the ciphertext plus the ESP header.Orig IP hdrHop-by-hop, dest, routing, fragmentIPv6Orig IP hdrIPv4 New IP hdrIPv4(b) Transport Mode New IP hdrExt headersIPv6authenticated encryptedauthenticated encryptedauthenticated encryptedauthenticated encrypted (c) Tunnel ModeOrig IP hdrExt headersTCP DataESP trlrESP authESP hdrESP authOrig IP"}, {"id": "454058918f1163b708d9a0b31879a4ec4204eda0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 301, "start_line": 23, "end_line": 39, "text": "hdrTCP DataESP trlrESP auth ESP hdrDest TCP DataTCP Data ESP trlrESP authESP trlr ESP hdrESP hdrOrig IP hdrExtension headers (if present)TCP Data IPv6Orig IP hdrTCP Data IPv4 (a) Before Applying ESP Figure 8.8 Scope of ESP Encryption and Authentication"}, {"id": "b2bf27b47a6b2a55f735b72766136957c2c89e1d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 302, "start_line": 1, "end_line": 5, "text": "8.3 / ENCAPSULATING SECURITY PAYLOAD 287 In the context of IPv6, ESP is viewed as an end-to-end payload; that is, it is not examined or processed by intermediate routers. Therefore, the ESP header appears after the IPv6 base header and the hop-by-hop, routing, and fragment extensionheaders. The destination options extension header could appear before or after theESP header, depending on the semantics desired. For IPv6, encryption coversthe entire transport-level segment plus the ESP trailer plus the destination optionsextension header if it occurs after the ESP header. Again, authentication covers theciphertext plus the ESP header. Transport mode operation may be summarized as follows."}, {"id": "57a2b33a7d5e66d3842d0f3096826d15fa262bad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 302, "start_line": 6, "end_line": 9, "text": "1.At the source, the block of data consisting of the ESP trailer plus the entiretransport-layer segment is encrypted and the plaintext of this block is replacedwith its ciphertext to form the IP packet for transmission. Authentication isadded if this option is selected. 2.The packet is then routed to the destination. Each intermediate router needs toexamine and process the IP header plus any plaintext IP extension headers butdoes not need to examine the ciphertext. 3.The destination node examines and processes the IP header plus any plaintextIP extension headers. Then, on the basis of the SPI in the ESP header, thedestination node decrypts the remainder of the packet to recover the plaintexttransport-layer segment. Transport mode operation provides confidentiality for any application that"}, {"id": "3901320a8c5c7afac1ece36e30178e865bdac130", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 302, "start_line": 10, "end_line": 16, "text": "uses it, thus avoiding the need to implement confidentiality in every individual application. One drawback to this mode is that it is possible to do traffic analysis onthe transmitted packets. T UNNEL MODE ESP Tunnel mode ESP is used to encrypt an entire IP packet (Figure 8.8c). For this mode, the ESP header is prefixed to the packet and then the packet plus the ESP trailer is encrypted. This method can be used to countertraffic analysis. Because the IP header contains the destination address and possibly source"}, {"id": "122314a5edbfe38b37b98d9e541b1079d157807c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 302, "start_line": 17, "end_line": 18, "text": "routing directives and hop-by-hop option information, it is not possible simply totransmit the encrypted IP packet prefixed by the ESP header. Intermediate routerswould be unable to process such a packet. Therefore, it is necessary to encapsulatethe entire block (ESP header plus ciphertext plus Authentication Data, if present)with a new IP header that will contain sufficient information for routing but not fortraffic analysis. Whereas the transport mode is suitable for protecting connections between"}, {"id": "55467958cb6bf72c3d1f84dd9996e62f55ba0683", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 302, "start_line": 19, "end_line": 21, "text": "hosts that support the ESP feature, the tunnel mode is useful in a configuration thatincludes a firewall or other sort of security gateway that protects a trusted networkfrom external networks. In this latter case, encryption occurs only between an exter-nal host and the security gateway or between two security gateways. This relieveshosts on the internal network of the processing burden of encryption and simplifiesthe key distribution task by reducing the number of needed keys. Further, it thwartstraffic analysis based on ultimate destination. Consider a case in which an external host wishes to communicate with a host on an internal network protected by a firewall, and in which ESP is implemented in"}, {"id": "56cc74bca01b617a0e3c3333aeedc9c9244ba520", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 303, "start_line": 1, "end_line": 4, "text": "288 CHAPTER 8 / IP SECURITY the external host and the firewalls. The following steps occur for transfer of a trans- port-layer segment from the external host to the internal host. 1.The source prepares an inner IP packet with a destination address of thetarget internal host. This packet is prefixed by an ESP header; then thepacket and ESP trailer are encrypted and Authentication Data maybe added. The resulting block is encapsulated with a new IP header (baseheader plus optional extensions such as routing and hop-by-hop options forIPv6) whose destination address is the firewall; this forms the outer IPpacket."}, {"id": "791f3e9c7b5b45c9d716f7701540b3350af34c00", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 303, "start_line": 5, "end_line": 9, "text": "2.The outer packet is routed to the destination firewall. Each intermediaterouter needs to examine and process the outer IP header plus any outer IPextension headers but does not need to examine the ciphertext. 3.The destination firewall examines and processes the outer IP header plusany outer IP extension headers. Then, on the basis of the SPI in the ESPheader, the destination node decrypts the remainder of the packet torecover the plaintext inner IP packet. This packet is then transmitted in theinternal network. 4.The inner packet is routed through zero or more routers in the internalnetwork to the destination host. Figure 8.9 shows the protocol architecture for the two modes. 8.4 COMBINING SECURITY ASSOCIATIONS"}, {"id": "37fa4434486a98bbb6f62c76363cffd1feacaaca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 303, "start_line": 10, "end_line": 12, "text": "An individual SA can implement either the AH or ESP protocol but not both.Sometimes a particular traffic flow will call for the services provided by both AHand ESP . Further, a particular traffic flow may require IPsec services between hostsand, for that same flow, separate services between security gateways, such as fire-walls. In all of these cases, multiple SAs must be employed for the same traffic flowto achieve the desired IPsec services.The term security association bundle refers to a sequence of SAs through which traffic must be processed to provide a desired set ofIPsec services. The SAs in a bundle may terminate at different endpoints or at thesame endpoints. Security associations may be combined into bundles in two ways:"}, {"id": "f1b9ab06cd559f87bc0179742746bdb028faf10a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 303, "start_line": 13, "end_line": 16, "text": "\u2022Transport adjacency: Refers to applying more than one security protocol to the same IP packet without invoking tunneling. This approach to combiningAH and ESP allows for only one level of combination; further nesting yieldsno added benefit since the processing is performed at one IPsec instance: the(ultimate) destination. \u2022Iterated tunneling: Refers to the application of multiple layers of security protocols effected through IP tunneling. This approach allows for multiplelevels of nesting, since each tunnel can originate or terminate at a differentIPsec site along the path."}, {"id": "a13325e35f6eae53f8d992f3fec3b7242ba0ecb6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 304, "start_line": 1, "end_line": 45, "text": "8.4 / COMBINING SECURITY ASSOCIATIONS 289 Data Data TCP hdrData TCP hdrDataOrig IP hdr TCP hdrDataESP trlrESP hdrOrig IP hdrESP auth New IP hdrTCP hdrDataESP trlrESP hdrOrig IP hdrESP authTCP hdrData Orig IP hdrTCP hdrData Orig IP hdrTCP hdrData (a) Transport mode (b) Tunnel modeESP trlrESP hdrESP authApplication TCP IP IPsec Application TCP IP IPsec IP Figure 8.9 Protocol Operation for ESP The two approaches can be combined, for example, by having a transport SA between hosts travel part of the way through a tunnel SA between security gateways. One interesting issue that arises when considering SA bundles is the order in"}, {"id": "edf5c3e774f9f924d6dca7d9ad018c1a33dcea7d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 304, "start_line": 46, "end_line": 46, "text": "which authentication and encryption may be applied between a given pair of endpointsand the ways of doing so.We examine that issue next.Then we look at combinations ofSAs that involve at least one tunnel."}, {"id": "6eb498836c31f028ad4c720f14f5ef6adb7e1682", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 305, "start_line": 1, "end_line": 11, "text": "290 CHAPTER 8 / IP SECURITY Authentication Plus Confidentiality Encryption and authentication can be combined in order to transmit an IP packet that has both confidentiality and authentication between hosts. We look at severalapproaches. ESP WITH AUTHENTICATION OPTION This approach is illustrated in Figure 8.8. In this approach, the user first applies ESP to the data to be protected and then appends the authentication data field. There are actually two subcases: \u2022Transport mode ESP: Authentication and encryption apply to the IP payload delivered to the host, but the IP header is not protected. \u2022Tunnel mode ESP: Authentication applies to the entire IP packet delivered"}, {"id": "285b3de566156ba13d803364a1ecfe61a7c48125", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 305, "start_line": 12, "end_line": 16, "text": "to the outer IP destination address (e.g., a firewall), and authentication isperformed at that destination. The entire inner IP packet is protected by theprivacy mechanism for delivery to the inner IP destination. For both cases, authentication applies to the ciphertext rather than the plaintext. T RANSPORT ADJACENCY Another way to apply authentication after encryption is to use two bundled transport SAs, with the inner being an ESP SA and the outer being"}, {"id": "9ba7479a66100cb3a1556137b31f1e924e19dabd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 305, "start_line": 17, "end_line": 19, "text": "an AH SA. In this case, ESP is used without its authentication option. Because theinner SA is a transport SA, encryption is applied to the IP payload. The resultingpacket consists of an IP header (and possibly IPv6 header extensions) followed by anESP .AH is then applied in transport mode, so that authentication covers the ESP plusthe original IP header (and extensions) except for mutable fields. The advantage ofthis approach over simply using a single ESP SA with the ESP authentication optionis that the authentication covers more fields, including the source and destination IPaddresses. The disadvantage is the overhead of two SAs versus one SA. T RANSPORT -TUNNEL BUNDLE The use of authentication prior to encryption might"}, {"id": "8e65a2bc6f527bb77d07be311aa3594076096914", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 305, "start_line": 20, "end_line": 22, "text": "be preferable for several reasons. First, because the authentication data are protected by encryption, it is impossible for anyone to intercept the message andalter the authentication data without detection. Second, it may be desirable to storethe authentication information with the message at the destination for laterreference. It is more convenient to do this if the authentication information appliesto the unencrypted message; otherwise the message would have to be reencryptedto verify the authentication information. One approach to applying authentication before encryption between two"}, {"id": "2c1160ee52d0b63a1f356744935467f157cab3aa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 305, "start_line": 23, "end_line": 25, "text": "hosts is to use a bundle consisting of an inner AH transport SA and an outer ESPtunnel SA. In this case, authentication is applied to the IP payload plus the IPheader (and extensions) except for mutable fields. The resulting IP packet is thenprocessed in tunnel mode by ESP; the result is that the entire, authenticated innerpacket is encrypted and a new outer IP header (and extensions) is added. Basic Combinations of Security Associations The IPsec Architecture document lists four examples of combinations of SAs thatmust be supported by compliant IPsec hosts (e.g., workstation, server) or securitygateways (e.g. firewall, router).These are illustrated in Figure 8.10.The lower part of"}, {"id": "063d27f337b1d178ea26075b0cd483b62fd172a7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 306, "start_line": 1, "end_line": 24, "text": "291InternetTunnel SAOne or two SAs Local IntranetLocal IntranetHost* Host*Security gateway*Security gateway* (c) Case 3 InternetTunnel SA Local IntranetLocal IntranetHost HostSecurity gateway*Security gateway* (b) Case 2 * /H11005 implements IPsecInternetOne or More SAs Local IntranetLocal IntranetHost* Host*Router Router (a) Case 1 InternetLocal IntranetHost* Host*Security gateway* (d) Case 4Tunnel SAOne or two SAs Figure 8.10 Basic Combinations of Security Associations"}, {"id": "527d422da1dbe3de0b8fe5ee9de6e5c595d8d58b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 307, "start_line": 1, "end_line": 10, "text": "292 CHAPTER 8 / IP SECURITY each case in the figure represents the physical connectivity of the elements; the upper part represents logical connectivity via one or more nested SAs. Each SA canbe either AH or ESP . For host-to-host SAs, the mode may be either transport ortunnel; otherwise it must be tunnel mode. Case 1. All security is provided between end systems that implement IPsec. For any two end systems to communicate via an SA, they must share the appropri-ate secret keys. Among the possible combinations are a.AH in transport mode b.ESP in transport mode c.ESP followed by AH in transport mode (an ESP SA inside an AH SA) d.Any one of a, b, or c inside an AH or ESP in tunnel mode We have already discussed how these various combinations can be used to"}, {"id": "aabf78062937f639f9f7f73dd8f59ca8837f9a76", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 307, "start_line": 11, "end_line": 15, "text": "support authentication, encryption, authentication before encryption, and authenti- cation after encryption. Case 2. Security is provided only between gateways (routers, firewalls, etc.) and no hosts implement IPsec. This case illustrates simple virtual private networksupport.The security architecture document specifies that only a single tunnel SA isneeded for this case. The tunnel could support AH, ESP , or ESP with the authenti-cation option. Nested tunnels are not required, because the IPsec services apply tothe entire inner packet. Case 3. This builds on case 2 by adding end-to-end security. The same combi-"}, {"id": "64ca780466593158a98b6aa74e35cb1eefc5866d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 307, "start_line": 16, "end_line": 19, "text": "nations discussed for cases 1 and 2 are allowed here.The gateway-to-gateway tunnelprovides either authentication, confidentiality, or both for all traffic between endsystems. When the gateway-to-gateway tunnel is ESP , it also provides a limited formof traffic confidentiality. Individual hosts can implement any additional IPsec ser-vices required for given applications or given users by means of end-to-end SAs. Case 4. This provides support for a remote host that uses the Internet to reach an organization\u2019s firewall and then to gain access to some server or workstation behindthe firewall. Only tunnel mode is required between the remote host and the firewall.Asin case 1, one or two SAs may be used between the remote host and the local host. 8.5 INTERNET KEY EXCHANGE"}, {"id": "ef67c219237af31e1bb3a2ed070abb7356d9eae1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 307, "start_line": 20, "end_line": 24, "text": "The key management portion of IPsec involves the determination and distribution ofsecret keys. A typical requirement is four keys for communication between twoapplications: transmit and receive pairs for both integrity and confidentiality. TheIPsec Architecture document mandates support for two types of key management: \u2022Manual: A system administrator manually configures each system with its own keys and with the keys of other communicating systems. This is practicalfor small, relatively static environments. \u2022Automated: An automated system enables the on-demand creation of keys for SAs and facilitates the use of keys in a large distributed system with anevolving configuration."}, {"id": "08db96bd808b57e2af582cb201344ae743401b25", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 308, "start_line": 1, "end_line": 9, "text": "8.5 / INTERNET KEY EXCHANGE 293 The default automated key management protocol for IPsec is referred to as ISAKMP/Oakley and consists of the following elements: \u2022Oakley Key Determination Protocol: Oakley is a key exchange protocol based on the Diffie-Hellman algorithm but providing added security. Oakley is generic in that it does not dictate specific formats. \u2022Internet Security Association and Key Management Protocol (ISAKMP):ISAKMP provides a framework for Internet key management and provides thespecific protocol support, including formats, for negotiation of security attributes. ISAKMP by itself does not dictate a specific key exchange algorithm; rather, ISAKMP consists of a set of message types that enable the use of a variety of key"}, {"id": "be7a41858c663470049e1aad9f2d54e396ea1534", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 308, "start_line": 10, "end_line": 14, "text": "exchange algorithms. Oakley is the specific key exchange algorithm mandated foruse with the initial version of ISAKMP . In IKEv2, the terms Oakley and ISAKMP are no longer used, and there are significant differences from the use of Oakley and ISAKMP in IKEv1. Nevertheless,the basic functionality is the same. In this section, we describe the IKEv2 specification. Key Determination Protocol IKE key determination is a refinement of the Diffie-Hellman key exchange algo-rithm. Recall that Diffie-Hellman involves the following interaction between usersA and B. There is prior agreement on two global parameters: , a large prime num-ber; and , a primitive root of .A selects a random integer as its private key andtransmits to B its public key . Similarly, B selects a random integer"}, {"id": "26cf01dbb9b4b15fbb536b16d07e639279b3fd92", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 308, "start_line": 15, "end_line": 21, "text": "as its private key and transmits to A its public key . Each side can now compute the secret session key: The Diffie-Hellman algorithm has two attractive features: \u2022Secret keys are created only when needed. There is no need to store secretkeys for a long period of time, exposing them to increased vulnerability. \u2022The exchange requires no pre-existing infrastructure other than an agreementon the global parameters. However, there are a number of weaknesses to Diffie-Hellman, as pointed out in[HUIT98]. \u2022It does not provide any information about the identities of the parties."}, {"id": "8ea5ed4e7abe4d38b7525fea23e00f858b75d76b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 308, "start_line": 22, "end_line": 25, "text": "\u2022It is subject to a man-in-the-middle attack, in which a third party C imperson-ates B while communicating with A and impersonates A while communicatingwith B. Both A and B end up negotiating a key with C, which can then listen toand pass on traffic. The man-in-the-middle attack proceeds as 1.B sends his public key in a message addressed to A (see Figure 3.13). 2.The enemy (E) intercepts this message. E saves B\u2019s public key and sends amessage to A that has B\u2019s User ID but E\u2019s public key . This message is Y EYBK=(/H9020B)XA mod q =(/H9020A)XB mod q=aXAXB mod q/H9020B=aXB mod q XB/H9020A=aXA mod qXA q aq"}, {"id": "1377b59d785a7e04b060c2f6932b929fd2b39a58", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 309, "start_line": 1, "end_line": 5, "text": "294 CHAPTER 8 / IP SECURITY sent in such a way that it appears as though it was sent from B\u2019s host system. A receives E\u2019s message and stores E\u2019s public key with B\u2019s User ID. Similarly,E sends a message to B with E\u2019s public key, purporting to come from A. 3.B computes a secret key based on B\u2019s private key and . A computes asecret key based on A\u2019s private key and . E computes using E\u2019ssecret key and and computers using and . 4.From now on, E is able to relay messages from A to B and from B to A,appropriately changing their encipherment en route in such a way thatneither A nor B will know that they share their communication with E."}, {"id": "3e8edc708bca20c2f2aa70652441b3a24cf7e3a6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 309, "start_line": 6, "end_line": 16, "text": "\u2022It is computationally intensive.As a result, it is vulnerable to a clogging attack,in which an opponent requests a high number of keys. The victim spendsconsiderable computing resources doing useless modular exponentiationrather than real work. IKE key determination is designed to retain the advantages of Diffie- Hellman, while countering its weaknesses. F EATURES OF IKE KEY DETERMINATION The IKE key determination algorithm is characterized by five important features: 1.It employs a mechanism known as cookies to thwart clogging attacks. 2.It enables the two parties to negotiate a group; this, in essence, specifies the global parameters of the Diffie-Hellman key exchange. 3.It uses nonces to ensure against replay attacks. 4.It enables the exchange of Diffie-Hellman public key values."}, {"id": "50b7306dab53258bcddaa20b4f6ab905308badad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 309, "start_line": 17, "end_line": 22, "text": "5.It authenticates the Diffie-Hellman exchange to thwart man-in-the-middle attacks. We have already discussed Diffie-Hellman. Let us look at the remainder of these elements in turn. First, consider the problem of clogging attacks. In this attack, an opponent forges the source address of a legitimate user and sends a public Diffie-Hellman key to the victim. The victim then performs a modular exponentiation tocompute the secret key. Repeated messages of this type can clog the victim\u2019s system with useless work. The cookie exchange requires that each side send a pseudoran-"}, {"id": "1a2a87c3297ae27dc5bf8c3c91b12fe5f3c3f0f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 309, "start_line": 23, "end_line": 25, "text": "dom number, the cookie, in the initial message, which the other side acknowledges.This acknowledgment must be repeated in the first message of the Diffie-Hellmankey exchange. If the source address was forged, the opponent gets no answer. Thus,an opponent can only force a user to generate acknowledgments and not to performthe Diffie-Hellman calculation. IKE mandates that cookie generation satisfy three basic requirements: 1.The cookie must depend on the specific parties.This prevents an attacker fromobtaining a cookie using a real IP address and UDP port and then using it toswamp the victim with requests from randomly chosen IP addresses or ports."}, {"id": "2ba61a8ac8823a4908c285f6bfa1e7439d650fef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 309, "start_line": 26, "end_line": 27, "text": "2.It must not be possible for anyone other than the issuing entity to generate cook-ies that will be accepted by that entity.This implies that the issuing entity will uselocal secret information in the generation and subsequent verification of aY A XE K2 YB XEK1 YE K2YE K1"}, {"id": "0f8afbaff1a81710a20b6511c01460b3d1795e79", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 310, "start_line": 1, "end_line": 8, "text": "8.5 / INTERNET KEY EXCHANGE 295 cookie. It must not be possible to deduce this secret information from any partic- ular cookie. The point of this requirement is that the issuing entity need not savecopies of its cookies, which are then more vulnerable to discovery, but can verifyan incoming cookie acknowledgment when it needs to. 3.The cookie generation and verification methods must be fast to thwart attacksintended to sabotage processor resources. The recommended method for creating the cookie is to perform a fast hash (e.g., MD5) over the IP Source and Destination addresses, the UDP Source and Destination ports, and a locally generated secret value. IKE key determination supports the use of different groups for the Diffie-"}, {"id": "9387609560aba0bad43a9763aadaad8c5fc213e0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 310, "start_line": 9, "end_line": 21, "text": "Hellman key exchange. Each group includes the definition of the two global parame-ters and the identity of the algorithm.The current specification includes the followinggroups. \u2022Modular exponentiation with a 768-bit modulus \u2022Modular exponentiation with a 1024-bit modulus \u2022Modular exponentiation with a 1536-bit modulus \u2022Parameters to be determined \u2022Elliptic curve group over \u2022Generator (hexadecimal): \u2022Elliptic curve parameters (hexadecimal): \u2022Elliptic curve group over \u2022Generator (hexadecimal): \u2022Elliptic curve parameters (hexadecimal): The first three groups are the classic Diffie-Hellman algorithm using modular exponentiation. The last two groups use the elliptic curve analog to Diffie-Hellman,which was described in Chapter 3."}, {"id": "d83e189317c2f11758943b4de26581d1376291b4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 310, "start_line": 22, "end_line": 29, "text": "IKE key determination employs nonces to ensure against replay attacks. Each nonce is a locally generated pseudorandom number. Nonces appear in responsesand are encrypted during certain portions of the exchange to secure their use. Three different authentication methods can be used with IKE key determination: \u2022Digital signatures: The exchange is authenticated by signing a mutually obtainable hash; each party encrypts the hash with its private key. The hash isgenerated over important parameters, such as user IDs and nonces. \u2022Public-key encryption: The exchange is authenticated by encrypting parame- ters such as IDs and nonces with the sender\u2019s private key.A=0, Y =1EE9X=18, Y =D2 185A=0, Y =7338FX=7B, Y =1C82155 a=2 q=21024-2960-1+264*(:2894*p;+129093) a=2 q=2768-2704-1+264*(:2638*p;+149686)"}, {"id": "6ee13745f0ef94eb0a8c729f4c2dac867be1a5d4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 311, "start_line": 1, "end_line": 6, "text": "296 CHAPTER 8 / IP SECURITY \u2022Symmetric-key encryption: A key derived by some out-of-band mechanism can be used to authenticate the exchange by symmetric encryption of exchange parameters. IKE V2 E XCHANGES The IKEv2 protocol involves the exchange of messages in pairs. The first two pairs of exchanges are referred to as the initial exchanges"}, {"id": "f1a7f52336be6b4bdbb49722ab39dfaf2c562a80", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 311, "start_line": 7, "end_line": 7, "text": "(Figure 8.11a). In the first exchange, the two peers exchange information concerningcryptographic algorithms and other security parameters they are willing to use alongwith nonces and Diffie-Hellman (DH) values. The result of this exchange is to set upa special SA called the IKE SA (see Figure 8.2). This SA defines parameters for asecure channel between the peers over which subsequent message exchanges takeplace. Thus, all subsequent IKE message exchanges are protected by encryption andmessage authentication. In the second exchange, the two parties authenticate oneanother and set up a first IPsec SA to be placed in the SADB and used for protectingordinary (i.e. non-IKE) communications between the peers. Thus, four messages areneeded to establish the first SA for general use."}, {"id": "5bf9ccee191e01998a513a02807e75e76f29e762", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 311, "start_line": 8, "end_line": 26, "text": "HDR, SAi1, KEi, Nir e d n o p s e R r o t a i t i n I (a) Initial exchangesHDR, SAr1, KEr, Nr, [CERTREQ] HDR, SK {IDi, [CERT,] [CERTREQ,] [IDr,] AUTH, SAi2, TSi, TSr} HDR, SK {IDr, [CERT,] AUTH, SAr2, TSi, TSr} HDR, SK {[N], SA, Ni, [KEi], [TSi, TSr]} (b) CREATE_CHILD_SA exchangeHDR, SK {SA, Nr, [KEr], [TSi, TSr]} HDR, SK {[N,] [D,] [CP,] ...} (c) Informational exchangeHDR, SK {[N,] [D,] [CP], ...} HDR = IKE header SAx1 = offered and chosen algorithms, DH group KEx = Diff ie-Hellman public key Nx= noncesCERTREQ = Certif icate request IDx = identityCERT = certif icateSK {...} = MAC and encrypt AUTH = Authentication SAx2 = algorithms, parameters for IPsec SA TSx = traff ic selectors for IPsec SA N = NotifyD = Delete CP = Conf iguration Figure 8.11 IKEv2 Exchanges"}, {"id": "05ac2ccf29c9211c12622ca116f630fc448eb1eb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 312, "start_line": 1, "end_line": 9, "text": "8.5 / INTERNET KEY EXCHANGE 297 The CREATE_CHILD_SA exchange can be used to establish further SAs for protecting traffic. The informational exchange is used to exchange management information, IKEv2 error messages, and other notifications. Header and Payload Formats IKE defines procedures and packet formats to establish, negotiate, modify, and delete security associations. As part of SA establishment, IKE defines payloads forexchanging key generation and authentication data. These payload formats providea consistent framework independent of the specific key exchange protocol, encryp-tion algorithm, and authentication mechanism. IKE H EADER FORMAT An IKE message consists of an IKE header followed by one or"}, {"id": "4d9f445c20b0a1e32d9d8c9b6ae95e0e2b4c7d9d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 312, "start_line": 10, "end_line": 25, "text": "more payloads. All of this is carried in a transport protocol. The specification dictates that implementations must support the use of UDP for the transport protocol. Figure 8.12a shows the header format for an IKE message. It consists of the following fields. \u2022Initiator SPI (64 bits): A value chosen by the initiator to identify a unique IKE security association (SA). \u2022Responder SPI (64 bits): A value chosen by the responder to identify a unique IKE SA. \u2022Next Payload (8 bits): Indicates the type of the first payload in the message; payloads are discussed in the next subsection. \u2022Major Version (4 bits): Indicates major version of IKE in use. \u2022Minor Version (4 bits): Indicates minor version in use. MjVer MnVer Exchange Type Flags Next Payload Message ID Length (a) IKE header"}, {"id": "81db128e3474949a8f1e59fe9ae78a3210497b9f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 312, "start_line": 26, "end_line": 29, "text": "(b) Generic Payload headerInitiator\u2019s Security Parameter Index (SPI) Responder\u2019s Security Parameter Index (SPI)0 Bit: 8 16 24 31 RESERVED Payload Length Next Payload C0 Bit: 8 16 31 Figure 8.12 IKE Formats"}, {"id": "275ffabea0e90eba5a7f33b1d986eb6287492968", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 313, "start_line": 1, "end_line": 18, "text": "Table 8.3 IKE Payload Types Type Parameters Security Association Proposals Key Exchange DH Group #, Key Exchange Data Identification ID Type, ID Data Certificate Cert Encoding, Certificate Data Certificate Request Cert Encoding, Certification Authority Authentication Auth Method, Authentication Data Nonce Nonce Data Notify Protocol-ID, SPI Size, Notify Message Type, SPI, Notification Data Delete Protocol-ID, SPI Size, # of SPIs, SPI (one or more) Vendor ID Vendor ID Traffic Selector Number of TSs, Traffic Selectors Encrypted IV , Encrypted IKE payloads, Padding, Pad Length, ICV Configuration CFG Type, Configuration Attributes Extensible Authentication ProtocolEAP Message298 CHAPTER 8 / IP SECURITY \u2022Exchange Type (8 bits): Indicates the type of exchange; these are discussed"}, {"id": "8a95f086545ec6efdc43ced92ac2245b1e79ccac", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 313, "start_line": 19, "end_line": 27, "text": "later in this section. \u2022Flags (8 bits): Indicates specific options set for this IKE exchange. Three bits are defined so far. The initiator bit indicates whether this packet is sent by the SA ini- tiator. The version bit indicates whether the transmitter is capable of using ahigher major version number than the one currently indicated. The response bitindicates whether this is a response to a message containing the same message ID. \u2022Message ID (32 bits): Used to control retransmission of lost packets and matching of requests and responses. \u2022Length (32 bits): Length of total message (header plus all payloads) in octets. IKE P AYLOAD TYPES All IKE payloads begin with the same generic payload header"}, {"id": "1d0fee69590dee1ec7e85ac5c67b34901938cd05", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 313, "start_line": 28, "end_line": 32, "text": "shown in Figure 8.12b. The Next Payload field has a value of 0 if this is the lastpayload in the message; otherwise its value is the type of the next payload. ThePayload Length field indicates the length in octets of this payload, including thegeneric payload header. The critical bit is 0 if the sender wants the recipient to skip this payload if it does not understand the payload type code in the Next Payload field of the previouspayload. It is set to 1 if the sender wants the recipient to reject this entire message ifit does not understand the payload type. Table 8.3 summarizes the payload types defined for IKE and lists the fields, or parameters, that are part of each payload. The SA payload is used to begin"}, {"id": "894186e1f5d25979e595b5e18ba4f35df6e9d9d1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 314, "start_line": 1, "end_line": 6, "text": "8.5 / INTERNET KEY EXCHANGE 299 the establishment of an SA. The payload has a complex, hierarchical structure. The payload may contain multiple proposals. Each proposal may contain multiple proto-cols. Each protocol may contain multiple transforms. And each transform maycontain multiple attributes. These elements are formatted as substructures withinthe payload as follows. \u2022Proposal: This substructure includes a proposal number, a protocol ID (AH, ESP , or IKE), an indicator of the number of transforms, and then atransform substructure. If more than one protocol is to be included in aproposal, then there is a subsequent proposal substructure with the same pro-posal number. \u2022Transform: Different protocols support different transform types. The trans-"}, {"id": "9d5946fe0b15a22b1e2d75b3a71eede1d43ce9f3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 314, "start_line": 7, "end_line": 14, "text": "forms are used primarily to define cryptographic algorithms to be used with aparticular protocol. \u2022Attribute: Each transform may include attributes that modify or complete the specification of the transform. An example is key length. The Key Exchange payload can be used for a variety of key exchange tech- niques, including Oakley, Diffie-Hellman, and the RSA-based key exchange used by PGP . The Key Exchange data field contains the data required to generate a sessionkey and is dependent on the key exchange algorithm used. The Identification payload is used to determine the identity of communicating peers and may be used for determining authenticity of information.Typically the IDData field will contain an IPv4 or IPv6 address."}, {"id": "2c1a2501db1b6beeca8cd7682497b2714658752f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 314, "start_line": 15, "end_line": 30, "text": "The Certificate payload transfers a public-key certificate. The Certificate Encoding field indicates the type of certificate or certificate-related information,which may include the following: \u2022PKCS #7 wrapped X.509 certificate \u2022PGP certificate \u2022DNS signed key \u2022X.509 certificate\u2014signature \u2022X.509 certificate\u2014key exchange \u2022Kerberos tokens \u2022Certificate Revocation List (CRL) \u2022Authority Revocation List (ARL) \u2022SPKI certificate At any point in an IKE exchange, the sender may include a Certificate Request payload to request the certificate of the other communicating entity. The payload may list more than one certificate type that is acceptable and more than one certificate authority that is acceptable. The Authentication payload contains data used for message authentication"}, {"id": "8315eedb27ccb7009f87d70b34f3d3c45e0b874f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 314, "start_line": 31, "end_line": 31, "text": "purposes.The authentication method types so far defined are RSA digital signature,shared-key message integrity code, and DSS digital signature."}, {"id": "a3b9faa97da3081f4f9b99eb4f67bbdd3c5ccb5b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 315, "start_line": 1, "end_line": 10, "text": "300 CHAPTER 8 / IP SECURITY The Delete payload indicates one or more SAs that the sender has deleted from its database and that therefore are no longer valid. The Vendor ID payload contains a vendor-defined constant. The constant is used by vendors to identify and recognize remote instances of their implementa- tions. This mechanism allows a vendor to experiment with new features whilemaintaining backward compatibility. The Traffic Selector payload allows peers to identify packet flows for process- ing by IPsec services. The Encrypted payload contains other payloads in encrypted form. The encrypted payload format is similar to that of ESP . It may include an IV if theencryption algorithm requires it and an ICV if authentication is selected."}, {"id": "1f445fd0d524674e48f6d055ed119c65fb0aedce", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 315, "start_line": 11, "end_line": 30, "text": "The Configuration payload is used to exchange configuration information between IKE peers. The Extensible Authentication Protocol (EAP) payload allows IKE SAs to be authenticated using EAP , which was discussed in Chapter 6.Error Messages Status Messages Unsupported Critical Initial Contact Payload Set Window Size Invalid IKE SPI Additional TS Possible Invalid Major Version IPCOMP Supported Invalid Syntax NAT Detection Source IP Invalid Payload Type NAT Detection Destination IP Invalid Message ID Cookie Invalid SPI Use Transport Mode No Proposal Chosen HTTP Cert Lookup Supported Invalid KE Payload Rekey SA Authentication Failed ESP TFC Padding Not Supported Single Pair Required Non First Fragments Also No Additional SAS Internal Address Failure Failed CP Required TS Unacceptable"}, {"id": "2678b562397eface7c7b29969e22dbf4e2309cde", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 315, "start_line": 31, "end_line": 34, "text": "Invalid SelectorsThe Nonce payload contains random data used to guarantee liveness during an exchange and to protect against replay attacks. The Notify payload contains either error or status information associated with this SA or this SA negotiation. The following table lists the IKE notifymessages."}, {"id": "8c78eebf72ca19fe2404771ef8af4c6012159cb5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 316, "start_line": 1, "end_line": 6, "text": "8.6 / CRYPTOGRAPHIC SUITES 301 8.6 CRYPTOGRAPHIC SUITES The IPsecv3 and IKEv3 protocols rely on a variety of types of cryptographic algo- rithms. As we have seen in this book, there are many cryptographic algorithms ofeach type, each with a variety of parameters, such as key size. To promote interoper-ability, two RFCs define recommended suites of cryptographic algorithms and para-meters for various applications. RFC 4308 defines two cryptographic suites for establishing virtual private net- works. Suite VPN-A matches the commonly used corporate VPN security used inolder IKEv1 implementations at the time of the issuance of IKEv2 in 2005. SuiteVPN-B provides stronger security and is recommended for new VPNs that imple-ment IPsecv3 and IKEv2."}, {"id": "4bd1ecb17d4008d29df4979064d5b66a69dced24", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 316, "start_line": 7, "end_line": 22, "text": "Table 8.4a lists the algorithms and parameters for the two suites. There are several points to note about these two suites. Note that for symmetric Table 8.4 Cryptographic Suites for IPsec VPN-A VPN-B ESP encryption 3DES-CBC AES-CBC (128-bit key) ESP integrity HMAC-SHA1-96 AES-XCBC-MAC-96 IKE encryption 3DES-CBC AES-CBC (128-bit key) IKE PRF HMAC-SHA1 AES-XCBC-PRF-128 IKE Integrity HMAC-SHA1-96 AES-XCBC-MAC-96 IKE DH group 1024-bit MODP 2048-bit MODP (a) Virtual private networks (RFC 4308) GCM-128 GCM-256 GMAC-128 GMAC-256 ESP encryption/IntegrityAES-GCM (128-bit key) AES-GCM (256-bit key) Null Null ESP integrity Null Null AES-GMAC (128-bit key) AES-GMAC (256-bit key) IKE encryption AES-CBC (128-bit key) AES-CBC (256-bit key) AES-CBC (128-bitkey) AES-CBC (256-bit key)"}, {"id": "fa98f2c079b2dd805c198dcd3d5447122ffff464", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 316, "start_line": 23, "end_line": 27, "text": "IKE PRF HMAC-SHA-256 HMAC-SHA-384 HMAC-SHA-256 HMAC-SHA-384 IKE Integrity HMAC-SHA-256-128 HMAC-SHA-384-192 HMAC-SHA-256-128 HMAC-SHA-384-192 IKE DH group 256-bit randomECP 384-bit randomECP 256-bit randomECP 384-bit randomECP IKE authentication ECDSA-256 ECDSA-384 ECDSA-256 ECDSA-384 (b) NSA Suite B (RFC 4869)"}, {"id": "17621986fa19a65d818333847e12ba4cc96eceb7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 317, "start_line": 1, "end_line": 10, "text": "302 CHAPTER 8 / IP SECURITY cryptography, VPN-A relies on 3DES and HMAC, while VPN-B relies exclu- sively on AES. Three types of secret-key algorithms are used: \u2022Encryption: For encryption, the cipher block chaining (CBC) mode is used. \u2022Message authentication: For message authentication,VPN-A relies on HMAC with SHA-1 with the output truncated to 96 bits. VPN-B relies on a variant ofCMAC with the output truncated to 96 bits. \u2022Pseudorandom function: IKEv2 generates pseudorandom bits by repeated use of the MAC used for message authentication. RFC 4869 defines four optional cryptographic suites that are compatible with the United States National Security Agency\u2019s Suite B specifications. In 2005, the"}, {"id": "2882e54787dd7238faecbc4d3265379e593e1115", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 317, "start_line": 11, "end_line": 14, "text": "NSA issued Suite B, which defined the algorithms and strengths needed to protectboth sensitive but unclassified (SBU) and classified information for use in itsCryptographic Modernization program [LATT09]. The four suites defined inRFC 4869 provide choices for ESP and IKE. The four suites are differentiated bythe choice of cryptographic algorithm strengths and a choice of whether ESP is toprovide both confidentiality and integrity or integrity only. All of the suites offergreater protection than the two VPN suites defined in RFC 4308. Table 8.4b lists the algorithms and parameters for the two suites. As with RFC 4308, three categories of secret key algorithms are listed: \u2022Encryption: For ESP , authenticated encryption is provided using the GCM"}, {"id": "026c00c23b8d6f2079a5c6ef2f2277cf2de8ddc0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 317, "start_line": 15, "end_line": 21, "text": "mode with either 128-bit or 256-bit AES keys. For IKE encryption, CBC isused, as it was for the VPN suites. \u2022Message authentication: For ESP , if only authentication is required, then GMAC is used. GMAC is a message authentication code algorithm based onthe CRT mode of operation discussed in Chapter 2. For IKE, message authen-tication is provided using HMAC with one of the SHA-3 hash functions. \u2022Pseudorandom function: As with the VPN suites, IKEv2 in these suites gener- ates pseudorandom bits by repeated use of the MAC used for messageauthentication. For the Diffie-Hellman algorithm, the use of elliptic curve groups modulo a prime is specified. For authentication, elliptic curve digital signatures are listed. The"}, {"id": "91231000cab04b9f08c15b4a6fb6bfd378d58b5c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 317, "start_line": 22, "end_line": 25, "text": "original IKEv2 documents used RSA-based digital signatures. Equivalent or greaterstrength can be achieved using ECC with fewer key bits. 8.7 RECOMMENDED READING AND WEB SITES IPv6 and IPv4 are covered in more detail in [STAL07]. [CHEN98] provides a good discussion of an IPsec design. [FRAN05] is a more comprehensive treatment of IPsec.[PATE06] is a useful overview of IPsecv3 and IKEv2 with an emphasis on cryptographicaspects."}, {"id": "65cf6eec7e1e329b3bd66c5e7b04f8b70e0c6260", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 318, "start_line": 1, "end_line": 19, "text": "8.8 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 303 Recommended Web Sites: \u2022NIST IPsec Project: Contains papers, presentations, and reference implemen- tations. \u2022IPsec Maintenance and Extensions Charter: Latest RFCs and internet drafts for IPsec. 8.8 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms anti-replay service Authentication Header (AH)Encapsulating Security Payload (ESP) Internet Security Association and Key ManagementProtocol (ISAKMP)Internet Key Exchange (IKE)IP Security (IPsec)IPv4IPv6Oakley key determination protocolreplay attacksecurity association (SA)transport modetunnel mode Review Questions 8.1 Give examples of applications of IPsec. 8.2 What services are provided by IPsec? 8.3 What parameters identify an SA and what parameters characterize the nature of a particular SA?"}, {"id": "5a97b043521289251852ec57ca9a1fb6a6554c3d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 318, "start_line": 20, "end_line": 30, "text": "8.4 What is the difference between transport mode and tunnel mode? 8.5 What is a replay attack? 8.6 Why does ESP include a padding field? 8.7 What are the basic approaches to bundling SAs? 8.8 What are the roles of the Oakley key determination protocol and ISAKMPin IPsec?CHEN98 Cheng, P ., et al. \u201cA Security Architecture for the Internet Protocol.\u201d IBM Systems Journal, Number 1, 1998. FRAN05 Frankel, S., et al. Guide to IPsec VPNs. NIST SP 800-77, 2005. PATE06 Paterson, K. \u201cA Cryptographic Tour of the IPsec Standards.\u201d \u201c Cryptology ePrint Archive: Report 2006/097 , April 2006. STAL07 Stallings, W. Data and Computer Communications, Eighth Edition. Upper Saddle River, NJ: Prentice Hall, 2007."}, {"id": "ffb5a76466c5500c29ff16b802e61ba6204ed77e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 319, "start_line": 1, "end_line": 10, "text": "304 CHAPTER 8 / IP SECURITY Problems 8.1 Describe and explain each of the entries in Table 8.2. 8.2 Draw a figure similar to Figure 8.8 for AH. 8.3 List the major security services provided by AH and ESP , respectively. 8.4 In discussing AH processing, it was mentioned that not all of the fields in an IP header are included in MAC calculation.a.For each of the fields in the IPv4 header, indicate whether the field is immutable,mutable but predictable, or mutable (zeroed prior to ICV calculation). b.Do the same for the IPv6 header. c.Do the same for the IPv6 extension headers. In each case, justify your decision for each field."}, {"id": "67e2d422dc216032cff0ab1424cd60db6623e62a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 319, "start_line": 11, "end_line": 13, "text": "8.5 Suppose that the current replay window spans from 120 to 530.a.If the next incoming authenticated packet has sequence number 105, what will thereceiver do with the packet, and what will be the parameters of the window afterthat? b.If instead the next incoming authenticated packet has sequence number 440, whatwill the receiver do with the packet, and what will be the parameters of thewindow after that? c.If instead the next incoming authenticated packet has sequence number 540, whatwill the receiver do with the packet, and what will be the parameters of thewindow after that?"}, {"id": "e4cb9fecb0702c37e2075ec196db421520004b55", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 319, "start_line": 14, "end_line": 17, "text": "8.6 When tunnel mode is used, a new outer IP header is constructed. For both IPv4 andIPv6, indicate the relationship of each outer IP header field and each extensionheader in the outer packet to the corresponding field or extension header of the innerIP packet. That is, indicate which outer values are derived from inner values andwhich are constructed independently of the inner values. 8.7 End-to-end authentication and encryption are desired between two hosts. Drawfigures similar to Figure 8.8 that show each of the following.a.Transport adjacency with encryption applied before authentication. b.A transport SA bundled inside a tunnel SA with encryption applied beforeauthentication. c.A transport SA bundled inside a tunnel SA with authentication applied beforeencryption."}, {"id": "74d8b2d097c0518826facd59d73734958f32025a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 319, "start_line": 18, "end_line": 20, "text": "8.8 The IPsec architecture document states that when two transport mode SAs are bun-dled to allow both AH and ESP protocols on the same end-to-end flow, only oneordering of security protocols seems appropriate: performing the ESP protocolbefore performing the AH protocol. Why is this approach recommended rather thanauthentication before encryption? 8.9 For the IKE key exchange, indicate which parameters in each message go in whichISAKMP payload types. 8.10 Where does IPsec reside in a protocol stack?"}, {"id": "972c3abcf643475a3d510795f8189ea66e254b64", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 320, "start_line": 1, "end_line": 12, "text": "INTRUDERS 9.1 Intruders Intruder Behavior Patterns Intrusion Techniques 9.2 Intrusion Detection Audit RecordsStatistical Anomaly DetectionRule-Based Intrusion DetectionThe Base-Rate FallacyDistributed Intrusion DetectionHoneypotsIntrusion Detection Exchange Format 9.3 Password Management Password ProtectionPassword Selection Strategies 9.4 Recommended Reading and Web Sites 9.5 Key Terms, Review Questions, and Problems Appendix 9A The Base-Rate Fallacy 305CHAPTERPART3: S YSTEM SECURITY"}, {"id": "75d1ec0251135d1120f9175eeda2b2ae71a1ca4c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 321, "start_line": 1, "end_line": 7, "text": "306 CHAPTER 9 / INTRUDERS They agreed that Graham should set the test for Charles Mabledene. It was nei- ther more nor less than that Dragon should get Stern\u2019s code. If he had the \u2018in\u2019 atUtting which he claimed to have this should be possible, only loyalty to MoscowCentre would prevent it. If he got the key to the code he would prove his loyaltyto London Central beyond a doubt. \u2014Talking to Strange Men , Ruth Rendell KEY POINTS \u25c6Unauthorized intrusion into a computer system or network is one of themost serious threats to computer security. \u25c6Intrusion detection systems have been developed to provide early warningof an intrusion so that defensive action can be taken to prevent or mini-mize damage."}, {"id": "8c9b4689f30cacba384b68f2b23b13812b3175f4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 321, "start_line": 8, "end_line": 12, "text": "\u25c6Intrusion detection involves detecting unusual patterns of activity orpatterns of activity that are known to correlate with intrusions. \u25c6One important element of intrusion prevention is password management,with the goal of preventing unauthorized users from having access to the passwords of others. A significant security problem for networked systems is hostile, or at leastunwanted, trespass by users or software. User trespass can take the form of unau-thorized logon to a machine or, in the case of an authorized user, acquisition of priv-ileges or performance of actions beyond those that have been authorized. Softwaretrespass can take the form of a virus, worm, or Trojan horse. All these attacks relate to network security because system entry can be"}, {"id": "898711edd196d971adf054c174124d9c708157c6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 321, "start_line": 13, "end_line": 16, "text": "achieved by means of a network. However, these attacks are not confined to net-work-based attacks. A user with access to a local terminal may attempt trespasswithout using an intermediate network. A virus or Trojan horse may be introducedinto a system by means of an optical disc. Only the worm is a uniquely network phe-nomenon.Thus, system trespass is an area in which the concerns of network securityand computer security overlap. Because the focus of this book is network security, we do not attempt a com- prehensive analysis of either the attacks or the security countermeasures relatedto system trespass. Instead, in this Part we present a broad overview of theseconcerns. This chapter covers the subject of intruders. First, we examine the nature of"}, {"id": "38cd155a5d4fce283de4fffec20fd4bf8b8ad66e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 321, "start_line": 17, "end_line": 17, "text": "the attack and then look at strategies intended for prevention and, failing that,detection. Next we examine the related topic of password management."}, {"id": "0e5688a0b55611683d34111e29da05911f5c1ffd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 322, "start_line": 1, "end_line": 10, "text": "9.1 / INTRUDERS 307 9.1 INTRUDERS One of the two most publicized threats to security is the intruder (the other is viruses), often referred to as a hacker or cracker. In an important early study ofintrusion, Anderson [ANDE80] identified three classes of intruders: \u2022Masquerader: An individual who is not authorized to use the computer and who penetrates a system\u2019s access controls to exploit a legitimate user\u2019s account \u2022Misfeasor: A legitimate user who accesses data, programs, or resources for which such access is not authorized, or who is authorized for such access butmisuses his or her privileges \u2022Clandestine user: An individual who seizes supervisory control of the system and uses this control to evade auditing and access controls or to suppress auditcollection"}, {"id": "7f0f406c70aa8c53fea0315c20869d96a81fc208", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 322, "start_line": 11, "end_line": 19, "text": "The masquerader is likely to be an outsider; the misfeasor generally is an insider;and the clandestine user can be either an outsider or an insider. Intruder attacks range from the benign to the serious.At the benign end of the scale, there are many people who simply wish to explore internets and see what isout there. At the serious end are individuals who are attempting to read privilegeddata, perform unauthorized modifications to data, or disrupt the system. [GRAN04] lists the following examples of intrusion: \u2022Performing a remote root compromise of an e-mail server \u2022Defacing a Web server \u2022Guessing and cracking passwords \u2022Copying a database containing credit card numbers \u2022Viewing sensitive data, including payroll records and medical information,without authorization"}, {"id": "a08cc9190c19b5e3032cfa22eacc5a1c869f3cfc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 322, "start_line": 20, "end_line": 26, "text": "\u2022Running a packet sniffer on a workstation to capture usernames and pass-words \u2022Using a permission error on an anonymous FTP server to distribute piratedsoftware and music files \u2022Dialing into an unsecured modem and gaining internal network access \u2022Posing as an executive, calling the help desk, resetting the executive\u2019s e-mailpassword, and learning the new password \u2022Using an unattended, logged-in workstation without permission Intruder Behavior Patterns The techniques and behavior patterns of intruders are constantly shifting, to exploitnewly discovered weaknesses and to evade detection and countermeasures. Evenso, intruders typically follow one of a number of recognizable behavior patterns, andthese patterns typically differ from those of ordinary users. In the following, we look"}, {"id": "9e21bd8defebf6972971cd68b379dc91f8c28ca0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 323, "start_line": 1, "end_line": 15, "text": "308 CHAPTER 9 / INTRUDERS Table 9.1 Some Examples of Intruder Patterns of Behavior (a) Hacker 1.Select the target using IP lookup tools such as NSLookup, Dig, and others. 2.Map network for accessible services using tools such as NMAP . 3.Identify potentially vulnerable services (in this case, pcAnywhere). 4.Brute force (guess) pcAnywhere password. 5.Install remote administration tool called DameWare. 6.Wait for administrator to log on and capture his password. 7.Use that password to access remainder of network. (b) Criminal Enterprise 1.Act quickly and precisely to make their activities harder to detect. 2.Exploit perimeter through vulnerable ports. 3.Use Trojan horses (hidden software) to leave back doors for reentry. 4.Use sniffers to capture passwords."}, {"id": "d84551b3f25a955b0a73812243a3cdae0d4e4143", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 323, "start_line": 16, "end_line": 28, "text": "5.Do not stick around until noticed. 6.Make few or no mistakes. (c) Internal Threat 1.Create network accounts for themselves and their friends. 2.Access accounts and applications they wouldn\u2019t normally use for their daily jobs. 3.E-mail former and prospective employers. 4.Conduct furtive instant-messaging chats. 5.Visit Web sites that cater to disgruntled employees, such as f\u2019dcompany.com. 6.Perform large downloads and file copying. 7.Access the network during off hours.at three broad examples of intruder behavior patterns, to give the reader some feel for the challenge facing the security administrator. Table 9.1, based on [RADC04],summarizes the behavior. H ACKERS Traditionally, those who hack into computers do so for the thrill of it or"}, {"id": "7ad54401119cd9a7b5544200d657c51403e1dc8f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 323, "start_line": 29, "end_line": 29, "text": "for status. The hacking community is a strong meritocracy in which status is"}, {"id": "7af408ce5666825e45e1a6619a6d7d363cefa6e6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 323, "start_line": 30, "end_line": 30, "text": "determined by level of competence. Thus, attackers often look for targets ofopportunity and then share the information with others. A typical example is abreak-in at a large financial institution reported in [RADC04]. The intruder tookadvantage of the fact that the corporate network was running unprotected services,some of which were not even needed. In this case, the key to the break-in was thepcAnywhere application. The manufacturer, Symantec, advertises this program as aremote control solution that enables secure connection to remote devices. But theattacker had an easy time gaining access to pcAnywhere; the administrator used thesame three-letter username and password for the program. In this case, there was nointrusion detection system on the 700-node corporate network. The intruder wasonly discovered when a vice president walked into her office and saw the cursormoving files around on her Windows workstation."}, {"id": "157e66829b0720733fdc21ca39f9127485897932", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 324, "start_line": 1, "end_line": 7, "text": "9.1 / INTRUDERS 309 Benign intruders might be tolerable, although they do consume resources and may slow performance for legitimate users. However, there is no way in advance to know whether an intruder will be benign or malign. Consequently, even for systemswith no particularly sensitive resources, there is a motivation to control this problem. Intrusion detection systems (IDSs) and intrusion prevention systems (IPSs) are designed to counter this type of hacker threat. In addition to using such systems,organizations can consider restricting remote logons to specific IP addresses and/oruse virtual private network technology. One of the results of the growing awareness of the intruder problem has been"}, {"id": "755602a8a99448b06fe3f27668f00a8d78362b76", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 324, "start_line": 8, "end_line": 10, "text": "the establishment of a number of computer emergency response teams (CERTs).These cooperative ventures collect information about system vulnerabilities anddisseminate it to systems managers. Hackers also routinely read CERT reports.Thus, it is important for system administrators to quickly insert all software patchesto discovered vulnerabilities. Unfortunately, given the complexity of many ITsystems, and the rate at which patches are released, this is increasingly difficult toachieve without automated updating. Even then, there are problems caused byincompatibilities resulting from the updated software. Hence the need for multiplelayers of defense in managing security threats to IT systems. C RIMINALS Organized groups of hackers have become a widespread and common"}, {"id": "555256c8f17a6ddaa6793a4a4eeb14f2ddd06dad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 324, "start_line": 11, "end_line": 12, "text": "threat to Internet-based systems. These groups can be in the employ of a corpo- ration or government but often are loosely affiliated gangs of hackers. Typically,these gangs are young, often Eastern European, Russian, or southeast Asianhackers who do business on the Web [ANTE06]. They meet in underground forumswith names like DarkMarket.org and theftservices.com to trade tips and data andcoordinate attacks. A common target is a credit card file at an e-commerce server.Attackers attempt to gain root access. The card numbers are used by organizedcrime gangs to purchase expensive items and are then posted to carder sites, whereothers can access and use the account numbers; this obscures usage patterns andcomplicates investigation."}, {"id": "379cf320c9587c9dcaabd26e6c15f4dd6abf88a1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 324, "start_line": 13, "end_line": 17, "text": "Whereas traditional hackers look for targets of opportunity, criminal hackers usually have specific targets, or at least classes of targets in mind. Once a site is pene-trated, the attacker acts quickly, scooping up as much valuable information as possi-ble and exiting. IDSs and IPSs can also be used for these types of attackers, but may be less effective because of the quick in-and-out nature of the attack. For e-commercesites, database encryption should be used for sensitive customer information, espe-cially credit cards. For hosted e-commerce sites (provided by an outsider service),the e-commerce organization should make use of a dedicated server (not used tosupport multiple customers) and closely monitor the provider\u2019s security services. I"}, {"id": "770be9e8c5470ee1623c8896cef266a31833b4fc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 324, "start_line": 18, "end_line": 20, "text": "NSIDER ATTACKS Insider attacks are among the most difficult to detect and prevent. Employees already have access and knowledge about the structure and content of corporate databases. Insider attacks can be motivated by revenge or simply a feelingof entitlement. An example of the former is the case of Kenneth Patterson, firedfrom his position as data communications manager for American Eagle Outfitters.Patterson disabled the company\u2019s ability to process credit card purchases duringfive days of the holiday season of 2002. As for a sense of entitlement, there have"}, {"id": "e3213f23a49237681272c6335bd071aa443a8a99", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 325, "start_line": 1, "end_line": 7, "text": "310 CHAPTER 9 / INTRUDERS always been many employees who felt entitled to take extra office supplies for home use, but this now extends to corporate data. An example is that of a vicepresident of sales for a stock analysis firm who quit to go to a competitor. Before sheleft, she copied the customer database to take with her. The offender reportedfeeling no animus toward her former employee; she simply wanted the data becauseit would be useful to her. Although IDS and IPS facilities can be useful in countering insider attacks, other more direct approaches are of higher priority. Examples include the following: \u2022Enforce least privilege, only allowing access to the resources employees needto do their job. \u2022Set logs to see what users access and what commands they are entering."}, {"id": "da36248d03e167cad0af2ca93f2b325eed7950dc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 325, "start_line": 8, "end_line": 14, "text": "\u2022Protect sensitive resources with strong authentication. \u2022Upon termination, delete employee\u2019s computer and network access. \u2022Upon termination, make a mirror image of employee\u2019s hard drive before reis-suing it. That evidence might be needed if your company information turns upat a competitor. In this section, we look at the techniques used for intrusion. Then we examine ways to detect intrusion. Intrusion Techniques The objective of the intruder is to gain access to a system or to increase the range of"}, {"id": "459adaa032b82cdc07ac07086bd500af1c6fa3a0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 325, "start_line": 15, "end_line": 17, "text": "privileges accessible on a system. Most initial attacks use system or software vulner-abilities that allow a user to execute code that opens a back door into the system.Alternatively, the intruder attempts to acquire information that should have beenprotected. In some cases, this information is in the form of a user password. Withknowledge of some other user\u2019s password, an intruder can log in to a system andexercise all the privileges accorded to the legitimate user. Typically, a system must maintain a file that associates a password with each authorized user. If such a file is stored with no protection, then it is an easy matter togain access to it and learn passwords. The password file can be protected in one oftwo ways:"}, {"id": "b7480225c3be003346faa576c21a93d58df5096c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 325, "start_line": 18, "end_line": 23, "text": "\u2022One-way function: The system stores only the value of a function based on the user\u2019s password. When the user presents a password, the system transformsthat password and compares it with the stored value. In practice, the systemusually performs a one-way transformation (not reversible) in which thepassword is used to generate a key for the one-way function and in which afixed-length output is produced. \u2022Access control: Access to the password file is limited to one or a very few accounts. If one or both of these countermeasures are in place, some effort is needed for a potential intruder to learn passwords. On the basis of a survey of the literature and"}, {"id": "0020f95ac2ae21e413cc9d3f6bf15413bac29cee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 326, "start_line": 1, "end_line": 8, "text": "9.1 / INTRUDERS 311 interviews with a number of password crackers, [AL VA90] reports the following techniques for learning passwords: 1.Try default passwords used with standard accounts that are shipped with thesystem. Many administrators do not bother to change these defaults. 2.Exhaustively try all short passwords (those of one to three characters). 3.Try words in the system\u2019s online dictionary or a list of likely passwords. Examplesof the latter are readily available on hacker bulletin boards. 4.Collect information about users, such as their full names, the names of theirspouse and children, pictures in their office, and books in their office that arerelated to hobbies. 5.Try users\u2019 phone numbers, Social Security numbers, and room numbers."}, {"id": "9b872a81a3ec4e7cdd0070f03e61ac1804caf240", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 326, "start_line": 9, "end_line": 13, "text": "6.Try all legitimate license plate numbers for this state. 7.Use a Trojan horse (described in Chapter 10) to bypass restrictions on access. 8.Tap the line between a remote user and the host system. The first six methods are various ways of guessing a password. If an intruder has to verify the guess by attempting to log in, it is a tedious and easily countered means of"}, {"id": "173144939ab3b4844d602c294ad305d685a9d0e2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 326, "start_line": 14, "end_line": 15, "text": "attack. For example, a system can simply reject any login after three password attempts,thus requiring the intruder to reconnect to the host to try again. Under these circum-stances, it is not practical to try more than a handful of passwords. However, theintruder is unlikely to try such crude methods. For example, if an intruder can gainaccess with a low level of privileges to an encrypted password file, then the strategywould be to capture that file and then use the encryption mechanism of that particularsystem at leisure until a valid password that provided greater privileges was discovered. Guessing attacks are feasible, and indeed highly effective, when a large num-"}, {"id": "25f7de8107e45e4a0d965ed40b9742a1c019a47b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 326, "start_line": 16, "end_line": 18, "text": "ber of guesses can be attempted automatically and each guess verified, without theguessing process being detectable. Later in this chapter, we have much to say aboutthwarting guessing attacks. The seventh method of attack listed earlier, the Trojan horse, can be particularly difficult to counter. An example of a program that bypasses access controls was citedin [AL VA90]. A low-privilege user produced a game program and invited the systemoperator to use it in his or her spare time. The program did indeed play a game, but inthe background it also contained code to copy the password file, which was unen-crypted but access protected, into the user\u2019s file. Because the game was running underthe operator\u2019s high-privilege mode, it was able to gain access to the password file."}, {"id": "fe781fc53d78a88eab5e339af15c40d4ccc89509", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 326, "start_line": 19, "end_line": 22, "text": "The eighth attack listed, line tapping, is a matter of physical security.Other intrusion techniques do not require learning a password. Intruders can get access to a system by exploiting attacks such as buffer overflows on a programthat runs with certain privileges. Privilege escalation can be done this way as well. We turn now to a discussion of the two principal countermeasures: detection and prevention. Detection is concerned with learning of an attack, either before orafter its success. Prevention is a challenging security goal and an uphill battle at alltimes.The difficulty stems from the fact that the defender must attempt to thwart allpossible attacks, whereas the attacker is free to try to find the weakest link in thedefense chain and attack at that point."}, {"id": "8771459db02729147c4a7aba1e8e9d33d8f6fc3b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 327, "start_line": 1, "end_line": 6, "text": "312 CHAPTER 9 / INTRUDERS 9.2 INTRUSION DETECTION Inevitably, the best intrusion prevention system will fail. A system\u2019s second line of defense is intrusion detection, and this has been the focus of much research inrecent years. This interest is motivated by a number of considerations, including thefollowing: 1.If an intrusion is detected quickly enough, the intruder can be identified andejected from the system before any damage is done or any data are compro-mised. Even if the detection is not sufficiently timely to preempt the intruder,the sooner that the intrusion is detected, the less the amount of damage andthe more quickly that recovery can be achieved. 2.An effective intrusion detection system can serve as a deterrent, so acting to pre-vent intrusions."}, {"id": "a108138e092aedcc6d461f089099ddc3b9309365", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 327, "start_line": 7, "end_line": 17, "text": "3.Intrusion detection enables the collection of information about intrusion tech-niques that can be used to strengthen the intrusion prevention facility. Intrusion detection is based on the assumption that the behavior of the intruder differs from that of a legitimate user in ways that can be quantified. Of course, we cannot expect that there will be a crisp, exact distinction between anattack by an intruder and the normal use of resources by an authorized user. Rather,we must expect that there will be some overlap. Figure 9.1 suggests, in very abstract terms, the nature of the task confronting the designer of an intrusion detection system. Although the typical behavior of an Overlap in observed or expected behavio rProf ile of intruder behaviorProf ile of authorized user behavior"}, {"id": "0ab6df27e4bd2f7cad578e1e474254e324741cec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 327, "start_line": 18, "end_line": 23, "text": "Measurable behav ior parameterAverage behavior of intruderAverage behavior of authorized userProbability density function Figure 9.1 Profiles of Behavior of Intruders and Authorized Users"}, {"id": "0fff4d95299b70d8e56d280062a568fe8b2c1c47", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 328, "start_line": 1, "end_line": 4, "text": "9.2 / INTRUSION DETECTION 313 intruder differs from the typical behavior of an authorized user, there is an overlap in these behaviors.Thus, a loose interpretation of intruder behavior, which will catchmore intruders, will also lead to a number of \u201cfalse positives,\u201d or authorized usersidentified as intruders. On the other hand, an attempt to limit false positives by atight interpretation of intruder behavior will lead to an increase in false negatives, orintruders not identified as intruders. Thus, there is an element of compromise andart in the practice of intrusion detection. In Anderson\u2019s study [ANDE80], it was postulated that one could, with reason-"}, {"id": "6e2d1c825470e7654fb845b83a1b268a64843d1e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 328, "start_line": 5, "end_line": 5, "text": "able confidence, distinguish between a masquerader and a legitimate user. Patternsof legitimate user behavior can be established by observing past history, and signifi-cant deviation from such patterns can be detected. Anderson suggests that the taskof detecting a misfeasor (legitimate user performing in an unauthorized fashion) ismore difficult, in that the distinction between abnormal and normal behavior maybe small. Anderson concluded that such violations would be undetectable solelythrough the search for anomalous behavior. However, misfeasor behavior mightnevertheless be detectable by intelligent definition of the class of conditions thatsuggest unauthorized use. Finally, the detection of the clandestine user was felt to bebeyond the scope of purely automated techniques. These observations, which weremade in 1980, remain true today."}, {"id": "d6d2d8c6f9e98f3d06fdbaa0613507c4439b4d71", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 328, "start_line": 6, "end_line": 12, "text": "[PORR92] identifies the following approaches to intrusion detection: 1.Statistical anomaly detection: Involves the collection of data relating to the behavior of legitimate users over a period of time. Then statistical testsare applied to observed behavior to determine with a high level of confidencewhether that behavior is not legitimate user behavior. a.Threshold detection: This approach involves defining thresholds, inde-pendent of user, for the frequency of occurrence of various events. b.Profile based: A profile of the activity of each user is developed and usedto detect changes in the behavior of individual accounts. 2.Rule-based detection: Involves an attempt to define a set of rules that can be used to decide that a given behavior is that of an intruder."}, {"id": "e9fe715a0b678bf243f37fc73f8a29cb7becd307", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 328, "start_line": 13, "end_line": 16, "text": "a.Anomaly detection: Rules are developed to detect deviation from previ-ous usage patterns. b.Penetration identification: An expert system approach that searches forsuspicious behavior. In a nutshell, statistical approaches attempt to define normal, or expected, behavior,whereas rule-based approaches attempt to define proper behavior. In terms of the types of attackers listed earlier, statistical anomaly detection is"}, {"id": "25c09bc0381d1d46847dbe07b161c1989aee4cee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 328, "start_line": 17, "end_line": 17, "text": "effective against masqueraders, who are unlikely to mimic the behavior patterns ofthe accounts they appropriate. On the other hand, such techniques may be unable todeal with misfeasors. For such attacks, rule-based approaches may be able to recog-nize events and sequences that, in context, reveal penetration. In practice, a systemmay exhibit a combination of both approaches to be effective against a broad rangeof attacks."}, {"id": "5f761ab6a4889965aece2de45ea0c2b98b418bdb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 329, "start_line": 1, "end_line": 7, "text": "314 CHAPTER 9 / INTRUDERS Audit Records A fundamental tool for intrusion detection is the audit record. Some record of ongoing activity by users must be maintained as input to an intrusion detectionsystem. Basically, two plans are used: \u2022Native audit records: Virtually all multiuser operating systems include accounting software that collects information on user activity. The advantageof using this information is that no additional collection software is needed.The disadvantage is that the native audit records may not contain the neededinformation or may not contain it in a convenient form. \u2022Detection-specific audit records: A collection facility can be implemented that"}, {"id": "7703d293f6a1fb611e54a41c0b0051a39ad9b2db", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 329, "start_line": 8, "end_line": 13, "text": "generates audit records containing only that information required by theintrusion detection system. One advantage of such an approach is that it couldbe made vendor independent and ported to a variety of systems. The disad-vantage is the extra overhead involved in having, in effect, two accountingpackages running on a machine. A good example of detection-specific audit records is one developed by Dorothy Denning [DENN87]. Each audit record contains the following fields: \u2022Subject: Initiators of actions. A subject is typically a terminal user but might also be a process acting on behalf of users or groups of users.All activity arises through commands issued by subjects. Subjects may be grouped into differentaccess classes, and these classes may overlap."}, {"id": "ee167a320f76581d23e9ea2fa1ac8d4535ead2b7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 329, "start_line": 14, "end_line": 20, "text": "\u2022Action: Operation performed by the subject on or with an object; for example, login, read, perform I/O, execute. \u2022Object: Receptors of actions. Examples include files, programs, messages, records, terminals, printers, and user- or program-created structures. When asubject is the recipient of an action, such as electronic mail, then that subject isconsidered an object. Objects may be grouped by type. Object granularity mayvary by object type and by environment. For example, database actions may beaudited for the database as a whole or at the record level. \u2022Exception-Condition: Denotes which, if any, exception condition is raised on return. \u2022Resource-Usage: A list of quantitative elements in which each element gives"}, {"id": "990d2e28a44376fbb1ba8df00cb0b9fcac016a13", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 329, "start_line": 21, "end_line": 27, "text": "the amount used of some resource (e.g., number of lines printed or displayed,number of records read or written, processor time, I/O units used, sessionelapsed time). \u2022Time-Stamp: Unique time-and-date stamp identifying when the action took place. Most user operations are made up of a number of elementary actions. For example, a file copy involves the execution of the user command, which includes doing access validation and setting up the copy, plus the read from one file, plus thewrite to another file. Consider the command COPY GAME.EXE TO<Libray>GAME.EXE"}, {"id": "b14f6311ac6bd90bed1c8db90836393f294d4016", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 330, "start_line": 1, "end_line": 8, "text": "9.2 / INTRUSION DETECTION 315 issued by Smith to copy an executable file GAME from the current directory to the <Library> directory. The following audit records may be generated: In this case, the copy is aborted because Smith does not have write permission to <Library>. The decomposition of a user operation into elementary actions has three advantages: 1.Because objects are the protectable entities in a system, the use of elementaryactions enables an audit of all behavior affecting an object. Thus, the systemcan detect attempted subversions of access controls (by noting an abnormal-ity in the number of exception conditions returned) and can detect successfulsubversions by noting an abnormality in the set of objects accessible to thesubject."}, {"id": "782949d85a5263fd6022366997a801982e548ecd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 330, "start_line": 9, "end_line": 12, "text": "2.Single-object, single-action audit records simplify the model and the implemen-tation. 3.Because of the simple, uniform structure of the detection-specific auditrecords, it may be relatively easy to obtain this information or at least part ofit by a straightforward mapping from existing native audit records to thedetection-specific audit records. Statistical Anomaly Detection As was mentioned, statistical anomaly detection techniques fall into two broadcategories: threshold detection and profile-based systems. Threshold detectioninvolves counting the number of occurrences of a specific event type over an inter-val of time. If the count surpasses what is considered a reasonable number that onemight expect to occur, then intrusion is assumed."}, {"id": "03298c864a7cb64e2bfa63d510eb79ccfa7c957a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 330, "start_line": 13, "end_line": 17, "text": "Threshold analysis, by itself, is a crude and ineffective detector of even moder- ately sophisticated attacks. Both the threshold and the time interval must be deter-mined. Because of the variability across users, such thresholds are likely to generateeither a lot of false positives or a lot of false negatives. However, simple thresholddetectors may be useful in conjunction with more sophisticated techniques. Profile-based anomaly detection focuses on characterizing the past behavior of individual users or related groups of users and then detecting significant devia-tions. A profile may consist of a set of parameters, so that deviation on just a singleparameter may not be sufficient in itself to signal an alert. The foundation of this approach is an analysis of audit records. The audit"}, {"id": "b59cf5d48b66cfbfa74c6644a3b4761f8eaf5bc1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 330, "start_line": 18, "end_line": 20, "text": "records provide input to the intrusion detection function in two ways. First, thedesigner must decide on a number of quantitative metrics that can be used to mea-sure user behavior.An analysis of audit records over a period of time can be used toSmith execute<Library>COPY.EXE 0 CPU =00002 11058721678 Smith read<Smith>GAME.EXE 0 RECORDS =011058721679 Smith execute<Library>COPY.EXE write-viol RECORDS =011058721680"}, {"id": "453991d56f3ef85f094fc0657ec22ccca330ebb9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 331, "start_line": 1, "end_line": 6, "text": "316 CHAPTER 9 / INTRUDERS determine the activity profile of the average user. Thus, the audit records serve to define typical behavior. Second, current audit records are the input used to detectintrusion. That is, the intrusion detection model analyzes incoming audit records todetermine deviation from average behavior. Examples of metrics that are useful for profile-based intrusion detection are the following: \u2022Counter: A nonnegative integer that may be incremented but not decre-"}, {"id": "8dce0dd1dd6c001ec4a5e01f9cc5ec4cf9d9536f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 331, "start_line": 7, "end_line": 11, "text": "mented until it is reset by management action. Typically, a count of certainevent types is kept over a particular period of time. Examples include thenumber of logins by a single user during an hour, the number of times a givencommand is executed during a single user session, and the number of pass-word failures during a minute. \u2022Gauge: A nonnegative integer that may be incremented or decremented. Typically, a gauge is used to measure the current value of some entity.Examples include the number of logical connections assigned to a user appli-cation and the number of outgoing messages queued for a user process. \u2022Interval timer: The length of time between two related events. An example is the length of time between successive logins to an account."}, {"id": "adeec36946aca1fd616a1f47a033690aa4e2ad2c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 331, "start_line": 12, "end_line": 23, "text": "\u2022Resource utilization: Quantity of resources consumed during a specified period. Examples include the number of pages printed during a user sessionand total time consumed by a program execution. Given these general metrics, various tests can be performed to determine whether current activity fits within acceptable limits. [DENN87] lists the following approaches that may be taken: \u2022Mean and standard deviation \u2022Multivariate \u2022Markov process \u2022Time series \u2022Operational The simplest statistical test is to measure the mean and standard deviation of a parameter over some historical period. This gives a reflection of the average behav-"}, {"id": "f419d1064f0f70fa01ffde2839ea5e217656e80f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 331, "start_line": 24, "end_line": 28, "text": "ior and its variability.The use of mean and standard deviation is applicable to a widevariety of counters, timers, and resource measures. But these measures, by them-selves, are typically too crude for intrusion detection purposes. A multivariate model is based on correlations between two or more variables. Intruder behavior may be characterized with greater confidence by consideringsuch correlations (for example, processor time and resource usage, or login fre-quency and session elapsed time). A Markov process model is used to establish transition probabilities among various states. As an example, this model might be used to look at transitionsbetween certain commands."}, {"id": "02b26fd3f2f76bb7c08a21b32a3e49c8fd8cb90f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 332, "start_line": 1, "end_line": 7, "text": "9.2 / INTRUSION DETECTION 317 A time series model focuses on time intervals, looking for sequences of events that happen too rapidly or too slowly. A variety of statistical tests can be applied to characterize abnormal timing. Finally, an operational model is based on a judgment of what is considered abnormal, rather than an automated analysis of past audit records. Typically, fixedlimits are defined and intrusion is suspected for an observation that is outside thelimits. This type of approach works best where intruder behavior can be deducedfrom certain types of activities. For example, a large number of login attempts overa short period suggests an attempted intrusion. As an example of the use of these various metrics and models, Table 9.2 shows"}, {"id": "84b71ca3b13c970d88b92e624d7c303a2b6f9d21", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 332, "start_line": 8, "end_line": 11, "text": "various measures considered or tested for the Stanford Research Institute (SRI)intrusion detection system (IDES) [DENN87, JA VI91, LUNT88]. The main advantage of the use of statistical profiles is that a prior knowledge of security flaws is not required.The detector program learns what is \u201cnormal\u201d behaviorand then looks for deviations. The approach is not based on system-dependentcharacteristics and vulnerabilities.Thus, it should be readily portable among a varietyof systems. Rule-Based Intrusion Detection"}, {"id": "4f380425b106d7f1b05c8528484871c75161954e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 332, "start_line": 12, "end_line": 13, "text": "Rule-based techniques detect intrusion by observing events in the system andapplying a set of rules that lead to a decision regarding whether a given pattern ofactivity is or is not suspicious. In very general terms, we can characterize allapproaches as focusing on either anomaly detection or penetration identification,although there is some overlap in these approaches. Rule-based anomaly detection is similar in terms of its approach and strengths"}, {"id": "d57411f88fe9e088edb89ca2aa7ae0941febc92a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 332, "start_line": 14, "end_line": 15, "text": "to statistical anomaly detection. With the rule-based approach, historical auditrecords are analyzed to identify usage patterns and to generate automatically rulesthat describe those patterns. Rules may represent past behavior patterns of users,programs, privileges, time slots, terminals, and so on. Current behavior is thenobserved, and each transaction is matched against the set of rules to determine if itconforms to any historically observed pattern of behavior. As with statistical anomaly detection, rule-based anomaly detection does not"}, {"id": "a268cab272ae42b70b6cae9f128849c8516ee463", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 332, "start_line": 16, "end_line": 18, "text": "require knowledge of security vulnerabilities within the system. Rather, the schemeis based on observing past behavior and, in effect, assuming that the future will belike the past. In order for this approach to be effective, a rather large database ofrules will be needed. For example, a scheme described in [VACC89] contains any-where from 10 4to 106rules. Rule-based penetration identification takes a very different approach to intru-"}, {"id": "58831fa9f80cca7bf3e3c616d0e17eff438d3086", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 332, "start_line": 19, "end_line": 19, "text": "sion detection. The key feature of such systems is the use of rules for identifyingknown penetrations or penetrations that would exploit known weaknesses. Rulescan also be defined that identify suspicious behavior, even when the behavior iswithin the bounds of established patterns of usage. Typically, the rules used in thesesystems are specific to the machine and operating system. The most fruitfulapproach to developing such rules is to analyze attack tools and scripts collected onthe Internet. These rules can be supplemented with rules generated by knowledge-able security personnel. In this latter case, the normal procedure is to interview"}, {"id": "fd809b9037cc3d00e0afd915d94d5f92d6b9e251", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 333, "start_line": 1, "end_line": 9, "text": "Table 9.2 Measures That May Be Used for Intrusion Detection Measure Model Type of Intrusion Detected Login and Session Activity Login frequency by day and timeMean and standarddeviation Intruders may be likely to log in during off-hours. Frequency of login at differentlocations Mean and standarddeviation Intruders may log in from a location that a particu-lar user rarely or never uses. Time since last login Operational Break-in on a \u201cdead\u201d account. Elapsed time per session Mean and standarddeviation Significant deviations might indicate masquerader. Quantity of output to location Mean and standarddeviation Excessive amounts of data transmitted to remotelocations could signify leakage of sensitive data."}, {"id": "4cdd259e988f88e8008eb44440a69efc90963a63", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 333, "start_line": 10, "end_line": 15, "text": "Session resource utilization Mean and standarddeviation Unusual processor or I/O levels could signal anintruder. Password failures at login Operational Attempted break-in by password guessing. Failures to login from specifiedterminals Operational Attempted break-in. Command or Program Execution Activity Execution frequency Mean and standarddeviation May detect intruders, who are likely to use differentcommands, or a successful penetration by a legiti-mate user, who has gained access to privilegedcommands. Program resource utilization Mean and standarddeviation An abnormal value might suggest injection of avirus or Trojan horse, which performs side-effectsthat increase I/O or processor utilization."}, {"id": "ad0409aa665e14e062c7b6065d6d71d41bdc7381", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 333, "start_line": 16, "end_line": 22, "text": "Execution denials Operational model May detect penetration attempt by individual userwho seeks higher privileges. File Access Activity Read, write, create, delete frequency Mean and standarddeviation Abnormalities for read and write access for individ-ual users may signify masquerading or browsing. Records read, written Mean and standarddeviation Abnormality could signify an attempt to obtain sen-sitive data by inference and aggregation. Failure count for read, write,create, delete Operational May detect users who persistently attempt to accessunauthorized files.318 CHAPTER 9 / INTRUDERS system administrators and security analysts to collect a suite of known penetration scenarios and key events that threaten the security of the target system."}, {"id": "858c75f73d7c3d1547d6c22c310c6c5e9af63aaa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 333, "start_line": 23, "end_line": 26, "text": "A simple example of the type of rules that can be used is found in NIDX, an early system that used heuristic rules that can be used to assign degrees of suspicionto activities [BAUE88]. Example heuristics are the following: 1.Users should not read files in other users\u2019 personal directories. 2.Users must not write other users\u2019 files."}, {"id": "ad26e12fdf58eb07b1ceb18641a56873e85c7568", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 334, "start_line": 1, "end_line": 11, "text": "9.2 / INTRUSION DETECTION 319 3.Users who log in after hours often access the same files they used earlier. 4.Users do not generally open disk devices directly but rely on higher-level operat- ing system utilities. 5.Users should not be logged in more than once to the same system. 6.Users do not make copies of system programs. The penetration identification scheme used in IDES is representative of the strategy followed. Audit records are examined as they are generated, and they are matched against the rule base. If a match is found, then the user\u2019s suspicion rating is increased. If enough rules are matched, then the rating will pass a threshold thatresults in the reporting of an anomaly. The IDES approach is based on an examination of audit records. A weak-"}, {"id": "303ad001f29059a5775d38106e12c7cfaaa6e5ab", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 334, "start_line": 12, "end_line": 12, "text": "ness of this plan is its lack of flexibility. For a given penetration scenario, theremay be a number of alternative audit record sequences that could be produced,each varying from the others slightly or in subtle ways. It may be difficult to pindown all these variations in explicit rules. Another method is to develop a higher-level model independent of specific audit records. An example of this is a statetransition model known as USTAT [ILGU93]. USTAT deals in general actionsrather than the detailed specific actions recorded by the UNIX auditing mecha-nism. USTAT is implemented on a SunOS system that provides audit records on239 events. Of these, only 28 are used by a preprocessor, which maps these onto10 general actions (Table 9.3). Using just these actions and the parameters that areinvoked with each action, a state transition diagram is developed that character-izes suspicious activity. Because a number of different auditable events map into asmaller number of actions, the rule-creation process is simpler. Furthermore, thestate transition diagram model is easily modified to accommodate newly learnedintrusion behaviors."}, {"id": "667738eda196039a42e20e4f4856c0e028f7e0ce", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 334, "start_line": 13, "end_line": 25, "text": "Table 9.3 USTAT Actions versus SunOS Event Types USTAT Action SunOS Event Type Read open_r, open_rc, open_rtc, open_rwc, open_rwtc, open_rt, open_rw, open_rwt Write truncate, ftruncate, creat, open_rtc, open_rwc, open_rwtc, open_rt,open_rw, open_rwt, open_w, open_wt, open_wc, open_wct Create mkdir, creat, open_rc, open_rtc, open_rwc, open_rwtc, open_wc,open_wtc, mknod Delete rmdir, unlink Execute exec, execve Exit exit Modify_Owner chown, fchown Modify_Perm chmod, fchmod Rename rename Hardlink link"}, {"id": "42007d38e0c84ecc45a3cc1e33fda78f691af972", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 335, "start_line": 1, "end_line": 5, "text": "320 CHAPTER 9 / INTRUDERS The Base-Rate Fallacy To be of practical use, an intrusion detection system should detect a substantial percentage of intrusions while keeping the false alarm rate at an acceptable level.If only a modest percentage of actual intrusions are detected, the system providesa false sense of security. On the other hand, if the system frequently triggers analert when there is no intrusion (a false alarm), then either system managers willbegin to ignore the alarms, or much time will be wasted analyzing the falsealarms. Unfortunately, because of the nature of the probabilities involved, it is very"}, {"id": "2b5435b08d46b44136b8fd7a7850fdebeadfcb1d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 335, "start_line": 6, "end_line": 7, "text": "difficult to meet the standard of high rate of detections with a low rate of falsealarms. In general, if the actual numbers of intrusions is low compared to thenumber of legitimate uses of a system, then the false alarm rate will be high unlessthe test is extremely discriminating.A study of existing intrusion detection systems,reported in [AXEL00], indicated that current systems have not overcome the prob-lem of the base-rate fallacy. See Appendix 9A for a brief background on the math-ematics of this problem. Distributed Intrusion Detection"}, {"id": "db0ef91d15a528d512733a9567d19214cd8a7e44", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 335, "start_line": 8, "end_line": 10, "text": "Until recently, work on intrusion detection systems focused on single-system stand-alone facilities. The typical organization, however, needs to defend a distributedcollection of hosts supported by a LAN or internetwork. Although it is possible tomount a defense by using stand-alone intrusion detection systems on each host, amore effective defense can be achieved by coordination and cooperation amongintrusion detection systems across the network. Porras points out the following major issues in the design of a distributed intrusion detection system [PORR92]:"}, {"id": "e6410eb5625f38f0cdbb4e10e02eef254b6f7610", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 335, "start_line": 11, "end_line": 11, "text": "\u2022A distributed intrusion detection system may need to deal with different auditrecord formats. In a heterogeneous environment, different systems willemploy different native audit collection systems and, if using intrusion detec-tion, may employ different formats for security-related audit records."}, {"id": "3b0a91c1a19999e5186e2f505c32d80e5b47488d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 335, "start_line": 12, "end_line": 12, "text": "\u2022One or more nodes in the network will serve as collection and analysis pointsfor the data from the systems on the network. Thus, either raw audit data orsummary data must be transmitted across the network. Therefore, there is arequirement to assure the integrity and confidentiality of these data. Integrityis required to prevent an intruder from masking his or her activities by alteringthe transmitted audit information. Confidentiality is required because thetransmitted audit information could be valuable."}, {"id": "c7c9c38b91a66ede198b5f3c39c77cf47d6ecdd7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 335, "start_line": 13, "end_line": 13, "text": "\u2022Either a centralized or decentralized architecture can be used. With a central-ized architecture, there is a single central point of collection and analysis of allaudit data. This eases the task of correlating incoming reports but creates apotential bottleneck and single point of failure. With a decentralized architec-ture, there are more than one analysis centers, but these must coordinate theiractivities and exchange information."}, {"id": "c4bdda89b454e0057445f28791c1f583a7c86822", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 336, "start_line": 1, "end_line": 15, "text": "9.2 / INTRUSION DETECTION 321 Central managerLAN monitorHost Host Agent module Router WAN Managermodule Figure 9.2 Architecture for Distributed Intrusion Detection A good example of a distributed intrusion detection system is one developed at the University of California at Davis [HEBE92, SNAP91]. Figure 9.2 shows the overall architecture, which consists of three main components: \u2022Host agent module: An audit collection module operating as a background process on a monitored system. Its purpose is to collect data on security-related events on the host and transmit these to the central manager. \u2022LAN monitor agent module: Operates in the same fashion as a host agent module except that it analyzes LAN traffic and reports the results to thecentral manager."}, {"id": "cfa037bf9c1381d25c29dea4489df45e5acee672", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 336, "start_line": 16, "end_line": 19, "text": "\u2022Central manager module: Receives reports from LAN monitor and host agents and processes and correlates these reports to detect intrusion. The scheme is designed to be independent of any operating system or system auditing implementation. Figure 9.3 [SNAP91] shows the general approach that is"}, {"id": "5858518c0ca26d6737957f32e3c9db1947e3618e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 336, "start_line": 20, "end_line": 20, "text": "taken. The agent captures each audit record produced by the native audit collectionsystem.A filter is applied that retains only those records that are of security interest.These records are then reformatted into a standardized format referred to as thehost audit record (HAR). Next, a template-driven logic module analyzes therecords for suspicious activity.At the lowest level, the agent scans for notable eventsthat are of interest independent of any past events. Examples include failed fileaccesses, accessing system files, and changing a file\u2019s access control. At the nexthigher level, the agent looks for sequences of events, such as known attack patterns(signatures). Finally, the agent looks for anomalous behavior of an individual userbased on a historical profile of that user, such as number of programs executed,number of files accessed, and the like."}, {"id": "23247d3abe02187719c2c1a47371ce89f7096cb9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 337, "start_line": 1, "end_line": 19, "text": "322 CHAPTER 9 / INTRUDERS OS audit information Filter Host audit record LogicCentral manager Agent protocol machineTemplatesNotable acti vity Signatures Noteworthy sessions Modif icationsAlertsQuery/response Figure 9.3 Agent Architecture When suspicious activity is detected, an alert is sent to the central manager. The central manager includes an expert system that can draw inferences from received data. The manager may also query individual systems for copies of HARsto correlate with those from other agents. The LAN monitor agent also supplies information to the central manager.The"}, {"id": "3938ee82bb3dd465dbc538c2dd1b1851c5fcefee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 337, "start_line": 20, "end_line": 24, "text": "LAN monitor agent audits host-host connections, services used, and volume of traf-fic. It searches for significant events, such as sudden changes in network load, the useof security-related services, and network activities such as rlogin . The architecture depicted in Figures 9.2 and 9.3 is quite general and flexible. It offers a foundation for a machine-independent approach that can expand fromstand-alone intrusion detection to a system that is able to correlate activity from anumber of sites and networks to detect suspicious activity that would otherwiseremain undetected. Honeypots A relatively recent innovation in intrusion detection technology is the honeypot.Honeypots are decoy systems that are designed to lure a potential attacker awayfrom critical systems. Honeypots are designed to"}, {"id": "f95dd88e93dd87e8ed79f84996b5155a4b916e3e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 337, "start_line": 25, "end_line": 27, "text": "\u2022divert an attacker from accessing critical systems \u2022collect information about the attacker\u2019s activity \u2022encourage the attacker to stay on the system long enough for administratorsto respond"}, {"id": "b8da64d3cb9220e295b59cc1619ea214a8e405de", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 338, "start_line": 1, "end_line": 5, "text": "9.3 / PASSWORD MANAGEMENT 323 These systems are filled with fabricated information designed to appear valu- able but that a legitimate user of the system wouldn\u2019t access. Thus, any access to the honeypot is suspect. The system is instrumented with sensitive monitors and eventloggers that detect these accesses and collect information about the attacker\u2019s activ-ities. Because any attack against the honeypot is made to seem successful, adminis-trators have time to mobilize and log and track the attacker without ever exposingproductive systems. Initial efforts involved a single honeypot computer with IP addresses designed"}, {"id": "92c018dd73479daa8390955833cd5e91d7264a3f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 338, "start_line": 6, "end_line": 7, "text": "to attract hackers. More recent research has focused on building entire honeypotnetworks that emulate an enterprise, possibly with actual or simulated traffic anddata. Once hackers are within the network, administrators can observe their behav-ior in detail and figure out defenses. Intrusion Detection Exchange Format"}, {"id": "1c36179b95832ef4a48e96714508934f87fe74f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 338, "start_line": 8, "end_line": 8, "text": "To facilitate the development of distributed intrusion detection systems that canfunction across a wide range of platforms and environments, standards are neededto support interoperability. Such standards are the focus of the IETF IntrusionDetection Working Group. The purpose of the working group is to define data for-mats and exchange procedures for sharing information of interest to intrusiondetection and response systems and to management systems that may need to inter-act with them. The outputs of this working group include:"}, {"id": "6369cf040cbdfafb205b19b9e21f5bb9e347507b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 338, "start_line": 9, "end_line": 14, "text": "1.A requirements document, which describes the high-level functional require-ments for communication between intrusion detection systems and requirementsfor communication between intrusion detection systems and with managementsystems, including the rationale for those requirements. Scenarios will be used toillustrate the requirements. 2.A common intrusion language specification, which describes data formats thatsatisfy the requirements. 3.A framework document, which identifies existing protocols best used for com-munication between intrusion detection systems, and describes how thedevised data formats relate to them. As of this writing, all of these documents are in an Internet-draft document stage. 9.3 PASSWORD MANAGEMENT Password Protection"}, {"id": "4315432410ab21ced466a0ea31fc0c4573332bec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 338, "start_line": 15, "end_line": 17, "text": "The front line of defense against intruders is the password system. Virtually all multiuser systems require that a user provide not only a name or identifier (ID) butalso a password. The password serves to authenticate the ID of the individual log-ging on to the system. In turn, the ID provides security in the following ways: \u2022The ID determines whether the user is authorized to gain access to a system.In some systems, only those who already have an ID filed on the system areallowed to gain access."}, {"id": "ea8876a37dc3279b1a02afbe637311026ce9e195", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 339, "start_line": 1, "end_line": 6, "text": "324 CHAPTER 9 / INTRUDERS \u2022The ID determines the privileges accorded to the user. A few users may have supervisory or \u201csuperuser\u201d status that enables them to read files and performfunctions that are especially protected by the operating system. Some systemshave guest or anonymous accounts, and users of these accounts have morelimited privileges than others. \u2022The ID is used in what is referred to as discretionary access control. For exam-ple, by listing the IDs of the other users, a user may grant permission to themto read files owned by that user. T HEVULNERABILITY OF PASSWORDS To understand the nature of the threat to"}, {"id": "bdcc2373ddc7e071285bcf286378f0a7b74416c1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 339, "start_line": 7, "end_line": 7, "text": "password-based systems, let us consider a scheme that is widely used on UNIX, inwhich passwords are never stored in the clear. Rather, the following procedure isemployed (Figure 9.4a). Each user selects a password of up to eight printablecharacters in length. This is converted into a 56-bit value (using 7-bit ASCII) thatserves as the key input to an encryption routine. The encryption routine, known ascrypt(3), is based on DES.The DES algorithm is modified using a 12-bit \u201csalt\u201d value.Typically, this value is related to the time at which the password is assigned to theuser. The modified DES algorithm is exercised with a data input consisting of a 64-bit block of zeros. The output of the algorithm then serves as input for a secondencryption.This process is repeated for a total of 25 encryptions.The resulting 64-bitoutput is then translated into an 11-character sequence. The hashed password isthen stored, together with a plaintext copy of the salt, in the password file for thecorresponding user ID. This method has been shown to be secure against a varietyof cryptanalytic attacks [WAGN00]."}, {"id": "4b2a1008cfd702c713c4c00143c85f8b87b6860b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 339, "start_line": 8, "end_line": 13, "text": "The salt serves three purposes: \u2022It prevents duplicate passwords from being visible in the password file. Even iftwo users choose the same password, those passwords will be assigned at dif-ferent times. Hence, the \u201cextended\u201d passwords of the two users will differ. \u2022It effectively increases the length of the password without requiring the userto remember two additional characters. Hence, the number of possible pass-words is increased by a factor of 4096, increasing the difficulty of guessing apassword. \u2022It prevents the use of a hardware implementation of DES, which would easethe difficulty of a brute-force guessing attack. When a user attempts to log on to a UNIX system, the user provides an ID and a password. The operating system uses the ID to index into the password file and"}, {"id": "5e4a07290d8f5d8c5059bc4965762671e9b751cd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 339, "start_line": 14, "end_line": 16, "text": "retrieve the plaintext salt and the encrypted password. The salt and user-suppliedpassword are used as input to the encryption routine. If the result matches thestored value, the password is accepted. The encryption routine is designed to discourage guessing attacks. Software implementations of DES are slow compared to hardware versions, and the use of25 iterations multiplies the time required by 25. However, since the original designof this algorithm, two changes have occurred. First, newer implementations of thealgorithm itself have resulted in speedups. For example, the Morris worm describedin Chapter 10 was able to do online password guessing of a few hundred passwords"}, {"id": "5afa97c6a8ef89da8a2c83f650ce78ddbd9d1df9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 340, "start_line": 1, "end_line": 18, "text": "9.3 / PASSWORD MANAGEMENT 325 User id 11 characterssalt 12 bits 56 bitspassword Load Select(a) Loading a new password (b) Verifying a passwordsalt \u2022 \u2022\u2022Password File E(pwd, [salt, 0]) E(pwd, [salt, 0]) User idUser idsaltPassword Filecrypt (3) salt hashed passwordpassword crypt (3) compare Figure 9.4 UNIX Password Scheme in a reasonably short time by using a more efficient encryption algorithm than thestandard one stored on the UNIX systems that it attacked. Second, hardware per-formance continues to increase, so that any software algorithm executes morequickly. Thus, there are two threats to the UNIX password scheme. First, a user can"}, {"id": "b95e7a8623522189dafc4be4b253a4bc8f239875", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 340, "start_line": 19, "end_line": 19, "text": "gain access on a machine using a guest account or by some other means and thenrun a password guessing program, called a password cracker, on that machine. Theattacker should be able to check hundreds and perhaps thousands of possible pass-words with little resource consumption. In addition, if an opponent is able to obtaina copy of the password file, then a cracker program can be run on another machine"}, {"id": "bf2859b47cdd36828f86ea86b918f87e3922ce91", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 341, "start_line": 1, "end_line": 6, "text": "326 CHAPTER 9 / INTRUDERS at leisure. This enables the opponent to run through many thousands of possible passwords in a reasonable period. As an example, a password cracker was reported on the Internet in August 1993 [MADS93]. Using a Thinking Machines Corporation parallel computer, aperformance of 1560 encryptions per second per vector unit was achieved.With fourvector units per processing node (a standard configuration), this works out to800,000 encryptions per second on a 128-node machine (which is a modest size) and6.4 million encryptions per second on a 1024-node machine. Even these stupendous guessing rates do not yet make it feasible for an"}, {"id": "1a87116231d012c6a8fc0a72acb9466480bed391", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 341, "start_line": 7, "end_line": 8, "text": "attacker to use a dumb brute-force technique of trying all possible combinations ofcharacters to discover a password. Instead, password crackers rely on the fact thatsome people choose easily guessable passwords. Some users, when permitted to choose their own password, pick one that is"}, {"id": "a513ed3947de028e4fe12f6e6e8cf5cb5d41e07e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 341, "start_line": 9, "end_line": 10, "text": "absurdly short. The results of one study at Purdue University are shown in Table 9.4.The study observed password change choices on 54 machines, representing approxi-mately 7000 user accounts. Almost 3% of the passwords were three characters orfewer in length. An attacker could begin the attack by exhaustively testing all possi-ble passwords of length 3 or fewer. A simple remedy is for the system to reject anypassword choice of fewer than, say, six characters or even to require that all pass-words be exactly eight characters in length. Most users would not complain aboutsuch a restriction. Password length is only part of the problem. Many people, when permitted to"}, {"id": "415e67c189daa31335b9654c22d5cc083e57977d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 341, "start_line": 11, "end_line": 23, "text": "choose their own password, pick a password that is guessable, such as their ownname, their street name, a common dictionary word, and so forth.This makes the jobof password cracking straightforward. The cracker simply has to test the passwordfile against lists of likely passwords. Because many people use guessable passwords,such a strategy should succeed on virtually all systems. One demonstration of the effectiveness of guessing is reported in [KLEI90]. From a variety of sources, the author collected UNIX password files, containingnearly 14,000 encrypted passwords. The result, which the author rightly characterizes Table 9.4 Observed Password Lengths [SPAF92a] Length Number Fraction of Total 1 55 .004 2 87 .006 3 212 .02 4 449 .03 5 1260 .09 6 3035 .22 7 2917 .21 8 5772 .42"}, {"id": "29e08469b4ef26ffe14497f2cb4b991674d8870b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 341, "start_line": 24, "end_line": 24, "text": "Total 13787 1.0"}, {"id": "a9c07d3b880cfc3de06feba1e645d9ee18f03bf0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 342, "start_line": 1, "end_line": 14, "text": "9.3 / PASSWORD MANAGEMENT 327 as frightening, is shown in Table 9.5. In all, nearly one-fourth of the passwords were guessed. The following strategy was used: 1.Try the user\u2019s name, initials, account name, and other relevant personal infor-mation. In all, 130 different permutations for each user were tried. 2.Try words from various dictionaries. The author compiled a dictionary of over60,000 words, including the online dictionary on the system itself, and variousother lists as shown. Table 9.5 Passwords Cracked from a Sample Set of 13,797 Accounts [KLEI90] Type of Password Search Size Number of MatchesPercentage of Passwords MatchedCost/Benefit Ratioa User/account name 130 368 2.7% 2.830 Character sequences 866 22 0.2% 0.025 Numbers 427 9 0.1% 0.021 Chinese 392 56 0.4% 0.143"}, {"id": "f7afd4267fb8e2897b737ee11adce95bb23434c1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 342, "start_line": 15, "end_line": 37, "text": "Place names 628 82 0.6% 0.131 Common names 2239 548 4.0% 0.245 Female names 4280 161 1.2% 0.038 Male names 2866 140 1.0% 0.049 Uncommon names 4955 130 0.9% 0.026 Myths & legends 1246 66 0.5% 0.053 Shakespearean 473 11 0.1% 0.023 Sports terms 238 32 0.2% 0.134 Science fiction 691 59 0.4% 0.085 Movies and actors 99 12 0.1% 0.121 Cartoons 92 9 0.1% 0.098 Famous people 290 55 0.4% 0.190 Phrases and patterns 933 253 1.8% 0.271 Surnames 33 9 0.1% 0.273 Biology 58 1 0.0% 0.017 System dictionary 19683 1027 7.4% 0.052 Machine names 9018 132 1.0% 0.015 Mnemonics 14 2 0.0% 0.143 King James bible 7525 83 0.6% 0.011 Miscellaneous words 3212 54 0.4% 0.017 Yiddish words 56 0 0.0% 0.000 Asteroids 2407 19 0.1% 0.007 TOTAL 62727 3340 24.2% 0.053"}, {"id": "868d6016fd0a4cdb8fb7b58dae46a5b0084d7675", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 342, "start_line": 38, "end_line": 39, "text": "aComputed as the number of matches divided by the search size. The more words that needed to be tested for a match, the lower the cost/benefit ratio."}, {"id": "6528e8d63b1cf561ac1736c107ce5c97b7f7279a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 343, "start_line": 1, "end_line": 4, "text": "328 CHAPTER 9 / INTRUDERS 3.Try various permutations on the words from step 2. This included making the first letter uppercase or a control character, making the entire word uppercase,reversing the word, changing the letter \u201co\u201d to the digit \u201czero,\u201d and so on. Thesepermutations added another 1 million words to the list. 4.Try various capitalization permutations on the words from step 2 that were notconsidered in step 3. This added almost 2 million additional words to the list."}, {"id": "63499a37d22ab4b21cb8b8da3e4560cfc068f841", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 343, "start_line": 5, "end_line": 9, "text": "Thus, the test involved in the neighborhood of 3 million words. Using the fastestThinking Machines implementation listed earlier, the time to encrypt all thesewords for all possible salt values is under an hour. Keep in mind that such a thor-ough search could produce a success rate of about 25%, whereas even a single hitmay be enough to gain a wide range of privileges on a system. A CCESS CONTROL One way to thwart a password attack is to deny the opponent access to the password file. If the encrypted password portion of the file is accessible only by a privileged user, then the opponent cannot read it without already knowingthe password of a privileged user. [SPAF92a] points out several flaws in this strategy:"}, {"id": "29e830a08a8883361b1aaccd4a1286e1b8c49b6d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 343, "start_line": 10, "end_line": 12, "text": "\u2022Many systems, including most UNIX systems, are susceptible to unanticipatedbreak-ins. Once an attacker has gained access by some means, he or she maywish to obtain a collection of passwords in order to use different accounts fordifferent logon sessions to decrease the risk of detection. Or a user withan account may desire another user\u2019s account to access privileged data or tosabotage the system. \u2022An accident of protection might render the password file readable, thus com-promising all the accounts. \u2022Some of the users have accounts on other machines in other protection domains,and they use the same password.Thus, if the passwords could be read by anyoneon one machine, a machine in another location might be compromised."}, {"id": "02bb403749a9e20f212af708e1924399133af240", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 343, "start_line": 13, "end_line": 14, "text": "Thus, a more effective strategy would be to force users to select passwords that aredifficult to guess. Password Selection Strategies"}, {"id": "1322b16ce18295e237bafd6782523861d339fae1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 343, "start_line": 15, "end_line": 17, "text": "The lesson from the two experiments just described (Tables 9.4 and 9.5) is that, leftto their own devices, many users choose a password that is too short or too easy toguess. At the other extreme, if users are assigned passwords consisting of eight ran-domly selected printable characters, password cracking is effectively impossible. Butit would be almost as impossible for most users to remember their passwords.Fortunately, even if we limit the password universe to strings of characters that arereasonably memorable, the size of the universe is still too large to permit practicalcracking. Our goal, then, is to eliminate guessable passwords while allowing the userto select a password that is memorable. Four basic techniques are in use: \u2022User education \u2022Computer-generated passwords"}, {"id": "1a1400a16b06a3223054f8295eb9d4854b10813f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 344, "start_line": 1, "end_line": 8, "text": "9.3 / PASSWORD MANAGEMENT 329 \u2022Reactive password checking \u2022Proactive password checking Users can be told the importance of using hard-to-guess passwords and can be provided with guidelines for selecting strong passwords. This user education strat- egy is unlikely to succeed at most installations, particularly where there is a large user population or a lot of turnover. Many users will simply ignore the guidelines.Others may not be good judges of what is a strong password. For example, manyusers (mistakenly) believe that reversing a word or capitalizing the last letter makesa password unguessable. Computer-generated passwords also have problems. If the passwords are quite"}, {"id": "9be7d77492c8a7ce2aaf1e63a47bc587d8cecbec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 344, "start_line": 9, "end_line": 10, "text": "random in nature, users will not be able to remember them. Even if the password ispronounceable, the user may have difficulty remembering it and so be tempted towrite it down. In general, computer-generated password schemes have a history ofpoor acceptance by users. FIPS PUB 181 defines one of the best-designed auto-mated password generators. The standard includes not only a description of theapproach but also a complete listing of the C source code of the algorithm.The algo-rithm generates words by forming pronounceable syllables and concatenating themto form a word. A random number generator produces a random stream of charac-ters used to construct the syllables and words. A reactive password checking strategy is one in which the system periodically"}, {"id": "92e1b98b59644c001834e4ea9fa6eb5e1bf6a3b4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 344, "start_line": 11, "end_line": 12, "text": "runs its own password cracker to find guessable passwords. The system cancels anypasswords that are guessed and notifies the user. This tactic has a number of draw-backs. First, it is resource intensive if the job is done right. Because a determinedopponent who is able to steal a password file can devote full CPU time to the taskfor hours or even days, an effective reactive password checker is at a distinct disad-vantage. Furthermore, any existing passwords remain vulnerable until the reactivepassword checker finds them. The most promising approach to improved password security is a proactive"}, {"id": "d1db2a62656f1c0ee7a56c93bdb6c50fb7ded543", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 344, "start_line": 13, "end_line": 14, "text": "password checker. In this scheme, a user is allowed to select his or her own pass-word. However, at the time of selection, the system checks to see if the password isallowable and, if not, rejects it. Such checkers are based on the philosophy that,with sufficient guidance from the system, users can select memorable passwordsfrom a fairly large password space that are not likely to be guessed in a dictionaryattack. The trick with a proactive password checker is to strike a balance between"}, {"id": "c6b50fa0e8242e965f75ce9469b54f3dfaf8e23d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 344, "start_line": 15, "end_line": 19, "text": "user acceptability and strength. If the system rejects too many passwords, users willcomplain that it is too hard to select a password. If the system uses some simplealgorithm to define what is acceptable, this provides guidance to password crackersto refine their guessing technique. In the remainder of this subsection, we look atpossible approaches to proactive password checking. The first approach is a simple system for rule enforcement. For example, the following rules could be enforced: \u2022All passwords must be at least eight characters long. \u2022In the first eight characters, the passwords must include at least one each ofuppercase, lowercase, numeric digits, and punctuation marks."}, {"id": "3e6e99725d444074cc32d17931f74f1b695cc460", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 345, "start_line": 1, "end_line": 9, "text": "330 CHAPTER 9 / INTRUDERS These rules could be coupled with advice to the user. Although this approach is superior to simply educating users, it may not be sufficient to thwart passwordcrackers. This scheme alerts crackers as to which passwords notto try but may still make it possible to do password cracking. Another possible procedure is simply to compile a large dictionary of possible \u201cbad\u201d passwords. When a user selects a password, the system checks to make surethat it is not on the disapproved list. There are two problems with this approach: \u2022Space: The dictionary must be very large to be effective. For example, the dic- tionary used in the Purdue study [SPAF92a] occupies more than 30 megabytesof storage. \u2022Time: The time required to search a large dictionary may itself be large. In"}, {"id": "35a65bc9697672a52ea4b2a278c4c3d101bedc53", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 345, "start_line": 10, "end_line": 12, "text": "addition, to check for likely permutations of dictionary words, either thosewords most be included in the dictionary, making it truly huge, or each searchmust also involve considerable processing. Two techniques for developing an effective and efficient proactive password checker that is based on rejecting words on a list show promise. One of these develops"}, {"id": "7084245c52b5c26873a1a036b64769af85b05de3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 345, "start_line": 13, "end_line": 27, "text": "a Markov model for the generation of guessable passwords [DA VI93]. Figure 9.5shows a simplified version of such a model.This model shows a language consisting ofan alphabet of three characters. The state of the system at any time is the identity ofthe most recent letter. The value on the transition from one state to another repre-sents the probability that one letter follows another.Thus, the probability that the nextletter is b, given that the current letter is a, is 0.5. a cb0.0 0.00.5 0.50.2 0.41.0 0.4 0.0 M /H11005 {3, {a, b, c} , T, 1 } where 0.0 0.5 0.5 T /H11005 0.2 0.4 0.4 1.0 0.0 0.0 e.g., string probably from this language: abbcacaba e.g., string probably not from this language: aacccbaaa Figure 9.5 An Example Markov Model"}, {"id": "7ef91e3a58985bc0c4c1c8aa22f36b3bc44b9756", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 346, "start_line": 1, "end_line": 9, "text": "9.3 / PASSWORD MANAGEMENT 331 In general, a Markov model is a quadruple , where is the number of states in the model, is the state space, is the matrix of transition probabilities, and is the order of the model. For a kth-order model, the probability of making a transition to a particular letter depends on the previous letters that have been gen-erated. Figure 9.5 shows a simple first-order model. The authors report on the development and use of a second-order model. To begin, a dictionary of guessable passwords is constructed.Then the transition matrixis calculated as follows: 1.Determine the frequency matrix f, where is the number of occurrences of the trigram consisting of the i th,jth, and kth character. For example, the"}, {"id": "cc3bfed53c1617471f82b7ce0c44c8405a5dd463", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 346, "start_line": 10, "end_line": 13, "text": "password parsnips yields the trigrams par, ars, rsn, sni, nip, and ips. 2.For each bigram , calculate as the total number of trigrams beginningwith . For example, would be the total number of trigrams of the formaba, abb, abc, and so on. 3.Compute the entries of T as follows: The result is a model that reflects the structure of the words in the dictionary."}, {"id": "5541e2a106ac0bdf61d064be11e14d0b2533e84b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 346, "start_line": 14, "end_line": 15, "text": "With this model, the question \u201cIs this a bad password?\u201d is transformed into thequestion \u201cWas this string (password) generated by this Markov model?\u201d For a givenpassword, the transition probabilities of all its trigrams can be looked up. Some stan-dard statistical tests can then be used to determine if the password is likely orunlikely for that model. Passwords that are likely to be generated by the model arerejected. The authors report good results for a second-order model. Their systemcatches virtually all the passwords in their dictionary and does not exclude so manypotentially good passwords as to be user unfriendly. A quite different approach has been reported by Spafford [SPAF92a,"}, {"id": "92f1c6aee59516ff2a9e446f9e75a06417c5ae39", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 346, "start_line": 16, "end_line": 25, "text": "SPAF92b]. It is based on the use of a Bloom filter [BLOO70]. To begin, we explainthe operation of the Bloom filter. A Bloom filter of order consists of a set of independent hash functions , where each function maps a password into a hash value in the range 0 to . That is, where th word in password dictionary number of words in password dictionary The following procedure is then applied to the dictionary: 1.A hash table of bits is defined, with all bits initially set to 0. 2.For each password, its hash values are calculated, and the corresponding bits in the hash table are set to 1.Thus, if for some , then the sixty- seventh bit of the hash table is set to 1; if the bit already has the value 1, itremains at 1.(i, j) H"}, {"id": "6c8915acf3e54316ca4ccc334699ec41724f1689", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 346, "start_line": 26, "end_line": 27, "text": "i(Xj)=67kND=j X j=Hi(Xj)=y 1\u2026i\u2026k;1 \u2026j\u2026D;0 \u2026y\u2026N - 1N - 1H1(x), H 2(x),\u00c1, H k(x)k kT1i, j, k2 = f1i, j, k2 f1i, j, q2f(a, b, q) ijf(i, j, q) ijf(i, j, k)kkT Am [m, A, T, k]"}, {"id": "b69f3b2f88d6a4a7089452a1be9c4b689dfc8e0d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 347, "start_line": 1, "end_line": 6, "text": "332 CHAPTER 9 / INTRUDERS When a new password is presented to the checker, its hash values are calcu- lated. If all the corresponding bits of the hash table are equal to 1, then the password is rejected. All passwords in the dictionary will be rejected. But there will also besome \u201cfalse positives\u201d (that is, passwords that are not in the dictionary but that pro-duce a match in the hash table). To see this, consider a scheme with two hash func-tions. Suppose that the passwords undertaker and hulkhogan are in the dictionary, but is not. Further suppose that If the password is presented to the system, it will be rejected even"}, {"id": "af53f3ce8611579e668785d65f0edb09a20ab6bb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 347, "start_line": 7, "end_line": 17, "text": "though it is not in the dictionary. If there are too many such false positives, it will bedifficult for users to select passwords. Therefore, we would like to design the hashscheme to minimize false positives. It can be shown that the probability of a falsepositive can be approximated by: or, equivalently, where number of hash functions number of bits in hash table number of words in dictionary , ratio of hash table size (bits) to dictionary size (words) Figure 9.6 plots as a function of for various values of . Suppose we have a dictionary of 1 million words and we wish to have a 0.01 probability of rejecting a password not in the dictionary. If we choose six hash functions, the required ratio is . Therefore, we need a hash table of or about 1.2 MBytes of"}, {"id": "a9ff91cafe39eb2a03928502ea8165c05bb5c4f8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 347, "start_line": 18, "end_line": 24, "text": "storage. In contrast, storage of the entire dictionary would require on the order of8 MBytes. Thus, we achieve a compression of almost a factor of 7. Furthermore,password checking involves the straightforward calculation of six hash functionsand is independent of the size of the dictionary, whereas with the use of the fulldictionary, there is substantial searching. 19.6*106 bits R=9.6k R PR=N/DD=N=k=RL -k ln11 - P1/k2PLa1 - ekD/Nbk =a1 - ek/RbkxG%#jj98H21undertaker 2=998 H 21hulkhogan 2=665 H 21xG%#jj98 2=998H11undertaker 2=25 H 11hulkhogan 2=83 H 11xG%#jj98 2=665xG%#jj98k 1Both the Markov model and the Bloom filter involve the use of probabilistic techniques. In the case of the Markov model, there is a small probability that some passwords in the dictionary will not be"}, {"id": "ce732477192f51e004003ef5a9b96b2b5cab90b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 347, "start_line": 25, "end_line": 25, "text": "caught and a small probability that some passwords not in the dictionary will be rejected. In the caseof the Bloom filter, there is a small probability that some passwords not in the dictionary will berejected."}, {"id": "0fb80693ce42b353b8990673980c1beec606a4cc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 348, "start_line": 1, "end_line": 10, "text": "9.4 / RECOMMENDED READING AND WEB SITES 333 9.4 RECOMMENDED READING AND WEB SITES Two thorough treatments of intrusion detection are [BACE00] and [PROC01]. A more concise but very worthwhile treatment is [SCAR07]. Two short but useful survey articles onthe subject are [KENT00] and [MCHU00]. [NING04] surveys recent advances in intrusiondetection techniques. [HONE01] is the definitive account on honeypots and provides adetailed analysis of the tools and methods of hackers.0.0010.010.11Pr[false positive] 20 15 10 5 0 Ratio of hash table size (bits) to dictionary size (words) 4 hash functions2 hash functions 6 hash functions Figure 9.6 Performance of Bloom Filter BACE00 Bace, R. Intrusion Detection. Indianapolis, IN: Macmillan Technical Publishing, 2000."}, {"id": "778e001ae1cf23eebabd948e339d288eccbd759f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 348, "start_line": 11, "end_line": 22, "text": "HONE01 The Honeynet Project. Know Your Enemy: Revealing the Security Tools, Tactics, and Motives of the Blackhat Community. Reading, MA: Addison-Wesley, 2001. KENT00 Kent, S. \u201cOn the Trail of Intrusions into Information Systems.\u201d IEEE Spectrum , December 2000. MCHU00 McHugh, J.; Christie, A.; and Allen, J. \u201cThe Role of Intrusion Detection Systems.\u201d IEEE Software , September/October 2000. NING04 Ning, P ., et al. \u201cTechniques and Tools for Analyzing Intrusion Alerts.\u201d ACM Transactions on Information and System Security , May 2004. PROC01 Proctor, P ., The Practical Intrusion Detection Handbook. Upper Saddle River, NJ: Prentice Hall, 2001. SCAR07 Scarfone, K., and Mell, P . Guide to Intrusion Detection and Prevention Systems. NIST Special Publication SP 800-94, February 2007."}, {"id": "c896ed8006e3ca80a04d7fd5ab18878865205146", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 349, "start_line": 1, "end_line": 12, "text": "334 CHAPTER 9 / INTRUDERS Recommended Web Sites: \u2022CERT Coordination Center: The organization that grew from the computer emergency response team formed by the Defense Advanced Research Projects Agency. Site provides good information on Internet security threats, vulnerabilities,and attack statistics. \u2022Packet Storm: Resource of up-to-date and historical security tools, exploits, and advisories. \u2022Honeynet Project: A research project studying the techniques of predatory hackers and developing honeypot products. \u2022Honeypots: A good collection of research papers and technical articles. \u2022Intrusion Detection Working Group: IETF group developing standards for exchange formats and exchange procedures for intrusion detection systems. Includes RFCs andInternet drafts."}, {"id": "10f508bcf367d97b3fbb29f86d8aa8e2497eb891", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 349, "start_line": 13, "end_line": 23, "text": "\u2022STAT Project: A research and open-source project at the University of California, Santa Barbara that focuses on signature-based intrusion detection tools for hosts,applications, and networks. \u2022Password Usage and Generation: NIST documents on this topic. 9.5 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms audit recordBayes\u2019 Theorembase-rate fallacyhoneypotintruderintrusion detectionintrusion detection exchange formatpasswordrule-based intrusion detectionsaltstatistical anomaly detection Review Questions 9.1 List and briefly define three classes of intruders. 9.2 What are two common techniques used to protect a password file? 9.3 What are three benefits that can be provided by an intrusion detection system?"}, {"id": "b2df1fbf300a353b499d00d546fbcb26011a1237", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 349, "start_line": 24, "end_line": 30, "text": "9.4 What is the difference between statistical anomaly detection and rule-based intrusion detection? 9.5 What metrics are useful for profile-based intrusion detection? 9.6 What is the difference between rule-based anomaly detection and rule-based pene-tration identification? 9.7 What is a honeypot? 9.8 What is a salt in the context of UNIX password management? 9.9 List and briefly define four techniques used to avoid guessable passwords."}, {"id": "2009345a07b81865bbd9729475c371a6f4b5fe57", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 350, "start_line": 1, "end_line": 10, "text": "9.5 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 335 Problems 9.1 In the context of an IDS, we define a false positive to be an alarm generated by an IDS in which the IDS alerts to a condition that is actually benign. A false negativeoccurs when an IDS fails to generate an alarm when an alert-worthy condition is ineffect. Using the following diagram, depict two curves that roughly indicate falsepositives and false negatives, respectively. Conservativeness of signaturesFrequency of alerts More specific or stricterLess specific or looser"}, {"id": "ea7cb96599ab98f03520db6ffb64b0c1cc1eb2b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 350, "start_line": 11, "end_line": 12, "text": "9.2 The overlapping area of the two probability density functions of Figure 9.1 representsthe region in which there is the potential for false positives and false negatives.Further, Figure 9.1 is an idealized and not necessarily representative depiction of therelative shapes of the two density functions. Suppose there is 1 actual intrusion forevery 1000 authorized users, and the overlapping area covers 1% of the authorizedusers and 50% of the intruders.a.Sketch such a set of density functions and argue that this is not an unreasonabledepiction. b.What is the probability that an event that occurs in this region is that of an autho-rized user? Keep in mind that 50% of all intrusions fall in this region."}, {"id": "7ac1f7788e264554627e1008f80b7139abac8eda", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 350, "start_line": 13, "end_line": 13, "text": "9.3 An example of a host-based intrusion detection tool is the tripwire program. This is afile integrity checking tool that scans files and directories on the system on a regularbasis and notifies the administrator of any changes. It uses a protected database ofcryptographic checksums for each file checked and compares this value with thatrecomputed on each file as it is scanned. It must be configured with a list of files anddirectories to check, and what changes, if any, are permissible to each. It can allow, forexample, log files to have new entries appended, but not for existing entries to bechanged. What are the advantages and disadvantages of using such a tool? Considerthe problem of determining which files should only change rarely, which files maychange more often and how, and which change frequently and hence cannot bechecked. Hence consider the amount of work in both the configuration of the pro-gram and on the system administrator monitoring the responses generated."}, {"id": "3a6c7d28d5b87711e4a360edc3ce539f170ebc2a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 350, "start_line": 14, "end_line": 22, "text": "9.4 A taxicab was involved in a fatal hit-and-run accident at night. Two cab companies,the Green and the Blue, operate in the city. You are told that: \u202285% of the cabs in the city are Green and 15% are Blue. \u2022A witness identified the cab as Blue. The court tested the reliability of the witness under the same circumstances that existed on the night of the accident and concluded that the witness was correct inidentifying the color of the cab 80% of the time. What is the probability that the cabinvolved in the incident was Blue rather than Green? 9.5 Explain the suitability or unsuitability of the following passwords: a.YK 334 b.mfmitm (for \u201cmy favorite c.Natalie1 d.Washington movie is tender mercies) e.Aristotle f.tv9stove g.12345678 h.dribgib"}, {"id": "762c3e2c01ea1f234f1485f57939cef6f7d0b883", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 351, "start_line": 1, "end_line": 3, "text": "336 CHAPTER 9 / INTRUDERS 9.6 An early attempt to force users to use less predictable passwords involved computer- supplied passwords. The passwords were eight characters long and were taken fromthe character set consisting of lowercase letters and digits. They were generated by apseudorandom number generator with possible starting values. Using the technol-ogy of the time, the time required to search through all character strings of length 8from a 36-character alphabet was 112 years. Unfortunately, this is not a true reflectionof the actual security of the system. Explain the problem."}, {"id": "445107e289c26d584d62d3db003d633542c1d093", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 351, "start_line": 4, "end_line": 7, "text": "9.7 Assume that passwords are selected from four-character combinations of 26 alpha-betic characters. Assume that an adversary is able to attempt passwords at a rate ofone per second.a.Assuming no feedback to the adversary until each attempt has been completed,what is the expected time to discover the correct password? b.Assuming feedback to the adversary flagging an error as each incorrect characteris entered, what is the expected time to discover the correct password? 9.8 Assume that source elements of length are mapped in some uniform fashion into atarget elements of length . If each digit can take on one of values, then the number of source elements is and the number of target elements is the smaller number ."}, {"id": "64aad590bdea52bb01769fd39ca338a45a1c9e56", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 351, "start_line": 8, "end_line": 14, "text": "A particular source element is mapped to a particular target element .a.What is the probability that the correct source element can beselected by an adversary on one try? b.What is the probability that a different source element that results inthe same target element, , could be produced by an adversary? c.What is the probability that the correct target element can be produced by anadversary on one try? 9.9 A phonetic password generator picks two segments randomly for each six-letter pass-word. The form of each segment is CVC (consonant, vowel, consonant), where and . a.What is the total password population? b.What is the probability of an adversary guessing a password correctly?"}, {"id": "8784a94bce75ba815c35fef39686426f890f3b90", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 351, "start_line": 15, "end_line": 17, "text": "9.10 Assume that passwords are limited to the use of the 95 printable ASCII charactersand that all passwords are 10 characters in length.Assume a password cracker with anencryption rate of 6.4 million encryptions per second. How long will it take to testexhaustively all possible passwords on a UNIX system? 9.11 Because of the known risks of the UNIX password system, the SunOS-4.0 documen-tation recommends that the password file be removed and replaced with a publiclyreadable file called /etc/publickey. An entry in the file for user A consists of a user\u2019sidentifier , the user\u2019s public key, , and the corresponding private key .Thisprivate key is encrypted using DES with a key derived from the user\u2019s login password . When A logs in, the system decrypts to obtain ."}, {"id": "baf3f7a3a6d4797ebfe40df73be549c09981886b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 351, "start_line": 18, "end_line": 21, "text": "a.The system then verifies that was correctly supplied. How? b.How can an opponent attack this system? 9.12 The encryption scheme used for UNIX passwords is one way; it is not possible toreverse it. Therefore, would it be accurate to say that this is, in fact, a hash code ratherthan an encryption of the password? 9.13 It was stated that the inclusion of the salt in the UNIX password scheme increases thedifficulty of guessing by a factor of 4096. But the salt is stored in plaintext in the sameentry as the corresponding ciphertext password. Therefore, those two characters areknown to the attacker and need not be guessed. Why is it asserted that the saltincreases security?"}, {"id": "ee1377bd25473be43f87a578ae3d026207ae6fe8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 351, "start_line": 22, "end_line": 24, "text": "9.14 Assuming that you have successfully answered the preceding problem and under-stand the significance of the salt, here is another question. Wouldn\u2019t it be possible tothwart completely all password crackers by dramatically increasing the salt size to,say, 24 or 48 bits? 9.15 Consider the Bloom filter discussed in Section 9.3. Define number of hash func-tions; number of bits in hash table; and number of words in dictionary. D= N=k=P aPR a E(P a, PR a) PaPR a PU a IDAC=V V=6 a, e, i, o, u 7yjxk(xiZxk)yj xirprkr pk215"}, {"id": "f340ddbaf0471c73c12035bf0aeaa35b90bd6792", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 352, "start_line": 1, "end_line": 9, "text": "APPENDIX 9A / THE BASE-RATE FALLACY 337 a.Show that the expected number of bits in the hash table that are equal to zero is expressed as b.Show that the probability that an input word, not in the dictionary, will be falselyaccepted as being in the dictionary is c.Show that the preceding expression can be approximated as 9.16 Design a file access system to allow certain users read and write access to a file,depending on authorization set up by the system. The instructions should be of theformat: READ (F, User A): attempt by User A to read file F READ (F, User A): attempt by User A to store a possibly modified copy of F Each file has a header record, which contains authorization privileges; that is, a list of"}, {"id": "944e94aefc55996c6e23c585561330434c4881d0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 352, "start_line": 10, "end_line": 15, "text": "users who can read and write.The file is to be encrypted by a key that is not shared by the users but known only to the system. APPENDIX 9A THE BASE-RATE FALLACY We begin with a review of important results from probability theory, then demon- strate the base-rate fallacy. Conditional Probability and Independence"}, {"id": "7f7390c15c7d28c4c110f653acd8fffab7db0879", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 352, "start_line": 16, "end_line": 21, "text": "We often want to know a probability that is conditional on some event.The effect of thecondition is to remove some of the outcomes from the sample space. For example, whatis the probability of getting a sum of 8 on the roll of two dice, if we know that the face ofat least one die is an even number? We can reason as follows. Because one die is evenand the sum is even, the second die must show an even number. Thus, there are threeequally likely successful outcomes: (2, 6), (4, 4) and (6, 2), out of a total set of possibilitiesof . The resultingprobability is . Formally, the conditional probability of an event assuming the event has occurred, denoted by , is defined as the ratio where we assume is not zero. In our example, and . The quantity"}, {"id": "48f8446f0cde05ab9e69844d8b83ce8a28fb818c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 352, "start_line": 22, "end_line": 27, "text": "encompasses all of those outcomes in which the sum is 8 and at least one die is even. As we have seen, there are three such outcomes. Thus, . A moment\u2019s thought should convince you that . We can now calculatePr[B]=3/4 Pr[AB] =3/36 =1/12Pr[AB]B={at least one die even} A={sum of 8}Pr[B]Pr[A | B] = Pr[AB] Pr[B]Pr[A| B]B A3/27 =1/9faces odd)] =36-(3*3)=27 [36-(number of events with bothPLa1 - e-kD/NbkP=(1 - f)kf=a1 - k N bD"}, {"id": "5b1883f3189f1f85b8c045aa23d0e834553c1957", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 353, "start_line": 1, "end_line": 11, "text": "338 CHAPTER 9 / INTRUDERS This agrees with our previous reasoning. Two events and are called independent if . It can eas- ily be seen that if and are independent, and . Bayes\u2019Theorem One of the most important results from probability theory is known as Bayes\u2019 theo- rem. First we need to state the total probability formula. Given a set of mutuallyexclusive events , such that the union of these events covers all possi-ble outcomes, and given an arbitrary event , then it can be shown that (9.1) Bayes\u2019 theorem may be stated as follows: (9.2) Figure 9.7a illustrates the concepts of total probability and Bayes\u2019 theorem.Bayes\u2019 theorem is used to calculate \u201cposterior odds,\u201d that is, the probability"}, {"id": "bd63726f4f0c949505e2721a0582952abf383b20", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 353, "start_line": 12, "end_line": 18, "text": "that something really is the case, given evidence in favor of it. For example, supposewe are transmitting a sequence of zeroes and ones over a noisy transmission line.Let S0 and S1 be the events a zero is sent at a given time and a one is sent, respec-tively, and R0 and R1 be the events that a zero is received and a one is received.Suppose we know the probabilities of the source, namely and . Now the line is observed to determine how frequently an error occurs when a one is sent and when a zero is sent, and the following probabilities arecalculated: and . If a zero is received, we can then Pr[R1|S0] =p b Pr[R0|S0] =paPr[S0] =1 - pPr[S1] =pPr[Ei|A]= Pr[A|E i]P[E i] Pr[A] = Pr[A|E i]P[E i] an j=1Pr[A|E j]Pr[E j]Pr[A]=an"}, {"id": "9c60ea34771fa332c84ac04cdbd83e66e20bc6dc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 353, "start_line": 19, "end_line": 28, "text": "i=1Pr[A|E i]Pr[Ei]AE1, E2, \u00c1, EnPr[B|A] =Pr[B] Pr[A|B] =Pr[A] B APr[AB] =Pr[A]Pr[B] B APr[A | B] = 1/12 3/4 = 1 9 AE1 E2 E3 E4 /H11005 S0; 0 sent /H11005 S1; 1 sent/H11005 R0; 0 recei ved /H11005 R1; 1 recei ved (b) Example (a) Diagram to illustrate concepts Figure 9.7 Illustration of Total Probability and Bayes\u2019 Theorem"}, {"id": "0c94e712dd7d886b6e9b26bd9523b31840e5863c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 354, "start_line": 1, "end_line": 10, "text": "APPENDIX 9A / THE BASE-RATE FALLACY 339 calculate the conditional probability of an error, namely the conditional probability that a one was sent given that a zero was received, using Bayes\u2019 theorem: Figure 9.7b illustrates the preceding equation. In the figure, the sample space is rep- resented by a unit square. Half of the square corresponds to S0 and half to S1, so . Similarly, half of the square corresponds to R0 and half to R1, so .Within the area representing S0, 1/4 of that area corresponds to R1, so . Other conditional probabilities are similarly evident. The Base-Rate Fallacy Demonstrated Consider the following situation. A patient has a test for some disease that comesback positive (indicating he has the disease). You are told that"}, {"id": "9bb5dd83b03473fccb9d8bcc26187f6017b819af", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 354, "start_line": 11, "end_line": 18, "text": "\u2022The accuracy of the test is 87% (i.e., if a patient has the disease, 87% of thetime, the test yields the correct result, and if the patient does not have the dis-ease, 87% of the time, the test yields the correct result). \u2022The incidence of the disease in the population is 1%. Given that the test is positive, how probable is it that the patient does not have the disease? That is, what is the probability that this is a false alarm? We need Bayes\u2019 theorem to get the correct answer: Thus, in the vast majority of cases, when a disease condition is detected, it is a false alarm. This problem, used in a study [PIAT91], was presented to a number of people."}, {"id": "84e6fc660093a081c9c44776e960a99b7d1a818f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 354, "start_line": 19, "end_line": 23, "text": "Most subjects gave the answer 13%. The vast majority, including many physicians,gave a number below 50%. Many physicians who guessed wrong lamented, \u201cIf youare right, there is no point in making clinical tests!\u201d The reason most people get itwrong is that they do not take into account the basic rate of incidence (the base rate)when intuitively solving the problem. This error is known as the base-rate fallacy. How could this problem be fixed? Suppose we could drive both of the correct result rates to 99.9%. That is, suppose we have and . Plugging these numbers into the Equation (9.2), we get . Thus, if we can accurately detect disease and accurately"}, {"id": "f2ebc69c044d50a34f045515da242b6c073c7577", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 354, "start_line": 24, "end_line": 28, "text": "detect lack of disease at a level of 99.9%, then the rate of false alarms will be 9%.This is much better, but still not ideal. Moreover, again assume 99.9% accuracy, butnow suppose that the incidence of the disease in the population is only . We then end up with a rate of false alarms of 91%. In actual situ- ations, [AXEL00] found that the probabilities associated with intrusion detectionsystems were such that the false alarm rate was unsatisfactory.1/10000 =0.0001positive] =0.09 Pr[well/well] =0.999 Pr[negative/Pr[positive/disease] =0.999 = (0.13)(0.99) (0.87)(0.01) + (0.13)(0.99) =0.937 Pr[well/positive] = Pr[positive/well]Pr[well] Pr[positive/disease]Pr[disease] + Pr[positive/well]Pr[well]Pr[R1/S0] =0.25Pr[R0] =Pr[R1] =0.5Pr[S0] =Pr[S1] =0.5Pr[S1 | R0] = Pr[R0 | S1]Pr[S1]"}, {"id": "437559e534d3c1cd2bac6028cdb4c73e7d059f38", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 354, "start_line": 29, "end_line": 30, "text": "Pr[R0 | S1]Pr[S1] + Pr[R0 | S0]Pr[S0] = pap pap + (1 - pb)(1 - p)"}, {"id": "c47564def7744ce6508c175aa587639cc3ef9616", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 355, "start_line": 1, "end_line": 16, "text": "CHAPTER MALICIOUS SOFTWARE 10.1 Types Of Malicious Software Backdoor Logic BombTrojan HorsesMobile CodeMultiple-Threat Malware 10.2 Viruses The Nature of VirusesViruses ClassificationVirus KitsMacro VirusesE-Mail Viruses 10.3 Virus Countermeasures Antivirus ApproachesAdvanced Antivirus Techniques 10.4 Worms The Morris WormWorm Propagation ModelRecent Worm AttacksState of Worm TechnologyMobile Phone WormsWorm Countermeasures 10.5 Distributed Denial Of Service Attacks DDoS Attack DescriptionConstructing the Attack NetworkDDoS Countermeasures 10.6 Recommended Reading And Web Sites 10.7 Key Terms, Review Questions, And Problems 340"}, {"id": "99d1f1d7c78fb3ae0e818cb44a0ce452295b5c82", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 356, "start_line": 1, "end_line": 8, "text": "10.1 / TYPES OF MALICIOUS SOFTWARE 341 What is the concept of defense: The parrying of a blow. What is its characteristic feature: Awaiting the blow. \u2014On War, Carl Von Clausewitz KEY POINTS \u25c6Malicious software is software that is intentionally included or inserted ina system for a harmful purpose. \u25c6A virus is a piece of software that can \u201cinfect\u201d other programs by modify-ing them; the modification includes a copy of the virus program, which canthen go on to infect other programs. \u25c6A worm is a program that can replicate itself and send copies from com-puter to computer across network connections. Upon arrival, the wormmay be activated to replicate and propagate again. In addition to propaga-tion, the worm usually performs some unwanted function."}, {"id": "8b65beb25e9defbd8ee1be648ce5337674eb2a89", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 356, "start_line": 9, "end_line": 14, "text": "\u25c6A denial of service (DoS) attack is an attempt to prevent legitimate usersof a service from using that service. \u25c6A distributed denial of service attack is launched from multiple coordinated sources. Perhaps the most sophisticated types of threats to computer systems are presented byprograms that exploit vulnerabilities in computing systems. Such threats are referred toas malicious software , or malware . In this context, we are concerned with threats to application programs as well as utility programs, such as editors and compilers, andkernel-level programs. This chapter examines malicious software, with a special emphasis on viruses"}, {"id": "04424bad47b9d41d04ec0a22a0229734c4b01f86", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 356, "start_line": 15, "end_line": 20, "text": "and worms. The chapter begins with a survey of various types of malware, with amore detailed look at the nature of viruses and worms. We then turn to distributeddenial-of-service attacks. Throughout, the discussion presents both threats andcountermeasures. 10.1 TYPES OF MALICIOUS SOFTWARE The terminology in this area presents problems because of a lack of universal agree-ment on all of the terms and because some of the categories overlap. Table 10.1 is auseful guide. Malicious software can be divided into two categories: those that need a host program, and those that are independent. The former, referred to as parasitic, are essentially fragments of programs that cannot exist independently of someactual application program, utility, or system program. Viruses, logic bombs,"}, {"id": "3665ddd159a64d0f40b9701e8268bd9de675a487", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 357, "start_line": 1, "end_line": 6, "text": "Table 10.1 Terminology of Malicious Programs Name Description Virus Malware that, when executed, tries to replicate itself into other executable code; when it succeeds the code is said to be infected. When the infected code is executed, the virus alsoexecutes. Worm A computer program that can run independently and can propagate a complete workingversion of itself onto other hosts on a network. Logic bomb A program inserted into software by an intruder. A logic bomb lies dormant until a prede-fined condition is met; the program then triggers an unauthorized act."}, {"id": "01b067a96ee9cd10d25b52532f3263d2eed5caf5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 357, "start_line": 7, "end_line": 11, "text": "Trojan horse A computer program that appears to have a useful function, but also has a hidden andpotentially malicious function that evades security mechanisms, sometimes by exploitinglegitimate authorizations of a system entity that invokes the Trojan horse program. Backdoor (trapdoor) Any mechanism that bypasses a normal security check; it may allow unauthorized accessto functionality. Mobile code Software (e.g., script, macro, or other portable instruction) that can be shipped unchangedto a heterogeneous collection of platforms and execute with identical semantics. Exploits Code specific to a single vulnerability or set of vulnerabilities. Downloaders Program that installs other items on a machine that is under attack. Usually, a downloaderis sent in an e-mail."}, {"id": "293f77fc7cddc5cbea962c36c8e018d71f213f13", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 357, "start_line": 12, "end_line": 19, "text": "Auto-rooter Malicious hacker tools used to break into new machines remotely. Kit (virus generator) Set of tools for generating new viruses automatically. Spammerprograms Used to send large volumes of unwanted e-mail. Flooders Used to attack networked computer systems with a large volume of traffic to carry out adenial-of-service (DoS) attack. Keyloggers Captures keystrokes on a compromised system. Rootkit Set of hacker tools used after attacker has broken into a computer system and gainedroot-level access. Zombie, bot Program activated on an infected machine that is activated to launch attacks on othermachines. Spyware Software that collects information from a computer and transmits it to another system."}, {"id": "9c02967ae41d061e452a396736c4c42a94e1dfda", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 357, "start_line": 20, "end_line": 24, "text": "Adware Advertising that is integrated into software. It can result in pop-up ads or redirection of abrowser to a commercial site. and backdoors are examples. Independent malware is a self-contained program that can be scheduled and run by the operating system. Worms and bot programsare examples. We can also differentiate between those software threats that do not repli- cate and those that do. The former are programs or fragments of programs thatare activated by a trigger. Examples are logic bombs, backdoors, and bot pro-grams. The latter consist of either a program fragment or an independentprogram that, when executed, may produce one or more copies of itself to be342 CHAPTER 10 / MALICIOUS SOFTWARE"}, {"id": "2a049b80f5bfe6821630255ebfa84c213fe34468", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 358, "start_line": 1, "end_line": 7, "text": "10.1 / TYPES OF MALICIOUS SOFTWARE 343 activated later on the same system or some other system. Viruses and worms are examples. In the remainder of this section, we briefly survey some of the key categories of malicious software, deferring discussion on the key topics of viruses and wormsuntil the following sections. Backdoor A backdoor , also known as a trapdoor , is a secret entry point into a program that"}, {"id": "acff0c2ad08694a1bd20744743d0e416d095ed96", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 358, "start_line": 8, "end_line": 8, "text": "allows someone who is aware of the backdoor to gain access without going throughthe usual security access procedures. Programmers have used backdoors legiti-mately for many years to debug and test programs; such a backdoor is called amaintenance hook. This usually is done when the programmer is developing anapplication that has an authentication procedure, or a long setup, requiring the userto enter many different values to run the application. To debug the program, thedeveloper may wish to gain special privileges or to avoid all the necessary setup andauthentication. The programmer may also want to ensure that there is a method ofactivating the program should something be wrong with the authentication proce-dure that is being built into the application. The backdoor is code that recognizessome special sequence of input or is triggered by being run from a certain user ID orby an unlikely sequence of events."}, {"id": "b7a8ed46862334d9fa506b9b6ba9ca142369322e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 358, "start_line": 9, "end_line": 12, "text": "Backdoors become threats when unscrupulous programmers use them to gain unauthorized access. The backdoor was the basic idea for the vulnerabilityportrayed in the movie War Games. Another example is that during the develop- ment of Multics, penetration tests were conducted by an Air Force \u201ctiger team\u201d(simulating adversaries). One tactic employed was to send a bogus operatingsystem update to a site running Multics. The update contained a Trojan horse(described later) that could be activated by a backdoor and that allowed thetiger team to gain access. The threat was so well implemented that the Multicsdevelopers could not find it, even after they were informed of its presence[ENGE80]. It is difficult to implement operating system controls for backdoors."}, {"id": "b70d4272fb1ec05017dacc258151d3fc441e12bc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 358, "start_line": 13, "end_line": 14, "text": "Security measures must focus on the program development and software updateactivities. Logic Bomb"}, {"id": "a8a98fe71b75547b2c53b508a2ae9fe6803ace05", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 358, "start_line": 15, "end_line": 15, "text": "One of the oldest types of program threat, predating viruses and worms, is thelogic bomb. The logic bomb is code embedded in some legitimate program that isset to \u201cexplode\u201d when certain conditions are met. Examples of conditions thatcan be used as triggers for a logic bomb are the presence or absence of certainfiles, a particular day of the week or date, or a particular user running the appli-cation. Once triggered, a bomb may alter or delete data or entire files, cause amachine halt, or do some other damage. A striking example of how logic bombscan be employed was the case of Tim Lloyd, who was convicted of setting a logicbomb that cost his employer, Omega Engineering, more than $10 million,derailed its corporate growth strategy, and eventually led to the layoff of 80"}, {"id": "fca264a6504f0633798011a31c02fff1c5ac5eb7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 359, "start_line": 1, "end_line": 7, "text": "344 CHAPTER 10 / MALICIOUS SOFTWARE workers [GAUD00]. Ultimately, Lloyd was sentenced to 41 months in prison and ordered to pay $2 million in restitution. Trojan Horses A Trojan horse1is a useful, or apparently useful, program or command procedure containing hidden code that, when invoked, performs some unwanted or harmfulfunction. Trojan horse programs can be used to accomplish functions indirectly that an"}, {"id": "13139b2f8dd6f3355845ea964c06165f1753d835", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 359, "start_line": 8, "end_line": 8, "text": "unauthorized user could not accomplish directly. For example, to gain access to thefiles of another user on a shared system, a user could create a Trojan horse programthat, when executed, changes the invoking user\u2019s file permissions so that the files arereadable by any user. The author could then induce users to run the program byplacing it in a common directory and naming it such that it appears to be a usefulutility program or application. An example is a program that ostensibly produces alisting of the user\u2019s files in a desirable format. After another user has run theprogram, the author of the program can then access the information in the user\u2019sfiles. An example of a Trojan horse program that would be difficult to detect is acompiler that has been modified to insert additional code into certain programs asthey are compiled, such as a system login program [THOM84]. The code creates abackdoor in the login program that permits the author to log on to the system usinga special password. This Trojan horse can never be discovered by reading the sourcecode of the login program."}, {"id": "de056f8afe371b31136f954695f0f7a87e5b6df5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 359, "start_line": 9, "end_line": 12, "text": "Another common motivation for the Trojan horse is data destruction. The program appears to be performing a useful function (e.g., a calculator program), butit may also be quietly deleting the user\u2019s files. For example, a CBS executive wasvictimized by a Trojan horse that destroyed all information contained in his com-puter\u2019s memory [TIME90]. The Trojan horse was implanted in a graphics routineoffered on an electronic bulletin board system. Trojan horses fit into one of three models: \u2022Continuing to perform the function of the original program and additionallyperforming a separate malicious activity"}, {"id": "a83d15663f164453b89111bf94c055e8bb886d5e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 359, "start_line": 13, "end_line": 16, "text": "\u2022Continuing to perform the function of the original program but modifying thefunction to perform malicious activity (e.g., a Trojan horse version of a loginprogram that collects passwords) or to disguise other malicious activity (e.g., aTrojan horse version of a process listing program that does not display certainprocesses that are malicious) \u2022Performing a malicious function that completely replaces the function of theoriginal program 1In Greek mythology, the Trojan horse was used by the Greeks during their siege of Troy. Epeios constructed a giant hollow wooden horse in which thirty of the most valiant Greek heroes concealed"}, {"id": "db4f7102d816ca9641f3fe5466befbd1a5c7d488", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 359, "start_line": 17, "end_line": 17, "text": "themselves. The rest of the Greeks burned their encampment and pretended to sail away but actually hidnearby. The Trojans, convinced the horse was a gift and the siege over, dragged the horse into the city.That night, the Greeks emerged from the horse and opened the city gates to the Greek army. A blood-bath ensued, resulting in the destruction of Troy and the death or enslavement of all its citizens."}, {"id": "0d9867776d1de7fd1482c3f6651f9f0eb27d0782", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 360, "start_line": 1, "end_line": 5, "text": "10.1 / TYPES OF MALICIOUS SOFTWARE 345 Mobile Code Mobile code refers to programs (e.g., script, macro, or other portable instruction) that can be shipped unchanged to a heterogeneous collection of platforms andexecute with identical semantics [JANS01]. The term also applies to situationsinvolving a large homogeneous collection of platforms (e.g., Microsoft Windows). Mobile code is transmitted from a remote system to a local system and then"}, {"id": "602f5bad5f545d21aacfbc7593417548e45e7ee5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 360, "start_line": 6, "end_line": 7, "text": "executed on the local system without the user\u2019s explicit instruction. Mobile codeoften acts as a mechanism for a virus, worm, or Trojan horse to be transmitted to theuser\u2019s workstation. In other cases, mobile code takes advantage of vulnerabilities toperform its own exploits, such as unauthorized data access or root compromise.Popular vehicles for mobile code include Java applets, ActiveX, JavaScript, andVBScript.The most common ways of using mobile code for malicious operations onlocal system are cross-site scripting, interactive and dynamic Web sites, e-mailattachments, and downloads from untrusted sites or of untrusted software. Multiple-Threat Malware"}, {"id": "63920e5416e664e577a0e2c7bbcae38b0626039d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 360, "start_line": 8, "end_line": 12, "text": "Viruses and other malware may operate in multiple ways. The terminology is farfrom uniform; this subsection gives a brief introduction to several related conceptsthat could be considered multiple-threat malware. A multipartite virus infects in multiple ways. Typically, the multipartite virus is capable of infecting multiple types of files, so that virus eradication must deal withall of the possible sites of infection. A blended attack uses multiple methods of infection or transmission, to maxi- mize the speed of contagion and the severity of the attack. Some writers characterizea blended attack as a package that includes multiple types of malware.An example ofa blended attack is the Nimda attack, erroneously referred to as simply a worm.Nimda uses four distribution methods:"}, {"id": "667951e93e0ab40eff8b7e7e8be1b1650c2a9f2c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 360, "start_line": 13, "end_line": 20, "text": "\u2022E-mail: A user on a vulnerable host opens an infected e-mail attachment; Nimda looks for e-mail addresses on the host and then sends copies of itself tothose addresses. \u2022Windows shares: Nimda scans hosts for unsecured Windows file shares; it can then use NetBIOS86 as a transport mechanism to infect files on that host inthe hopes that a user will run an infected file, which will activate Nimda onthat host. \u2022Web servers: Nimda scans Web servers, looking for known vulnerabilities in Microsoft IIS. If it finds a vulnerable server, it attempts to transfer a copy ofitself to the server and infect it and its files. \u2022Web clients: If a vulnerable Web client visits a Web server that has been infected by Nimda, the client\u2019s workstation will become infected."}, {"id": "e587156722ef5c432f51ffda740e5c189bc9a76c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 360, "start_line": 21, "end_line": 23, "text": "Thus, Nimda has worm, virus, and mobile code characteristics. Blended attacks may also spread through other services, such as instant messaging and peer-to-peer file sharing."}, {"id": "52f0650e7dcc6281655c1ecfb25ef52031904448", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 361, "start_line": 1, "end_line": 6, "text": "346 CHAPTER 10 / MALICIOUS SOFTWARE 10.2 VIRUSES The Nature of Viruses A computer virus is a piece of software that can \u201cinfect\u201d other programs by modifying them; the modification includes injecting the original program with a routine to makecopies of the virus program, which can then go on to infect other programs. Computerviruses first appeared in the early 1980s, and the term itself is attributed to Fred Cohenin 1983. Cohen is the author of a groundbreaking book on the subject [COHE94]. Biological viruses are tiny scraps of genetic code\u2014DNA or RNA\u2014that can"}, {"id": "26a4fd75a654fb887d13aa99f19649915d8f4a87", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 361, "start_line": 7, "end_line": 7, "text": "take over the machinery of a living cell and trick it into making thousands of flaw-less replicas of the original virus. Like its biological counterpart, a computer viruscarries in its instructional code the recipe for making perfect copies of itself. Thetypical virus becomes embedded in a program on a computer. Then, whenever theinfected computer comes into contact with an uninfected piece of software, a freshcopy of the virus passes into the new program. Thus, the infection can be spreadfrom computer to computer by unsuspecting users who either swap disks or sendprograms to one another over a network. In a network environment, the ability toaccess applications and system services on other computers provides a perfect cul-ture for the spread of a virus."}, {"id": "c7d4c77101f423692a80a14104cdc00f248daeb3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 361, "start_line": 8, "end_line": 17, "text": "A virus can do anything that other programs do. The difference is that a virus attaches itself to another program and executes secretly when the host program isrun. Once a virus is executing, it can perform any function, such as erasing files andprograms that is allowed by the privileges of the current user. A computer virus has three parts [A YCO06]: \u2022Infection mechanism: The means by which a virus spreads, enabling it to repli- cate. The mechanism is also referred to as the infection vector . \u2022Trigger: The event or condition that determines when the payload is activated or delivered. \u2022Payload: What the virus does, besides spreading. The payload may involve damage or may involve benign but noticeable activity. During its lifetime, a typical virus goes through the following four phases:"}, {"id": "c2549a044dc910f3e151834d7bf77a64b70f9053", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 361, "start_line": 18, "end_line": 23, "text": "\u2022Dormant phase: The virus is idle. The virus will eventually be activated by some event, such as a date, the presence of another program or file, or the capacity of the disk exceeding some limit. Not all viruses have this stage. \u2022Propagation phase: The virus places a copy of itself into other programs or into certain system areas on the disk. The copy may not be identical to the propa-gating version; viruses often morph to evade detection. Each infected programwill now contain a clone of the virus, which will itself enter a propagation phase. \u2022Triggering phase: The virus is activated to perform the function for which it"}, {"id": "a823bfebcd627f50a772242eea865feff0ff8258", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 361, "start_line": 24, "end_line": 24, "text": "was intended. As with the dormant phase, the triggering phase can be causedby a variety of system events, including a count of the number of times thatthis copy of the virus has made copies of itself."}, {"id": "d3205f05b158643c3ee37a7b9097c693131fc1b1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 362, "start_line": 1, "end_line": 10, "text": "10.2 / VIRUSES 347 \u2022Execution phase: The function is performed. The function may be harmless, such as a message on the screen, or damaging, such as the destruction of programs and data files. Most viruses carry out their work in a manner that is specific to a particular oper- ating system and, in some cases, specific to a particular hardware platform. Thus, they are designed to take advantage of the details and weaknesses of particular systems. VIRUS STRUCTURE A virus can be prepended or postpended to an executable program, or it can be embedded in some other fashion. The key to its operation is that the infected program, when invoked, will first execute the virus code and thenexecute the original code of the program."}, {"id": "fa3efc48d2cf0bb3cfb78791951d7cebfd242df3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 362, "start_line": 11, "end_line": 13, "text": "A very general depiction of virus structure is shown in Figure 10.1 (based on [COHE94]). In this case, the virus code, V , is prepended to infected programs, and itis assumed that the entry point to the program, when invoked, is the first line of theprogram. The infected program begins with the virus code and works as follows. The first"}, {"id": "54fa6579d238ae91c1b1ea8bc33e240633417612", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 362, "start_line": 14, "end_line": 19, "text": "line of code is a jump to the main virus program. The second line is a special markerthat is used by the virus to determine whether or not a potential victim program hasalready been infected with this virus. When the program is invoked, control is imme-diately transferred to the main virus program. The virus program may first seek outuninfected executable files and infect them. Next, the virus may perform someaction, usually detrimental to the system. This action could be performed every timethe program is invoked, or it could be a logic bomb that triggers only under certainconditions. Finally, the virus transfers control to the original program. If the infection program V :/H11005 1234567; subroutine infect-executable :/H11005 {loop: file :/H11005 get-random-executable-file;"}, {"id": "14f765fb70d774bd86f7d7a5649a41bc3dbfc0a5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 362, "start_line": 20, "end_line": 30, "text": "if (first-line-of-file /H11005 1234567) then goto loop else prepend V to file; } subroutine do-damage :/H11005 {whatever damage is to be done} subroutine trigger-pulled :/H11005 {return true if some condition holds} main: main-program :/H11005 {infect-executable; if trigger-pulled then do-damage; goto next;}next: }{goto main; Figure 10.1 A Simple Virus"}, {"id": "2dc93e3b53167a9f5fd3b124a8932277a6cce0ee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 363, "start_line": 1, "end_line": 21, "text": "348 CHAPTER 10 / MALICIOUS SOFTWARE program CV :/H11005 {goto main; 01234567; subroutine infect-executable :/H11005 {loop: file :/H11005 get-random-executable-file; if (first-line-of-file /H11005 01234567) then goto loop; (1) compress file; (2) prepend CV to file; } main: main-program :/H11005 {if ask-permission then infect-executable; (3) uncompress rest-of-file; (4) run uncompressed file;} } Figure 10.2 Logic for a Compression Virus CV P1/H11541 P1/H11541 P2/H11541 P1 t1 t0P2 P2CV CV 12 34 Figure 10.3 A Compression Virusphase of the program is reasonably rapid, a user is unlikely to notice any difference between the execution of an infected and an uninfected program. A virus such as the one just described is easily detected because an infected"}, {"id": "f4b519d9a7708a128eed5a8007a953bf5db53014", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 363, "start_line": 22, "end_line": 26, "text": "version of a program is longer than the corresponding uninfected one. A way tothwart such a simple means of detecting a virus is to compress the executable file sothat both the infected and uninfected versions are of identical length. Figure 10.2[COHE94] shows in general terms the logic required. The key lines in this virus arenumbered, and Figure 10.3 [COHE94] illustrates the operation. We assume thatprogram P1 is infected with the virus CV . When this program is invoked, controlpasses to its virus, which performs the following steps: 1.For each uninfected file P 2that is found, the virus first compresses that file to produce , which is shorter than the original program by the size of the virus. 2.A copy of the virus is prepended to the compressed program."}, {"id": "2072a9ef2bcce53246b6e1aa2b2fd32fc1b26df7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 363, "start_line": 27, "end_line": 28, "text": "3.The compressed version of the original infected program, , is uncompressed. 4.The uncompressed original program is executed.P\u00bf1P\u00bf2"}, {"id": "c29bfe4ab3388ca655536e20857e9e06149467a9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 364, "start_line": 1, "end_line": 5, "text": "10.2 / VIRUSES 349 In this example, the virus does nothing other than propagate. As previously mentioned, the virus may include a logic bomb. INITIAL INFECTION Once a virus has gained entry to a system by infecting a single program, it is in a position to potentially infect some or all other executable files on"}, {"id": "416db57f5bb76a81bea74ce7aed42d69d39d8fae", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 364, "start_line": 6, "end_line": 7, "text": "that system when the infected program executes. Thus, viral infection can becompletely prevented by preventing the virus from gaining entry in the first place.Unfortunately, prevention is extraordinarily difficult because a virus can be part ofany program outside a system.Thus, unless one is content to take an absolutely barepiece of iron and write all one\u2019s own system and application programs, one isvulnerable. Many forms of infection can also be blocked by denying normal usersthe right to modify programs on the system. The lack of access controls on early PCs is a key reason why traditional"}, {"id": "e7c76fee691084c3bcc4bc3df023f944d909b087", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 364, "start_line": 8, "end_line": 9, "text": "machine code based viruses spread rapidly on these systems. In contrast, while it iseasy enough to write a machine code virus for UNIX systems, they were almostnever seen in practice because the existence of access controls on these systems pre-vented effective propagation of the virus. Traditional machine code based virusesare now less prevalent, because modern PC OSs do have more effective access con-trols. However, virus creators have found other avenues, such as macro and e-mailviruses, as discussed subsequently. Viruses Classification"}, {"id": "40fcee21334e166198a0dafe15adf39e86d97102", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 364, "start_line": 10, "end_line": 13, "text": "There has been a continuous arms race between virus writers and writers ofantivirus software since viruses first appeared. As effective countermeasures aredeveloped for existing types of viruses, newer types are developed. There is nosimple or universally agreed upon classification scheme for viruses, In this section,we follow [A YCO06] and classify viruses along two orthogonal axes: the type oftarget the virus tries to infect and the method the virus uses to conceal itself fromdetection by users and antivirus software. A virus classification by target includes the following categories: \u2022Boot sector infector: Infects a master boot record or boot record and spreads when a system is booted from the disk containing the virus."}, {"id": "5d3772632f8d070a7bb16cbdb2bd0f5302d31f75", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 364, "start_line": 14, "end_line": 20, "text": "\u2022File infector: Infects files that the operating system or shell consider to be executable. \u2022Macro virus: Infects files with macro code that is interpreted by an applica- tion. A virus classification by concealment strategy includes the following categories: \u2022Encrypted virus: A typical approach is as follows. A portion of the virus cre- ates a random encryption key and encrypts the remainder of the virus.The keyis stored with the virus. When an infected program is invoked, the virus usesthe stored random key to decrypt the virus. When the virus replicates, a differ-ent random key is selected. Because the bulk of the virus is encrypted with adifferent key for each instance, there is no constant bit pattern to observe."}, {"id": "66c670e55c12904a64b06257e7e0eabec257caee", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 365, "start_line": 1, "end_line": 10, "text": "350 CHAPTER 10 / MALICIOUS SOFTWARE \u2022Stealth virus: A form of virus explicitly designed to hide itself from detection by antivirus software. Thus, the entire virus, not just a payload is hidden. \u2022Polymorphic virus: A virus that mutates with every infection, making detec- tion by the \u201csignature\u201d of the virus impossible. \u2022Metamorphic virus: As with a polymorphic virus, a metamorphic virus mutates with every infection. The difference is that a metamorphic virus rewrites itself completely at each iteration, increasing the difficulty of detection.Metamorphic viruses may change their behavior as well as their appearance. One example of a stealth virus was discussed earlier: a virus that uses com- pression so that the infected program is exactly the same length as an uninfected"}, {"id": "7a6133a0bca0715ec84d3f81ea2bb94ce4b3c79a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 365, "start_line": 11, "end_line": 13, "text": "version. Far more sophisticated techniques are possible. For example, a virus canplace intercept logic in disk I/O routines, so that when there is an attempt to readsuspected portions of the disk using these routines, the virus will present back theoriginal, uninfected program.Thus, stealth is not a term that applies to a virus as such but, rather, refers to a technique used by a virus to evade detection. A polymorphic virus creates copies during replication that are functionally"}, {"id": "8103d8f5cc2f7e06c37b0a37bdfaf49b6b2c1ac6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 365, "start_line": 14, "end_line": 16, "text": "equivalent but have distinctly different bit patterns. As with a stealth virus, the pur-pose is to defeat programs that scan for viruses. In this case, the \u201csignature\u201d of thevirus will vary with each copy. To achieve this variation, the virus may randomlyinsert superfluous instructions or interchange the order of independent instructions.A more effective approach is to use encryption. The strategy of the encryption virusis followed. The portion of the virus that is responsible for generating keys andperforming encryption/decryption is referred to as the mutation engine . The muta- tion engine itself is altered with each use. Virus Kits"}, {"id": "5d62a1edd218769499308235f02a8725f8055760", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 365, "start_line": 17, "end_line": 20, "text": "Another weapon in the virus writers\u2019 armory is the virus-creation toolkit. Such atoolkit enables a relative novice to quickly create a number of different viruses.Although viruses created with toolkits tend to be less sophisticated than virusesdesigned from scratch, the sheer number of new viruses that can be generated usinga toolkit creates a problem for antivirus schemes. Macro Viruses In the mid-1990s, macro viruses became by far the most prevalent type of virus.Macro viruses are particularly threatening for a number of reasons: 1.A macro virus is platform independent. Many macro viruses infect MicrosoftWord documents or other Microsoft Office documents. Any hardware plat-form and operating system that supports these applications can be infected."}, {"id": "98d5869e8ae48109cb9accc82b6d5459be1fc2d8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 365, "start_line": 21, "end_line": 23, "text": "2.Macro viruses infect documents, not executable portions of code. Most of theinformation introduced onto a computer system is in the form of a documentrather than a program. 3.Macro viruses are easily spread. A very common method is by electronic mail. 4.Because macro viruses infect user documents rather than system programs, tra-ditional file system access controls are of limited use in preventing their spread."}, {"id": "826ea26fc33881f79a59d27ed76d4a2dd420d4ef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 366, "start_line": 1, "end_line": 5, "text": "10.3 / VIRUS COUNTERMEASURES 351 Macro viruses take advantage of a feature found in Word and other office applications such as Microsoft Excel, namely the macro. In essence, a macro is an executable program embedded in a word processing document or other type of file.Typically, users employ macros to automate repetitive tasks and thereby savekeystrokes. The macro language is usually some form of the Basic programminglanguage. A user might define a sequence of keystrokes in a macro and set it up sothat the macro is invoked when a function key or special short combination of keysis input. Successive releases of MS Office products provide increased protection"}, {"id": "1f014916503de8b418b447dec1a2cca1dbb878d5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 366, "start_line": 6, "end_line": 8, "text": "against macro viruses. For example, Microsoft offers an optional Macro VirusProtection tool that detects suspicious Word files and alerts the customer to thepotential risk of opening a file with macros. Various antivirus product vendors havealso developed tools to detect and correct macro viruses. As in other types ofviruses, the arms race continues in the field of macro viruses, but they no longer arethe predominant virus threat. E-Mail Viruses A more recent development in malicious software is the e-mail virus. The firstrapidly spreading e-mail viruses, such as Melissa, made use of a Microsoft Wordmacro embedded in an attachment. If the recipient opens the e-mail attachment, theWord macro is activated. Then"}, {"id": "3c068c93d6e4305ed34879caa27a6e24e31c0c78", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 366, "start_line": 9, "end_line": 14, "text": "1.The e-mail virus sends itself to everyone on the mailing list in the user\u2019s e-mailpackage. 2.The virus does local damage on the user\u2019s system. In 1999, a more powerful version of the e-mail virus appeared. This newer version can be activated merely by opening an e-mail that contains the virus rather than opening an attachment. The virus uses the Visual Basic scripting languagesupported by the e-mail package. Thus we see a new generation of malware that arrives via e-mail and uses e-mail"}, {"id": "c19698b6e2519fc1da96151e750f2256be5dead7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 366, "start_line": 15, "end_line": 17, "text": "software features to replicate itself across the Internet. The virus propagates itself assoon as it is activated (either by opening an e-mail attachment or by opening the e-mail) to all of the e-mail addresses known to the infected host. As a result, whereasviruses used to take months or years to propagate, they now do so in hours.This makesit very difficult for antivirus software to respond before much damage is done.Ultimately, a greater degree of security must be built into Internet utility and applica-tion software on PCs to counter the growing threat. 10.3 VIRUS COUNTERMEASURES Antivirus Approaches"}, {"id": "8939c8200c2837c347cc89d6e071390e34a98663", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 366, "start_line": 18, "end_line": 18, "text": "The ideal solution to the threat of viruses is prevention: Do not allow a virus to getinto the system in the first place, or block the ability of a virus to modify any filescontaining executable code or macros. This goal is, in general, impossible to achieve,"}, {"id": "fc29496f87f4e2773970160199b1c12b45aaa349", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 367, "start_line": 1, "end_line": 10, "text": "352 CHAPTER 10 / MALICIOUS SOFTWARE although prevention can reduce the number of successful viral attacks.The next best approach is to be able to do the following: \u2022Detection: Once the infection has occurred, determine that it has occurred and locate the virus. \u2022Identification: Once detection has been achieved, identify the specific virus that has infected a program. \u2022Removal: Once the specific virus has been identified, remove all traces of the virus from the infected program and restore it to its original state. Remove thevirus from all infected systems so that the virus cannot spread further. If detection succeeds but either identification or removal is not possible, then thealternative is to discard the infected file and reload a clean backup version."}, {"id": "69a063fb14f95fa4c3af8cb75df0d83d96ec1890", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 367, "start_line": 11, "end_line": 19, "text": "Advances in virus and antivirus technology go hand in hand. Early viruses were relatively simple code fragments and could be identified and purged withrelatively simple antivirus software packages. As the virus arms race has evolved,both viruses and, necessarily, antivirus software have grown more complex andsophisticated. [STEP93] identifies four generations of antivirus software: \u2022First generation: simple scanners \u2022Second generation: heuristic scanners \u2022Third generation: activity traps \u2022Fourth generation: full-featured protection A first-generation scanner requires a virus signature to identify a virus. The virus may contain \u201cwildcards\u201d but has essentially the same structure and bit pattern"}, {"id": "5f9431fbfe3377b46ca58eaaa5d04e1f5a848753", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 367, "start_line": 20, "end_line": 23, "text": "in all copies. Such signature-specific scanners are limited to the detection of knownviruses. Another type of first-generation scanner maintains a record of the length ofprograms and looks for changes in length. A second-generation scanner does not rely on a specific signature. Rather, the scanner uses heuristic rules to search for probable virus infection. One class of suchscanners looks for fragments of code that are often associated with viruses. Forexample, a scanner may look for the beginning of an encryption loop used in a poly-morphic virus and discover the encryption key. Once the key is discovered, thescanner can decrypt the virus to identify it, then remove the infection and returnthe program to service. Another second-generation approach is integrity checking. A checksum can"}, {"id": "bb591551cfb48014ee9ea77c06f8888f1bd9bf7e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 367, "start_line": 24, "end_line": 26, "text": "be appended to each program. If a virus infects the program without changing thechecksum, then an integrity check will catch the change. To counter a virus that issophisticated enough to change the checksum when it infects a program, anencrypted hash function can be used. The encryption key is stored separately fromthe program so that the virus cannot generate a new hash code and encrypt that. Byusing a hash function rather than a simpler checksum, the virus is prevented fromadjusting the program to produce the same hash code as before. Third-generation programs are memory-resident programs that identify a virus by its actions rather than its structure in an infected program. Such programs"}, {"id": "61a0510d1fd77203e974a52424de288c6f53aa8d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 368, "start_line": 1, "end_line": 6, "text": "10.3 / VIRUS COUNTERMEASURES 353 have the advantage that it is not necessary to develop signatures and heuristics for a wide array of viruses. Rather, it is necessary only to identify the small set of actionsthat indicate an infection is being attempted and then to intervene. Fourth-generation products are packages consisting of a variety of antivirus techniques used in conjunction. These include scanning and activity trap compo-nents. In addition, such a package includes access control capability, which limits theability of viruses to penetrate a system and then limits the ability of a virus to updatefiles in order to pass on the infection. The arms race continues. With fourth-generation packages, a more compre-"}, {"id": "98741f1374f8c33b7b8bdc574246eb2e52c5e3fa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 368, "start_line": 7, "end_line": 14, "text": "hensive defense strategy is employed, broadening the scope of defense to moregeneral-purpose computer security measures. Advanced Antivirus Techniques More sophisticated antivirus approaches and products continue to appear. In thissubsection, we highlight some of the most important. G ENERIC DECRYPTION Generic decryption (GD) technology enables the antivirus program to easily detect even the most complex polymorphic viruses while maintaining fast scanning speeds [NACH97]. Recall that when a file containing apolymorphic virus is executed, the virus must decrypt itself to activate. In order todetect such a structure, executable files are run through a GD scanner, whichcontains the following elements: \u2022CPU emulator: A software-based virtual computer. Instructions in an exe-"}, {"id": "2fddde3c995345bb40188264dd24feeca7896ecb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 368, "start_line": 15, "end_line": 19, "text": "cutable file are interpreted by the emulator rather than executed on theunderlying processor. The emulator includes software versions of all registersand other processor hardware, so that the underlying processor is unaffectedby programs interpreted on the emulator. \u2022Virus signature scanner: A module that scans the target code looking for known virus signatures. \u2022Emulation control module: Controls the execution of the target code. At the start of each simulation, the emulator begins interpreting instructions"}, {"id": "1e13c4a212c34b5993d7083ce45982b7bb779117", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 368, "start_line": 20, "end_line": 23, "text": "in the target code, one at a time. Thus, if the code includes a decryption routine thatdecrypts and hence exposes the virus, that code is interpreted. In effect, the virusdoes the work for the antivirus program by exposing the virus. Periodically, the con-trol module interrupts interpretation to scan the target code for virus signatures. During interpretation, the target code can cause no damage to the actual per- sonal computer environment, because it is being interpreted in a completely con-trolled environment. The most difficult design issue with a GD scanner is to determine how long to"}, {"id": "31755d57ba3bed36cf08a6035d33f9fc788a6c89", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 368, "start_line": 24, "end_line": 24, "text": "run each interpretation. Typically, virus elements are activated soon after a programbegins executing, but this need not be the case. The longer the scanner emulates aparticular program, the more likely it is to catch any hidden viruses. However, theantivirus program can take up only a limited amount of time and resources beforeusers complain of degraded system performance."}, {"id": "5b463fc4811e5812ad5034ec92b0903bd73a705a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 369, "start_line": 1, "end_line": 5, "text": "354 CHAPTER 10 / MALICIOUS SOFTWARE DIGITAL IMMUNE SYSTEM The digital immune system is a comprehensive approach to virus protection developed by IBM [KEPH97a, KEPH97b, WHIT99] and subsequently refined by Symantec [SYMA01]. The motivation for this developmenthas been the rising threat of Internet-based virus propagation. We first say a fewwords about this threat and then summarize IBM\u2019s approach. Traditionally, the virus threat was characterized by the relatively slow spread of"}, {"id": "fb4b003d2ebb2e0bb7498b74fff2f3d623bfaa93", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 369, "start_line": 6, "end_line": 11, "text": "new viruses and new mutations. Antivirus software was typically updated on amonthly basis, and this was sufficient to control the problem. Also traditionally, theInternet played a comparatively small role in the spread of viruses. But as [CHES97]points out, two major trends in Internet technology have had an increasing impact onthe rate of virus propagation in recent years: \u2022Integrated mail systems: Systems such as Lotus Notes and Microsoft Outlook make it very simple to send anything to anyone and to work with objects thatare received. \u2022Mobile-program systems: Capabilities such as Java and ActiveX allow programs to move on their own from one system to another. In response to the threat posed by these Internet-based capabilities, IBM has"}, {"id": "a47cabf0b440ccd2a82b8ac1edab4fa539eae4d7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 369, "start_line": 12, "end_line": 14, "text": "developed a prototype digital immune system. This system expands on the use of program emulation discussed in the preceding subsection and provides a general-purpose emulation and virus-detection system. The objective of this system is toprovide rapid response time so that viruses can be stamped out almost as soon asthey are introduced. When a new virus enters an organization, the immune systemautomatically captures it, analyzes it, adds detection and shielding for it, removes it,and passes information about that virus to systems running IBM AntiVirus so that itcan be detected before it is allowed to run elsewhere. Figure 10.4 illustrates the typical steps in digital immune system operation:"}, {"id": "f5cf2ff5e3b4c85b1f4b4dbdfe0363960c915258", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 369, "start_line": 15, "end_line": 17, "text": "1.A monitoring program on each PC uses a variety of heuristics based on systembehavior, suspicious changes to programs, or family signature to infer that avirus may be present.The monitoring program forwards a copy of any programthought to be infected to an administrative machine within the organization. 2.The administrative machine encrypts the sample and sends it to a central virusanalysis machine. 3.This machine creates an environment in which the infected program can besafely run for analysis.Techniques used for this purpose include emulation, or thecreation of a protected environment within which the suspect program can beexecuted and monitored. The virus analysis machine then produces a prescrip-tion for identifying and removing the virus."}, {"id": "5f010b0c083957676e64920a8b03b05b87d7e0e7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 369, "start_line": 18, "end_line": 21, "text": "4.The resulting prescription is sent back to the administrative machine. 5.The administrative machine forwards the prescription to the infected client. 6.The prescription is also forwarded to other clients in the organization. 7.Subscribers around the world receive regular antivirus updates that protectthem from the new virus."}, {"id": "96e623ca3466e3df556b96b32293c21b7fc8bdd1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 370, "start_line": 1, "end_line": 9, "text": "10.3 / VIRUS COUNTERMEASURES 355 The success of the digital immune system depends on the ability of the virus analysis machine to detect new and innovative virus strains. By constantly analyzing and monitoring the viruses found in the wild, it should be possible to continuallyupdate the digital immune software to keep up with the threat. B EHAVIOR -BLOCKING SOFTW ARE Unlike heuristics or fingerprint-based scanners, behavior-blocking software integrates with the operating system of a host computer and monitors program behavior in real-time for malicious actions [CONR02,NACH02].The behavior blocking software then blocks potentially malicious actionsbefore they have a chance to affect the system. Monitored behaviors can include \u2022Attempts to open, view, delete, and/or modify files;"}, {"id": "e4e050cdc5a37675e5769a809f2e8327b68f188e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 370, "start_line": 10, "end_line": 16, "text": "\u2022Attempts to format disk drives and other unrecoverable disk operations; \u2022Modifications to the logic of executable files or macros; \u2022Modification of critical system settings, such as start-up settings; \u2022Scripting of e-mail and instant messaging clients to send executable content; and \u2022Initiation of network communications. Figure 10.5 illustrates the operation of a behavior blocker. Behavior-blocking software runs on server and desktop computers and is instructed through policies"}, {"id": "5908c34b3873a21d7777123930f464ff92e59223", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 370, "start_line": 17, "end_line": 49, "text": "set by the network administrator to let benign actions take place but to intercedewhen unauthorized or suspicious actions occur. The module blocks any suspicioussoftware from executing. A blocker isolates the code in a sandbox, which restrictsthe code\u2019s access to various OS resources and applications. The blocker then sendsan alert. Because a behavior blocker can block suspicious software in real-time, it has an advantage over such established antivirus detection techniques as fingerprinting orDerive prescriptionExtract signatureVirus analysis machine3 21 Analyze virus behavior and structureAdministrative machine Administrative machine Individual userVirus- infected client machine Client machine ClientClient ClientClient machineClient machine Private network Other private network5 6 4 7"}, {"id": "2a9d1c824a275ab06e634bd841211c1355b188d0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 370, "start_line": 50, "end_line": 50, "text": "Figure 10.4 Digital Immune System"}, {"id": "3fda30bf764aabe4b835d9ec4801004eca0038b0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 371, "start_line": 1, "end_line": 25, "text": "356 CHAPTER 10 / MALICIOUS SOFTWARE InternetFirewall Server running behavior-blocking softwareAdministratorSandbox1. Administrator sets acceptable software behavior policies and uploads them to a server. Policies can also be uploaded to desktops.3. Behavior-blocking software at server flags suspicious code. The blocker \"sandboxes\" the suspicious software to prevent it from proceeding 2. Malicious software manages to make it through the f irewall. 4. Server alerts administrator that suspicious code has been identif ied and sandboxed, awa iting administrator's decision on whether the code should be removed or allowed to run.! Figure 10.5 Behavior-Blocking Software Operation heuristics. While there are literally trillions of different ways to obfuscate and"}, {"id": "f6bfd52bb05595f08d0fc9a3757487ed38d40d98", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 371, "start_line": 26, "end_line": 27, "text": "rearrange the instructions of a virus or worm, many of which will evade detection by afingerprint scanner or heuristic, eventually malicious code must make a well-definedrequest to the operating system. Given that the behavior blocker can intercept all suchrequests, it can identify and block malicious actions regardless of how obfuscated theprogram logic appears to be. Behavior blocking alone has limitations. Because the malicious code must run"}, {"id": "c257bea6357f5efdd7c84c3e7e42df0b33b6eeb2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 371, "start_line": 28, "end_line": 29, "text": "on the target machine before all its behaviors can be identified, it can cause harmbefore it has been detected and blocked. For example, a new virus might shuffle anumber of seemingly unimportant files around the hard drive before infecting a sin-gle file and being blocked. Even though the actual infection was blocked, the usermay be unable to locate his or her files, causing a loss to productivity or possiblyworse. 10.4 WORMS"}, {"id": "209faf95ef46866d85ded65d0e0f4f7ed3d03d66", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 371, "start_line": 30, "end_line": 30, "text": "A worm is a program that can replicate itself and send copies from computer tocomputer across network connections. Upon arrival, the worm may be activated toreplicate and propagate again. In addition to propagation, the worm usuallyperforms some unwanted function. An e-mail virus has some of the characteristicsof a worm because it propagates itself from system to system. However, we can still"}, {"id": "d829a5a6941832e443a12324aa61918b7015b9a3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 372, "start_line": 1, "end_line": 7, "text": "10.4 / WORMS 357 classify it as a virus because it uses a document modified to contain viral macro content and requires human action. A worm actively seeks out more machines toinfect and each machine that is infected serves as an automated launching pad forattacks on other machines. The concept of a computer worm was introduced in John Brunner\u2019s 1975 SF novel The Shockwave Rider. The first known worm implementation was done in Xerox Palo Alto Labs in the early 1980s. It was nonmalicious, searching for idlesystems to use to run a computationally intensive task. Network worm programs use network connections to spread from system to"}, {"id": "29fe571fc0f4398b4c8ac1ed378df126c4f4d4f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 372, "start_line": 8, "end_line": 15, "text": "system. Once active within a system, a network worm can behave as a computervirus or bacteria, or it could implant Trojan horse programs or perform any numberof disruptive or destructive actions. To replicate itself, a network worm uses some sort of network vehicle. Examples include the following: \u2022Electronic mail facility: A worm mails a copy of itself to other systems, so that its code is run when the e-mail or an attachment is received or viewed. \u2022Remote execution capability: A worm executes a copy of itself on another system, either using an explicit remote execution facility or by exploiting aprogram flaw in a network service to subvert its operations. \u2022Remote login capability: A worm logs onto a remote system as a user and then"}, {"id": "017aa926c8bb2fe03dee46afcfaf50ec6ea8673b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 372, "start_line": 16, "end_line": 25, "text": "uses commands to copy itself from one system to the other, where it thenexecutes. The new copy of the worm program is then run on the remote system where, in addition to any functions that it performs at that system, it continues to spread in the same fashion. A network worm exhibits the same characteristics as a computer virus: a dormant phase, a propagation phase, a triggering phase, and an execution phase.Thepropagation phase generally performs the following functions: 1.Search for other systems to infect by examining host tables or similar reposi-tories of remote system addresses. 2.Establish a connection with a remote system. 3.Copy itself to the remote system and cause the copy to be run. The network worm may also attempt to determine whether a system has"}, {"id": "157c3e804072b9b8034721e8d16312add2d1f5a9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 372, "start_line": 26, "end_line": 30, "text": "previously been infected before copying itself to the system. In a multiprogramming system, it may also disguise its presence by naming itself as a system process or usingsome other name that may not be noticed by a system operator. As with viruses, network worms are difficult to counter. The Morris Worm Until the current generation of worms, the best known was the worm released ontothe Internet by Robert Morris in 1988 [ORMA03].The Morris worm was designed tospread on UNIX systems and used a number of different techniques for propagation."}, {"id": "878ce95bea07c8bf4b6008e6619ede2a9bf30e8a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 373, "start_line": 1, "end_line": 3, "text": "358 CHAPTER 10 / MALICIOUS SOFTWARE When a copy began execution, its first task was to discover other hosts known to this host that would allow entry from this host.The worm performed this task by examin-ing a variety of lists and tables, including system tables that declared which othermachines were trusted by this host, users\u2019 mail forwarding files, tables by which usersgave themselves permission for access to remote accounts, and from a program thatreported the status of network connections. For each discovered host, the worm trieda number of methods for gaining access:"}, {"id": "0db9839f36553020c42cf915e8317dccbca20c7b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 373, "start_line": 4, "end_line": 10, "text": "1.It attempted to log on to a remote host as a legitimate user. In this method, theworm first attempted to crack the local password file and then used thediscovered passwords and corresponding user IDs. The assumption was thatmany users would use the same password on different systems. To obtain thepasswords, the worm ran a password-cracking program that tried a.Each user\u2019s account name and simple permutations of it b.A list of 432 built-in passwords that Morris thought to be likelycandidates 2 c.All the words in the local system dictionary 2.It exploited a bug in the UNIX finger protocol, which reports the whereabouts ofa remote user. 3.It exploited a trapdoor in the debug option of the remote process that receivesand sends mail."}, {"id": "b421dc20e9528a8b50a3d9820c0ae2d67287bfdf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 373, "start_line": 11, "end_line": 14, "text": "If any of these attacks succeeded, the worm achieved communication with the operating system command interpreter. It then sent this interpreter a short boot- strap program, issued a command to execute that program, and then logged off. Thebootstrap program then called back the parent program and downloaded theremainder of the worm. The new worm was then executed. Worm Propagation Model"}, {"id": "969127ded5d95f7de81df8cc4c9b84f5c716fed2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 373, "start_line": 15, "end_line": 15, "text": "[ZOU05] describes a model for worm propagation based on an analysis of recentworm attacks. The speed of propagation and the total number of hosts infecteddepend on a number of factors, including the mode of propagation, the vulnerabilityor vulnerabilities exploited, and the degree of similarity to preceding attacks. Forthe latter factor, an attack that is a variation of a recent previous attack may becountered more effectively than a more novel attack. Figure 10.6 shows the dynam-ics for one typical set of parameters. Propagation proceeds through three phases. Inthe initial phase, the number of hosts increases exponentially. To see that this is so,consider a simplified case in which a worm is launched from a single host and infectstwo nearby hosts. Each of these hosts infects two more hosts, and so on. This resultsin exponential growth. After a time, infecting hosts waste some time attackingalready infected hosts, which reduces the rate of infection. During this middle phase,growth is approximately linear, but the rate of infection is rapid. When most vulner-able computers have been infected, the attack enters a slow finish phase as theworm seeks out those remaining hosts that are difficult to identify."}, {"id": "dc2a0a3c7af139ec1345c59b2ec9aa356791e73c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 373, "start_line": 16, "end_line": 16, "text": "2The complete list is provided at this book\u2019s Web site."}, {"id": "ebfc4ff6a039be308dd236209ee9d12aa780c174", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 374, "start_line": 1, "end_line": 15, "text": "10.4 / WORMS 359 0.5 100Slow start phaseSlow finish phase Fast spread phase 200 300 Time t (minutes)Number of infected hosts 400 500 60011.522.533.545.55105 Figure 10.6 Worm Propagation Model Clearly, the objective in countering a worm is to catch the worm in its slow start phase, at a time when few hosts have been infected. Recent Worm Attacks The contemporary era of worm threats began with the release of the Code Red"}, {"id": "cc18949963db8d9a7567bbe88b92c5e824a113fd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 374, "start_line": 16, "end_line": 17, "text": "worm in July of 2001. Code Red exploits a security hole in the Microsoft InternetInformation Server (IIS) to penetrate and spread. It also disables the system filechecker in Windows.The worm probes random IP addresses to spread to other hosts.During a certain period of time, it only spreads. It then initiates a denial-of-serviceattack against a government Web site by flooding the site with packets from numer-ous hosts. The worm then suspends activities and reactivates periodically. In thesecond wave of attack, Code Red infected nearly 360,000 servers in 14 hours. In addi-tion to the havoc it caused at the targeted server, Code Red consumed enormousamounts of Internet capacity, disrupting service. Code Red II is a variant that targets Microsoft IISs. In addition, this newer"}, {"id": "b9c06eeaf9d8bbd7823fd80408c5f58241e7e8d8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 374, "start_line": 18, "end_line": 20, "text": "worm installs a backdoor, allowing a hacker to remotely execute commands onvictim computers. In early 2003, the SQL Slammer worm appeared.This worm exploited a buffer overflow vulnerability in Microsoft SQL server. The Slammer was extremely com-pact and spread rapidly, infecting 90% of vulnerable hosts within 10 minutes. Late2003 saw the arrival of the Sobig.f worm, which exploited open proxy servers to turninfected machines into spam engines. At its peak, Sobig.f reportedly accounted forone in every 17 messages and produced more than one million copies of itself withinthe first 24 hours."}, {"id": "8352d0090c7601476430a39a0599fc263a1a0303", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 375, "start_line": 1, "end_line": 5, "text": "360 CHAPTER 10 / MALICIOUS SOFTWARE Mydoom is a mass-mailing e-mail worm that appeared in 2004. It followed a growing trend of installing a backdoor in infected computers, thereby enabling hackers to gain remote access to data such as passwords and credit card numbers.Mydoom replicated up to 1000 times per minute and reportedly flooded theInternet with 100 million infected messages in 36 hours. A recent worm that rapidly became prevalent in a variety of versions is the"}, {"id": "2ef41dc686a80f49f017ecbff290916db46e14b7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 375, "start_line": 6, "end_line": 11, "text": "Warezov family of worms [KIRK06]. When the worm is launched, it creates severalexecutable in system directories and sets itself to run every time Windows starts, bycreating a registry entry. Warezov scans several types of files for e-mail addressesand sends itself as an e-mail attachment. Some variants are capable of downloadingother malware, such as Trojan horses and adware. Many variants disable security-related products and/or disable their updating capability. State of Worm Technology The state of the art in worm technology includes the following: \u2022Multiplatform: Newer worms are not limited to Windows machines but can attack a variety of platforms, especially the popular varieties of UNIX. \u2022Multi-exploit: New worms penetrate systems in a variety of ways, using"}, {"id": "0dfba01b68c941a9d660e25117f901b2647a33cb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 375, "start_line": 12, "end_line": 19, "text": "exploits against Web servers, browsers, e-mail, file sharing, and other network-based applications. \u2022Ultrafast spreading: One technique to accelerate the spread of a worm is to conduct a prior Internet scan to accumulate Internet addresses of vulnerablemachines. \u2022Polymorphic: To evade detection, skip past filters, and foil real-time analysis, worms adopt the virus polymorphic technique. Each copy of the worm hasnew code generated on the fly using functionally equivalent instructions andencryption techniques. \u2022Metamorphic: In addition to changing their appearance, metamorphic worms have a repertoire of behavior patterns that are unleashed at different stages ofpropagation. \u2022Transport vehicles: Because worms can rapidly compromise a large number of"}, {"id": "51f81254aa3feee910f8d3d1e727d344612012aa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 375, "start_line": 20, "end_line": 24, "text": "systems, they are ideal for spreading other distributed attack tools, such asdistributed denial of service bots. \u2022Zero-day exploit: To achieve maximum surprise and distribution, a worm should exploit an unknown vulnerability that is only discovered by the generalnetwork community when the worm is launched. Mobile Phone Worms Worms first appeared on mobile phones in 2004. These worms communicatethrough Bluetooth wireless connections or via the multimedia messaging service(MMS). The target is the smartphone, which is a mobile phone that permits users toinstall software applications from sources other than the cellular network operator.Mobile phone malware can completely disable the phone, delete data on the phone,or force the device to send costly messages to premium-priced numbers."}, {"id": "5c2e18255fc3391dc4290d60f238138a3b2e910f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 376, "start_line": 1, "end_line": 6, "text": "10.4 / WORMS 361 An example of a mobile phone worm is CommWarrior, which was launched in 2005. This worm replicates by means of Bluetooth to other phones in the receiving area. It also sends itself as an MMS file to numbers in the phone\u2019s address book andin automatic replies to incoming text messages and MMS messages. In addition, itcopies itself to the removable memory card and inserts itself into the programinstallation files on the phone. Worm Countermeasures There is considerable overlap in techniques for dealing with viruses and worms.Once a worm is resident on a machine, antivirus software can be used to detect it. Inaddition, because worm propagation generates considerable network activity, net-work activity and usage monitoring can form the basis of a worm defense."}, {"id": "0720939bb86a9d1d4d2286de2d7b2eb94cf7b49d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 376, "start_line": 7, "end_line": 16, "text": "To begin, let us consider the requirements for an effective worm countermea- sure scheme: \u2022Generality: The approach taken should be able to handle a wide variety of worm attacks, including polymorphic worms. \u2022Timeliness: The approach should respond quickly so as to limit the number of infected systems and the number of generated transmissions from infectedsystems. \u2022Resiliency: The approach should be resistant to evasion techniques employed by attackers to evade worm countermeasures. \u2022Minimal denial-of-service costs: The approach should result in minimal reduc- tion in capacity or service due to the actions of the countermeasure software.That is, in an attempt to contain worm propagation, the countermeasureshould not significantly disrupt normal operation."}, {"id": "dc6b176722b3b6fdec948e3e8228d715bc380dd0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 376, "start_line": 17, "end_line": 28, "text": "\u2022Transparency: The countermeasure software and devices should not require modification to existing (legacy) OSs, application software, and hardware. \u2022Global and local coverage: The approach should be able to deal with attack sources both from outside and inside the enterprise network. No existing worm countermeasure scheme appears to satisfy all these require- ments. Thus, administrators typically need to use multiple approaches in defending against worm attacks. C OUNTERMEASURE APPROACHES Following [JHI07], we list six classes of worm defense: A.Signature-based worm scan filtering: This type of approach generates a worm signature, which is then used to prevent worm scans from entering/leaving a"}, {"id": "4c89b8344c6f8b84ac04e6de59199009a0026861", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 376, "start_line": 29, "end_line": 31, "text": "network/host. Typically, this approach involves identifying suspicious flowsand generating a worm signature. This approach is vulnerable to the use ofpolymorphic worms: Either the detection software misses the worm or, if it issufficiently sophisticated to deal with polymorphic worms, the scheme maytake a long time to react. [NEWS05] is an example of this approach. B.Filter-based worm containment: This approach is similar to class A but focuses on worm content rather than a scan signature. The filter checks a message to"}, {"id": "ea85366b591e399794b617cbfdea8a995f7c563e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 377, "start_line": 1, "end_line": 5, "text": "362 CHAPTER 10 / MALICIOUS SOFTWARE determine if it contains worm code. An example is Vigilante [COST05], which relies on collaborative worm detection at end hosts. This approach can be quiteeffective but requires efficient detection algorithms and rapid alert dissemination. C.Payload-classification-based worm containment: These network-based tech- niques examine packets to see if they contain a worm.Various anomaly detectiontechniques can be used, but care is needed to avoid high levels of false positivesor negatives. An example of this approach is reported in [CHIN05], which looksfor exploit code in network flows. This approach does not generate signaturesbased on byte patterns but rather looks for control and data flow structures thatsuggest an exploit."}, {"id": "4a3c0e4ce9fe57b712b5635c2f75b1769b2f8fdf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 377, "start_line": 6, "end_line": 8, "text": "D.Threshold random walk (TRW) scan detection: TRW exploits randomness in picking destinations to connect to as a way of detecting if a scanner is inoperation [JUNG04]. TRW is suitable for deployment in high-speed, low-costnetwork devices. It is effective against the common behavior seen in wormscans. E.Rate limiting: This class limits the rate of scanlike traffic from an infected host."}, {"id": "c9a5a0eddb35456a69f07d81d8dd0030eb02260b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 377, "start_line": 9, "end_line": 10, "text": "Various strategies can be used, including limiting the number of new machines ahost can connect to in a window of time, detecting a high connection failure rate,and limiting the number of unique IP addresses a host can scan in a window oftime. [CHEN04] is an example. This class of countermeasures may introducelonger delays for normal traffic. This class is also not suited for slow, stealthyworms that spread slowly to avoid detection based on activity level. F.Rate halting: This approach immediately blocks outgoing traffic when a"}, {"id": "82872b7d5477c892426281aa7e77c99620f2fd79", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 377, "start_line": 11, "end_line": 15, "text": "threshold is exceeded either in outgoing connection rate or diversity of con-nection attempts [JHI07]. The approach must include measures to quicklyunblock mistakenly blocked hosts in a transparent way. Rate halting can inte-grate with a signature- or filter-based approach so that once a signature or fil-ter is generated, every blocked host can be unblocked. Rate halting appears tooffer a very effective countermeasure. As with rate limiting, rate halting tech-niques are not suitable for slow, stealthy worms. We look now at two approaches in more detail. P ROACTIVE WORM CONTAINMENT The PWC scheme [JHI07] is host based rather than being based on network devices such as honeypots, firewalls, and network"}, {"id": "24c6bd86922fd8fa17ae496b1c46df5431aec828", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 377, "start_line": 16, "end_line": 17, "text": "IDSs. PWC is designed to address the threat of worms that spread rapidly. Thesoftware on a host looks for surges in the rate of frequency of outgoing connectionattempts and the diversity of connections to remote hosts. When such a surge isdetected, the software immediately blocks its host from further connectionattempts. The developers estimate that only a few dozen infected packets may besent out to other systems before PWC quarantines that attack. In contrast, theSlammer worm on average sent out 4000 infected packets per second. A deployed PWC system consists of a PWC manager and PWC agents in"}, {"id": "23ebc063a8ce092ac43d9d7f6a6fbacb069e1234", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 377, "start_line": 18, "end_line": 18, "text": "hosts. Figure 10.7 is an example of an architecture that includes PWC. In this exam-ple, the security manager, signature extractor, and PWC manager are implementedin a single network device. In practice, these three modules could be implemented astwo or three separate devices."}, {"id": "140d242ed438b1571eb2640587a9495ba67ca1d5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 378, "start_line": 1, "end_line": 5, "text": "10.4 / WORMS 363 The operation of the PWC architecture can be described as follows: A.A PWC agent monitors outgoing traffic for scan activity, determined by a surge in UDP or TCP connection attempts to remote hosts. If a surge isdetected, the agent performs the following actions: (1) issues an alert to localsystem; (2) blocks all outgoing connection attempts; (3) transmits the alert tothe PWC manager; and (4) starts a relaxation analysis, described in D. B.A PWC manager receives an alert. The PWC propagates the alert to all otheragents (beside the originating agent)."}, {"id": "66473d6c890406c8cf6fa9d080896d5faa7ecf8b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 378, "start_line": 6, "end_line": 6, "text": "C.The host receives an alert. The agent must decide whether to ignore the alert, inthe following way. If the time since the last incoming packet has been sufficientlylong so that the agent would have detected a worm if infected, then the alert isignored. Otherwise, the agent assumes that it might be infected and performs thefollowing actions: (1) blocks all outgoing connection attempts from the specificalerting port; and (2) starts a relaxation analysis, described in D."}, {"id": "bf3fcb9597200d11e1bd1f80f95662165a1acd8b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 378, "start_line": 7, "end_line": 17, "text": "D.Relaxation analysis is performed as follows.An agent monitors outgoing activ-ity for a fixed window of time to see if outgoing connections exceed a thresh-old. If so, blockage is continued and relaxation analysis is performed foranother window of time. This process continues until the outgoing connectionrate drops below the threshold, at which time the agent removes the block. Ifthe threshold continues to be exceeded over a sufficient number of relaxationwindows, the agent isolates the host and reports to the PWC manager.Internet external firewall Worm management center \u2014Security manager \u2014Signature extractor \u2014PWC manager hostshosts routerLAN switch LAN switch Figure 10.7 Example PWC Deployment"}, {"id": "e47815b0514790dcd71c7f54c97b3f868f7a3189", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 379, "start_line": 1, "end_line": 8, "text": "364 CHAPTER 10 / MALICIOUS SOFTWARE Meanwhile, a separate aspect of the worm defense system is in operation. The signature extractor functions as a passive sensor that monitors all traffic and attempts to detect worms by signature analysis. When a new worm is detected, itssignature is sent by the security manager to the firewall to filter out any more copiesof the worm. In addition, the PWC manager sends the signature to PWC agents,enabling them to immediately recognize infection and disable the worm. N ETWORK -BASED WORM DEFENSE The key element of a network-based worm defense is worm monitoring software. Consider an enterprise network at a site, consisting of one or an interconnected set of LANs. Two types of monitoringsoftware are needed:"}, {"id": "33f3b5273fff24f7744d10d081d8dc304efe3514", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 379, "start_line": 9, "end_line": 11, "text": "\u2022Ingress monitors: These are located at the border between the enterprise net- work and the Internet.They can be part of the ingress filtering software of a bor-der router or external firewall or a separate passive monitor. A honeypot canalso capture incoming worm traffic. An example of a detection technique for aningress monitor is to look for incoming traffic to unused local IP addresses. \u2022Egress monitors: These can be located at the egress point of individual LANs"}, {"id": "3a7d8c9ed5b2fbe68e0869c56f0098a8f07aee04", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 379, "start_line": 12, "end_line": 14, "text": "on the enterprise network as well as at the border between the enterprise net-work and the Internet. In the former case, the egress monitor can be part ofthe egress filtering software of a LAN router or switch. As with ingress moni-tors, the external firewall or a honeypot can house the monitoring software.Indeed, the two types of monitors can be collocated. The egress monitor isdesigned to catch the source of a worm attack by monitoring outgoing trafficfor signs of scanning or other suspicious behavior. Worm monitors can act in the manner of intrusion detection systems and gen- erate alerts to a central administrative system. It is also possible to implement a sys-"}, {"id": "a031064d975dc523769a7493c2d27ece259b4c9a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 379, "start_line": 15, "end_line": 19, "text": "tem that attempts to react in real time to a worm attack, so as to counter zero-dayexploits effectively. This is similar to the approach taken with the digital immunesystem (Figure 10.4). Figure 10.8 shows an example of a worm countermeasure architecture [SIDI05]. The system works as follows (numbers in figure refer to numbers in the following list): 1.Sensors deployed at various network locations detect a potential worm. Thesensor logic can also be incorporated in IDS sensors. 2.The sensors send alerts to a central server that correlates and analyzes the incom-ing alerts. The correlation server determines the likelihood that a worm attack isbeing observed and the key characteristics of the attack."}, {"id": "375a019c9b7f384c7fd793a0aaa18bfb40d3cdbb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 379, "start_line": 20, "end_line": 23, "text": "3.The server forwards its information to a protected environment, where thepotential worm may be sandboxed for analysis and testing. 4.The protected system tests the suspicious software against an appropriatelyinstrumented version of the targeted application to identify the vulnerability. 5.The protected system generates one or more software patches and tests these. 6.If the patch is not susceptible to the infection and does not compromise theapplication\u2019s functionality, the system sends the patch to the application hostto update the targeted application."}, {"id": "4f405ec8987c9133bcec50876ac3ae4794a6f01b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 380, "start_line": 1, "end_line": 27, "text": "10.5 / DISTRIBUTED DENIAL OF SERVICE ATTACKS 365 Internet Remote sensorHoneypotPassive sensorFirewall sensor Correlation server Application server Instrumented applicationsSandboxed environmentEnterprise network Hypothesis testing and analysis Patch generation3. Forward features 5. Possible f ix generation6. Application update 4. Vulnerability testing and identif ication1. Worm scans or infection attempts 2. Notif ications Figure 10.8 Placement of Worm Monitors The success of such an automated patching system depends on maintaining a current list of potential attacks and developing general tools for patching software to counter such attacks. Examples of approaches are as follows: \u2022Increasing the size of buffers"}, {"id": "fa4f15d57e1d1c60b5cb79e7371cc0b7d1c31afd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 380, "start_line": 28, "end_line": 30, "text": "\u2022Using minor code-randomization techniques [BHAT03] so that the infectionno longer works because the code to be attacked is no longer in the same formand location \u2022Adding filters to the application that enable it to recognize and ignore an attack 10.5 DISTRIBUTED DENIAL OF SERVICE ATTACKS"}, {"id": "d93d87710b91ff2d2de13438d71661d15c81423d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 380, "start_line": 31, "end_line": 31, "text": "Distributed denial of service (DDoS) attacks present a significant security threat tocorporations, and the threat appears to be growing [VIJA02]. In one study, coveringa three-week period in 2001, investigators observed more than 12,000 attacksagainst more than 5000 distinct targets, ranging from well-known ecommerce com-panies such as Amazon and Hotmail to small foreign ISPs and dial-up connections[MOOR01]. DDoS attacks make computer systems inaccessible by flooding servers,networks, or even end user systems with useless traffic so that legitimate users canno longer gain access to those resources. In a typical DDoS attack, a large number of"}, {"id": "2febc3618e16e629a6b68411e1838dd470920553", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 381, "start_line": 1, "end_line": 3, "text": "compromised hosts are amassed to send useless packets. In recent years, the attack methods and tools have become more sophisticated, effective, and more difficult totrace to the real attackers, while defense technologies have been unable to with-stand large-scale attacks [CHAN02]. A denial of service (DoS) attack is an attempt to prevent legitimate users of a"}, {"id": "a070e188f236be52df1f8aa226418a85702bc9e5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 381, "start_line": 4, "end_line": 5, "text": "service from using that service. When this attack comes from a single host or net-work node, then it is simply referred to as a DoS attack. A more serious threat isposed by a DDoS attack. In a DDoS attack, an attacker is able to recruit a numberof hosts throughout the Internet to simultaneously or in a coordinated fashionlaunch an attack upon the target.This section is concerned with DDoS attacks. First,we look at the nature and types of attacks. Next, we examine means by which anattacker is able to recruit a network of hosts for attack launch. Finally, this sectionlooks at countermeasures. DDoS Attack Description"}, {"id": "2db3e71f048668235a581fc701d767db62cd99de", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 381, "start_line": 6, "end_line": 10, "text": "A DDoS attack attempts to consume the target\u2019s resources so that it cannot provideservice. One way to classify DDoS attacks is in terms of the type of resource that isconsumed. Broadly speaking, the resource consumed is either an internal hostresource on the target system or data transmission capacity in the local network towhich the target is attacked. A simple example of an internal resource attack is the SYN flood attack. Figure 10.9a shows the steps involved: 1.The attacker takes control of multiple hosts over the Internet, instructingthem to contact the target Web server. 2.The slave hosts begin sending TCP/IP SYN (synchronize/initialization) packets,with erroneous return IP address information, to the target."}, {"id": "94b165edd01b906b8216784988933fa3448fc622", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 381, "start_line": 11, "end_line": 14, "text": "3.Each SYN packet is a request to open a TCP connection. For each suchpacket, the Web server responds with a SYN/ACK (synchronize/acknowl-edge) packet, trying to establish a TCP connection with a TCP entity at a spu-rious IP address. The Web server maintains a data structure for each SYNrequest waiting for a response back and becomes bogged down as more trafficfloods in. The result is that legitimate connections are denied while the victimmachine is waiting to complete bogus \u201chalf-open\u201d connections. The TCP state data structure is a popular internal resource target but by no means the only one. [CERT01] gives the following examples: 1.In many systems, a limited number of data structures are available to hold"}, {"id": "a1bea5c6571b5b31c7766ba7eab6ad022f828796", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 381, "start_line": 15, "end_line": 19, "text": "process information (process identifiers, process table entries, process slots, etc.).An intruder may be able to consume these data structures by writing a simpleprogram or script that does nothing but repeatedly create copies of itself. 2.An intruder may also attempt to consume disk space in other ways, including \u2022generating excessive numbers of mail messages \u2022intentionally generating errors that must be logged \u2022placing files in anonymous ftp areas or network-shared areas366 CHAPTER 10 / MALICIOUS SOFTWARE"}, {"id": "4eef00883439b8ada1937c43980dfaa65cd5bdcd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 382, "start_line": 1, "end_line": 19, "text": "SYN packetsAttack machine Attack machine Reflector machinesSlave servers1 12 23 3(a) Distributed SYN flood attack (a) Distributed ICMP attackInternet Target Web server Target routerSYNpackets SYN/ACKpackets Figure 10.9 Examples of Simple DDoS Attacks 367"}, {"id": "21d7b10c57f9d41d66678a9a2e61324af89f01c6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 383, "start_line": 1, "end_line": 10, "text": "368 CHAPTER 10 / MALICIOUS SOFTWARE Figure 10.9b illustrates an example of an attack that consumes data transmis- sion resources . The following steps are involved: 1.The attacker takes control of multiple hosts over the Internet, instructing them to send ICMP ECHO packets3with the target\u2019s spoofed IP address to a group of hosts that act as reflectors, as described subsequently. 2.Nodes at the bounce site receive multiple spoofed requests and respond by send-ing echo reply packets to the target site. 3.The target\u2019s router is flooded with packets from the bounce site, leaving nodata transmission capacity for legitimate traffic. Another way to classify DDoS attacks is as either direct or reflector DDoS attacks. In a direct DDoS attack (Figure 10.10a), the attacker is able to implant zom-"}, {"id": "41a70bc54450f24d437bc289beace8ff9fc58111", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 383, "start_line": 11, "end_line": 13, "text": "bie software on a number of sites distributed throughout the Internet. Often, the DDoS attack involves two levels of zombie machines: master zombies and slave zom-bies.The hosts of both machines have been infected with malicious code.The attackercoordinates and triggers the master zombies, which in turn coordinate and triggerthe slave zombies.The use of two levels of zombies makes it more difficult to trace theattack back to its source and provides for a more resilient network of attackers. A reflector DDoS attack adds another layer of machines (Figure 10.10b). In"}, {"id": "f514470636df7e2fa4e52f86a8d16bbffefba71c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 383, "start_line": 14, "end_line": 15, "text": "this type of attack, the slave zombies construct packets requiring a response thatcontains the target\u2019s IP address as the source IP address in the packet\u2019s IP header.These packets are sent to uninfected machines known as reflectors. The uninfectedmachines respond with packets directed at the target machine. A reflector DDoSattack can easily involve more machines and more traffic than a direct DDoS attackand hence be more damaging. Further, tracing back the attack or filtering out theattack packets is more difficult because the attack comes from widely disperseduninfected machines. Constructing the Attack Network"}, {"id": "ec5f0b98e42ad7e706b488601eaeef042c6060bf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 383, "start_line": 16, "end_line": 18, "text": "The first step in a DDoS attack is for the attacker to infect a number of machineswith zombie software that will ultimately be used to carry out the attack. The essen-tial ingredients in this phase of the attack are the following: 1.Software that can carry out the DDoS attack.The software must be able to runon a large number of machines, must be able to conceal its existence, must beable to communicate with the attacker or have some sort of time-triggeredmechanism, and must be able to launch the intended attack toward the target. 2.A vulnerability in a large number of systems.The attacker must become aware ofa vulnerability that many system administrators and individual users have failedto patch and that enables the attacker to install the zombie software."}, {"id": "b0e9b6c6b404feb7938bfdf9696c41f6eb52cf62", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 383, "start_line": 19, "end_line": 22, "text": "3.A strategy for locating vulnerable machines, a process known as scanning. 3The Internet Control Message Protocol (ICMP) is an IP-level protocol for the exchange of control pack- ets between a router and a host or between hosts. The ECHO packet requires the recipient to respond with an echo reply to check that communication is possible between entities."}, {"id": "470a2d15c6cc0f03e6dd2df5f61271035c559dc5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 384, "start_line": 1, "end_line": 18, "text": "10.5 / DISTRIBUTED DENIAL OF SERVICE ATTACKS 369 (a) Direct DDoS AttackAttacker Attacker ReflectorsVictim VictimMaster zombies Master zombiesSlave zombies Slave zombies (b) Reflector DDoS Attack Figure 10.10 Types of Flooding-Based DDoS Attacks In the scanning process, the attacker first seeks out a number of vulnerable machines and infects them. Then, typically, the zombie software that is installed in the infected machines repeats the same scanning process, until a large distributednetwork of infected machines is created. [MIRK04] lists the following types of scan-ning strategies: \u2022Random: Each compromised host probes random addresses in the IP address space, using a different seed. This technique produces a high volume of"}, {"id": "bc4fca6ef515f1e1aafe7f370dc6341d667f0d41", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 385, "start_line": 1, "end_line": 8, "text": "370 CHAPTER 10 / MALICIOUS SOFTWARE Internet traffic, which may cause generalized disruption even before the actual attack is launched. \u2022Hit-List: The attacker first compiles a long list of potential vulnerable machines. This can be a slow process done over a long period to avoid detec-tion that an attack is underway. Once the list is compiled, the attacker beginsinfecting machines on the list. Each infected machine is provided with aportion of the list to scan. This strategy results in a very short scanning period,which may make it difficult to detect that infection is taking place. \u2022Topological: This method uses information contained on an infected victim machine to find more hosts to scan. \u2022Local subnet: If a host can be infected behind a firewall, that host then looks"}, {"id": "4cad2c3672ded3946898a1e6741a43284f4acd39", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 385, "start_line": 9, "end_line": 14, "text": "for targets in its own local network. The host uses the subnet address structureto find other hosts that would otherwise be protected by the firewall. DDoS Countermeasures In general, there are three lines of defense against DDoS attacks [CHAN02]: \u2022Attack prevention and preemption (before the attack): These mechanisms enable the victim to endure attack attempts without denying service to legiti-mate clients. Techniques include enforcing policies for resource consumptionand providing backup resources available on demand. In addition, preventionmechanisms modify systems and protocols on the Internet to reduce the possi-bility of DDoS attacks. \u2022Attack detection and filtering (during the attack): These mechanisms attempt to"}, {"id": "5e941522cbfdfc90e7de178d30e6a4266b08b16e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 385, "start_line": 15, "end_line": 20, "text": "detect the attack as it begins and respond immediately.This minimizes the impactof the attack on the target. Detection involves looking for suspicious patterns ofbehavior. Response involves filtering out packets likely to be part of the attack. \u2022Attack source traceback and identification (during and after the attack): This is an attempt to identify the source of the attack as a first step in preventingfuture attacks. However, this method typically does not yield results fastenough, if at all, to mitigate an ongoing attack. The challenge in coping with DDoS attacks is the sheer number of ways in which they can operate. Thus DDoS countermeasures must evolve with the threat. 10.6 RECOMMENDED READING AND WEB SITES"}, {"id": "602f6a4c24a4247c6087630064d9e60f4a8435dd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 385, "start_line": 21, "end_line": 24, "text": "For a thorough understanding of viruses, the book to read is [SZOR05]. Another excellent treatment is [A YCO06]. Good overview articles on viruses and worms are [CASS01],[FORR97], [KEPH97a], and [NACH97]. [MEIN01] provides a good treatment of the CodeRed worm. [WEA V03] is a comprehensive survey of worm characteristics. [HYPP06] dis-cusses worm attacks on mobile phones. [PATR04] is a worthwhile survey of DDoS attacks. [MIRK04] is a thorough description of the variety of DDoS attacks and countermeasures. [CHAN02] is a good examination ofDDoS defense strategies."}, {"id": "f09c1a785d686f334b94a13f619b5b2cf02db38c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 386, "start_line": 1, "end_line": 11, "text": "10.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 371 A YCO06 Aycock, J. Computer Viruses and Malware. New York: Springer, 2006. CASS01 Cass, S. \u201cAnatomy of Malice.\u201d IEEE Spectrum , November 2001. CHAN02 Chang, R.\u201cDefending Against Flooding-Based Distributed Denial-of-Service Attacks: A Tutorial.\u201d IEEE Communications Magazine , October 2002. FORR97 Forrest, S.; Hofmeyr, S.; and Somayaji, A. \u201cComputer Immunology.\u201d Communications of the ACM , October 1997. HYPP06 Hypponen, M. \u201cMalware Goes Mobile.\u201d Scientific American , November 2006. KEPH97a Kephart, J.; Sorkin, G.; Chess, D.; and White, S. \u201cFighting Computer Viruses.\u201d Scientific American , November 1997. MEIN01 Meinel, C. \u201cCode Red for the Web.\u201d Scientific American , October 2001."}, {"id": "b36201ff3acbb6f07dd4ef73301e7da05c2d061d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 386, "start_line": 12, "end_line": 25, "text": "MIRK04 Mirkovic, J., and Relher, P . \u201cA Taxonomy of DDoS Attack and DDoS Defense Mechanisms.\u201d ACM SIGCOMM Computer Communications Review , April 2004. NACH97 Nachenberg, C. \u201cComputer Virus-Antivirus Coevolution.\u201d Communications of the ACM , January 1997. PATR04 Patrikakis, C.; Masikos, M.; and Zouraraki, O. \u201cDistributed Denial of Service Attacks.\u201d The Internet Protocol Journal , December 2004. SZOR05 Szor, P ., The Art of Computer Virus Research and Defense. Reading, MA: Addison-Wesley, 2005. WEA V03 Weaver, N., et al. \u201cA Taxonomy of Computer Worms.\u201d The First ACM Workshop on Rapid Malcode (WORM) , 2003. Recommended Web Sites: \u2022AntiVirus Online: IBM\u2019s site on virus information. \u2022Vmyths: Dedicated to exposing virus hoaxes and dispelling misconceptions about real viruses."}, {"id": "94f27725dd24bede54aef4747a53468f2210b239", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 386, "start_line": 26, "end_line": 34, "text": "\u2022VirusList: Site maintained by commercial antivirus software provider. Good collection of useful information. \u2022DDoS Attacks/Tools: Extensive list of links and documents. 10.7 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms backdoor behavior-blocking softwareblended attackboot-sector virusdigital immune systemdirect DDoS attackdistributed denial of service (DDoS) downloaderse-mail virusflooderlogic bombmacro virusmalicious softwaremalwaremetamorphic virusmobile codeparasitic virus"}, {"id": "2496fa9f39b65771d11e58a948451c098b5de360", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 387, "start_line": 1, "end_line": 12, "text": "Review Questions 10.1 What is the role of compression in the operation of a virus? 10.2 What is the role of encryption in the operation of a virus? 10.3 What are typical phases of operation of a virus or worm? 10.4 What is a digital immune system? 10.5 How does behavior-blocking software work? 10.6 In general terms, how does a worm propagate? 10.7 Describe some worm countermeasures. 10.8 What is a DDoS? Problems 10.1 There is a flaw in the virus program of Figure 10.1. What is it? 10.2 The question arises as to whether it is possible to develop a program that can analyze"}, {"id": "877d4212d58328743562a22526ba6039541e1dce", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 387, "start_line": 13, "end_line": 21, "text": "a piece of software to determine if it is a virus. Consider that we have a program Dthat is supposed to be able to do that. That is, for any program P , if we run D(P), theresult returned is TRUE (P is a virus) or FALSE (P is not a virus). Now consider thefollowing program: Program CV := { ...main-program := {if D(CV) then goto next: else infect-executable; } next: } In the preceding program, infect-executable is a module that scans memory for exe-cutable programs and replicates itself in those programs. Determine if D can correctlydecide whether CV is a virus."}, {"id": "0cf12cf3582eb8d206dd28b9488d878b3ed8d41c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 387, "start_line": 22, "end_line": 32, "text": "10.3 The point of this problem is to demonstrate the type of puzzles that must be solved inthe design of malicious code and therefore, the type of mindset that one wishing tocounter such attacks must adopt.a.Consider the following C program: begin print (*begin print (); end.*); end What do you think the program was intended to do? Does it work? b.Answer the same questions for the following program: char [] = {'0', ' ', '}', ';', 'm', 'a', 'i', 'n', '(', ')', '{', and so on... 't', ')', '0'}; main () { int I;printf(*char t[] = (*);polymorphic virus reflector DDoS attackscanningstealth virustrapdoorTrojan horseviruswormzero-day exploit 372 CHAPTER 10 / MALICIOUS SOFTWARE"}, {"id": "400a396048de355fc9e65a394f70b240c592d7aa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 388, "start_line": 1, "end_line": 21, "text": "10.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 373 for (i=0; t[i]!=0; i=i+1) printf(\"%d, \", t[i]); printf(\"%s\", t); } c.What is the specific relevance of this problem to this chapter? 10.4 Consider the following fragment: legitimate code ifdata is Friday the 13th; crash_computer(); legitimate code What type of malicious software is this? 10.5 Consider the following fragment in an authentication program: username = read_username(); password = read_password();ifusername is \"133t h4ck0r\" returnALLOW_LOGIN; ifusername and password are valid returnALLOW_LOGIN else return DENY_LOGIN What type of malicious software is this? 10.6 The following code fragments show a sequence of virus instructions and a metamor-phic version of the virus. Describe the effect produced by the metamorphic code."}, {"id": "45fd0e17b02d6e69387de8076718148e035d490f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 388, "start_line": 22, "end_line": 28, "text": "Original Code Metamorphic Code mov eax, 5 add eax, ebxcall [eax]mov eax, 5push ecxpop ecxadd eax, ebxswap eax, ebxswap ebx, eaxcall [eax]nop 10.7 The list of passwords used by the Morris worm is provided at this book\u2019s Web site. a.The assumption has been expressed by many people that this list represents wordscommonly used as passwords. Does this seem likely? Justify your answer. b.If the list does not reflect commonly used passwords, suggest some approachesthat Morris may have used to construct the list. 10.8 Suggest some methods of attacking the PWC worm defense that could be used byworm creators and suggest countermeasures to these methods."}, {"id": "fd02b20245f778139428ec22c8703e74ebfceab8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 389, "start_line": 1, "end_line": 14, "text": "CHAPTER FIREWALLS 11.1 The Need for Firewalls 11.2 Firewall Characteristics 11.3 Types of Firewalls Packet Filtering Firewall Stateful Inspection FirewallsApplication-Level GatewayCircuit-Level Gateway 11.4 Firewall Basing Bastion HostHost-Based FirewallsPersonal Firewall 11.5 Firewall Location and Configurations DMZ NetworksVirtual Private NetworksDistributed FirewallsSummary of Firewall Locations and Topologies 11.6 Recommended Reading and Web Site 11.7 Key Terms, Review Questions, and Problems 374"}, {"id": "040b398db5808dbaf1eab5896a30ed5da172225c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 390, "start_line": 1, "end_line": 9, "text": "11.1 / THE NEED FOR FIREWALLS 375 The function of a strong position is to make the forces holding it practically unassailable. \u2014On War, Carl Von Clausewitz On the day that you take up your command, block the frontier passes, destroy theofficial tallies, and stop the passage of all emissaries. \u2014The Art of War , Sun Tzu KEY POINTS \u25c6A firewall forms a barrier through which the traffic going in each directionmust pass. A firewall security policy dictates which traffic is authorized topass in each direction. \u25c6A firewall may be designed to operate as a filter at the level of IP packets,or may operate at a higher protocol layer."}, {"id": "284169b5fa8b9fe79285709d4f4821146db25fe1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 390, "start_line": 10, "end_line": 15, "text": "Firewalls can be an effective means of protecting a local system or network of systemsfrom network-based security threats while at the same time affording access to the out-side world via wide area networks and the Internet. 11.1 THE NEED FOR FIREWALLS Information systems in corporations, government agencies, and other organizationshave undergone a steady evolution. The following are notable developments: \u2022Centralized data processing system, with a central mainframe supporting anumber of directly connected terminals \u2022Local area networks (LANs) interconnecting PCs and terminals to each otherand the mainframe \u2022Premises network, consisting of a number of LANs, interconnecting PCs,servers, and perhaps a mainframe or two"}, {"id": "c838d8518b8865df6f8f880a474897a2b5b57a24", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 390, "start_line": 16, "end_line": 20, "text": "\u2022Enterprise-wide network, consisting of multiple, geographically distributedpremises networks interconnected by a private wide area network (WAN) \u2022Internet connectivity, in which the various premises networks all hook into theInternet and may or may not also be connected by a private WAN Internet connectivity is no longer optional for organizations. The information and services available are essential to the organization. Moreover, individual users within the organization want and need Internet access, and if this is not provided viatheir LAN, they will use dial-up capability from their PC to an Internet serviceprovider (ISP). However, while Internet access provides benefits to the organization,"}, {"id": "61462d65b453b61967e1df2bf0e8b74d11dcf674", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 391, "start_line": 1, "end_line": 1, "text": "it enables the outside world to reach and interact with local network assets. This"}, {"id": "4223eb67132d7b633bc5b71a8f6e7ac6de9b325c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 391, "start_line": 2, "end_line": 2, "text": "creates a threat to the organization. While it is possible to equip each workstationand server on the premises network with strong security features, such as intrusionprotection, this may not be sufficient and in some cases is not cost-effective. Considera network with hundreds or even thousands of systems, running various operatingsystems, such as different versions of UNIX and Windows. When a security flaw isdiscovered, each potentially affected system must be upgraded to fix that flaw. Thisrequires scaleable configuration management and aggressive patching to functioneffectively. While difficult, this is possible and is necessary if only host-based securityis used. A widely accepted alternative or at least complement to host-based securityservices is the firewall.The firewall is inserted between the premises network and theInternet to establish a controlled link and to erect an outer security wall or perime-ter.The aim of this perimeter is to protect the premises network from Internet-basedattacks and to provide a single choke point where security and auditing can beimposed. The firewall may be a single computer system or a set of two or moresystems that cooperate to perform the firewall function."}, {"id": "a1326b51a2addf44f8c3996cd93545ad97d2cd88", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 391, "start_line": 3, "end_line": 8, "text": "The firewall, then, provides an additional layer of defense, insulating the inter- nal systems from external networks. This follows the classic military doctrine of\u201cdefense in depth,\u201d which is just as applicable to IT security. 11.2 FIREWALL CHARACTERISTICS [BELL94b] lists the following design goals for a firewall: 1.All traffic from inside to outside, and vice versa, must pass through the firewall.This is achieved by physically blocking all access to the local network exceptvia the firewall. Various configurations are possible, as explained later in thischapter. 2.Only authorized traffic, as defined by the local security policy, will be allowed topass. Various types of firewalls are used, which implement various types of secu-rity policies, as explained later in this chapter."}, {"id": "50c18d34b0fc56f2e6707516db1dba57d75741d0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 391, "start_line": 9, "end_line": 13, "text": "3.The firewall itself is immune to penetration.This implies the use of a hardenedsystem with a secured operating system.Trusted computer systems are suitablefor hosting a firewall and often required in government applications. [SMIT97] lists four general techniques that firewalls use to control access and enforce the site\u2019s security policy. Originally, firewalls focused primarily on service control, but they have since evolved to provide all four: \u2022Service control: Determines the types of Internet services that can be"}, {"id": "af65500f5d24bf310e6f7b83d5f5de683eda60c9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 391, "start_line": 14, "end_line": 16, "text": "accessed, inbound or outbound. The firewall may filter traffic on the basis ofIP address, protocol, or port number; may provide proxy software that receivesand interprets each service request before passing it on; or may host the serversoftware itself, such as a Web or mail service. \u2022Direction control: Determines the direction in which particular service requests may be initiated and allowed to flow through the firewall.376 CHAPTER 11 / FIREWALLS"}, {"id": "42da0e0b3ff1ccb3a95ecb2e1955b8ed2e8aa0a7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 392, "start_line": 1, "end_line": 8, "text": "11.2 / FIREWALL CHARACTERISTICS 377 \u2022User control: Controls access to a service according to which user is attempt- ing to access it. This feature is typically applied to users inside the firewall perimeter (local users). It may also be applied to incoming traffic from exter-nal users; the latter requires some form of secure authentication technology,such as is provided in IPsec (Chapter 8). \u2022Behavior control: Controls how particular services are used. For example, the firewall may filter e-mail to eliminate spam, or it may enable external access toonly a portion of the information on a local Web server. Before proceeding to the details of firewall types and configurations, it is best to summarize what one can expect from a firewall. The following capabilities are"}, {"id": "2a562feeddd50a211a9488631f3befd48009c03a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 392, "start_line": 9, "end_line": 11, "text": "within the scope of a firewall: 1.A firewall defines a single choke point that keeps unauthorized users out ofthe protected network, prohibits potentially vulnerable services from enteringor leaving the network, and provides protection from various kinds of IPspoofing and routing attacks.The use of a single choke point simplifies securitymanagement because security capabilities are consolidated on a single systemor set of systems. 2.A firewall provides a location for monitoring security-related events. Audits andalarms can be implemented on the firewall system."}, {"id": "0290ba3ccb4634ad3018250c1d4fb9c7314186f7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 392, "start_line": 12, "end_line": 16, "text": "3.A firewall is a convenient platform for several Internet functions that are notsecurity related. These include a network address translator, which maps localaddresses to Internet addresses, and a network management function that auditsor logs Internet usage. 4.A firewall can serve as the platform for IPsec. Using the tunnel mode capabil-ity described in Chapter 8, the firewall can be used to implement virtualprivate networks. Firewalls have their limitations, including the following: 1.The firewall cannot protect against attacks that bypass the firewall. Internal systems may have dial-out capability to connect to an ISP . An internal LANmay support a modem pool that provides dial-in capability for travelingemployees and telecommuters."}, {"id": "07d027dc1939ee66f7c26bb2f8be21237231d62b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 392, "start_line": 17, "end_line": 19, "text": "2.The firewall may not protect fully against internal threats, such as a disgruntledemployee or an employee who unwittingly cooperates with an externalattacker. 3.An improperly secured wireless LAN may be accessed from outside the organi-zation. An internal firewall that separates portions of an enterprise networkcannot guard against wireless communications between local systems on differ-ent sides of the internal firewall. 4.A laptop, PDA, or portable storage device may be used and infected outsidethe corporate network, and then attached and used internally."}, {"id": "579050dee00d1785cb16c0d211becf0d8f90baaa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 393, "start_line": 1, "end_line": 5, "text": "378 CHAPTER 11 / FIREWALLS 11.3 TYPES OF FIREWALLS A firewall may act as a packet filter. It can operate as a positive filter, allowing to pass only packets that meet specific criteria, or as a negative filter, rejecting anypacket that meets certain criteria. Depending on the type of firewall, it may examineone or more protocol headers in each packet, the payload of each packet, or the pat-tern generated by a sequence of packets. In this section, we look at the principaltypes of firewalls. Packet Filtering Firewall"}, {"id": "68211d205cb9280c2e41df0303f84e3202822869", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 393, "start_line": 6, "end_line": 13, "text": "A packet filtering firewall applies a set of rules to each incoming and outgoing IPpacket and then forwards or discards the packet (Figure 11.1b). The firewall is typi-cally configured to filter packets going in both directions (from and to the internalnetwork). Filtering rules are based on information contained in a network packet: \u2022Source IP address: The IP address of the system that originated the IP packet (e.g., 192.178.1.1) \u2022Destination IP address: The IP address of the system the IP packet is trying to reach (e.g., 192.168.1.2) \u2022Source and destination transport-level address: The transport-level (e.g., TCP or UDP) port number, which defines applications such as SNMP or TELNET \u2022IP protocol field: Defines the transport protocol"}, {"id": "1b2a5f35c5c1f1b407c22eb4d1a3cc8c8ac00c3f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 393, "start_line": 14, "end_line": 21, "text": "\u2022Interface: For a firewall with three or more ports, which interface of the fire- wall the packet came from or which interface of the firewall the packet is des-tined for The packet filter is typically set up as a list of rules based on matches to fields in the IP or TCP header. If there is a match to one of the rules, that rule is invoked to determine whether to forward or discard the packet. If there is no match to anyrule, then a default action is taken. Two default policies are possible: \u2022Default = discard: That which is not expressly permitted is prohibited. \u2022Default = forward: That which is not expressly prohibited is permitted. The default discard policy is more conservative. Initially, everything is"}, {"id": "0774a22e8790e87408187dbedcf430549f86265b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 393, "start_line": 22, "end_line": 24, "text": "blocked, and services must be added on a case-by-case basis. This policy is morevisible to users, who are more likely to see the firewall as a hindrance. However,this is the policy likely to be preferred by businesses and government organiza-tions. Further, visibility to users diminishes as rules are created. The default for-ward policy increases ease of use for end users but provides reduced security; thesecurity administrator must, in essence, react to each new security threat as itbecomes known. This policy may be used by generally more open organizations,such as universities. Table 11.1, from [BELL94b], gives some examples of packet filtering rulesets. In each set, the rules are applied top to bottom. The \u201c*\u201d in a field is a wildcard"}, {"id": "6379e4d38b9e714df890d2e0d83f083fbac434bf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 394, "start_line": 1, "end_line": 28, "text": "11.3 / TYPES OF FIREWALLS 379 External (untrusted) network (e.g., Internet)Internal (protected) network (e.g., enterprise network) Firewall (a) General model (d) Application proxy firewallPhysical Network accessInternetTransportApplication Physical Network accessInternetTransportApplicationApplication proxy External transport connectionInternal transport connection(b) Packet filtering firewallPhysical Network accessInternetTransportApplicationEnd-to-end transport connectionEnd-to-end transport connection (c) Stateful inspection firewallPhysical Network accessInternetTransportApplicationEnd-to-end transport connectionEnd-to-end transport connection (e) Circuit-level proxy firewallPhysical Network accessInternetTransportApplication Physical Network"}, {"id": "d9cfeb88efee0b11de76d71c52467ecdf7b6905a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 394, "start_line": 29, "end_line": 36, "text": "accessInternetTransportApplicationCircuit-level proxy External transport connectionInternal transport connectionState info Figure 11.1 Types of Firewalls"}, {"id": "3e31d9d811ba7b2f740fb7970e68acf92cee5ce6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 395, "start_line": 1, "end_line": 23, "text": "380 CHAPTER 11 / FIREWALLS Table 11.1 Packet-Filtering Examples Rule Set A action ourhost port theirhost port comment block * * SPIGOT * we don\u2019t trust these people allow OUR-GW 25 * * connection to our SMTP port Rule Set B action ourhost port theirhost port comment block * * * * default Rule Set C action ourhost port theirhost port comment allow * * * 25 connection to their SMTP port Rule Set D action src port dest port flags comment allow {our hosts} * * 25 our packets to their SMTP port allow * 25 * * ACK their replies Rule Set E action src port dest port flags comment allow {our hosts} * * * our outgoing calls allow * * * * ACK replies to our calls allow * * * >1024 traffic to nonservers designator that matches everything. We assume that the default = discard policy is in force."}, {"id": "084e060e77e1db72cb2d8959720739b340879c9a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 395, "start_line": 24, "end_line": 25, "text": "A.Inbound mail is allowed (port 25 is for SMTP incoming), but only to a gatewayhost. However, packets from a particular external host, SPIGOT, are blockedbecause that host has a history of sending massive files in e-mail messages. B.This is an explicit statement of the default policy. All rulesets include this ruleimplicitly as the last rule."}, {"id": "f1f0afd1e05577339f2d83f83ec59abf31ee8a46", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 395, "start_line": 26, "end_line": 26, "text": "C.This ruleset is intended to specify that any inside host can send mail to the out-side.A TCP packet with a destination port of 25 is routed to the SMTP server onthe destination machine. The problem with this rule is that the use of port 25 forSMTP receipt is only a default; an outside machine could be configured to havesome other application linked to port 25.As this rule is written, an attacker couldgain access to internal machines by sending packets with a TCP source port num-ber of 25."}, {"id": "5fb0303e134f38d85c1113a2fd5e2346011e4da8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 395, "start_line": 27, "end_line": 27, "text": "D.This ruleset achieves the intended result that was not achieved in C. The rulestake advantage of a feature of TCP connections. Once a connection is set up, theACK flag of a TCP segment is set to acknowledge segments sent from the otherside.Thus, this ruleset states that it allows IP packets where the source IP address"}, {"id": "5090d8dda8f8189d50bd343f2b554361403a09e0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 396, "start_line": 1, "end_line": 4, "text": "11.3 / TYPES OF FIREWALLS 381 is one of a list of designated internal hosts and the destination TCP port number is 25. It also allows incoming packets with a source port number of 25 that includethe ACK flag in the TCP segment. Note that we explicitly designate source anddestination systems to define these rules explicitly. E.This ruleset is one approach to handling FTP connections. With FTP , two TCPconnections are used: a control connection to set up the file transfer and a dataconnection for the actual file transfer. The data connection uses a different portnumber that is dynamically assigned for the transfer. Most servers, and hencemost attack targets, use low-numbered ports; most outgoing calls tend to use ahigher-numbered port, typically above 1023. Thus, this ruleset allows"}, {"id": "bc56da2dd1ea9dd0f017c4f33ace1a1f8303aef4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 396, "start_line": 5, "end_line": 11, "text": "\u2014 Packets that originate internally\u2014 Reply packets to a connection initiated by an internal machine\u2014 Packets destined for a high-numbered port on an internal machineThis scheme requires that the systems be configured so that only the appropriate port numbers are in use. Rule set E points out the difficulty in dealing with applications at the packet- filtering level.Another way to deal with FTP and similar applications is either state- ful packet filters or an application-level gateway, both described subsequently in thissection. One advantage of a packet filtering firewall is its simplicity.Also, packet filters typically are transparent to users and are very fast. [WACK02] lists the followingweaknesses of packet filter firewalls:"}, {"id": "b9c0af742787018fcc0de1b1c93bf7f574fcd9b2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 396, "start_line": 12, "end_line": 13, "text": "\u2022Because packet filter firewalls do not examine upper-layer data, they cannotprevent attacks that employ application-specific vulnerabilities or functions.For example, a packet filter firewall cannot block specific applicationcommands; if a packet filter firewall allows a given application, all functionsavailable within that application will be permitted. \u2022Because of the limited information available to the firewall, the logging func-tionality present in packet filter firewalls is limited. Packet filter logs normallycontain the same information used to make access control decisions (sourceaddress, destination address, and traffic type)."}, {"id": "c01502d834fc441a3a5f71cddc779b09242c2672", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 396, "start_line": 14, "end_line": 16, "text": "\u2022Most packet filter firewalls do not support advanced user authenticationschemes. Once again, this limitation is mostly due to the lack of upper-layerfunctionality by the firewall. \u2022Packet filter firewalls are generally vulnerable to attacks and exploits thattake advantage of problems within the TCP/IP specification and protocolstack, such as network layer address spoofing. Many packet filter firewalls cannot detect a network packet in which the OSI Layer 3 addressing informa-tion has been altered. Spoofing attacks are generally employed by intruders tobypass the security controls implemented in a firewall platform."}, {"id": "fa63ca9b0d79b19a10da6a1cb995851201e60ebf", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 396, "start_line": 17, "end_line": 17, "text": "\u2022Finally, due to the small number of variables used in access control decisions,packet filter firewalls are susceptible to security breaches caused by improperconfigurations. In other words, it is easy to accidentally configure a packet"}, {"id": "db3653b0d86a3baf6a90a6e0e0c4eeda15f81b72", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 397, "start_line": 1, "end_line": 7, "text": "382 CHAPTER 11 / FIREWALLS filter firewall to allow traffic types, sources, and destinations that should be denied based on an organization\u2019s information security policy. Some of the attacks that can be made on packet filtering firewalls and the appropriate countermeasures are the following: \u2022IP address spoofing: The intruder transmits packets from the outside with a source IP address field containing an address of an internal host. The attacker"}, {"id": "3755a1eaa4e20b7a351ad52810c0ccdea6e6cec7", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 397, "start_line": 8, "end_line": 11, "text": "hopes that the use of a spoofed address will allow penetration of systems thatemploy simple source address security, in which packets from specific trustedinternal hosts are accepted. The countermeasure is to discard packets with aninside source address if the packet arrives on an external interface. In fact, thiscountermeasure is often implemented at the router external to the firewall. \u2022Source routing attacks: The source station specifies the route that a packet should take as it crosses the Internet, in the hopes that this will bypass securitymeasures that do not analyze the source routing information. The counter-measure is to discard all packets that use this option. \u2022Tiny fragment attacks: The intruder uses the IP fragmentation option to create"}, {"id": "2d715a84e95596fcd880aa486471663a2a415cde", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 397, "start_line": 12, "end_line": 12, "text": "extremely small fragments and force the TCP header information into a sepa-rate packet fragment. This attack is designed to circumvent filtering rules thatdepend on TCP header information. Typically, a packet filter will make a fil-tering decision on the first fragment of a packet. All subsequent fragments ofthat packet are filtered out solely on the basis that they are part of the packetwhose first fragment was rejected.The attacker hopes that the filtering firewallexamines only the first fragment and that the remaining fragments are passedthrough. A tiny fragment attack can be defeated by enforcing a rule that thefirst fragment of a packet must contain a predefined minimum amount ofthe transport header. If the first fragment is rejected, the filter can rememberthe packet and discard all subsequent fragments."}, {"id": "a9d048821fc73147cb3ea76617d461baf89ee9db", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 397, "start_line": 13, "end_line": 14, "text": "Stateful Inspection Firewalls A traditional packet filter makes filtering decisions on an individual packet basisand does not take into consideration any higher layer context.To understand what ismeant by context and why a traditional packet filter is limited with regard to con-"}, {"id": "f6a351f64e617a03dbd7f99d1bda258d761bdbbe", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 397, "start_line": 15, "end_line": 16, "text": "text, a little background is needed. Most standardized applications that run on top ofTCP follow a client/server model. For example, for the Simple Mail TransferProtocol (SMTP), e-mail is transmitted from a client system to a server system. Theclient system generates new e-mail messages, typically from user input. The serversystem accepts incoming e-mail messages and places them in the appropriate usermailboxes. SMTP operates by setting up a TCP connection between client andserver, in which the TCP server port number, which identifies the SMTP serverapplication, is 25. The TCP port number for the SMTP client is a number between1024 and 65535 that is generated by the SMTP client. In general, when an application that uses TCP creates a session with a remote"}, {"id": "ab5c81e4a1f742bee2f38516d8970f7c8e6793af", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 397, "start_line": 17, "end_line": 17, "text": "host, it creates a TCP connection in which the TCP port number for the remote(server) application is a number less than 1024 and the TCP port number for the local"}, {"id": "7500b315decb20a3dc629b851ab94cce1e9e664a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 398, "start_line": 1, "end_line": 14, "text": "11.3 / TYPES OF FIREWALLS 383 Table 11.2 Example Stateful Firewall Connection State Table [WACK02] Source Address Source Port Destination AddressDestination Port Connection State 192.168.1.100 1030 210.22.88.29 80 Established 192.168.1.102 1031 216.32.42.123 80 Established 192.168.1.101 1033 173.66.32.122 25 Established 192.168.1.106 1035 177.231.32.12 79 Established 223.43.21.231 1990 192.168.1.6 80 Established 2122.22.123.32 2112 192.168.1.6 80 Established 210.922.212.18 3321 192.168.1.6 80 Established 24.102.32.23 1025 192.168.1.6 80 Established 223.21.22.12 1046 192.168.1.6 80 Established(client) application is a number between 1024 and 65535.The numbers less than 1024"}, {"id": "f116a74d9a7ac0f55c79079b25f5ea3677a03c96", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 398, "start_line": 15, "end_line": 18, "text": "are the \u201cwell-known\u201d port numbers and are assigned permanently to particularapplications (e.g., 25 for server SMTP). The numbers between 1024 and 65535 aregenerated dynamically and have temporary significance only for the lifetime of aTCP connection. A simple packet filtering firewall must permit inbound network traffic on all these high-numbered ports for TCP-based traffic to occur. This creates a vulnerabil-ity that can be exploited by unauthorized users. A stateful inspection packet firewall tightens up the rules for TCP traffic by"}, {"id": "b84ab140b319fb667c98d36dce05de4e063c2307", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 398, "start_line": 19, "end_line": 22, "text": "creating a directory of outbound TCP connections, as shown in Table 11.2. There isan entry for each currently established connection. The packet filter will now allowincoming traffic to high-numbered ports only for those packets that fit the profile ofone of the entries in this directory. A stateful packet inspection firewall reviews the same packet information as a packet filtering firewall, but also records information about TCP connections(Figure 11.1c). Some stateful firewalls also keep track of TCP sequence numbers toprevent a ttacks that depend on the sequence number, such as session hijacking. Some even inspect limited amounts of application data for some well-known protocols likeFTP , IM and SIPS commands, in order to identify and track related connections."}, {"id": "dbf16924cdd41b3b55bcf08b02feb700eef38978", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 398, "start_line": 23, "end_line": 25, "text": "Application-Level Gateway An application-level gateway, also called an application proxy, acts as a relay of application-level traffic (Figure 11.1d). The user contacts the gateway using aTCP/IP application, such as Telnet or FTP , and the gateway asks the user for thename of the remote host to be accessed. When the user responds and provides avalid user ID and authentication information, the gateway contacts the applicationon the remote host and relays TCP segments containing the application databetween the two endpoints. If the gateway does not implement the proxy code for aspecific application, the service is not supported and cannot be forwarded across thefirewall. Further, the gateway can be configured to support only specific features of"}, {"id": "2e2411b1c3fb4aa48b86310542c0b0a0941e312b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 399, "start_line": 1, "end_line": 8, "text": "384 CHAPTER 11 / FIREWALLS an application that the network administrator considers acceptable while denying all other features. Application-level gateways tend to be more secure than packet filters. Rather than trying to deal with the numerous possible combinations that are to be allowedand forbidden at the TCP and IP level, the application-level gateway need onlyscrutinize a few allowable applications. In addition, it is easy to log and audit allincoming traffic at the application level. A prime disadvantage of this type of gateway is the additional processing overhead on each connection. In effect, there are two spliced connections betweenthe end users, with the gateway at the splice point, and the gateway must examineand forward all traffic in both directions. Circuit-Level Gateway"}, {"id": "9a4b498c7801a3cd3c82d1d03d3eb2a7bb629997", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 399, "start_line": 9, "end_line": 10, "text": "A fourth type of firewall is the circuit-level gateway or circuit-level proxy(Figure 11.1e). This can be a stand-alone system or it can be a specialized func-tion performed by an application-level gateway for certain applications. As withan application gateway, a circuit-level gateway does not permit an end-to-endTCP connection; rather, the gateway sets up two TCP connections, one betweenitself and a TCP user on an inner host and one between itself and a TCP user onan outside host. Once the two connections are established, the gateway typicallyrelays TCP segments from one connection to the other without examining thecontents. The security function consists of determining which connections will beallowed. A typical use of circuit-level gateways is a situation in which the system admin-"}, {"id": "afd586bf46aa3fd17d4c5817716164b99ac1b4cb", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 399, "start_line": 11, "end_line": 13, "text": "istrator trusts the internal users. The gateway can be configured to support applica-tion-level or proxy service on inbound connections and circuit-level functions foroutbound connections. In this configuration, the gateway can incur the processingoverhead of examining incoming application data for forbidden functions but doesnot incur that overhead on outgoing data. An example of a circuit-level gateway implementation is the SOCKS package [KOBL92]; version 5 of SOCKS is specified in RFC 1928. The RFC defines SOCKSin the following fashion:"}, {"id": "30c93183a84de9e7e9c5782da34d02e9a8feef4f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 399, "start_line": 14, "end_line": 17, "text": "The protocol described here is designed to provide a framework forclient-server applications in both the TCP and UDP domains toconveniently and securely use the services of a network firewall.The protocol is conceptually a \u201cshim-layer\u201d between the applicationlayer and the transport layer, and as such does not provide network-layer gateway services, such as forwarding of ICMP messages. SOCKS consists of the following components: \u2022The SOCKS server, which often runs on a UNIX-based firewall. SOCKS isalso implemented on Windows systems. \u2022The SOCKS client library, which runs on internal hosts protected by thefirewall."}, {"id": "032a5f0eed216d1ce30164a3b5eb9b619a87b5c5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 400, "start_line": 1, "end_line": 5, "text": "11.4 / FIREWALL BASING 385 \u2022SOCKS-ified versions of several standard client programs such as FTP and TELNET. The implementation of the SOCKS protocol typically involveseither the recompilation or relinking of TCP-based client applications, or theuse of alternate dynamically loaded libraries, to use the appropriate encapsu-lation routines in the SOCKS library. When a TCP-based client wishes to establish a connection to an object that is reachable only via a firewall (such determination is left up to the implementa-"}, {"id": "81506f3a9e5b006b85788844887b1d82c8e4f315", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 400, "start_line": 6, "end_line": 7, "text": "tion), it must open a TCP connection to the appropriate SOCKS port on theSOCKS server system.The SOCKS service is located on TCP port 1080. If the con-nection request succeeds, the client enters a negotiation for the authenticationmethod to be used, authenticates with the chosen method, and then sends a relayrequest. The SOCKS server evaluates the request and either establishes theappropriate connection or denies it. UDP exchanges are handled in a similar fash-ion. In essence, a TCP connection is opened to authenticate a user to send andreceive UDP segments, and the UDP segments are forwarded as long as the TCPconnection is open. 11.4 FIREWALL BASING"}, {"id": "3837555f8fb5a0140acf35d17e49a6a41e06deec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 400, "start_line": 8, "end_line": 11, "text": "It is common to base a firewall on a stand-alone machine running a common oper-ating system, such as UNIX or Linux. Firewall functionality can also be imple-mented as a software module in a router or LAN switch. In this section, we look atsome additional firewall basing considerations. Bastion Host A bastion host is a system identified by the firewall administrator as a critical strongpoint in the network\u2019s security.Typically, the bastion host serves as a platform for anapplication-level or circuit-level gateway. Common characteristics of a bastion hostare as follows: \u2022The bastion host hardware platform executes a secure version of its operatingsystem, making it a hardened system."}, {"id": "3940ccf30f6cd409b24b7b5f2f3b5de2eea16735", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 400, "start_line": 12, "end_line": 15, "text": "\u2022Only the services that the network administrator considers essential areinstalled on the bastion host. These could include proxy applications for DNS,FTP , HTTP , and SMTP . \u2022The bastion host may require additional authentication before a user isallowed access to the proxy services. In addition, each proxy service mayrequire its own authentication before granting user access. \u2022Each proxy is configured to support only a subset of the standard application\u2019scommand set. \u2022Each proxy is configured to allow access only to specific host systems. Thismeans that the limited command/feature set may be applied only to a subset ofsystems on the protected network."}, {"id": "b1c26de3b12cd261c3bba481128b05001cb29da3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 401, "start_line": 1, "end_line": 4, "text": "386 CHAPTER 11 / FIREWALLS \u2022Each proxy maintains detailed audit information by logging all traffic, each connection, and the duration of each connection. The audit log is an essentialtool for discovering and terminating intruder attacks. \u2022Each proxy module is a very small software package specifically designed fornetwork security. Because of its relative simplicity, it is easier to check suchmodules for security flaws. For example, a typical UNIX mail application maycontain over 20,000 lines of code, while a mail proxy may contain fewerthan 1000."}, {"id": "d76d850f7cff412f862375cf082186c1725519b5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 401, "start_line": 5, "end_line": 7, "text": "\u2022Each proxy is independent of other proxies on the bastion host. If there is aproblem with the operation of any proxy, or if a future vulnerability is discov-ered, it can be uninstalled without affecting the operation of the other proxyapplications. Also, if the user population requires support for a new service,the network administrator can easily install the required proxy on thebastion host. \u2022A proxy generally performs no disk access other than to read its initial config-uration file. Hence, the portions of the file system containing executable codecan be made read only. This makes it difficult for an intruder to install Trojanhorse sniffers or other dangerous files on the bastion host. \u2022Each proxy runs as a nonprivileged user in a private and secured directory onthe bastion host."}, {"id": "ac2b2a41924916c7cc80466010ce0d5b1663ed28", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 401, "start_line": 8, "end_line": 11, "text": "Host-Based Firewalls A host-based firewall is a software module used to secure an individual host.Such modules are available in many operating systems or can be provided as anadd-on package. Like conventional stand-alone firewalls, host-resident firewallsfilter and restrict the flow of packets. A common location for such firewalls is aserver. There are several advantages to the use of a server-based or workstation-based firewall: \u2022Filtering rules can be tailored to the host environment. Specific corporatesecurity policies for servers can be implemented, with different filters forservers used for different application. \u2022Protection is provided independent of topology. Thus both internal and exter-nal attacks must pass through the firewall."}, {"id": "40f3254c7237765d926d61d65005113809bf77d3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 401, "start_line": 12, "end_line": 14, "text": "\u2022Used in conjunction with stand-alone firewalls, the host-based firewall pro-vides an additional layer of protection. A new type of server can be added tothe network, with its own firewall, without the necessity of altering the net-work firewall configuration. Personal Firewall A personal firewall controls the traffic between a personal computer or workstationon one side and the Internet or enterprise network on the other side. Personal fire-wall functionality can be used in the home environment and on corporate intranets.Typically, the personal firewall is a software module on the personal computer. In a"}, {"id": "3ec269d60d625460b95170dcc51a33c03a8b88e8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 402, "start_line": 1, "end_line": 6, "text": "11.4 / FIREWALL BASING 387 home environment with multiple computers connected to the Internet, firewall functionality can also be housed in a router that connects all of the home computersto a DSL, cable modem, or other Internet interface. Personal firewalls are typically much less complex than either server-based firewalls or stand-alone firewalls.The primary role of the personal firewall is to denyunauthorized remote access to the computer.The firewall can also monitor outgoingactivity in an attempt to detect and block worms and other malware. An example of a personal firewall is the capability built in to the Mac OS X"}, {"id": "f8cbbae25a0b9565846570f27f4341cd1d9dd531", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 402, "start_line": 7, "end_line": 18, "text": "operating system. When the user enables the personal firewall in Mac OS X,all inbound connections are denied except for those the user explicitly permits.Figure 11.2 shows this simple interface. The list of inbound services that can beselectively reenabled, with their port numbers, includes the following: \u2022Personal file sharing (548, 427) \u2022Windows sharing (139) \u2022Personal Web sharing (80, 427) \u2022Remote login - SSH (22) \u2022FTP access (20-21, 1024-64535 from 20-21) \u2022Remote Apple events (3031) \u2022Printer sharing (631, 515) \u2022IChat Rendezvous (5297, 5298) \u2022ITunes Music Sharing (3869) \u2022CVS (2401) Figure 11.2 Example Personal Firewall Interface"}, {"id": "8cd149e613dff9dd0ef41922c3cf63d2568d9483", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 403, "start_line": 1, "end_line": 15, "text": "388 CHAPTER 11 / FIREWALLS \u2022Gnutella/Limewire (6346) \u2022ICQ (4000) \u2022IRC (194) \u2022MSN Messenger (6891-6900) \u2022Network Time (123) \u2022Retrospect (497) \u2022SMB (without netbios-445) \u2022Timbuktu (407) \u2022VNC (5900-5902) \u2022WebSTAR Admin (1080, 1443) When FTP access is enabled, ports 20 and 21 on the local machine are opened for FTP; if others connect to this computer from ports 20 or 21, the ports 1024 through 64535 are open. For increased protection, advanced firewall features are available through"}, {"id": "8eddad00beaef8ed98c378add27d05539211861d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 403, "start_line": 16, "end_line": 19, "text": "easy-to-configure checkboxes. Stealth mode hides the Mac on the Internet by drop-ping unsolicited communication packets, making it appear as though no Mac ispresent. UDP packets can be blocked, restricting network traffic to TCP packetsonly for open ports. The firewall also supports logging, an important tool for check-ing on unwanted activity. 11.5 FIREWALL LOCATION AND CONFIGURATIONS As Figure 11.1a indicates, a firewall is positioned to provide a protective barrierbetween an external, potentially untrusted source of traffic and an internal network.With that general principle in mind, a security administrator must decide on thelocation and on the number of firewalls needed. In this section, we look at somecommon options. DMZ Networks"}, {"id": "12a06b357dd2f80264ed69c13feb5abee7da2c89", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 403, "start_line": 20, "end_line": 20, "text": "Figure 11.3 suggests the most common distinction, that between an internal and anexternal firewall. An external firewall is placed at the edge of a local or enterprisenetwork, just inside the boundary router that connects to the Internet or some widearea network (WAN). One or more internal firewalls protect the bulk of the enter-prise network. Between these two types of firewalls are one or more networkeddevices in a region referred to as a DMZ (demilitarized zone) network. Systemsthat are externally accessible but need some protections are usually located onDMZ networks. Typically, the systems in the DMZ require or foster external con-nectivity, such as a corporate Web site, an e-mail server, or a DNS (domain namesystem) server."}, {"id": "bf0ae3ae1cab4ce7ea002f9c7b512cb8526db21c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 403, "start_line": 21, "end_line": 22, "text": "The external firewall provides a measure of access control and protection for the DMZ systems consistent with their need for external connectivity. The external"}, {"id": "8182ea11937ec61b55dbecacd484ddc0c983d24e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 404, "start_line": 1, "end_line": 17, "text": "11.5 / FIREWALL LOCATION AND CONFIGURATIONS 389 WorkstationsApplication and database serversWeb server(s)Email serverInternal DMZ networkBoundary router External firewall LAN switch LAN switchInternal firewallInternal protected networkDNS serverInternet Figure 11.3 Example Firewall Configuration firewall also provides a basic level of protection for the remainder of the enterprise network. In this type of configuration, internal firewalls serve three purposes: 1.The internal firewall adds more stringent filtering capability, compared to theexternal firewall, in order to protect enterprise servers and workstations fromexternal attack."}, {"id": "b76d814bb8f8dec15e9c9730185e88dc90d49438", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 404, "start_line": 18, "end_line": 18, "text": "2.The internal firewall provides two-way protection with respect to the DMZ. First,the internal firewall protects the remainder of the network from attacks launchedfrom DMZ systems. Such attacks might originate from worms, rootkits, bots, orother malware lodged in a DMZ system. Second, an internal firewall can protectthe DMZ systems from attack from the internal protected network."}, {"id": "9e4345fade1e5e7262ac97e5c1e607e63a875805", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 405, "start_line": 1, "end_line": 5, "text": "390 CHAPTER 11 / FIREWALLS 3.Multiple internal firewalls can be used to protect portions of the internal network from each other. For example, firewalls can be configured so thatinternal servers are protected from internal workstations and vice versa.A common practice is to place the DMZ on a different network interface onthe external firewall from that used to access the internal networks. Virtual Private Networks In today\u2019s distributed computing environment, the virtual private network (VPN)"}, {"id": "5772a0e09877ebe044857be50ea5fce50e540b7b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 405, "start_line": 6, "end_line": 7, "text": "offers an attractive solution to network managers. In essence, a VPN consists of a setof computers that interconnect by means of a relatively unsecure network and thatmake use of encryption and special protocols to provide security. At each corporatesite, workstations, servers, and databases are linked by one or more local area net-works (LANs). The Internet or some other public network can be used to intercon-nect sites, providing a cost savings over the use of a private network and offloadingthe wide area network management task to the public network provider. That samepublic network provides an access path for telecommuters and other mobileemployees to log on to corporate systems from remote sites. But the manager faces a fundamental requirement: security. Use of a public"}, {"id": "e36ad43e7dd12028774348edfdaa1b0517fb6d68", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 405, "start_line": 8, "end_line": 9, "text": "network exposes corporate traffic to eavesdropping and provides an entry point forunauthorized users. To counter this problem, a VPN is needed. In essence, a VPNuses encryption and authentication in the lower protocol layers to provide a secureconnection through an otherwise insecure network, typically the Internet. VPNs aregenerally cheaper than real private networks using private lines but rely on havingthe same encryption and authentication system at both ends.The encryption may beperformed by firewall software or possibly by routers. The most common protocolmechanism used for this purpose is at the IP level and is known as IPsec. An organization maintains LANs at dispersed locations. A logical means of"}, {"id": "4b69d0ac7cee4603d2bdc8f36eec2fabc87f6bdc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 405, "start_line": 10, "end_line": 11, "text": "implementing an IPsec is in a firewall, as shown in Figure 11.4, which essentiallyrepeats Figure 8.1. If IPsec is implemented in a separate box behind (internal to) thefirewall, then VPN traffic passing through the firewall in both directions isencrypted. In this case, the firewall is unable to perform its filtering function orother security functions, such as access control, logging, or scanning for viruses.IPsec could be implemented in the boundary router, outside the firewall. However,this device is likely to be less secure than the firewall and thus less desirable as anIPsec platform. Distributed Firewalls"}, {"id": "1f3f1b9450e7c77565a0f5e0d82ebc1d78b3bc2d", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 405, "start_line": 12, "end_line": 12, "text": "A distributed firewall configuration involves stand-alone firewall devices plus host-based firewalls working together under a central administrative control. Figure 11.5suggests a distributed firewall configuration. Administrators can configure host-resident firewalls on hundreds of servers and workstations as well as configurepersonal firewalls on local and remote user systems. Tools let the network adminis-trator set policies and monitor security across the entire network. These firewallsprotect against internal attacks and provide protection tailored to specific machinesand applications. Stand-alone firewalls provide global protection, including internalfirewalls and an external firewall, as discussed previously."}, {"id": "1dc63685d31a1c033792d825aefc8d863f2bfd66", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 406, "start_line": 1, "end_line": 31, "text": "11.5 / FIREWALL LOCATION AND CONFIGURATIONS 391 IP HeaderIP PayloadIP HeaderIPsec HeaderSecure IP Payload IPHeader IPsecHeader Secure IP Payload IP HeaderIPsec HeaderSecure IPPayload IP HeaderIP Payload Firewall with IPsecEthernet switchEthernet switchUser system with IPsec Firewall with IPsecPublic (Internet) or Private Network Figure 11.4 A VPN Security Scenario With distributed firewalls, it may make sense to establish both an internal and an external DMZ. Web servers that need less protection because they have less critical information on them could be placed in an external DMZ, outside the exter-nal firewall. What protection is needed is provided by host-based firewalls on theseservers. An important aspect of a distributed firewall configuration is security moni-"}, {"id": "51c3e85767afb62073605412c1b2392ce8492d81", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 406, "start_line": 32, "end_line": 38, "text": "toring. Such monitoring typically includes log aggregation and analysis, firewallstatistics, and fine-grained remote monitoring of individual hosts if needed. Summary of Firewall Locations and Topologies We can now summarize the discussion from Sections 11.4 and 11.5 to define aspectrum of firewall locations and topologies. The following alternatives can beidentified: \u2022Host-resident firewall: This category includes personal firewall software and firewall software on servers. Such firewalls can be used alone or as part of anin-depth firewall deployment. \u2022Screening router: A single router between internal and external networks with stateless or full packet filtering. This arrangement is typical for smalloffice/home office (SOHO) applications."}, {"id": "a841024649ec8a8faf2bb16a87310dee8674668f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 407, "start_line": 1, "end_line": 24, "text": "392 CHAPTER 11 / FIREWALLS WorkstationsApplication and database serversWeb server(s)Email serverInternal DMZ networkBoundary router External firewall LAN switch LAN switch host-resident firewallInternal firewall Internal protected networkDNS serverInternet Web server(s)External DMZ networkRemote users Figure 11.5 Example Distributed Firewall Configuration \u2022Single bastion inline: A single firewall device between an internal and external router (e.g., Figure 11.1a). The firewall may implement stateful filters and/or application proxies. This is the typical firewall appliance configuration forsmall to medium-sized organizations."}, {"id": "eb027ae601eb4d977a11021834fc2b137b57891f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 408, "start_line": 1, "end_line": 7, "text": "11.6 / RECOMMENDED READING AND WEB SITE 393 \u2022Single bastion T: Similar to single bastion inline but has a third network interface on bastion to a DMZ where externally visible servers are placed. Again, this is a common appliance configuration for medium to largeorganizations. \u2022Double bastion inline: Figure 11.3 illustrates this configuration, where the DMZ is sandwiched between bastion firewalls. This configuration is commonfor large businesses and government organizations. \u2022Double bastion T: The DMZ is on a separate network interface on the bastion"}, {"id": "c7d44afe7c3345ade145592769da93722926a5ef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 408, "start_line": 8, "end_line": 14, "text": "firewall. This configuration is also common for large businesses and govern-ment organizations and may be required. For example, this configuration isrequired for Australian government use (Australian Government InformationTechnology Security Manual - ACSI33). \u2022Distributed firewall configuration: Illustrated in Figure 11.5. This configura- tion is used by some large businesses and government organizations. 11.6 RECOMMENDED READING AND WEB SITE A classic treatment of firewalls is [CHES03]. [LODI98], [OPPL97], and [BELL94b] are good overview articles on the subject. [WACK02] is an excellent overview of firewall technologyand firewall policies. [AUDI04] and [WILS05] provide useful discussions of firewalls. AUDI04 Audin, G. \u201cNext-Gen Firewalls: What to Expect.\u201d Business Communications"}, {"id": "37dd07b022e321a93cb67e399833f28b16b68092", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 408, "start_line": 15, "end_line": 29, "text": "Review , June 2004. BELL94b Bellovin, S., and Cheswick, W. \u201cNetwork Firewalls.\u201d IEEE Communications Magazine , September 1994. CHAP00 Chapman, D., and Zwicky, E. Building Internet Firewalls. Sebastopol, CA: O\u2019Reilly, 2000. CHES03 Cheswick, W., and Bellovin, S. Firewalls and Internet Security: Repelling the Wily Hacker . Reading, MA: Addison-Wesley, 2003. LODI98 Lodin, S., and Schuba, C. \u201cFirewalls Fend Off Invasions from the Net.\u201d IEEE Spectrum , February 1998. OPPL97 Oppliger, R. \u201cInternet Security: Firewalls and Beyond.\u201d Communications of the ACM , May 1997. WACK02 Wack, J.; Cutler, K.; and Pole, J. Guidelines on Firewalls and Firewall Policy . NIST Special Publication SP 800-41, January 2002. WILS05 Wilson, J.\u201cThe Future of the Firewall.\u201d Business Communications Review , May 2005."}, {"id": "f292651bc66511f37974425d362620fd31fc6980", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 408, "start_line": 30, "end_line": 31, "text": "Recommended Web Site: \u2022Firewall.com: Numerous links to firewall references and software resources."}, {"id": "aba240558b6ad350d31c022066469fd028d2c6e1", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 409, "start_line": 1, "end_line": 15, "text": "394 CHAPTER 11 / FIREWALLS 11.7 KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS Key Terms Review Questions 11.1 List three design goals for a firewall. 11.2 List four techniques used by firewalls to control access and enforce a security policy. 11.3 What information is used by a typical packet filtering firewall? 11.4 What are some weaknesses of a packet filtering firewall? 11.5 What is the difference between a packet filtering firewall and a stateful inspection firewall? 11.6 What is an application-level gateway? 11.7 What is a circuit-level gateway? 11.8 What are the differences among the firewalls of Figure 11.1? 11.9 What are the common characteristics of a bastion host? 11.10 Why is it useful to have host-based firewalls?"}, {"id": "d6a298ad88be9abda3fc9f68a9b45b2636188356", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 409, "start_line": 16, "end_line": 19, "text": "11.11 What is a DMZ network and what types of systems would you expect to find on suchnetworks? 11.12 What is the difference between an internal and an external firewall? Problems 11.1 As was mentioned in Section 11.3, one approach to defeating the tiny fragment attackis to enforce a minimum length of the transport header that must be contained in thefirst fragment of an IP packet. If the first fragment is rejected, all subsequent frag-ments can be rejected. However, the nature of IP is such that fragments may arriveout of order. Thus, an intermediate fragment may pass through the filter before theinitial fragment is rejected. How can this situation be handled?"}, {"id": "ae070a2851d587870eda6c4a306c2640abd2edb2", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 409, "start_line": 20, "end_line": 21, "text": "11.2 In an IPv4 packet, the size of the payload in the first fragment, in octets, is equal toTotal Length \u2013 (4 \u00d7IHL). If this value is less than the required minimum (8 octets for TCP), then this fragment and the entire packet are rejected. Suggest an alternativemethod of achieving the same result using only the Fragment Offset field."}, {"id": "061a8a949bf832f0223204b9c2de0f546f40b3ab", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 409, "start_line": 22, "end_line": 22, "text": "11.3 RFC 791, the IPv4 protocol specification, describes a reassembly algorithm thatresults in new fragments overwriting any overlapped portions of previously receivedfragments. Given such a reassembly implementation, an attacker could construct aseries of packets in which the lowest (zero-offset) fragment would contain innocuousdata (and thereby be passed by administrative packet filters), and in which some sub-sequent packet having a non-zero offset would overlap TCP header information (des-tination port, for instance) and cause it to be modified. The second packet would bepassed through most filter implementations because it does not have a zero fragmentoffset. Suggest a method that could be used by a packet filter to counter this attack.application-level gateway"}, {"id": "284776fce955f86688ac977f18f794083eadccad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 409, "start_line": 23, "end_line": 23, "text": "bastion hostcircuit-level gatewaydistributed firewallsDMZfirewallhost-based firewallIP address spoofingIP security (IPsec)packet filtering firewallpersonal firewallproxystateful inspection firewalltiny fragment attackvirtual private network (VPN)"}, {"id": "4f6d9e04a1385302815e912dd5815fcf84cbe437", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 410, "start_line": 1, "end_line": 5, "text": "11.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 395 11.4 Table 11.3 shows a sample of a packet filter firewall ruleset for an imaginary network of IP address that range from 192.168.1.0 to 192.168.1.254. Describe the effect of eachrule. 11.5 SMTP (Simple Mail Transfer Protocol) is the standard protocol for transferring mailbetween hosts over TCP . A TCP connection is set up between a user agent and aserver program. The server listens on TCP port 25 for incoming connection requests.The user end of the connection is on a TCP port number above 1023. Suppose youwish to build a packet filter rule set allowing inbound and outbound SMTP traffic.You generate the following ruleset:Table 11.3 Sample Packet Filter Firewall Ruleset Source Address Source Port Dest Address Dest Port Action"}, {"id": "c7295fe75ec1531e29fc3a95642e8fb4613ba495", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 410, "start_line": 6, "end_line": 23, "text": "1 Any Any 192.168.1.0 > 1023 Allow 2 192.168.1.1 Any Any Any Deny 3 Any Any 192.168.1.1 Any Deny 4 192.168.1.0 Any Any Any Allow 5 Any Any 192.168.1.2 SMTP Allow 6 Any Any 192.168.1.3 HTTP Allow 7 Any Any Any Any Deny Rule Direction Src Addr Dest Addr Protocol Dest Port Action A In External Internal TCP 25 Permit B Out Internal External TCP >1023 Permit C Out Internal External TCP 25 Permit D In External Internal TCP >1023 Permit E Either Any Any Any Any Deny Packet Direction Src Addr Dest Addr Protocol Dest Port Action 1 In 192.168.3.4 172.16.1.1 TCP 25 ? 2 Out 172.16.1.1 192.168.3.4 TCP 1234 ? 3 Out 172.16.1.1 192.168.3.4 TCP 25 ? 4 In 192.168.3.4 172.16.1.1 TCP 1357 ?a.Describe the effect of each rule."}, {"id": "b731e022d4fec9f4f8e9962062b2a0ed5542abcc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 410, "start_line": 24, "end_line": 26, "text": "b.Your host in this example has IP address 172.16.1.1. Someone tries to send e-mailfrom a remote host with IP address 192.168.3.4. If successful, this generates anSMTP dialogue between the remote user and the SMTP server on your host con-sisting of SMTP commands and mail. Additionally, assume that a user on yourhost tries to send e-mail to the SMTP server on the remote system. Four typicalpackets for this scenario are as shown: Indicate which packets are permitted or denied and which rule is used in each case."}, {"id": "a468265cb54962fb1e8c3f17d564928099cfb8ed", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 411, "start_line": 1, "end_line": 10, "text": "396 CHAPTER 11 / FIREWALLS c.Someone from the outside world (10.1.2.3) attempts to open a connection from port 5150 on a remote host to the Web proxy server on port 8080 on one of yourlocal hosts (172.16.3.4), in order to carry out an attack. Typical packets are asfollows: Will the attack succeed? Give details. 11.6 To provide more protection, the ruleset from the preceding problem is modified as follows: a.Describe the change. b.Apply this new ruleset to the same six packets of the preceding problem. Indicate which packets are permitted or denied and which rule is used in each case. 11.7 A hacker uses port 25 as the client port on his or her end to attempt to open a con-nection to your Web proxy server.a.The following packets might be generated:"}, {"id": "ee9201280ab4e8e4ab52cd8d6b4557c42f99bc1b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 411, "start_line": 11, "end_line": 13, "text": "Explain why this attack will succeed, using the ruleset of the preceding problem. b.When a TCP connection is initiated, the ACK bit in the TCP header is not set. Subsequently, all TCP headers sent over the TCP connection have the ACK bitset. Use this information to modify the ruleset of the preceding problem toprevent the attack just described."}, {"id": "1b4e5226ba07446da70445e0ebb8e139fc13f2f9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 411, "start_line": 14, "end_line": 14, "text": "11.8 A common management requirement is that \u201call external Web traffic must flow viathe organization\u2019s Web proxy.\u201d However, that requirement is easier stated than imple-mented. Discuss the various problems and issues, possible solutions, and limitationswith supporting this requirement. In particular consider issues such as identifyingexactly what constitutes \u201cWeb traffic\u201d and how it may be monitored, given the largerange of ports and various protocols used by Web browsers and servers."}, {"id": "fabb854b7f9f35c94e3c96bf9a575301d2e433d9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 411, "start_line": 15, "end_line": 23, "text": "11.9 Consider the threat of \u201ctheft/breach of proprietary or confidential information held inkey data files on the system.\u201d One method by which such a breach might occur isthe accidental/deliberate e-mailing of information to a user outside to the organiza-tion. A possible countermeasure to this is to require all external e-mail to be given aPacket Direction Src Addr Dest Addr Protocol Dest Port Action 5 In 10.1.2.3 172.16.3.4 TCP 8080 ? 6 Out 172.16.3.4 10.1.2.3 TCP 5150 ? Rule Direction Src Addr Dest Addr Protocol Src Port Dest Port Action A In External Internal TCP >1023 25 Permit B Out Internal External TCP 25 >1023 Permit C Out Internal External TCP >1023 25 Permit D In External Internal TCP 25 >1023 Permit E Either Any Any Any Any Any Deny"}, {"id": "dede5772b23c24ecadad02bcea39599852d31bef", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 411, "start_line": 24, "end_line": 26, "text": "Packet Direction Src Addr Dest Addr Protocol Src Port Dest Port Action 7 In 10.1.2.3 172.16.3.4 TCP 25 8080 ? 8 Out 172.16.3.4 10.1.2.3 TCP 8080 25 ?"}, {"id": "790a835fe21f47ff4210d04c5ba0dcc0d66d22c6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 412, "start_line": 1, "end_line": 7, "text": "11.7 / KEY TERMS, REVIEW QUESTIONS,AND PROBLEMS 397 sensitivity tag (classification if you like) in its subject and for external e-mail to have the lowest sensitivity tag. Discuss how this measure could be implemented in a firewalland what components and architecture would be needed to do this. 11.10 You are given the following \u201cinformal firewall policy\u201d details to be implementedusing a firewall like that in Figure 11.3: 1.E-mail may be sent using SMTP in both directions through the firewall, but it must be relayed via the DMZ mail gateway that provides header sanitization andcontent filtering. External e-mail must be destined for the DMZ mail server. 2.Users inside may retrieve their e-mail from the DMZ mail gateway, using eitherPOP3 or POP3S, and authenticate themselves."}, {"id": "83744ed2f36d9949037ab3cddf9a43b80b3027aa", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 412, "start_line": 8, "end_line": 12, "text": "3.Users outside may retrieve their e-mail from the DMZ mail gateway, but only ifthey use the secure POP3 protocol, and authenticate themselves 4.Web requests (both insecure and secure) are allowed from any internal user outthrough the firewall but must be relayed via the DMZ Web proxy, which providescontent filtering (noting this is not possible for secure requests), and users mustauthenticate with the proxy for logging. 5.Web requests (both insecure and secure) are allowed from anywhere on theInternet to the DMZ Web server 6.DNS lookup requests by internal users allowed via the DMZ DNS server, whichqueries to the Internet. 7.External DNS requests are provided by the DMZ DNS server."}, {"id": "e6db91692fe6d413383bee034a0e529e40b2fa50", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 412, "start_line": 13, "end_line": 15, "text": "8.Management and update of information on the DMZ servers is allowed usingsecure shell connections from relevant authorized internal users (may have differ-ent sets of users on each system as appropriate). 9.SNMP management requests are permitted from the internal management hoststo the firewalls, with the firewalls also allowed to send management traps (i.e.,notification of some event occurring) to the management hosts Design suitable packet filter rulesets (similar to those shown in Table 11.1) to beimplemented on the \u201cExternal Firewall\u201d and the \u201cInternal Firewall\u201d to satisfy theaforementioned policy requirements."}, {"id": "149ee50d82721256df65d1faa908e1462940aca3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 413, "start_line": 1, "end_line": 7, "text": "APPENDIX A SOME ASPECTS OF NUMBER THEORY A.1 Prime and Relatively Prime Numbers Divisors Prime NumbersRelatively Prime Numbers A.2 Modular Arithmetic 398"}, {"id": "946e96a6050080603631ec57ab955a0ddf2d7dd0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 414, "start_line": 1, "end_line": 10, "text": "A.1 / PRIME AND RELATIVELY PRIME NUMBERS 399 The Devil said to Daniel W ebster:\u201cSet me a task I can\u2019t carry out, and I\u2019ll give you anything in the world you ask for.\u201d Daniel W ebster:\u201cFair enough. Prove that for n greater than 2, the equation an+ bn= cn has no non-trivial solution in the integers.\u201d They agreed on a three-day period for the labor, and the Devil disappeared.At the end of three days, the Devil presented himself, haggard, jumpy, biting his lip. Daniel W ebster said to him,\u201cW ell, how did you do at my task? Did you prove the theorem?\u201d \u201cEh? No ...n o , I h a v e n \u2019 t p r o v e d it.\u201d \u201cThen I can have whatever I ask for? Money? The Presidency?\u201d\u201cWhat? Oh, that\u2014of course. But listen! If we could just prove the following two lemmas\u2014\u201d \u2014The Mathematical Magpie, Clifton Fadiman"}, {"id": "1d2c744c3e13775d35bce0ad42d109d9b9b008ff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 414, "start_line": 11, "end_line": 23, "text": "In this appendix, we provide some background on two concepts referenced in thisbook: prime numbers and modular arithmetic. A.1 PRIME AND RELATIVELY PRIME NUMBERS In this section, unless otherwise noted, we deal only with nonnegative integers. Theuse of negative integers would introduce no essential differences. Divisors We say that b 0 divides a if am b for some m , where a,b, and mare integers. That is,bdivides aif there is no remainder on division. The notation bais commonly used to mean b divides a. Also, if ba, we say that b is a divisor of a. For example, the positive divisors of 24 are 1, 2, 3, 4, 6, 8, 12, and 24. The following relations hold: \u2022If a1, then a ;1. \u2022If ab and ba , then a =;b. \u2022Any b 0 divides 0. \u2022If bg and bh , then b (mg +nh) for arbitrary integers mand n."}, {"id": "742459e271699df10199bea8677a9ead769a8461", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 414, "start_line": 24, "end_line": 32, "text": "To see this last point, note that If bg , then g is of the form g=b\u00d7g1for some integer g1. If bh , then h is of the form h=b\u00d7h1for some integer h1. So mg+nh=mbg 1+nbh 1=b\u00d7(mg 1+nh1) and therefore bdivides mg+nh. Prime Numbers An integer p > 1 is a prime number if its only divisors are ;1 and ; p. Prime numbers play a critical role in number theory and in the techniques discussed inChapter 3.\u0192\u0192\u0192 \u0192 \u0192Z\u0192 \u0192= \u0192\u0192\u0192= Z"}, {"id": "61a996422ff89ea1d16317068b79dd2902f2ce80", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 415, "start_line": 1, "end_line": 11, "text": "400 APPENDIX A / SOME ASPECTS OF NUMBER THEORY Any integer a > 1 can be factored in a unique way as where p16p266 ptare prime numbers and where each aiis a positive integer. For example, 91 =7 \u00d713 and 11011 = 7 \u00d7112\u00d713. It is useful to cast this another way. If P is the set of all prime numbers, then any positive integer can be written uniquely in the following form: The right-hand side is the product over all possible prime numbers p; for any particular value of a , most of the exponents a pwill be 0. The value of any given positive integer can be specified by simply listing all the nonzero exponents in the foregoing formulation. Thus, the integer 12 is represented by {a 2=2,a3=1}, and the integer 18 is represented by { a2=1,a3=2}. Multiplication"}, {"id": "c4d1d20759903c0eb81a603224f0e30d7e8d65ff", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 415, "start_line": 12, "end_line": 25, "text": "of two numbers is equivalent to adding the corresponding exponents: k=mn kp=mp+np for all p What does it mean, in terms of these prime factors, to say that ab? Any integer of the form pkcan be divided only by an integer that is of a lesser or equal power of the same prime number, pjwith j \u2264k. Thus, we can say ab a p bp for all p Relatively Prime Numbers We will use the notation gcd ( a,b) to mean the greatest common divisor of aand b. The positive integer cis said to be the greatest common divisor of aand b if 1.cis a divisor of aand of b. 2.Any divisor of aand b is a divisor of c. An equivalent definition is the following: gcd(a, b) = max[ k, such that ka and k b] Because we require that the greatest common divisor be positive, gcd( a,b) ="}, {"id": "177d9bd8c7e087e8b54a0d22e6b3e36436921102", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 415, "start_line": 26, "end_line": 36, "text": "gcd(a ,-b) =gcd(- a,b) =gcd(- a,-b). In general, gcd(a ,b) =gcd( a,b). For example, gcd(60, 24) =gcd(60, -24) =12. Also, because all nonzero integers divide 0, we have gcd(a , 0) = a It is easy to determine the greatest common divisor of two positive integers if we express each integer as the product of primes. For example, 300 = 22\u00d731\u00d752 18 = 21\u00d732 gcd(18, 300) = 21\u00d731\u00d750=6 In general, k=gcd(a, b) kp=min(a p,bp) for all p :\u0192.\u0192\u0192 \u0192 \u0192 \u0192\u0192 \u0192\u2026 : \u0192\u0192:a=q p /H20678 Ppap where each ap\u00da0\u00c1a=p1a1*p2a2*\u00c1* ptat"}, {"id": "7b8a6d64a84c0910fb32a65bccc03cb128c12a66", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 416, "start_line": 1, "end_line": 13, "text": "A.2 / MODULAR ARITHMETIC 401 Determining the prime factors of a large number is no easy task, so the preceding relationship does not directly lead to a way of calculating the greatest common divisor. The integers aand bare relatively prime if they have no prime factors in com- mon, that is, if their only common factor is 1. This is equivalent to saying that aand bare relatively prime if gcd( a,b) =1. For example, 8 and 15 are relatively prime because the divisors of 8 are 1, 2, 4, and 8, and the divisors of 15 are 1, 3, 5, and 15, so1 is the only number on both lists. A.2 MODULAR ARITHMETIC Given any positive integer n and any nonnegative integer a, if we divide a by n, we get an integer quotient qand an integer remainder rthat obey the following relationship: a=qn+r 0r6n;q="}, {"id": "e42e2afa0643a0308850c4a9fbd49e1c62e6911c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 416, "start_line": 14, "end_line": 29, "text": "where xis the largest integer less than or equal to x. Figure A.1a demonstrates that, given aand positive n , it is always possible to find q and rthat satisfy the preceding relationship. Represent the integers on the number line; awill fall somewhere on that line (positive ais shown, a similar demonstration can be made for negative a). Starting at 0, proceed to n,2n, up to qnsuch that qn a and (q +1)n> a. The distance from qnto ais r, and we have found the unique values of qand r. The remainder ris often referred to as a residue. If ais an integer and n is a positive integer, we define a mod nto be the remainder when a is divided by n .Thus, for any integer a, we can always write: a=a/n \u00d7n+(amod n) ; :\u2026; ::a/n; \u2026 0n 2n 3n qn (q + 1)n an r (a) General relationship 01 515 1030 = 2 1570"}, {"id": "91a27e097ed6d6295ac03caa76dab50b34a819e6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 416, "start_line": 30, "end_line": 34, "text": "(b) Example: 70 = (4 15) + 1045 = 3 1560 = 4 1575 = 5 15 Figure A.1 The Relationship a=qn+r;0 r6n \u2026"}, {"id": "6667a6b104f4dd54abeae54448e1c620b9004497", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 417, "start_line": 1, "end_line": 14, "text": "402 APPENDIX A / SOME ASPECTS OF NUMBER THEORY Two integers aand bare said to be congruent modulo n, if (amod n) =(bmod n). This is written ab mod n. For example, 73 4 mod 23 and 21 -9 mod 10. Note that if a 0 mod n , then na . The modulo operator has the following properties: 1.ab mod n if n(a-b). 2.(amod n) = (bmod n) implies ab mod n. 3.ab mod n implies ba mod n. 4.ab mod n and bc mod n imply ac mod n. To demonstrate the first point, if n (a-b), then ( a-b) =knfor some k . So we can write a=b+kn. Therefore, (a mod n) =(remainder when b +knis divided by n ) = (remainder when b is divided by n ) =(bmod n). The remaining points are as easily proved. The (mod n ) operator maps all integers into the set of integers {0, 1, ,"}, {"id": "345b58bc90ccb24bca798d5649d4f87204b68774", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 417, "start_line": 15, "end_line": 29, "text": "(n-1)}. This suggests the question: Can we perform arithmetic operations within the confines of this set? It turns out that we can; the technique is known as modular arithmetic. Modular arithmetic exhibits the following properties: 1.[(amod n) + (bmod n)] mod n=(a+b) mod n 2.[(amod n) - (bmod n)] mod n=(a-b) mod n 3.[(amod n) \u00d7 (bmod n)] mod n=(a\u00d7b) mod n We demonstrate the first property. Define ( amod n) =raand (b mod n) =rb. Then we can write a=ra+jnfor some integer jand b=rb+knfor some integer k. Then (a+b) mod n=(ra+jn+rb+kn) mod n =(ra+rb+(k + j)n) mod n =(ra+rb) mod n =[(amod n) + (bmod n)] mod n The remaining properties are as easily proved.\u00c1\u0192K K KK KK\u0192 K\u0192 KK K K"}, {"id": "b7b70a474bc0a4578ddb56fb230f781dd862a1b0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 418, "start_line": 1, "end_line": 10, "text": "APPENDIX B PROJECTS FOR TEACHING NETWORK SECURITY B.1 Research Projects B.2 Hacking Project B.3 Programming Projects B.4 Laboratory Exercises B.5 Practical Security Assessments B.6 Writing Assignments B.7 Reading/Report Assignments 403"}, {"id": "58a5822305ab2cbe520af699f3ffdf559061fa71", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 419, "start_line": 1, "end_line": 5, "text": "404 APPENDIX B / PROJECTS FOR TEACHING NETWORK SECURITY Analysis and observation, theory and experience must never disdain or exclude each other; on the contrary, they support each other. \u2014On W ar, Carl Von Clausewitz Many instructors believe that research or implementation projects are crucial tothe clear understanding of network security.Without projects, it may be difficult forstudents to grasp some of the basic concepts and interactions among components.Projects reinforce the concepts introduced in the book, give the student a greaterappreciation of how a cryptographic algorithm or protocol works, and can motivatestudents and give them confidence that they are capable of not only understandingbut implementing the details of a security capability."}, {"id": "b3a3359b9b98642a4f6422c2620aaf9c2cdbd82c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 419, "start_line": 6, "end_line": 16, "text": "In this text, I have tried to present the concepts of network security as clear- ly as possible and have provided numerous homework problems to reinforcethose concepts. However, many instructors will wish to supplement this materialwith projects. This appendix provides some guidance in that regard and describessupport material available in the Instructor\u2019s Resource Center (IRC) for this book, accessible to instructors from Prentice Hall. The support material coversseven types of projects: 1.Research projects 2.Hacking project 3.Programming projects 4.Laboratory exercises 5.Practical security assessments 6.Writing assignments 7.Reading/report assignments B.1 RESEARCH PROJECTS"}, {"id": "42a34f597b87863f7e089506ac82a0177a069c18", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 419, "start_line": 17, "end_line": 21, "text": "An effective way of reinforcing basic concepts from the course and for teachingstudents research skills is to assign a research project. Such a project could involvea literature search as well as an Internet search of vendor products, research labactivities, and standardization efforts. Projects could be assigned to teams or, forsmaller projects, to individuals. In any case, it is best to require some sort of projectproposal early in the term, giving the instructor time to evaluate the proposal forappropriate topic and appropriate level of effort. Student handouts for researchprojects should include \u2022A format for the proposal \u2022A format for the final report \u2022A schedule with intermediate and final deadlines \u2022A list of possible project topics"}, {"id": "6c7416f04c7b7b6628d89bd37a7e1404680142e9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 419, "start_line": 22, "end_line": 24, "text": "The students can select one of the topics listed in the instructor\u2019s manual or devise their own comparable project. The IRC includes a suggested format for the proposal and final report as well as a list of fifteen possible research topics."}, {"id": "68c20da9cbb01387ac0178e5bfa57418e7b2ee7c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 420, "start_line": 1, "end_line": 5, "text": "B.3 / PROGRAMMING PROJECTS 405 B.2 HACKING PROJECT The aim of this project is to hack into a corporation\u2019s network through a series of steps. The Corporation is named Extreme In Security Corporation. As the nameindicates, the corporation has some security holes in it, and a clever hacker is able toaccess critical information by hacking into its network. The IRC includes what isneeded to set up the Web site.The student\u2019s goal is to capture the secret informationabout the price on the quote the corporation is placing next week to obtain acontract for a governmental project. The student should start at the Web site and find his or her way into the network."}, {"id": "fdc14a825d14ba918c1f9f17f96f5381daf6f66e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 420, "start_line": 6, "end_line": 17, "text": "At each step, if the student succeeds, there are indications as to how to proceed on tothe next step as well as the grade until that point. The project can be attempted in three ways: 1.Without seeking any sort of help. 2.Using some provided hints. 3.Using exact directions. The IRC includes the files needed for this project: 1.Web Security project. 2.Web Hacking exercises (XSS and Script-attacks) covering client-side and server- side vulnerability exploitations, respectively. 3.Documentation for installation and use for the above. 4.A PowerPoint file describing Web hacking.This file is crucial to understandinghow to use the exercises since it clearly explains the operation using screenshots. This project was designed and implemented by Professor Sreekanth Malladi"}, {"id": "e49971414b4b2c9903249a00d9a7b546c9398c6f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 420, "start_line": 18, "end_line": 26, "text": "of Dakota State University. B.3 PROGRAMMING PROJECTS The programming project is a useful pedagogical tool. There are several attractive features of stand-alone programming projects that are not part of an existing securityfacility. 1.The instructor can choose from a wide variety of cryptography and networksecurity concepts to assign projects. 2.The projects can be programmed by the students on any available computerand in any appropriate language; they are platform and language independent. 3.The instructor need not download, install, and configure any particular infra-structure for stand-alone projects. There is also flexibility in the size of projects. Larger projects give students more a sense of achievement, but students with less ability or fewer organizational skills can"}, {"id": "61dd4f881e0fe76149de53abbd92ff6bcca670ca", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 420, "start_line": 27, "end_line": 27, "text": "be left behind. Larger projects usually elicit more overall effort from the best students.Smaller projects can have a higher concepts-to-code ratio, and because more of themcan be assigned, the opportunity exists to address a variety of different areas."}, {"id": "555db9329af535ed0a8680b28251843011473f1b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 421, "start_line": 1, "end_line": 7, "text": "406 APPENDIX B / PROJECTS FOR TEACHING NETWORK SECURITY Again, as with research projects, the students should first submit a proposal. The student handout should include the same elements listed in Section A.1. The IRC includes a set of twelve possible programming projects. The following individuals have supplied the research and programming projects suggested in the instructor\u2019s manual: Henning Schulzrinne of Columbia University;Cetin Kaya Koc of Oregon State University; and David M. Balenson of Trusted Infor-mation Systems and George Washington University. B.4 LABORATORY EXERCISES"}, {"id": "ac14bf59107e29b3d70e95cfbe210822b9600bd9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 421, "start_line": 8, "end_line": 9, "text": "Professor Sanjay Rao and Ruben Torres of Purdue University have prepared a set oflaboratory exercises that are part of the IRC. These are implementation projectsdesigned to be programmed on Linux but could be adapted for any Unix environment.These laboratory exercises provide realistic experience in implementing security func-tions and applications. B.5 PRACTICAL SECURITY ASSESSMENTS"}, {"id": "03e4147b6117bf4e9d277c90a761005e2c400b50", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 421, "start_line": 10, "end_line": 10, "text": "Examining the current infrastructure and practices of an existing organization is oneof the best ways of developing skills in assessing its security posture. The IRCcontains a list of such activities. Students, working either individually or in smallgroups, select a suitable small-to-medium-sized organization. They then interviewsome key personnel in that organization in order to conduct a suitable selection ofsecurity risk assessment and review tasks as it relates to the organization\u2019s IT infra-structure and practices.As a result, they can then recommend suitable changes, whichcan improve the organization\u2019s IT security. These activities help students develop anappreciation of current security practices and the skills needed to review these andrecommend changes."}, {"id": "1b54b2fe568dc29594d813e74abd1d730a38a9b6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 421, "start_line": 11, "end_line": 14, "text": "Lawrie Brown of the Australian Defence Force Academy developed these projects. B.6 WRITING ASSIGNMENTS Writing assignments can have a powerful multiplier effect in the learning processin a technical discipline such as cryptography and network security. Adherents ofthe Writing Across the Curriculum (WAC) movement (http://wac.colostate.edu/)report substantial benefits of writing assignments in facilitating learning.Writing assignments lead to more detailed and complete thinking about a particu-lar topic. In addition, writing assignments help to overcome the tendency of stu-dents to pursue a subject with a minimum of personal engagement\u2014just learningfacts and problem-solving techniques without obtaining a deep understanding ofthe subject matter."}, {"id": "958b327d698958777fefc637ab964481dd863bd5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 421, "start_line": 15, "end_line": 16, "text": "The IRC contains a number of suggested writing assignments, organized by chapter. Instructors may ultimately find that this is an important part of theirapproach to teaching the material. I would greatly appreciate any feedback on thisarea and any suggestions for additional writing assignments."}, {"id": "7f3dd709e6d3fe8c5fb55fd6b2f8641f4c2d1373", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 422, "start_line": 1, "end_line": 4, "text": "B.7 / READING/REPORT ASSIGNMENTS 407 B.7 READING/REPORT ASSIGNMENTS Another excellent way to reinforce concepts from the course and to give students research experience is to assign papers from the literature to be read and analyzed.The IRC includes a suggested list of papers, one or two per chapter, to be assigned.The IRC provides a PDF copy of each of the papers. The IRC also includes a sug-gested assignment wording."}, {"id": "fc5d6e5a14f865e51d8348780015a72a90a2263c", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 423, "start_line": 1, "end_line": 11, "text": "408A Access, 16, 21 control, 16 threats, 22 Access control, 15 defined, 16 Access point (AP), IEEE 802.11, 180, 182Active attacks, security, 11\u201314Add Round Key, AES, 40AES, seeAdvanced Encryption Standard (AES) Alert codes, TLS, 158\u2013159Algorithms, 28, 34\u201341, 83\u201390, 211\u2013214, 249\u2013251, 283 cryptographic, 211\u2013214, 249\u2013251ESP , 283S/MIME, 249\u2013251WTLS, 211\u2013214 Advanced Encryption Standard (AES), 34, 38\u201341"}, {"id": "a65b71733bc74ca6e38605f44c81b719a6bffa85", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 423, "start_line": 12, "end_line": 17, "text": "Add Round Key, 40algorithm, 38\u201341Data Encryption (DEA), 35Data Encryption Standard (DES), 34\u201338decryption, defined, 29Diffie-Hellman key exchange, 85\u201389Digital Signature (DSA), 89elliptic curve cryptography (ECC), 89\u201390encryption, 28mix columns, 40public-key cryptography, 83\u201390RSA public-key encryption, 83\u201385shift rows, 40state array, 38structure, 39subkey generation, 34substitution bytes, 40symmetric block encryption, 34\u201341triple Data Encryption Standard (3DES), 36\u201338 Anti-replay service, ESP , 284Architecture, 9 open systems interconnection (OSI), 9 Attacks, 10\u201314, 32\u201333, 90\u201391, 114. See also Security attacks; Threats; Cryptanalysis"}, {"id": "8bca1b1bff106d5654b744b97ecbf707fe8a9451", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 423, "start_line": 18, "end_line": 27, "text": "active, 12chosen plaintext, 31ciphertext only, 30\u201331denial-of-service (DoS), 16known plaintext, 30\u201331man-in-the-middle, 88\u201389messages, types of for, 31passive, 10\u201311password, 112security, 10\u201314 Authentication, 14\u201315, 63\u201398, 99\u2013140, 154\u2013156, 187, 190\u2013192, 213\u2013214, 226\u2013228, 235\u2013236, 292, 297\u2013298. See also Message authentication; Message authentication codes (MAC) applications, 97\u2013138client/server exchange, 113data origin, 15, 18dialogues, 100\u2013106, 112\u2013114forwarding, 111IEEE 802.11i phase, 185, 188\u2013190IKE key determination, 295\u2013296Internet Protocol (IP), 290interrealm, 111Kerberos, 99\u2013114key exchange client and server, SSL, 152\u2013154 message, 61\u201396, 233\u2013234peer entity, 15pretty good privacy (PGP), 224\u2013227, 233\u2013234 public-key infrastructure (PKI), 124\u2013126recommended reading and Web sites,"}, {"id": "d2c452f26315c2789d3d5a54fc945eed79e24885", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 423, "start_line": 28, "end_line": 33, "text": "132\u2013133 server (AS), 101service exchange, 112\u2013113timestamp, 233\u2013234WTLS, 211\u2013212X.509 service, 116\u2013124 Authority key identifier, 123 B Base-64 (radix-64) transfer encoding, 247Basic service set (BSS), IEEE 802.11, 179\u2013180Block ciphers, 30, 34, 45, 50\u201353 cipher block chaining (CBC) mode, 50, 51cipher feedback (CFB) mode, 52\u201353defined, 45design of, 34electronic codebook (ECB), 50modes of operation, 54plaintext processing, cryptography, 30Index"}, {"id": "8fb09dadb5194c4125829632d1e04593799117c8", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 424, "start_line": 1, "end_line": 6, "text": "INDEX 409 C Canonical form, MIME and S/MIME, 247 Certificates, 114\u2013115, 116\u2013118, 125, 152\u2013154, 159\u2013160, 254\u2013257 certification authority (CA), 114, 116, 255enhanced security services, 257extensions, 118forward, 120issuer, 117, 118, 123\u2013124key information, 122path constraints, 124period of validity, 117PKI certification, 126policy information, 122policy mappings, 123public-key, 114\u2013115, 116reverse, 120revocation list (CRL), 122, 254revocation of, 121\u2013122serial number, 117signature, 118signature algorithm identifier, 117S/MIME, 254\u2013257SSL messages for key exchange, 152\u2013154subject, 117, 123\u2013124TLS client types, 159\u2013160unique identifiers, 118user, 255user\u2019s, obtaining, 118\u2013121VeriSign, 255\u2013257version, 117X.507, 116\u2013118"}, {"id": "ecd2b220cc0ddb02ba9b69c46aef485cd801c2f5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 424, "start_line": 7, "end_line": 17, "text": "Certificates-only message, S/MIME, 254Certification authority (CA), 114, 116, 124\u2013125 key distribution, 114public-key infrastructure (PKI), 125\u2013126SET, 244VeriSign certificates, 163X.509 certificates, 116 Change Cipher Spec Protocol, 143, 147\u2013148, 154, 207\u2013208 Channels, SSH, 169\u2013170Cipher block chaining (CBC) mode, 46\u201347Cipher feedback (CFB) mode, 52\u201353Cipher suites, TLS, 159Ciphertext, 29, 81Clear signing, S/MIME, 253\u2013254Client/server authentication exchange, 113Code, 64\u201365 message authentication (MAC), 64\u201365Codebook, 50 defined, 50electronic (ECB), 50 Compression, 227\u2013228 PGP , 227\u2013228SSL, 145 Computer security, defined, 2Confidentiality, 15\u201316, 27\u201360, 227\u2013229, 285, 292. See also Encryption"}, {"id": "7da73fb6b105fd789169bb0155c08e0e6cf5593f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 424, "start_line": 18, "end_line": 29, "text": "data, 15, 16Internet Protocol (IP), 283, 290messages, 27\u201358pretty good privacy (PGP), 225\u2013227traffic flow (TFC), 283 Connection, SSL, 143Connection Protocol, SSH, 163, 168\u2013172Cookie exchange, 294\u2013295CRL issuer, PKI, 125Cross-certification, PKI, 126Cryptanalysis, 30\u201332Cryptography, 32, 81\u201384, 85\u201392. See also Public-key cryptography algorithms, 83\u201390classification of systems, 30cryptosystems, applications for, 79\u201382encryption structure, 79\u201381public-key, 79\u201382, 83\u201390requirements for, 82 Cryptographic computations, 154\u2013155, 160 D Data, 15, 16\u201317 confidentiality, 15, 16integrity, 16\u201317origin authentication, 18 Data Encryption Standard (DES), 34\u201338 algorithm (DES), description of, 35strength of, 35\u201336triple (3DES), 36\u201338 Decryption algorithm, 29, 81Denial-of-service (DoS) attack, 16 defined, 11"}, {"id": "ebeb29e86160916c689452d59d6a09a4d8225ed0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 424, "start_line": 30, "end_line": 32, "text": "DES, seeData Encryption Standard (DES) Diffie-Hellman key exchange, 85\u201389, 151, 155 anonymous, 151algorithm, 86\u201388ephemeral, 151fixed, 151introduction to, 85\u201386man-in-the-middle attack, 88\u201389"}, {"id": "9c88f58066285ef75e75183125d28e31439b5109", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 425, "start_line": 1, "end_line": 12, "text": "Diffie-Hellman key exchange ( Continued ) protocols, 88 SSL Handshake Protocol, 151, 155 Digital Signature Algorithm (DSA), 89Digital Signature Standard (DSS), 89Digital signatures, 90Discovery phase, IEEE 802.11i, 185\u2013188Distribution system (DS), IEEE 802.11, 180\u2013182DomainKeys Identified Mail (DKIM), 257\u2013264 e-mail threats, 259\u2013261functional flow, 261\u2013264Internet mail architecture, 258\u2013259 DoS, seeDenial-of-service (DoS) attack Double encryption, 111 E ECC, seeElliptic curve cryptography (ECC) Electronic codebook (ECB), 50Electronic data interchange (EDI), 123Electronic mail security, 221\u2013268 DomainKeys Identified Mail (DKIM), 257\u2013264pretty good privacy (PGP), 222\u2013241radix-64 conversion, 266\u2013268Secure/Multipurpose Internet Mail Extension (S/MIME), 222, 241\u2013257"}, {"id": "b081e0520687df424e64eb84160846f3740368f0", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 425, "start_line": 13, "end_line": 21, "text": "Elliptic curve cryptography (ECC), 89\u201390Encapsulating security payload (ESP), 281\u2013288 algorithms, 283anti-replay service, 284format, 282\u2013283padding, 283transport mode, 285\u2013287tunnel mode, 285\u2013288 Encryption, 27\u201360, 64\u201365, 81\u201383, 85\u201387, 92\u201394, 113, 114. See also Block ciphers; Public-key cryptography; Stream ciphers Advanced Encryption Standard (AES), 34, 38\u201341 algorithms, 28, 34\u201341, 50, 80, 83\u201390block ciphers, 30, 45, 50\u201353ciphertext, 81cryptanalysis, 30\u201332cryptography, 30Data Encryption Standard (DES), 34\u201338decryption algorithms, 81digital signatures, 90double, 111end-to-end, 98Feistel cipher structure, 32\u201334introduction to, 28key distribution, 98\u201399key distribution, 114\u2013116message authentication and, 62\u201366National Institute of Standards and Technology (NIST), 34"}, {"id": "27021bb410af7b83f88443be5431a1be2e9dfa14", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 425, "start_line": 22, "end_line": 30, "text": "plaintext, 28, 30\u201331, 80propagating cipher block chaining (PCBC), 112 public-key, 79\u201381, 90\u201392RC4 algorithm, 45\u201349, 50recommended reading and Web sites, 55RSA algorithm, 83\u201385stream cipher, 30, 45\u201348, 52symmetric, 28\u201334symmetric block algorithms, 34\u201341system dependence, 111triple Data Encryption Standard (3DES), 36\u201338 End entity, PKI, 124End-to-end encryption, 98, 214\u2013217EnvelopedData, S/MIME, 252\u2013253ESP , seeEncapsulated Security Payload (ESP) Exchanges, 114\u2013115, 117. See also Key exchange authentication service, 111\u2013112client/server authentication, 113Kerberos, 112\u2013113, 114ticket-granting service, 113 Extended service set (ESS), IEEE 802.11, 180External Functionality Interface (EFI), WAP , 201 F"}, {"id": "4aceb847ffd3ad26438520b610c08ae7d0fb18b9", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 425, "start_line": 31, "end_line": 37, "text": "Feistel cipher structure, 32\u201334Fortezza key exchange, 151\u2013153, 159Forward certificate, 120Fragmentation, SSL, 145 G Group master key (PMK), IEEE 802.11i, 192\u2013193 H Handshake Protocol, 143, 149\u2013154, 209\u2013211Hash functions, 65\u201366, 67\u201373 HMAC, 73\u201376one-way, 65\u201366requirements, 66\u201367secure, 67\u201373Secure Hash Algorithm (SHA), 70SHA-1 secure functions, 70\u201373simple, 68\u201370strong collision resistance, 67weak collision resistance, 67410 INDEX"}, {"id": "86224d11ed3351f9a793146bd8112ed3f8f1683a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 426, "start_line": 1, "end_line": 18, "text": "INDEX 411 HMAC, 73\u201376 algorithm, 74\u201376 design objectives, 74 Host keys, SSH, 163HTTPS, 140, 160\u2013162 I IEEE 802.11 LAN, 177\u2013182 association-related services, 182message distribution, 181\u2013182network components, 179\u2013180protocol architecture, 178\u2013179 IEEE 802.11i LAN, 183\u2013197 authentication phase, 185, 188\u2013190characteristics of, 183connection termination, 186discovery phase, 185\u2013188key management phase, 186, 188\u2013192phases of operation, 184\u2013186protected data transfer phase, 186, 194\u2013195pseudorandom function (PRF), 195\u2013197Robust Security Network (RSN), 183\u2013184services, 183\u2013184 Independent basic service set (IBSS), IEEE 802.11, 180 Information, 2, 20 access threats, 20security, 2 Initialization, 125 PKI, 126 International Telecommunication Union (ITU), 8"}, {"id": "af639374d42ff8ab4fdfad36e222b73ca2dff658", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 426, "start_line": 19, "end_line": 28, "text": "Internet Architecture Board (IAB), 270\u2013271Internet Engineering Task Force (IETF), 21 standards from, 21 Internet key exchange (IKE), 292\u2013300 cookies, 294\u2013295header and payload formats, 297\u2013300IKEv5 message exchange, 296\u2013297key determination protocol, 293\u2013300 Internet Protocol (IP), 113, 143\u2013144, 271\u2013305. See also Internet Protocol security (IPSec) authentication plus confidentiality, 290combining security associations (SA), 288\u2013292cryptographic suites, 301\u2013302dependence, 111encapsulating security payload (ESP), 281\u2013288 Internet key exchange (IKE), 292\u2013300security (IPsec), 270\u2013276security association database (SAD), 276\u2013278security policy database (SPD), 276, 278\u2013279traffic processing, 279\u2013281 Internet Protocol security (IPsec), 270\u2013279"}, {"id": "c5d71559abff90d190887750a39b5a76bf330fdd", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 426, "start_line": 29, "end_line": 42, "text": "documents, 273\u2013274packets, 279\u2013281policy, 276\u2013279routing, 273transport mode, 274\u2013276tunnel mode, 274\u2013276 Internet security, 221\u2013304 defined, 2electronic mail, 221\u2013304Internet protocol (IP), 142, 269\u2013303Transport Layer Security (TLS), 140, 142transport-level, 139\u2013174 Internet Security Association and Key Management Protocol (ISAKMP), 293 Internet standards, 21 Internet Architecture Board (IAB), 21Internet Engineering Task Force (IETF), 21RFCs, 21 Interrealm authentication, 111IP ,seeInternet Protocol (IP) ISAKMP , seeInternet Security and Key management Protocol (ISAKMP) ITU-T Recommendation X.800, seeX.800 standard recommendations K Kerberos, 99\u2013114"}, {"id": "ee3bc9998eefa2d80cb8fa999ba6b360066c6052", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 426, "start_line": 43, "end_line": 45, "text": "authentication dialogues, 100\u2013108, 112\u2013114authentication forwarding, 111authentication server (AS), 100authentication service exchange, 112\u2013113client/server authentication exchange, 113differences between versions 4 and 5, 110\u2013111double encryption, 111encryption system dependence, 111environmental shortcomings, 111Internet protocol dependence, 111interrealm authentication, 111introduction to, 99\u2013100message byte ordering, 111nonce, 112options, 112password attacks, 112principal, 108propagating cipher block chaining (PCBC) encryption, 112 realms, 108\u2013112, 113session keys, 112"}, {"id": "05b3b11906d9a2b84b3af2010f9b17017800cb73", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 427, "start_line": 1, "end_line": 13, "text": "Kerberos ( Continued ) technical deficiencies of, 110\u2013111 ticket-granting server (TGS), 102\u2013103ticket-granting service exchange, 113ticket lifetime, 111times, 112version 4, 100\u2013110version 5, 110\u2013114 Key distribution, 100\u2013111, 116\u2013118, 188, 192\u2013196, 232\u2013243. See also Exchanges; Private keys; Public keys center (KDC), 99certificate authority (CA), 114hierarchy, 191IEEE 802.11i management phase, 186, 190\u2013194 key identifiers, 230\u2013233key rings, 233\u2013236permanent key, 99pretty good privacy (PGP), 230\u2013241private key, 233\u2013234public key, 234\u2013241public-key certificates, 114\u2013115public-key distribution of secret keys, 115session key, 99, 230\u2013233wireless network security, 190\u2013194 Keyed hash function, seeMessage authentication codes (MAC) Key exchange, 85\u201389, 151\u2013154, 165\u2013166, 212\u2013213, 292\u2013300"}, {"id": "f827674d0efa231074a626fb90622bd8d10140fc", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 427, "start_line": 14, "end_line": 27, "text": "certificate messages for, 152\u2013154client authentication and, 153\u2013154Diffie-Hellman, 85\u201389, 151, 212\u2013213Fortezza, 151\u2013153Internet (IKE) key determination protocol, 293\u2013300 Internet, 292\u2013300protocols, 88RSA, 151, 212\u2013213server authentication and, 152\u2013153SSH Transport Layer Protocol, 165\u2013166SSL Handshake Protocol, 151\u2013154WTLS, 212\u2013213 Key generation, 167, 213\u2013214, 230 PGP , 230SSH, 167WTLS, 213\u2013214 Key identifiers (key ID), PGP , 230\u2013233Key management, seeKey distribution Key pair recovery, PKI, 126Key pair update, PKI, 126Key rings, PGP , 233\u2013236Key schedule algorithm, DES, 94Keystream, defined, 45 L Link encryption, 98Logical link control (LLC) layer, IEEE 800, 179 M MAC protocol data unit (MPDU), IEEE 800, 178\u2013179, 181, 187\u2013188, 189\u2013190 MAC service data unit (MSDU), IEEE 800, 178\u2013179, 181"}, {"id": "0574860336ff2ae3b8a9aaac6ef5c2bcc740e8a4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 427, "start_line": 28, "end_line": 36, "text": "Man-in-the-middle attack, 88\u201389Master key, 213\u2013214Master secret creation, 155, 160Master session key (MSK), IEEE 802.11i, 190Masquerade, 11\u201312Media access control (MAC) layer, IEEE 800, 178\u2013179 Message authentication, 61\u201396 approaches to, 62\u201366code (MAC), 64\u201365digital signatures, 90encryption, and, 62\u201366hash functions, 65\u201366, 67\u201373introduction to, 62key distribution, 114\u2013146one-way hash functions, 65\u201366public-key cryptography, 79\u201382, 83\u201390recommended reading and Web sites, 90\u201391secure hash functions, 67\u201373 Message authentication code (MAC), 64\u201365, 156 SSL, 145\u2013147technique, 64\u201365TLS, 156 Messages, 10, 11, 13\u201314, 27\u201360, 63\u201398, 113, 169\u2013170, 232\u2013238, 253\u2013256, 298\u2013299. See also Encryption; Public-key cryptography"}, {"id": "469f5e18676bd80f560991bded91762ff3f20fac", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 427, "start_line": 37, "end_line": 39, "text": "attacks on, types of, 31authentication, 61\u201396byte ordering, 111confidentiality of, 27\u201358IKEv5 exchange, 296\u2013297key rings for, 230\u2013236modification of, 13\u201314pretty good privacy (PGP), 230\u2013236release of contents, 10, 11Secure/Multipurpose Internet Mail Extension (S/MIME), 251\u2013254 SSH exchange, 167\u2013168412 INDEX"}, {"id": "f8651cc5ee4871231d900c6f970932dc0a9fc2a3", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 428, "start_line": 1, "end_line": 15, "text": "INDEX 413 MIME, seeMultipurpose Internet Mail Extensions (MIME) Mix columns, AES, 40 Model for network security, 19\u201321Modification of messages, 11, 13Multipurpose Internet Mail Extensions (MIME), 242\u2013247 canonical form, 247content types, 244\u2013246transfer encodings, 246\u2013247 N National Institute of Standards and Technology (NIST), 34, 89 Network security, 1\u201325, 97\u201398, 97\u2013138, 139\u2013174, 175\u2013220 applications, 97authentication, 97\u2013138computer security, 2defined, 2HTTPS, 140, 160\u2013162information security, 2International Telecommunication Union (ITU), 8 Internet and Web resources, 23\u201325Internet Engineering Task Force (IETF), 21internet security, 2Internet standards, 21introduction to, 1\u201325ITU-T Recommendation X.798, 8, 14, 16\u201317mechanisms, 9, 17\u201318model for, 19\u201322open systems interconnection (OSI)"}, {"id": "2489f9e49964c9ac81b54c1904a0274af602f48a", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 428, "start_line": 16, "end_line": 29, "text": "architecture, 8\u20139 outline for study of, 21\u201322recommended reading, 22Secure Socket Layer (SSL), 140, 142\u2013145Secure Shell (SSH), 140, 162\u2013172services, 9, 13\u201316threats, 19, 99\u2013100transport-level, 139\u2013174trends in, 7\u20138USENET newsgroups, 24violations of, 3wireless, 175\u2013220X.800 standard recommendations, 9, 14, 16\u201317 Nonce, 112, 295 Kerberos, 112 Nonrepudiation, 14, 16Nonsecret encryption, seePublic-key cryptographyO Oakley Key Determination Protocol, 293One-way function, 65\u201366 authentication, 65\u201366hash functions, 65\u201366X.507, 121\u2013122 Open systems interconnection (OSI), 8\u201319Options, Kerberos, 111 P Packet exchange, SSH, 163\u2013165Packets, IPsec, 279\u2013281Padding, 160, 283Pairwise master key (PMK), IEEE 802.11i, 191\u2013192 Pairwise transient key (PTK), IEEE 802.11i, 192\u2013193"}, {"id": "49413c57631be61a3a88fc0dbb22f0b36f217712", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 428, "start_line": 30, "end_line": 36, "text": "Passive attacks, security, 9\u201311Password attacks, Kerberos, 111Peer entity authentication, 15Permanent key, defined, 99PGP , seePretty Good Privacy (PGP) Physical layer, IEEE 800, 178PKI, seePublic-key infrastructure (PKI) Plaintext, 28, 30\u201331, 80 chosen, attack, 31defined, 28known, attack, 30\u201331processing, cryptography, 30public-key encryption, 79 Port forwarding, SSH, 170\u2013172Pre-shared key (PSK), IEEE 802.11i, 190Pretty good privacy (PGP), 222\u2013241 authentication, 224\u2013227compression, 227\u2013228confidentiality, 225\u2013227e-mail compatibility, 228\u2013229key identifiers, 230\u2013233key rings, 233\u2013236notation for, 223\u2013224private key, 233\u2013234public-key, 234\u2013241session key, 230\u2013233trust, fields for, 237\u2013241 Private keys, 81\u201382, 123, 233\u2013234"}, {"id": "09d6e0dfb74436a19cad69aeeca96ef97a5b4821", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 428, "start_line": 37, "end_line": 39, "text": "pretty good privacy (PGP), 233\u2013234public-key cryptography and, 81\u201382ring, 233\u2013234usage, X.509 authentication service, 123 Propagating cipher block chaining (PCBC) encryption, 112"}, {"id": "3494076ae1f3aa759ecf94450c26a4ad06835086", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 429, "start_line": 1, "end_line": 12, "text": "Protected data transfer phase, IEEE 802.11i, 194\u2013195 Protocol, 90, 128. See also Internet Protocol (IP) Diffie-Hellman, 88 key exchange, 88PKIX management, 126 Pseudorandom function (PRF), 157\u2013158, 195\u2013197, 213 IEEE 802.11i, 195\u2013197TLS, 157\u2013158WTLS, 213 Public-key cryptography, 79\u201382, 83\u201390 algorithms, 83\u201390applications for, 81\u201382ciphertext, 81cryptography, 79\u201382, 83\u201390decryption algorithm, 81Diffie-Hellman key exchange, 85\u201389Digital Signature Standard (DSS), 89elliptic curve (ECC), 89\u201390encryption algorithm, 80encryption structure, 79\u201381plaintext, 80private keys, 80, 81public keys, 80, 81requirements for, 82RSA public-key encryption, 83\u201385secret keys, 80, 81, 92 Public-key encryption, 79\u201381, 90\u201392"}, {"id": "a576465b195277873cdc9fa8aab61bae9e338a8e", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 429, "start_line": 13, "end_line": 18, "text": "algorithm, 80certificates, 91\u201392digital signatures, 90key management, 90\u201392secret keys, distribution of, 92structure, 79\u201381 Public-key infrastructure (PKI), 124\u2013126 certification authority (CA), 124\u2013125CRL issuer, 124end entity, 124key pairs, 126PKIX management functions, 125\u2013126PKIX management protocols, 126PKIX model, 124\u2013126registration authority (RA), 124repository, 124 Public keys, 81\u201382, 90\u201392, 116, 123\u2013124, 234\u2013241 authority key identifier, 123certificates, 114\u2013115, 116, 123\u2013124cryptography, 80, 81defined, 81distribution, 114\u2013116management, 236\u2013241pretty good privacy (PGP), 234\u2013241revoking, 241ring, 233\u2013236secret keys, distribution of using, 116subject key identifier, 123trust, PGP fields, 237\u2013241usage, X.509 authentication service, 123X.509 authentication service information,"}, {"id": "7e0e705a855079d893479fb048dcc737bd9006d6", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 429, "start_line": 19, "end_line": 37, "text": "123\u2013124 Q Quoted-printable transfer encoding, 247 R Radix-64 conversion, 266\u2013268RC4 algorithm, 45\u201349, 50 generation, 49initialization of S, 48\u201349logic, 50strength of, 49 Realm, 108\u2013112 concept of, 108Kerberos version 4, 108\u2013112Kerberos version 5, 112 Record Protocol, 143, 145\u2013147, 206\u2013207Registration, PKI, 125Registration authority (RA), PKI, 125Release of message contents, 9, 10Replay, 12Replay attacks, 284Repository, PKI, 125Request for Comment (RFC) standards, 9, 242, 259\u2013260 RFC 5322, S/MIME, 242RFC 6484, e-mail threats, 259\u2013260security recommendations, 8 Reverse certificate, 120Revocation, 121\u2013122, 126 certificates, X.509 authentication service, 121\u2013122 request, PKI, 126 RFC, seeRequest for Comment (RFC) standards Rivest-Shamir-Adleman (RSA) algorithm, 151, 155, 212\u2013213"}, {"id": "9a675b9d89b5c054549c95365e618bb664873c37", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 429, "start_line": 38, "end_line": 38, "text": "key exchange, 151, 155, 212\u2013213SSL Handshake Protocol, 151, 155WTLS, 212\u2013213414 INDEX"}, {"id": "8e94032ec6cdef05c7e66225197fa1c6c5c402c5", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 430, "start_line": 1, "end_line": 17, "text": "INDEX 415 Round, 32, 34, 40\u201341 Add Round Key, 40 AES encryption, 40\u201341function, Feistel cipher, 31, 33 Routing, IPsec, 273RSA, 83\u201385 public-key encryption, 83\u201385 RSA algorithm, seeRivest-Shamir-Adleman (RSA) algorithm S Secret keys, 28, 80, 81, 115 encryption using, 28, 81key management, 115public-key cryptography, 80, 81, 115public-key distribution of, 115 Secure Hash Algorithm (SHA), 70Secure hash functions, seeHash functions Secure/Multipurpose Internet Mail Extension (S/MIME), 222, 241\u2013257 certificate processing, 255\u2013257clear signing, 253\u2013254cryptographic algorithms, 249\u2013251functionality, 247\u20132451messages, 251\u2013254Multipurpose Internet Mail Extensions (MIME), 242\u2013247 Secure Shell (SSH), 140, 162\u2013172"}, {"id": "f46245e9bda99e8c9f7af5261c8a6a79f02d182b", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 430, "start_line": 18, "end_line": 23, "text": "channels, 169\u2013170Connection Protocol, 163, 168\u2013172host keys, 163key exchange and generation, 165\u2013167message exchange, 167\u2013168packet exchange, 163\u2013165port forwarding, 170\u2013172Transport Layer Protocol, 162\u2013167User Authentication Protocol, 163, 167\u2013168 Secure Socket Layer (SSL), 140, 142\u2013145 Alert Protocol, 143, 148\u2013149architecture, 143\u2013144Change Cipher Spec Protocol, 143, 147\u2013148, 154 cryptographic computations, 154\u2013155Handshake Protocol, 143, 149\u2013154Hypertext Transfer Protocol (HTTP), 143master secret, 155message authentication code (MAC), 145\u2013147Record Protocol, 143, 145\u2013147session, 143\u2013144 Security association (SA), IP , 276\u2013278, 288\u2013292Security association database (SAD), 276\u2013278Security attacks, 9\u201313"}, {"id": "e4bf6462c2e011535327e771dd2560ea13b571ad", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 430, "start_line": 24, "end_line": 35, "text": "active, 11\u201313defined, 9denial of service, 11masquerade, 11\u201312modification of messages, 11, 13passive, 9\u201311release of message contents, 9\u201310replay, 12traffic analysis, 10\u201311 Security mechanisms, 9, 16\u201318 services and, relationship of, 18X.800 recommendations, 17 Security policy database (SPD), 276, 278\u2013279Security services, 9, 13\u201316 access control, 15authentication, 14\u201316availability, 16data confidentiality, 15data integrity, 14, 16\u201317defined, 9, 13nonrepudiation, 16 Sequence number, 114 Kerberos, 113 Service request, SSH, 167Service threats, defined, 20Session keys, 99, 112, 230\u2013233 defined, 99Kerberos, 112 Session, SSL, 143\u2013144Shift rows, AES, 40SignedData, S/MIME, 253S/MIME, seeSecure/Multipurpose Internet Mail Extension (S/MIME) SSH, seeSecure Shell (SSH)"}, {"id": "a44d358e9f2a7d52f934578ac385f6affbb99565", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 430, "start_line": 36, "end_line": 40, "text": "SSL, seeSecure Socket Layer (SSL) State array, AES, 38Stream ciphers, 30, 45\u201348, 52 defined, 45design considerations, 46keystream, 45plaintext processing, cryptography, 30RC4 algorithm, 45\u201348, 52structure of, 45\u201348 Subject field, 304Subkey, Kerberos, 113Substitution bytes, AES, 40Symmetric encryption, 28\u201334 block cipher, design of, 33\u201334block size, 33ciphertext, 29"}, {"id": "14fb677fd6421d86134d99118d68aaa41d978f47", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 431, "start_line": 1, "end_line": 8, "text": "416 INDEX Symmetric encryption ( Continued ) computationally secure, 31 cryptanalysis, 30\u201332cryptography, 30decryption algorithm, 29encryption algorithm, 28Feistel cipher structure, 32\u201334key size, 33plaintext, 28, 30\u201331principles of, 28\u201334requirements of, 29round function, 32, 33rounds, number of, 33secret key, 29subkey generation algorithm, 34 T Threats, 10\u201314, 21, 101\u2013102, 261\u2013263. See also Attacks active attacks, 11\u201313denial-of-service (DoS) attack, 16disclosure, 14masquerade, 11\u201312modification of information, 13network security, 21, 99\u2013100passive attack, 9\u201311release of contents, 10replay, 11service, 20traffic analysis, 9\u201311"}, {"id": "53867bb141e56bb51889294ad08d55a07e5094e4", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 431, "start_line": 9, "end_line": 15, "text": "Ticket-granting server (TGS), 102\u2013103Ticket-granting service exchange, 113Ticket lifetime, 111Times, Kerberos, 113Timestamp authentication, 231, 233\u2013234TLS, seeTransport Layer Security (TLS) Traffic analysis, 10\u201311Traffic flow confidentiality (TFC), 283Traffic processing, IP , 279\u2013281Transport Layer Protocol, SSH, 162\u2013167Transport Layer Security (TLS), 140, 142, 156\u2013160 alert codes, 158\u2013159certificate types (client), 159\u201360cipher suites, 159cryptographic computations, 160message authentication code (MAC), 156padding, 160pseudorandom function (PRF), 156\u2013158 Transport-level security, 139\u2013174 HTTPS, 140, 160\u2013162Secure Shell (SSH), 140, 162\u2013172Secure Socket Layer (SSL), 140, 142\u2013155Transport Layer Security (TLS), 140, 142, 156\u2013160 Web considerations, 140\u2013142"}, {"id": "ebd46d069987128565df5217a8cee5cd243de934", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 431, "start_line": 16, "end_line": 33, "text": "Transport mode, IP , 274\u2013276, 285\u2013288Triple Data Encryption Standard (3DES), 36\u201337Trust, PGP fields, 237\u2013241Tunnel, SSH, 169\u2013170Tunnel mode, IP , 274\u2013276, 285\u2013288 U USENET newsgroups, 24User Authentication Protocol, SSH, 163, 167\u2013168 V VeriSign certificates, S/MIME, 255\u2013257Version number, TLS, 156 W WAP, seeWireless Application Protocol (WAP) Web security, 141\u2013144, 162\u2013163. See also Internet security Web sites, 24\u201325, 55, 90\u2013191, 133 authentication applications, network security, 133 message authentication, 90\u201391network security, 23\u201324, 133symmetric encryption, 56 Wi-Fi Protected Access (WPA), 176\u2013177, 183Wireless application environment (WAE), WAP , 201\u2013202 Wireless Application Protocol (WAP), 176, 197\u2013204, 214\u2013217"}, {"id": "4849503b6906a99fa5f4e37dfa7661f768baf39f", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 431, "start_line": 34, "end_line": 42, "text": "architecture, 200\u2013201end-to-end security, 214\u2013217programming model, 198protocol, 197\u2013204, 202\u2013204security discovery and services, 201wireless application environment (WAE), 201\u2013202 wireless markup language (WML), 198\u2013200wireless session protocol (WSP), 203wireless transaction protocol (WTP), 203\u2013204 Wireless Ethernet Compatibility Alliance (WECA), 177 Wireless markup language (WML), WAP , 198\u2013200 Wireless network security, 175\u2013220 IEEE 802.11 LAN, 177\u201382IEEE 802.11i LAN, 183\u201397"}, {"id": "14f597986a4b17fe9bde3b1510e1af2af1cb9dec", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 432, "start_line": 1, "end_line": 15, "text": "INDEX 417 Robust Security Network (RSN), 183\u2013184 Wi-Fi Protected Access (WPA), 176\u2013177, 183 Wired Equivalent Privacy (WEP), 183Wireless Application Protocol (WAP), 176, 197\u2013204, 214\u2013217 Wireless Transport Layer Security (WTLS), 176, 204\u2013214 Wireless session protocol (WSP), WAP , 203Wireless transaction protocol (WTP), WAP , 203\u2013204 Wireless Transport Layer Security (WTLS), 176, 204\u2013214 Alert Protocol, 208\u2013209authentication, 211\u2013212Change Cipher Spec Protocol, 207\u2013208cryptographic algorithms, 211\u2013214Handshake Protocol, 209\u2013211key exchange, 212\u2013213master key generation, 213\u2013214protocol architecture, 206\u2013211pseudorandom function (PRF), 213Record Protocol, 206\u2013207sessions and connections, 205\u2013206 X X.509 certificate, 116\u2013124"}, {"id": "6655df8e24dfc5b86e6d2514a4cc95967e7dda13", "filename": "3._Network-security-essentials-4th-edition-william-stallings.pdf", "page": 432, "start_line": 16, "end_line": 17, "text": "certificate revocation list (CRL), 122certificates, 117\u2013119certification authority (CA), 116forward certificate, 120introduction to, 116issuer attributes, 123\u2013124key information, 122\u2013123path constraints, 124policy information, 122reverse certificate, 120revocation of certificates, 121\u2013122subject attributes, 122\u2013123user\u2019s certificate, obtaining, 118\u2013119version 3, 122\u2013124 X.800 standard recommendations, 8, 14, 16\u201317"}, {"id": "9096e90b65f92bc60b6d1cec5c4df0fc340acadc", "filename": "Lecture 10_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Random and Pseudorandom Numbers"}, {"id": "edb79eb5333dab0bb27dd12cd8dc30586d0e5ce4", "filename": "Lecture 10_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "When to use random numbers?\u2022Generation of a stream key for symmetric stream cipher \u2022Generation of keys for public-key algorithms\u2022RSA public-key encryption algorithm (described in Chapter 3)\u2022Generation of a symmetric key for use as a temporary session key\u2022used in a number of networking applications, such as Transport Layer Security (Chapter 5), Wi-Fi (Chapter 6), e-mail security (Chapter 7), and IP security (Chapter 8) \u2022In a number of key distribution scenarios\u2022Kerberos (Chapter 4)"}, {"id": "45d560fd313e424ac82cbd0f2515fd3207648e7f", "filename": "Lecture 10_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Two types of random numbers\u2022True random numbers:\u2022generated in non-deterministic ways. They are not predictable and repeatable\u2022Pseudorandom numbers:\u2022appear random, but are obtained in a deterministic, repeatable, and predictable manner"}, {"id": "4c140dea680ffdf145bcb6f748f05c2bac2e16cb", "filename": "Lecture 10_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Properties of Random Numbers\u2022Randomness\u2022Uniformity\u2022distribution of bits in the sequence should be uniform \u2022Independence\u2022no one subsequence in the sequence can be inferred from the others \u2022Unpredictable\u2022satisfies the \"next-bit test\u201c"}, {"id": "79f69574480c8903735ebd503f2a30bdef6a8899", "filename": "Lecture 10_slides.pdf", "page": 5, "start_line": 1, "end_line": 2, "text": "Entropy\u2022A measure of uncertainty\u2022In other words, a measure of how unpredictable the outcomes are\u2022High entropy= unpredictable outcomes = desirable in cryptography\u2022The uniform distribution has the highest entropy (every outcome equally likely, e.g. fair coin toss)\u2022Usually measured in bits (so 3 bits of entropy = uniform, random distribution over 8 values) Entropy of an information source"}, {"id": "db68db99056b7bb7dca3680bf3f8a140b089a709", "filename": "Lecture 11_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Properties of Random Numbers\u2022Randomness\u2022Uniformity\u2022distribution of bits in the sequence should be uniform \u2022Independence\u2022no one subsequence in the sequence can be inferred from the others \u2022Unpredictable\u2022satisfies the \"next-bit test\u201c"}, {"id": "7f8e1326201a448d6abae8f3d669ea5d70d53c88", "filename": "Lecture 11_slides.pdf", "page": 2, "start_line": 1, "end_line": 2, "text": "Entropy\u2022A measure of uncertainty\u2022In other words, a measure of how unpredictable the outcomes are\u2022High entropy= unpredictable outcomes = desirable in cryptography\u2022The uniform distribution has the highest entropy (every outcome equally likely, e.g. fair coin toss)\u2022Usually measured in bits (so 3 bits of entropy = uniform, random distribution over 8 values) Entropy of an information source"}, {"id": "1288e833a769d97c05166dd53e117e6e88089dbd", "filename": "Lecture 11_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "True random numbers generators\u2022Several sources of randomness \u2013natural sources of randomness\u2022decay times of radioactive materials\u2022electrical noise from a resistor or semiconductor\u2022radio channel or audible noise\u2022keyboard timings\u2022disk electrical activity\u2022mouse movements\u2022Physical unclonable function (PUF)\u2022Some are better than others"}, {"id": "29c2102bf018eb158c6671011cde3a684f1d45ea", "filename": "Lecture 11_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Combining sources of randomness\u2022Suppose r1, r2, \u2026, rkare random numbers from different sources. E.g.,r1 = electrical noise from a resistor or semiconductorr2 = sample of hip-hop music on radior3 = clock on computerb = r1\u2295r2\u2295\u2026\u2295rkIf any one of r1, r2, \u2026, rkis truly random, then so is bMany poor sources + 1 good source = good entropy"}, {"id": "0d5983b7a0aab7475569e9d55e6d7d8aefccc251", "filename": "Lecture 11_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Pseudorandom Number Generators (PRNGs)\u2022True randomness is expensive\u2022Pseudorandom number generator(PRNGs): An algorithm that uses a little bit of true randomness to generate a lot of random-looking output\u2022Also called deterministic random bit generators(DRBGs)\u2022PRNGs are deterministic: Output is generated according to a set algorithm\u2022However, for an attacker who can\u2019t see the internal state, the output is computationally indistinguishablefrom true randomness"}, {"id": "e97353a04c3ac0e36f919af40596417ed8fd3f2c", "filename": "Lecture 12_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Pseudorandom Number Generators (PRNGs)\u2022True randomness is expensive\u2022Pseudorandom number generator(PRNGs): An algorithm that uses a little bit of true randomness to generate a lot of random-looking output\u2022Also called deterministic random bit generators(DRBGs)\u2022PRNGs are deterministic: Output is generated according to a set algorithm\u2022However, for an attacker who can\u2019t see the internal state, the output is computationally indistinguishablefrom true randomness"}, {"id": "1c6f1b7752e58ba298b2d92a91fe684c452a5615", "filename": "Lecture 12_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "PRNG: Definition\u2022A PRNG has two functions:\u2022PRNG.Seed(randomness): Initializes the internal state using the entropy\u2022Input: Some truly random bits\u2022PRNG.Generate(n): Generate npseudorandom bits\u2022Input: A number n\u2022Output: npseudorandom bits\u2022Updates the internal state as needed\u2022Properties\u2022Correctness: Deterministic\u2022Efficiency: Efficient to generate pseudorandom bits\u2022Security: Indistinguishability from random\u2022Rollback resistance: cannot deduce anything about any previously-generated bit"}, {"id": "231de181c013e007f5d632fcc71722503c0d9831", "filename": "Lecture 12_slides.pdf", "page": 3, "start_line": 1, "end_line": 2, "text": "Example construction of PRNG\u2022Using block cipher in Counter (CTR) mode:\u2022If you want m random bits, and a block cipher with Ekhas n bits, apply the block cipher m/n times and concatenate the result:\u2022PRNG.Seed(K | IV) = Ek(IV, 1) | Ek(IV, 2) | Ek(IV, 3) \u2026 Ek(IV, ceil(m/n)),\u2022| is concatenation\u2022Initialization vector (IV)/Nonce\u2013typically is random or pseudorandom Randomness, PRNG output"}, {"id": "28f3ec0d11bc7f76fcd9a3c28d1e117a05970ef5", "filename": "Lecture 12_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "PRNG: Security\u2022Can we design a PRNG that is truly random?\u2022A PRNG cannot be truly random\u2022The output is deterministic given the initial seed\u2022A secure PRNG is computationally indistinguishable from random to an attacker\u2022Game: Present an attacker with a truly random sequence and a sequence outputted from a secure PRNG\u2022An attacker should be able to determine which is which with probability \u22480\u2022Equivalence: An attacker cannot predict future output of the PRNG"}, {"id": "bdbdf76d10df20a7f48a82907682c4da5742dcd9", "filename": "Lecture 12_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Create pseudorandom numbers\u2022Truly random numbers are impossible with any program!\u2022However, we can generate seemingly random numbers, called pseudorandom numbers\u2022The function rand() returns a non-negative number between 0 and RAND_MAX\u2022For C, it is defined in stdlib.h\u2022arc4random() is a function available in some operating systems (primarily BSD-based systems like macOS and FreeBSD) that generates random numbers. It is part of the C standard library and provides a more secure and higher-quality source of random numbers compared to rand()"}, {"id": "c0d76f8d388819b34867d82fd3095e246bdb363b", "filename": "Lecture 12_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "PRNGs: Summary\u2022True randomness requires sampling a physical process\u2022PRNG: An algorithm that uses a little bit of true randomness to generate a lot of random-looking output\u2022Seed(entropy): Initialize internal state\u2022Generate(n): Generate n bits of pseudorandom output\u2022Security: computationally indistinguishable from truly random bits"}, {"id": "ce013b97f45f9e4da5e36dd7a70bc4182330e62a", "filename": "Lecture 12_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Stream Ciphers"}, {"id": "b93f94199974b49fd4ab6df95589e8cf651baff2", "filename": "Lecture 12_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Stream Ciphers\u2022process the message bit by bit (as a stream) \u2022typically have a (pseudo) random stream key\u2022combined (XOR) with plaintext bit by bit \u2022randomness of stream keycompletely destroysany statistically properties in the message \u2022Ci= MiXOR StreamKeyi\u2022what could be simpler!!!! \u2022but must never reuse stream key\u2022otherwise, can remove effect and recover messages, M\u2a01K\u2a01K = M"}, {"id": "047ff6a2554f8051c9ff1c5ef2ccbf8d55d505e9", "filename": "Lecture 13_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Stream Ciphers\u2022process the message bit by bit (as a stream) \u2022typically have a (pseudo) random stream key\u2022combined (XOR) with plaintext bit by bit \u2022randomness of stream keycompletely destroysany statistically properties in the message \u2022Ci= MiXOR StreamKeyi\u2022what could be simpler!!!! \u2022but must never reuse stream key\u2022otherwise, can remove effect and recover messages, M\u2a01K\u2a01K = M"}, {"id": "bc77ef90726959c29e2d9b45b3488b24928623d3", "filename": "Lecture 13_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Stream Cipher Properties\u2022some design considerations are:\u2022statistically random \u2022depends on large enough key\u2022large linear complexity\u2022correlation immunity \u2022confusion\u2022diffusion"}, {"id": "fd7247866ff33bdb43152caa3da2e6f6e95fe424", "filename": "Lecture 13_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "How to generate Stream Key?\u2022How to generate Stream Key?"}, {"id": "24f29efa6ab2b4cd963fbc4c00f1f0d12eb346b2", "filename": "Lecture 13_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Stream Ciphers \u2022Idea: replace \u201crand\u201d by \u201cpseudo rand\u201d\u2022Use Pseudo Random Number Generator \u2022A secure PRNG produces output that looks indistinguishable from random\u2022An attacker who can\u2019t see the internal PRNG state can\u2019t learn any output\u2022PRNG: {0,1}s\u00ae{0,1}n\u2022expand a short (e.g., 128-bit) random seed into a long (typically unbounded) string that \u201clooks random\u201d\u2022Secret key is the seed\u2022Basic encryption method: Ekey[M] = M \u00c5PRNG(key)"}, {"id": "e9b21e07d8e48d52e28bb885f711e214b194f3a9", "filename": "Lecture 13_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Stream Ciphers\u2022Protocol: Alice and Bob both seed a secure PRNG with their symmetric secret key, and then use the output as the key for stream keyAliceBobSeed(k)Seed(k)Generate(n)Generate(n)PlaintextPlaintextCiphertext\u2295\u2295"}, {"id": "62e7a3dd4961440e75f3bb25c20d571d3041a3ff", "filename": "Lecture 13_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Stream Ciphers: Encrypting Multiple Messages\u2022How do we encrypt multiple messages without key reuses?AliceBobSeed(k)Seed(k)Generate(n)Generate(n)PlaintextPlaintextCiphertext\u2295\u2295"}, {"id": "2fd9319617f54816ea34dcd59f6de107dab6b163", "filename": "Lecture 13_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Stream Ciphers: Encrypting Multiple Messages\u2022Solution: For each message, seed the PRNG with the key and a random IV, concatenated(\u201c|\u201d). Send the IV with the ciphertextAliceBobSeed(k | IV)Seed(k | IV)Generate(n)Generate(n)PlaintextPlaintextCiphertext\u2295\u2295IVIV"}, {"id": "bcf570f10746fd11ef259a6715bbef827dcb5e69", "filename": "Lecture 13_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Real-world example: RC4\u2022a proprietary cipher designed in 1987 \u2022Extremely simple but effective!\u2022Very fast -especially in software\u2022Easily adapts to any key length, byte-oriented stream cipher \u2022widely used (web SSL/TLS, wireless WEP , WAP) \u2022A trade secret by RSA Security\u2022uses that permutation to scramble input info processed a byte at a time"}, {"id": "6ec09c18d215ec8b94403b3e043b59c407b95bab", "filename": "Lecture 13_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "RC4 Stream CipherKRC4 (K|IV)011010010111\u2295MCkey(seed)key stream(pseudo random sequence)messageciphertext"}, {"id": "2cf13c4b6a16870aafe377f95e65d8f58572d6bb", "filename": "Lecture 13_slides.pdf", "page": 10, "start_line": 1, "end_line": 2, "text": "RC4 Key Schedule\u2022starts with an array S of numbers: 0\u2026255\u2022use key to well and truly shuffle\u2022S forms internal state of the cipher\u2022given a key k of length I bytes Throw away T & K, retain S"}, {"id": "fbcb941c4e5eb58aaaf65e95bc504ba18d0e514b", "filename": "Lecture 14_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "RC4 Stream CipherKRC4 (K|IV)011010010111\u2295MCkey(seed)key stream(pseudo random sequence)messageciphertext"}, {"id": "83217f4ac5a5a1ff1848290ca0a4bb9fad91f00b", "filename": "Lecture 14_slides.pdf", "page": 2, "start_line": 1, "end_line": 2, "text": "RC4 Key Schedule\u2022starts with an array S of numbers: 0\u2026255\u2022use key to well and truly shuffle\u2022S forms internal state of the cipher\u2022given a key k of length I bytes Throw away T & K, retain S"}, {"id": "a486c567ee6ce6f54f8dc44523c64ec31242dcb4", "filename": "Lecture 14_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "RC4 Encryption\u2022encryption continues shuffling array values\u2022sum of shuffled pair selects \"stream key\" value\u2022XOR with next byte of message to en/decrypt"}, {"id": "f2fbad85721f5a1df5f55cb3539ca1ba4efebdd9", "filename": "Lecture 14_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "RC4"}, {"id": "585a09051467b13ad32dd38eb0ab37e3ba31cbed", "filename": "Lecture 14_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "RC4 Security\u2022claimed secure against known attacks\u2022since RC4 is a stream cipher, must never reuse a key\u2022have a concern with WEP , but due to key handling rather than RC4 itself \u2022RC4 Biases: It is extensively studied, not a completely secure PRNG, first part of output biased, when used as stream cipher, should use RC4-Drop[n]\u2022Which drops first n bytes before using the output\u2022Conservatively, set n=3072"}, {"id": "3deec4ca7e9ccbd0a4a0968a7eda2aa29c67f275", "filename": "Lecture 14_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Summary \u2013Chapter 2\u2022Symmetric block cipher\u2022DES, 3DES\u2022AES\u2022Random number\u2022true random number\u2022pseudorandom number\u2022Stream cipher \u2022The security of symmetric encryption depends on the secrecy of the key\u2022Symmetric encryption: pros and cons"}, {"id": "3707c4a81d2cd62a3a3384576a7c3cbe5aaa809d", "filename": "Lecture 14_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Modular Arithmetic\u2022Definition (congruent modulo): \u2022given b \u2013a = km for some k \ud835\udf16\ud835\udc4d, then a\u2261\ud835\udc4f(mod m)\u2022Given a\u2261\ud835\udc4f(mod m) and c\u2261\ud835\udc51(mod m), then\u2022a + b \u2261c + d (mod m)\u2022a -b \u2261c -d (mod m)\u2022a + c \u2261b + d (mod m)\u2022a \u00d7c \u2261b \u00d7d (mod m)\u2022ak\u2261bk(mod m)\u2022ka = kb (mod m)\u2022p(a) \u2261p(b) (mod m), any polynomialp(x)with integer coefficients\u2022A\u2a01\ud835\udc35\u2a01\ud835\udc35= A"}, {"id": "3a5b35d64387ee9b837178e7e80254b84cdb32f7", "filename": "Lecture 14_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Thank you!"}, {"id": "267f07ab94f6a3dbeef1b839b2e1d68b6931f380", "filename": "Lecture 14_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Network SecurityChapter 3Public-Key Cryptography and Message Authentication"}, {"id": "a542d214013dbc48f3dffd272d80b3738acf00d2", "filename": "Lecture 14_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Public-Key Cryptography"}, {"id": "91c46ca397d8552884e7b94354396927500f6232", "filename": "Lecture 14_slides.pdf", "page": 12, "start_line": 1, "end_line": 1, "text": "Conventional cryptography\u2022traditional private/secret/single-keycryptography uses onekey \u2022shared by both sender and receiver \u2022if this key is disclosed, communications are compromised \u2022also is symmetric, parties are equal"}, {"id": "c3654272267b5d227e92057111e2e8da69793daa", "filename": "Lecture 14_slides.pdf", "page": 13, "start_line": 1, "end_line": 1, "text": "Pros and cons\u2022Pros:\u2022Encryption is fast for large amounts of data\u2022Provide the same level of security with a shorter encryption key\u2022By now, it\u2019s unbreakable to quantum computing\u2022Cons\u2022Key distribution assumes a secure channel\u2022Does not protect sender from receiver forging a message & claiming it\u2019s sent by sender\u2022It does not scale well for large networks. It requires a separate key for each pair of communicating parties, which can result in a large number of keys to manage and protect."}, {"id": "c9d654ad8508c9b8340c876957454c7d9005ca60", "filename": "Lecture 14_slides.pdf", "page": 14, "start_line": 1, "end_line": 1, "text": "Homework 1 -individual\u2022Chapter 1 & 2\u2022Deadline: Tuesday, October 8, 11:59 PM\u2022Submit your homework via the provided link.\u2022The Google submission timestamp will be considered final.\u2022A 10% penalty will be applied for each day of late submission."}, {"id": "63571fdbc531a51200656f6c42e311f7de388bcc", "filename": "Lecture 14_slides.pdf", "page": 15, "start_line": 1, "end_line": 1, "text": "Review & Quiz I\u2022Chapter 1 & 2\u2022Wednesday (Oct. 9, 2024), in class\u2022Please ensure your participation\u2022No make-up quiz"}, {"id": "d9c4e9b85c06a4b7c113e9bd8347624010be67bd", "filename": "Lecture 15_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Public-Key Cryptography\u2022In public-key schemes, each person has two keys\u2022Public key: Known to everybody\u2022Private key: Only known by that person\u2022Keys come in pairs: every public key corresponds to one private key\u2022Uses number theory\u2022Examples: Modular arithmetic, factoring, discrete logarithm problem, Elliptic logs over Elliptic Curves\u2022Contrast with symmetric-key cryptography (uses XORs and bit-shifts)\u2022Messages are numbers\u2022Contrast with symmetric-key cryptography (messages are bit strings)"}, {"id": "4e3f0a0bbb56446a414dea21cf058219ea670aa5", "filename": "Lecture 15_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Public-key Cryptography\u2022Benefit:\u2022Drawback:\u2022Benefit: No longer need to assume that Alice and Bob already share a secret\u2022Drawback: Much slower than symmetric-key cryptography\u2022Number theory calculations are much slower than XORs and bit-shifts"}, {"id": "83958dffc06dfa997e2ed9646a6ff4e5495d1500", "filename": "Lecture 15_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Reading materials\u2022Encryption: Strengths and Weaknesses of Public-key Cryptography\u2022Public-key cryptography is a public invention due to Whitfield Diffie & Martin Hellman at Stanford Uni in 1976"}, {"id": "9047ceee3608fe488aa47a2b78afd7dd85eb252a", "filename": "Lecture 15_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Public-key cryptography\u2022public-key/two-key/asymmetriccryptography involves the use of twokeys: \u2022a public-key, which may be known by anybody, and can be used to encrypt messages, and verify signatures\u2022a private-key, known only to the recipient, used to decrypt messages, and sign(create)signatures\u2022is asymmetricbecause\u2022Not the same key\u2022those who encrypt messages or verify signatures cannotdecrypt messages or create signatures"}, {"id": "69d1808721b4112930c0f8f8c18941c4d9902719", "filename": "Lecture 15_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Public-Key Encryption\u2022Everybody can encrypt with the public key\u2022Only the recipient can decrypt with the private key"}, {"id": "c98e11f0984183d40df76546f1f77d0060983434", "filename": "Lecture 15_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Public-Key Cryptography -Encryption"}, {"id": "1a16d3b900651adf2f640d3e6d6b22d4b6cfe230", "filename": "Lecture 15_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Encryption steps\u2022step1: generate a pair of keys\u2022step2: keep the private key / secret key (SK) and distribute the public key (PK) \u2013place PK in a public register or other accessible file\u2022step3: Bob encrypts the message with Alice\u2019s PK\u2022step4: upon receiving the ciphertext (CT), Alice decrypt CT with SK"}, {"id": "5228ca8d2e065b19d399dd09a4bed214aad284a3", "filename": "Lecture 15_slides.pdf", "page": 8, "start_line": 1, "end_line": 2, "text": "Anexample of key distribution SSH key-based client authentication. Source: Peiyue and Yuanyuan 2021.1.Peiyue, G. and F. Yuanyuan. 2021. \"What Is SSH?\" Info-Finder, Huawei, July 22. Updated 2021-12-14. Accessed 2023-04-18."}, {"id": "57191ddcdaefe5c3a18c743c639b32cfe2177fa1", "filename": "Lecture 16_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Encryption steps\u2022step1: generate a pair of keys\u2022step2: keep the private key / secret key (SK) and distribute the public key (PK) \u2013place PK in a public register or other accessible file\u2022step3: Bob encrypts the message with Alice\u2019s PK\u2022step4: upon receiving the ciphertext (CT), Alice decrypt CT with SK"}, {"id": "7456f6ef86410225cb83f81f72204b9ad0d7f788", "filename": "Lecture 16_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Public-Key Encryption: Definition\u2022Three parts:\u2022KeyGen() \u2192 PK, SK: Generate a public/private keypair, where PKis the public key, and SKis the private (secret) key\u2022Enc(PK, M) \u2192 C: Encrypt a plaintext Musing public key PKto produce ciphertext C\u2022Dec(SK, C) \u2192 M: Decrypt a ciphertext Cusing secret key SK\u2022Properties\u2022Correctness: Decrypting a ciphertext should result in the message that was originally encrypted\u2022Dec(SK, Enc(PK, M)) = Mfor all PK, SK\u2190 KeyGen() and M\u2022Efficiency: Encryption/decryption should be fast\u2022Security: 1. Alice (the challenger) just gives Eve (the adversary) the public key, and Eve doesn\u2019t request encryptions. Eve cannot guess out anything; 2. computationally infeasible to recover M with PK and ciphertext"}, {"id": "d29c9eb003351dd84fcfb2587cbb4ab8e9153f8a", "filename": "Lecture 16_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Public-Key Cryptography -Signature"}, {"id": "bff28b1477953aa5e718803e5dc906be1380ca8d", "filename": "Lecture 16_slides.pdf", "page": 4, "start_line": 1, "end_line": 2, "text": "Review Private KeyPublic KeySignatureEncryption"}, {"id": "0c28d7af9d4ba7e5b858b5b5acf5be9b8a853264", "filename": "Lecture 16_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Public-Key application\u2022can classify uses into 3 categories:\u2022encryption/decryption(provide secrecy)\u2022digital signatures(provide authentication)\u2022key exchange(of session keys)\u2022some algorithms are suitable for all uses; others are specific to one\u2022Either of the two related keys can be used for encryption, with the other used for decryption"}, {"id": "1c2a38ecf44dcf23c8211b0c6bf8fda938d685a5", "filename": "Lecture 16_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Security of Public Key Schemes\u2022Keys used are very large (>512bits) \u2022like private key schemes brute force exhaustive searchattack is always theoretically possible \u2022Security relies on a large enough difference in difficultybetween easy (en/decrypt) and hard (cryptanalyze) problems\u2022more generally the hard problem is known, it\u2019s just made too hard to do in practice \u2022Requires the use of very large numbers, hence is slowcompared to private/symmetric key schemes"}, {"id": "7afb7bfaba5c7efe3f1eeddc55c96ba294c84d73", "filename": "Lecture 17_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Public-Key Cryptography Algorithm(RSA)"}, {"id": "df9f1ff3988a3d45767af5d1102a3de49f22c04a", "filename": "Lecture 17_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "RSA Public-key encryption\u2022by Rivest, Shamir & Adleman of MIT in 1977 \u2022currently the \u201cwork horse\u201d of Internet security\u2022most public key infrastructure (PKI) products\u2022SSL/TLS: certificates and key-exchange\u2022secure e-mail: PGP , Outlook, \u2026.\u2022based on exponentiation in a finite (Galois) field over integers modulo a prime \u2022exponentiation takes O((log n)3) operations (easy)\u2022security due to cost of factoring large integer numbers \u2022factorization takes O(e log n log log n) operations (hard)\u2022uses large integers (eg.1024 bits)"}, {"id": "9fc26658ba324ccbe099d494c838eb211d170e18", "filename": "Lecture 17_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "RSA key setup\u2022each user generates a public/private key pair by: \u2022selecting two large primes at random -p, q\u2022computing their system modulus n=p!q\u2022note \u00f8(n)=(p-1)(q-1)\u2022selecting at random the encryption key e\u2022where 1<e<\u00f8(n), gcd(e,\u00f8(n))=1 \u2022solve following equation to find decryption key d\u2022ed=1 mod \u00f8(n)\u2022publish their public encryption key: pk={e,n} \u2022keep secret private decryption key: sk={d,p,q}"}, {"id": "48d9e58fae4cceda847df05ec319e6de435125f7", "filename": "Lecture 17_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "RSA example1.Select primes: p=17 & q=112.Computen = pq=17\u00d711=1873.Compute\u00f8(n)=(p\u20131)(q-1)=16\u00d710=1604.Select e: gcd(e,160)=1; choose e=75.Determine d: de=1 mod 160and d < 160Value is d=23since 23\u00d77=161= 10\u00d7160+16.Publish public key pk={7,187}7.Keep secret private key sk={23,17,11}"}, {"id": "a91a02b6044fed9d19fffd6fcd22b369be2a277c", "filename": "Lecture 18_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "RSA example1.Select primes: p=17 & q=112.Computen = pq=17\u00d711=1873.Compute\u00f8(n)=(p\u20131)(q-1)=16\u00d710=1604.Select e: gcd(e,160)=1; choose e=75.Determine d: de=1 mod 160and d < 160Value is d=23since 23\u00d77=161= 10\u00d7160+16.Publish public key pk={7,187}7.Keep secret private key sk={23,17,11}"}, {"id": "532fd82a4f2194f3ded66a2c224db34451d9006d", "filename": "Lecture 18_slides.pdf", "page": 2, "start_line": 1, "end_line": 2, "text": "RSA use\u2022to encrypt a message M the sender:\u2022obtains public keyof recipient pk={e,n}\u2022computes: C=Memod n, where 0\u2264M<n\u2022to decrypt the ciphertext C the owner:\u2022uses their private key sk={d,p,q}\u2022computes: M=Cdmod n\u2022note that the message M must be smaller than the modulus n (block if needed) PlaintextCiphertextC = \ud835\udc40!pk={e,n}sk={d,p,q}"}, {"id": "732df1bc2ee79acedf87ed6ab5af8065196ba8fd", "filename": "Lecture 18_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "RSA example continue\u2022sample RSA encryption/decryption is: \u2022given message M = 88( 88<187)\u2022encryption:C = 887mod 187 = 11\u2022decryption:M = 1123mod 187 = 88"}, {"id": "600e3cf77fceb9c2e972528a2fe6d84ff72ce6f1", "filename": "Lecture 18_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Example of RSA algorithm"}, {"id": "ff2cc893c54e1015b9ac8e4ec97717146348b4cf", "filename": "Lecture 18_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "RSA key generation\u2022users of RSA must:\u2022determine two primes at random -p, q\u2022select either eor dand compute the other\u2022primes p,qmust not be easily derived from modulus n=p.q\u2022means must be sufficiently large\u2022typically guess and use probabilistic test\u2022exponents e, dare inverses, so use Inverse algorithm to compute the other"}, {"id": "2c5d47f2ad6c47592b3c38c78f822e29250bbd56", "filename": "Lecture 18_slides.pdf", "page": 6, "start_line": 1, "end_line": 2, "text": "Correctness of RSA\u2022Euler\u2019s theorem: if gcd(M, n) = 1, then \ud835\udc40!(#)=1mod n. Here \u03c6(n) is Euler\u2019s totient function: the number of integers in {1, 2, . . .,n-1} which are relatively prime ton. Whennis a prime, this theorem is just Fermat\u2019s little theorem M\u2019 = \ud835\udc36%mod n=\ud835\udc40&% mod n= \ud835\udc40(!#)* mod n= [\ud835\udc40!(#)](,\ud835\udc40 mod n= M mod n"}, {"id": "7d7b048cce74499ebde5436ea34ec2b1ba5a1909", "filename": "Lecture 18_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Attack approaches\u2022Mathematical attacks: several approaches, all equivalent in effort to factoring the product of two primes. The defense against mathematical attacks is to use a large key size. \u2022Timing attacks: These depend on the running time of the decryption algorithm\u2022Chosen ciphertext attacks: this type of attacks exploits properties of the RSA algorithm by selecting blocks of data. These attacks can be thwarted by suitable padding of the plaintext, such as PKCS1 V1.5 in SSL"}, {"id": "779ce4f30c061a4cf6fb76c006b419f0ef346b45", "filename": "Lecture 18_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "A simple attack on textbook RSA\u2022Session-key K is 64 bits. View K \u00ce{0,\u2026,264}\u2022Eavesdropper sees: C = Ke(mod N) .\u2022Suppose K = K1\u00d7K2where K1, K2< 234 . \u2022Then: C/K1e= K2e(mod N)\u2022Build table: C/1e, C/2e, C/3e, \u2026, C/234e. time: 234For K2= 0,\u2026, 234test if K2eis in table. time: 234\u00d734\u2022Attack time: \u00bb240 << 264Web BrowserWebServerRandom session key KdClient HelloServer Hello (e, N)C = RSA (K)"}, {"id": "a364775d10cbd3fd53089010049e29d85b26ce52", "filename": "Lecture 19_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Attack approaches\u2022Mathematical attacks: several approaches, all equivalent in effort to factoring the product of two primes. The defense against mathematical attacks is to use a large key size. \u2022Timing attacks: These depend on the running time of the decryption algorithm\u2022Chosen ciphertext attacks: this type of attacks exploits properties of the RSA algorithm by selecting blocks of data. These attacks can be thwarted by suitable padding of the plaintext, such as PKCS1 V1.5 in SSL"}, {"id": "7723dd85b7a20dec96473539402dffc8166e8259", "filename": "Lecture 19_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "A simple attack on textbook RSA\u2022Session-key K is 64 bits. View K \u00ce{0,\u2026,264}\u2022Eavesdropper sees: C = Ke(mod N) .\u2022Suppose K = K1\u00d7K2where K1, K2< 234 . \u2022Then: C/K1e= K2e(mod N)\u2022Build table: C/1e, C/2e, C/3e, \u2026, C/234e. time: 234For K2= 0,\u2026, 234test if K2eis in table. time: 234\u00d734\u2022Attack time: \u00bb240 << 264Web BrowserWebServerRandom session key KdClient HelloServer Hello (e, N)C = RSA (K)"}, {"id": "c4efbeaa58fadc71b2cb65817bd54b7e69e15cf7", "filename": "Lecture 19_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Take-home exercise \u2013no need to submit \u2022SWtextbook (6th edition)problems: 3.14 & 3.15"}, {"id": "c10e909770bb8200dae0570d4618025586c76e1f", "filename": "Lecture 19_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Homomorphic encryption \u2022Encryption scheme that allows computation on ciphertexts \u2022an extension of public-key encryption scheme that allows anyone in possession of the public key to perform operations on encrypted data without access to the decryption key\u2022Partially Homomorphic Encryption: Initial public-key systems that allow this for either addition or multiplication, but not both.\u2022i.e.RSA\u2022Fully homomorphic encryption (FHE)"}, {"id": "b98fcb2ccdb88b0809f703d975a54b91acf2b366", "filename": "Lecture 19_slides.pdf", "page": 5, "start_line": 1, "end_line": 2, "text": "Application of homomorphic encryption \u2022One Use case: cloud computing \u2022A weak computational device Alice (e.g., a mobile phoneor a laptop) wishes to perform a computationally heavy task, beyond her computational means. She can delegate it to a much stronger (but still feasible) machine Bob (the cloud, or a supercomputer) who offers the service of doing so. The problem is that Alice does not trust Bob, who may give the wrong answer due to laziness, fault, or malice. E (Pk, data)E (Pk, f(data))"}, {"id": "f63721b2b6d63e74d6ea18b44813ee0bda82afd8", "filename": "Lecture 19_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "RSA reading materials\u2022A Method for Obtaining Digital Signatures and Public-Key Cryptosystems"}, {"id": "510d7fa1f19d1bdec541464bd68b8472cfbb6032", "filename": "Lecture 1_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Network SecurityIntroductionChapter 1"}, {"id": "055b7a6f1b790c72c3e888d7cabfc4949458ddfc", "filename": "Lecture 1_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Learning Objective\u2022Introduce the security requirements \u2022confidentiality\u2022integrity\u2022availability\u2022Describe the X.800 security architecture for OSI"}, {"id": "8332416494b2021c23548bb8c90c8f54e6d9161c", "filename": "Lecture 1_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Network Security Requirements"}, {"id": "77334ba3058d109e2bd24145adc27b369e961412", "filename": "Lecture 1_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Computer NetworkSecurity\u2022Definition: The protection afforded to an automated information system in order toattain the application objectives to preserving the integrity, availability, and confidentialityof information system resources (includes hardware, software, firmware, information/data, and telecommunications). -NIST Computer Security Handbook"}, {"id": "aa3a2c22942ab7f8fa256ab20020741dbcfa7ec6", "filename": "Lecture 1_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Confidentiality\u2022Dataconfidentiality: Assures that private or confidential information is not made available or disclosed to unauthorizedindividuals; \u2022Privacy: Assures that individual's control or influence what information related to them may be collected and stored and by whomand to whomthat information may be disclosed\u2022i.e., student grade information"}, {"id": "2d7b5d5c8f2b4da9f00d850185cef6b4df31ecff", "filename": "Lecture 1_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Integrity\u2022Data integrity: Assures that data (both stored and in transmitted packets) and programs are changed only in a specifiedand authorizedmanner;\u2022System integrity: Assures that a system performs its intended function in an unimpaired manner, free from deliberate or inadvertent unauthorizedmanipulation of the system\u2022i.e., a hospital patient\u2019s allergy information"}, {"id": "8d44a6901201d3dc08386cdd232d760fdf1e4378", "filename": "Lecture 1_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Availability\u2022Availability: Assures that systems work promptly, and service is not denied to authorized users, ensuring timelyand reliableaccess to and use of information\u2022i.e., denial of service attack"}, {"id": "f5c381c1846c1652f70b1e9c1ac6572b69180d3d", "filename": "Lecture 1_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Other security requirements\u2022Authenticity\u2022Accountability\u2022tracible data source, \u2022fault isolation\u2022intrusion detection and prevention, \u2022recovery and legal action\u2022system must keep records of their activities to permit later forensic analysis to trace security breaches or to aid in transaction disputes"}, {"id": "850a09c74b5ae88effc0e5f8932674f60d3f9c50", "filename": "Lecture 1_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Question\u2022What security requirements does a blockchain system have achieved?"}, {"id": "968433f988ed64bf9761238d74b5d4dbb53f77a2", "filename": "Lecture 1_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "A Hyperledger"}, {"id": "7619d3db4a2546baf4e5a976de5bf622b29b97d1", "filename": "Lecture 20_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Message Authentication"}, {"id": "2775d832f1a706cc7a278f468dd7f72ed9760e68", "filename": "Lecture 20_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Message authentication\u2022message authentication is concerned with: \u2022protecting the integrity of a message \u2022validating identity of originator \u2022non-repudiation of origin (dispute resolution)\u2022then threealternative functions used:\u2022message encryption \u2013symmetric\u2022message authentication code (MAC)\u2022digital signature"}, {"id": "c9b018a782b0e34dc88972bb5158b28f08caa936", "filename": "Lecture 20_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Message encryption\u2022Symmetric message encryption by itself also provides a measure of authentication\u2022if symmetric encryption is used then:\u2022receiver knows sender must have created it\u2022since only sender and receiver know key used\u2022know content cannot be altered"}, {"id": "b4310d1b8050d624e67565844e9defa0a17fd5a7", "filename": "Lecture 20_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Homework 1 questions\u2022Symmetric Block Cypher provides authentication and confidentiality\u2022Ans: True"}, {"id": "77da3cbc5796d91d3ceedc42bfcb0936f4c61a6a", "filename": "Lecture 20_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Message encryption\u2022if public-key encryption is used:\u2022encryption provides no confidence of sender\u2022since anyone potentially knows public-key\u2022so, need to recognize corrupted messages\u2022however, if \u2022sender signsmessage using their private-key\u2022then encrypts with recipients\u2019 public key\u2022have both secrecy and authentication\u2022but at cost of two public-key uses on message"}, {"id": "6c541e124c01e70658e0ef4cb1e8268a955f3dba", "filename": "Lecture 20_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Reasons to avoid encryption authentication\u2022Encryption software is quite slow\u2022Encryption hardware costs are nonnegligible\u2022Encryption hardware is optimized toward large data sizes\u2022An encryption algorithm may be protected by a patent"}, {"id": "395534b4056e625b389feeb8a8918132a860609d", "filename": "Lecture 20_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Hash Function"}, {"id": "982f2b781b5926224b79875a5f302970a7f80849", "filename": "Lecture 20_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Hash functions\u2022Hash function: h = H(M)\u2022M can be of any size \u2022h is always of fixed size \u2022Typically, h << size(M)"}, {"id": "38885672a0711a793c3b03e8aa823b2052b16004", "filename": "Lecture 20_slides.pdf", "page": 9, "start_line": 1, "end_line": 2, "text": "One use case -using hash function \u2022Initialization: A and B share a common secret, SAB\u2022Message, M\u2022A calculates MDM= H (SAB|| M)\u2022B recalculates MD\u2019M, and check\u2022MD\u2019M= MDM"}, {"id": "f98f62a9cd049b27407564271fbecd07e79b58d6", "filename": "Lecture 20_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Requirements for secure hash functions\u20221. can be applied to any sized message M\u20222. produces fixed-length output h\u20223. is easy to compute h=H(M)for any message M\u20224. given his infeasible to find xs.t.H(x)=h\u2022one-way property or preimage resistance\u20225. given xis infeasible to find x\u2019s.t.H(x\u2019)=H(x)\u2022weak collision resistance or second pre-image resistant\u20226. infeasible to find any pairof x,x\u2019s.t.H(x\u2019)=H(x)\u2022strong collision resistance"}, {"id": "eedbf6530409a69b5a8b151aa2517a460e57d4de", "filename": "Lecture 20_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Hash Function: Collision Resistance\u2022Collision: Two different inputs with the same output\u2022x\u2260 x' and H(x) = H(x')\u2022Can we design a hash function with no collisions?\u2022No, because there are more inputs than outputs (pigeonhole principle)\u2022However, we want to make finding collisions infeasiblefor an attacker\u2022Collision resistance: It is infeasible to (i.e.no polynomial time attacker can) find any pair of inputs x'\u2260 xsuch that H(x) = H(x')"}, {"id": "bc5c660054918307eb9f47544443c2e6f3f5a366", "filename": "Lecture 20_slides.pdf", "page": 12, "start_line": 1, "end_line": 1, "text": "Secure hash function\u2022A hash function that satisfies the first five properties is referred to as a weak hash function\u2022Security: random/unpredictability, no predictable patterns for how changing the input affects the output\u2022Changing 1 bit in the input causes the output to be completely different\u2022Also called \u201crandom oracle\u201d assumption"}, {"id": "9bcb127412ab9c10b3a2834bb916c48b918a50ea", "filename": "Lecture 20_slides.pdf", "page": 13, "start_line": 1, "end_line": 1, "text": "Secure hash function\u2022A hash function that satisfies the first five properties is referred to as a weak hash function\u2022Security: random/unpredictability, no predictable patterns for how changing the input affects the output\u2022Changing 1 bit in the input causes the output to be completely different\u2022Also called \u201crandom oracle\u201d assumption\u2022A message digest\u2022a cryptographic hash function containing a string of digits created by a one-way hashing formula\u2022provides data integrity\u2022Examples: SHA-1 (Secure Hash Algorithm 1), SHA-2, SHA-3, MD5"}, {"id": "724ab0d8379735f27f866d2744995ff05d1fdb75", "filename": "Lecture 20_slides.pdf", "page": 14, "start_line": 1, "end_line": 1, "text": "Hash Function: Examples\u2022MD5\u2022Output: 128 bits\u2022Security: Completely broken\u2022SHA-1\u2022Output: 160 bits\u2022Security: Completely broken in 2017\u2022Was known to be weak before 2017, but still used sometimes\u2022SHA-2\u2022Output: 256, 384, or 512 bits (sometimes labeled SHA-256, SHA-384, SHA-512)\u2022Not currently broken, but some variants are vulnerable to a length extension attack\u2022Current standard\u2022SHA-3 (Keccak)\u2022Output: 256, 384, or 512 bits\u2022Current standard (not meant to replace SHA-2, just a different construction)"}, {"id": "5c4970b8991da9b5c505a929f423a34531b9b46e", "filename": "Lecture 20_slides.pdf", "page": 15, "start_line": 1, "end_line": 1, "text": "Length Extension Attacks\u2022Length extension attack: Given H(x) and the length of x, but not x, an attacker can create H(x || m) for any mof the attacker\u2019s choosing\u2022Length extension attack -Wikipedia\u2022SHA-256 (256-bit version of SHA-2) is vulnerable\u2022SHA-3 is not vulnerable"}, {"id": "44f70919cf5cc0a6dbf0ceabaa87ba3cee6cb79f", "filename": "Lecture 21_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Length Extension Attacks\u2022Length extension attack: Given H(x) and the length of x, but not x, an attacker can create H(x || m) for any mof the attacker\u2019s choosing\u2022Length extension attack -Wikipedia\u2022SHA-256 (256-bit version of SHA-2) is vulnerable\u2022SHA-3 is not vulnerable"}, {"id": "4d901f2f705083f8547535d696b4572ab057149d", "filename": "Lecture 21_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Does hashes provide integrity?\u2022It depends on your threat model\u2022Scenario\u2022Mozilla publishes a new version of Firefox on some download servers\u2022Alice downloads the program binary\u2022How can she be sure that nobody tampered with the program?\u2022Idea: use cryptographic hashes\u2022Mozilla hashes the program binary and publishes the hash on its website\u2022Alice hashes the binary she downloaded and checks that it matches the hash on the website\u2022If Alice downloaded a malicious program, the hash would not match (tampering detected!)\u2022An attacker can\u2019t create a malicious program with the same hash (collision resistance)\u2022Threat model: We assume the attacker cannot modify the hash on the website\u2022We have integrity, as long aswe can communicate the hash securely"}, {"id": "0382052282095abd1398254354b6cdad48eda2af", "filename": "Lecture 21_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Do hashes provide integrity?\u2022It depends on your threat model\u2022Scenario\u2022Alice and Bob want to communicate over an insecure channel\u2022David might tamper with messages\u2022Idea: Use cryptographic hashes\u2022Alice sends her message with a cryptographic hash over the channel\u2022Bob receives the message and computes a hash on the message\u2022Bob checks that the hash he computed matches the hash sent by Alice\u2022Threat model: David can modify the message and the hash\u2022No integrity!"}, {"id": "12422d6e3249be8ec0cbea4a89c39e6f4b814115", "filename": "Lecture 21_slides.pdf", "page": 5, "start_line": 1, "end_line": 2, "text": "Man-in-the-middle attack AliceM\u2019MD\u2019MMDMMDM\u2019MD\u2019BobDavid"}, {"id": "303fa07a231caa8522610d38c40a505813b10657", "filename": "Lecture 21_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Do hashes provide integrity? \u2022It depends on your threat model\u2022If the attacker can modify the hash, hashes don\u2019t provide integrity\u2022Main issue: Hashes are unkeyedfunctions\u2022There is no secret key being used as input, so any attacker can compute a hash on any value"}, {"id": "74c26b936919222a796a47dfbd9a3c965da62a80", "filename": "Lecture 21_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Solutions\u2022A message digest created using a secret symmetric key is known as a Message Authentication Code (MAC), because it can provide assurance that the message has not been modified\u2022The sender can also generate a message digest and then encrypt the digest using the private key of an asymmetric key pair, forming a digital signature. The signature must then be verified by the receiver through comparing it with a locally generated digest"}, {"id": "7d091f1ad907319cf165fcab6cc1a47ffe422463", "filename": "Lecture 21_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Hashes: Summary\u2022Map arbitrary-length input to fixed-length output\u2022Output is deterministic\u2022Security properties\u2022One way: Given an output y, it is infeasible to find any input xsuch that H(x) = y.\u2022Second preimage resistant: Given an input x, it is infeasible to find another input x'\u2260 xsuch that H(x) = H(x').\u2022Collision resistant: It is infeasible to find any pair of inputs x'\u2260 xsuch that H(x) = H(x\u2019).\u2022Randomized output\u2022Some hashes are vulnerable to length extension attacks\u2022Hashes don\u2019t provide integrity (unless you can publish the hash securely)"}, {"id": "a83399f8de8b1c20bce69725335bc0ddbcf4b9b7", "filename": "Lecture 21_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Message Authentication Code"}, {"id": "9a032636e9ade0af953604f17186c48460f5baab", "filename": "Lecture 21_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Message authentication code (MAC)\u2022generated by an algorithm that creates a small fixed-sized block\u2022depending on both message and some key\u2022not be reversible\u2022MACM= F(KAB, M)\u2022appended to message as a signature\u2022receiver performs same computation on message and checks it matches the MAC\u2022provides assurance that message is unaltered and comes from sender"}, {"id": "9e44c4315d8a3ef6db00a7032036e910dc96ff3b", "filename": "Lecture 21_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "MACs: Usage\u2022Alice wants to send Mto Bob, but doesn\u2019t want David to tamper with it\u2022Alice sends Mand T= MAC(K, M) to Bob\u2022Bob receives Mand T\u2022Bob computes MAC(K, M) and checks that it matches T\u2022If the MACs match, Bob is confident the message has not been tampered with (integrity)"}, {"id": "a83cbdba7889e8af14059e8f92f6cf52599652f6", "filename": "Lecture 21_slides.pdf", "page": 12, "start_line": 1, "end_line": 1, "text": "MACs: Definition\u2022Two parts:\u2022KeyGen() \u2192 K: Generate a key K\u2022MAC(K, M) \u2192 T: Generate a tag Tfor the message Musing key K\u2022Inputs: A secret key and an arbitrary-length message\u2022Output: A fixed-length tagon the message\u2022Properties\u2022Correctness: Determinism\u2022Note: Some more complicated MAC schemes have an additional Verify(K, M, T) function that don\u2019t require determinism, but this is out of scope\u2022Efficiency: Computing a MAC should be efficient\u2022Security: existentially unforgeable under chosen plaintext attack"}, {"id": "fc7f0625864f88c329fe4e3409322337a188d6b4", "filename": "Lecture 21_slides.pdf", "page": 13, "start_line": 1, "end_line": 1, "text": "Mid-term Exam\u2022Nov. 6, 2024 (Wednesday), 12:00 pm \u201312:50 pm, in class\u2022Closed book, but you're allowed to bring one cheat sheet (1 A4-sized paper)\u2022Chapter 1 \u20133\u2022Will have a review class on Nov. 1st,during class"}, {"id": "7f4a3d981dd8a9f66e07f87ffa9d5f9fd3192c67", "filename": "Lecture 22_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Existentially unforgeable\u2022A secure MAC is existentially unforgeable: without the key, an attacker cannot create a valid tag on a message\u2022David cannot generate MAC(K, M') without K\u2022David cannot find any M' \u2260 Msuch that MAC(K, M') = MAC(K, M)"}, {"id": "1656510db4c8342c81e13a3a0c0585ce6cf024d9", "filename": "Lecture 22_slides.pdf", "page": 2, "start_line": 1, "end_line": 2, "text": "Example: HMAC\u2022issued as RFC 2104 [1]\u2022has been chosen as the mandatory-to-implement MAC for IP Security\u2022Used in Transport Layer Security (TLS) and Secure Electronic Transaction (SET) [1] \u201cHMAC: Keyed-Hashing for Message Authentication\u201d, RFC 2104, https://datatracker.ietf.org/doc/html/rfc2104"}, {"id": "679fd8dc2be1f50d94a7f896253c83088c703e14", "filename": "Lecture 22_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "HMAC(K, M)\u2022will produce two keys to increase security\u2022If key is longer than the desired size, we can hash it first, but be careful with using keys that are too much smaller, they have to have enough randomness in them\u2022Output H[(K+\u2295opad) || H[(K+\u2295ipad) || M]]"}, {"id": "46f232e1bc75b0b4a64de6470a6e17a9076d25df", "filename": "Lecture 22_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Example: HMAC\u2022HMAC(K, M):\u2022Output H[(K+\u2295opad) || H[(K+\u2295ipad) || M]]\u2022Use Kto derive two different keys\u2022opad(outer pad) is the hard-coded byte 0x5crepeated until it\u2019s the same length as K+\u2022ipad(inner pad) is the hard-coded byte 0x36repeated until it\u2019s the same length as K+\u2022As long as opadand ipadare different, you\u2019ll get two different keys\u2022For paranoia, the designers chose two very different bit patterns, even though they theoretically need only differ in one bit"}, {"id": "c43adbf8d06f5f11f7ca0baafe37862f88d90aa2", "filename": "Lecture 22_slides.pdf", "page": 5, "start_line": 1, "end_line": 2, "text": "HMAC ABA \u2a01B0 00011101110K+ =!H\ud835\udc3e \ud835\udc3e \ud835\udc56\ud835\udc60 \ud835\udc59\ud835\udc4e\ud835\udc5f\ud835\udc54\ud835\udc52\ud835\udc5f \ud835\udc61\u210e\ud835\udc4e\ud835\udc5b \ud835\udc4f\ud835\udc59\ud835\udc5c\ud835\udc50\ud835\udc58 \ud835\udc60\ud835\udc56\ud835\udc67\ud835\udc52\ud835\udc3e \ud835\udc5c\ud835\udc61\u210e\ud835\udc52\ud835\udc5f\ud835\udc64\ud835\udc56\ud835\udc60\ud835\udc52ipad = 00110110 , repeat b/8 timesopad = 01011100, repeat b/8 times"}, {"id": "56e9de3f198851bb59d1167207b6bd0939782763", "filename": "Lecture 22_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "HMAC procedure\u2022Step 1: Append zeros to the left end of K to create a b-bit string K+(e.g., if K is of length 160 bits and b = 512, then K will be appended with 44 zero bytes); \u2022Step 2: XOR (bitwise exclusive-OR) K+ with ipadto produce the b-bit block Si;\u2022Step 3: Append M to Si;\u2022Step 4: Apply H to the stream generated in step 3; \u2022Step 5: XOR K+with opadto produce the b-bit block So;\u2022Step 6: Append the hash result from step 4 to So;\u2022Step 7: Apply H to the stream generated in step 6 and output the result."}, {"id": "ac46cdc53cd4ad5355cbae21599ee06cc66954b7", "filename": "Lecture 22_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "HMAC Properties\u2022HMAC(K, M) = H[(K+\u2295opad) || H((K+\u2295ipad) || M]]\u2022HMAC is a hash function, so it has the properties of the underlying hash too\u2022It is collision resistant\u2022Given HMAC(K, M), an attacker can\u2019t learn M \u2013one way\u2022If the underlying hash is secure, HMAC doesn\u2019t reveal M, but it is still deterministic\u2022You can\u2019t verify a tag Tif you don\u2019t have K\u2022This means that an attacker can\u2019t brute-force the message Mwithout knowingK"}, {"id": "28662740be54da993545bb514cfe2cd7e0005e6d", "filename": "Lecture 22_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "MACs: Summary\u2022Inputs: a secret key and a message\u2022Output: a tag on the message\u2022A secure MAC is unforgeable: Even if David can trick Alice into creating MACs for messages that David chooses, David cannot create a valid MAC on a message that she hasn't seen before\u2022Example: HMAC(K, M) = H((K+\u2295opad) || H((K+\u2295ipad) || M))\u2022MACs do not provide confidentiality"}, {"id": "1935fb1dc8d7610991f7914966c3cdd701651055", "filename": "Lecture 22_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Do MACs provide integrity? \u2022Do MACs provide integrity?\u2022Yes. An attacker cannot tamper with the message without being detected\u2022Do MACs provide authenticity?\u2022It depends on your threat model\u2022If only two people have the secret key, MACs provide authenticity: it has a valid MAC, and it\u2019s not from me, so it must be from the other person\u2022More than one secret key, If a message has a valid MAC, you can be sure it came from someone with the secret key, but you can\u2019t narrow it down to one person\u2022Do MACs provide confidentiality?"}, {"id": "f37d094fa9373fe16e85d948795fee6c34b6f1ab", "filename": "Lecture 22_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Authenticated Encryption"}, {"id": "3bfec67ecd37ad7ebdae393af2a7e2e06413b72a", "filename": "Lecture 22_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Authenticated Encryption: Definition\u2022Authenticated encryption (AE): A scheme that simultaneously guarantees confidentiality and integrity (and authenticity, depending on your threat model) on a message\u2022Two ways of achieving authenticated encryption:\u2022Combine schemes that provide confidentiality with schemes that provide integrity\u2022Use a scheme that is designed to provide confidentiality and integrity"}, {"id": "79584c6202a886b459170a54f9c44d234549f1d0", "filename": "Lecture 23_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Authenticated Encryption: Definition\u2022Authenticated encryption (AE): A scheme that simultaneously guarantees confidentiality and integrity (and authenticity, depending on your threat model) on a message\u2022Two ways of achieving authenticated encryption:\u2022Combine schemes that provide confidentiality with schemes that provide integrity\u2022Use a scheme that is designed to provide confidentiality and integrity"}, {"id": "9a61d8bcb5c75d449a241a5ac52b4d6536da36a9", "filename": "Lecture 23_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Scratchpad: Let\u2019s design it together\u2022You can use:\u2022An encryption scheme: Enc(K, M) and Dec(K, M)\u2022An unforgeable MAC scheme (e.g.HMAC): MAC(K, M)\u2022First attempt: Alice sends Enc(K1, M) and MAC(K2, M)\u2022Integrity? Yes, attacker can\u2019t tamper with the MAC\u2022Confidentiality? No, the MAC is not secure\u2022Idea 1: Let\u2019s compute the MAC on the ciphertextinstead of the plaintext:Enc(K1, M)and MAC(k2, Enc(K1, M))\u2022Integrity? Yes, attacker can\u2019t tamper with the MAC\u2022Confidentiality? Yes, the MAC might leak info about the ciphertext, but that\u2019s okay\u2022Idea 2: Let\u2019s encrypt the MAC too: Enc(K1, M|| MAC(K2, M))\u2022Integrity? Yes, attacker can\u2019t tamper with the MAC\u2022Confidentiality? Yes, everything is encrypted"}, {"id": "cdb055c8ee6faee9ef56926dcb1164c0ce975656", "filename": "Lecture 23_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "MAC-then-Encrypt or Encrypt-then-MAC?\u2022Method 1: Encrypt-then-MAC\u2022First compute Enc(K1, M)\u2022Then MAC the ciphertext: MAC(K2, Enc(K1, M))\u2022Method 2: MAC-then-encrypt\u2022First compute MAC(K2, M)\u2022Then encrypt the message and the MAC together: Enc(k1, M||MAC(K2, M))\u2022Which is better?\u2022In theory, both are secure if applied properly\u2022MAC-then-encrypt has a flaw: You don\u2019t know if tampering has occurred until after decrypting\u2022Attacker can supply arbitrary tampered input, and you always have todecrypt it\u2022Passing attacker-chosen input through the decryption function can cause side-channel leaks\u2022Always use encrypt-then-MACbecause it\u2019s more robust to mistakes"}, {"id": "ad5279b0949116fb09a87f3ddea692998a9ae4d2", "filename": "Lecture 23_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "TLS 1.0 \u201cLucky 13\u201d Attack\u2022TLS: A protocol for sending encrypted and authenticated messages over the Internet\u2022TLS 1.0 uses MAC-then-encrypt: Enc(k1, M || MAC(k2, M))\u2022The encryption algorithm is AES-CBC\u2022The Lucky 13 attack abuses MAC-then-encrypt to read encrypted messages\u2022Guess a byte of plaintext and change the ciphertext accordingly\u2022The MAC will error, but the time it takes to error is different depending on if the guess is correct\u2022Attacker measures how long it takes to error in order tolearn information about plaintext\u2022TLS will send the message again if the MAC errors, so the attacker can guess repeatedly\u2022Takeaways\u2022Side channel attack: The algorithm is proved secure, but poor implementation made it vulnerable\u2022Always encrypt-then-MAC"}, {"id": "2feaf2ab5f2834f761269e69fa66613f4c758e76", "filename": "Lecture 23_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Authenticated Encryption: Summary\u2022Authenticated encryption: A scheme that simultaneously guarantees confidentiality and integrity (and authenticity) on a message\u2022First approach: Combine schemes that provide confidentiality with schemes that provide integrity and authenticity\u2022MAC-then-encrypt: Enc(K1, M|| MAC(K2, M))\u2022Encrypt-then-MAC: MAC(K2, Enc(K1, M))\u2022Always use Encrypt-then-MAC because it's more robust to mistakes"}, {"id": "a54983c9048c2a10ef4e2e8560b681bbaa00becd", "filename": "Lecture 23_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Digital Signature"}, {"id": "5aac40d2569c97e87a40250728a71efd08da8943", "filename": "Lecture 23_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Digital Signatures\u2022NIST FIPS PUB 186-4 -the result of a cryptographic transformation of data that, when properly implemented, provides a mechanism for verifying origin authentication, data integrity, and signatory non-repudiation\u2022Based on asymmetric keys"}, {"id": "2e25a67a5618765bf5d8eab1bbb60b89809c97b4", "filename": "Lecture 23_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Digital Signatures\u2022Asymmetric cryptography is good because we don\u2019t need to share a secret key\u2022Digital signatures are the asymmetric way of providing integrity/authenticity to data\u2022Assume that Alice and Bob can communicate public keys without David interfering"}, {"id": "d1dccdd73408cd41944e0ce00a438f3235ade37e", "filename": "Lecture 23_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Digital Signatures: Definition\u2022Three parts:\u2022KeyGen() \u2192 PK, SK: Generate a public/private keypair, where PKis the verify (public) key, and SKis the signing (secret) key\u2022Sign(SK, M) \u2192 sig: Sign the message Musing the signing key SKto produce the signature sig\u2022Verify(PK, M, sig) \u2192 {0, 1}: Verify the signature sigon message Musing the verify key PKand output 1 if valid and 0 if invalid\u2022Properties:\u2022Correctness: Verification should be successful for a signature generated over any message\u2022Verify(PK, M, Sign(SK, M)) = 1 for all PK, SK\u2190 KeyGen() and M\u2022Efficiency: Signing/verifying should be fast\u2022Security: Same as for MACs except that the attacker also receives PK\u2022Namely, no attacker can forge a signature for a message"}, {"id": "0ecf1ceadc6666a0ec3d0eae531cc4c368abfff6", "filename": "Lecture 23_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "RSA Signature\u2022KeyGen():\u2022Randomly pick two large primes, pand q\u2022Compute n= pq\u2022nis usually between 2048 bits and 4096 bits long\u2022Choose e\u2022Requirement: eis relatively prime to (p-1)(q-1)\u2022Requirement: 2 < e< (p-1)(q-1)\u2022Compute d= e-1mod (p-1)(q-1)\u2022Public key: nand e\u2022Private key:d"}, {"id": "62781e15c4c289beb13555a620efa7475c8fd5fc", "filename": "Lecture 23_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "A Short Quiz\u2022We will have a short quiz on Wednesday, Oct. 30, in class \u2022A short quiz will cover the materials taught that day."}, {"id": "a2ac4f88846f38adff8fa82f4ccd47c7099303e6", "filename": "Lecture 24_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "RSA Signatures\u2022Sign(d, M):\u2022Compute H(M)dmod n\u2022Verify(e, n, M, sig)\u2022Verify that H(M) \u2261 sigemodn"}, {"id": "548e95cf117c1d5884d813d49a3205feabc02196", "filename": "Lecture 24_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "RSA Digital Signature AlgoStep1: Generate a hash value, or message digest, mHashfrom the message M to be signed Step2: Pad mHashwith a constant value padding1 and pseudorandom value salt to form M\u2019 Step3: Generate hash value H from M\u2019Step4: Generate a block DB consisting of a constant value padding 2 and saltStep5: Use the mask generating function MGF, which produces a randomized out-put from input H of the same length as DBStep 6: Create the encoded message (EM) block by padding H with the hexadecimal constant bcand the XOR of DB and output of MGFStep 7: Encrypt EM with RSA using the signer\u2019s private key"}, {"id": "d639d92f4edc9d8cb6753b2ed04fb2c1125015ef", "filename": "Lecture 24_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "RSA Signatures: CorrectnessTheorem: sige\u2261 H(M)mod NProof:sige = [\ud835\udc3b\ud835\udc40\ud835\udc51 ]\ud835\udc52 \ud835\udc5a\ud835\udc5c\ud835\udc51 \ud835\udc41=\ud835\udc3b(\ud835\udc40)\"# mod N"}, {"id": "4886b823f59ed6a4f37066415aec2db66c73256a", "filename": "Lecture 24_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "RSA Signatures: CorrectnessTheorem: sige\u2261 H(M)mod NProof:sige = [\ud835\udc3b\ud835\udc40\ud835\udc51 ]\ud835\udc52 \ud835\udc5a\ud835\udc5c\ud835\udc51 \ud835\udc41=\ud835\udc3b(\ud835\udc40)\"# mod N=\ud835\udc3b(\ud835\udc40)$%&'( mod N= [\ud835\udc3b(\ud835\udc40)%(&)]$-\ud835\udc3b\ud835\udc40 mod N= H(M) mod N"}, {"id": "09553f5cac54a47ff494559418a332628da75a54", "filename": "Lecture 24_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "RSA Digital Signature: Security\u2022Necessary hardness assumptions:\u2022Factoring hardness assumption: Given nlarge, it is hard to find primes pq= n\u2022Discrete logarithm hardness assumption:Given nlarge, hash, and hashdmod n, it is hard to find d\u2022Salt also adds security\u2022Even the same message and private key will get different signatures"}, {"id": "f80234ba0d81c4ff1e1fddc9224256a908994cd0", "filename": "Lecture 24_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Hybrid Encryption\u2022Issues with public-key encryption\u2022Notice: We can only encrypt small messages because of the modulo operator\u2022Notice: There is a lot of math, and computers are slow at math\u2022Result: We don\u2019t use asymmetric for large messages\u2022Hybrid encryption: Encrypt data under a randomly generated key Kusing symmetric encryption, and encrypt Kusing asymmetric encryption\u2022EncAsym(PK, K); EncSym(K, large message)\u2022Benefit: Now we can encrypt large amounts of data quickly using symmetric encryption, and we still have the security of asymmetric encryption"}, {"id": "3358d825e4c627c76578d97752e62209ade2873a", "filename": "Lecture 24_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Homework (Textbook) \u2013no submission\u2022Review Question: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6\u2022Problems: \u2022prove correctness of RSA digital signature\u20223.14 & 3.15"}, {"id": "64c49a1743f58369d87a0bce6a20bfb6b948b59b", "filename": "Lecture 24_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Homework 2 -individual\u2022For Chapter 3\u2022Deadline Friday, Nov. 1 before class\u202210% penalty per day for late submission"}, {"id": "c42d90ceacadf06d66af65a568d2dcde179ca4fe", "filename": "Lecture 24_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Thank you!"}, {"id": "2aba854902373ebf08da8095d64c3e9c897ad704", "filename": "Lecture 24_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Network SecurityChapter 4"}, {"id": "d89aff65ea68f5537c6d83d07cfa83ae80f90efa", "filename": "Lecture 24_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Key Distribution"}, {"id": "79a4d592e430678b4d85ed4787ed77cb1cd73441", "filename": "Lecture 24_slides.pdf", "page": 12, "start_line": 1, "end_line": 1, "text": "Symmetric Key Distribution and User Authentication4.2"}, {"id": "0a7d368c1f13224686454f81755082af4a115cdb", "filename": "Lecture 24_slides.pdf", "page": 13, "start_line": 1, "end_line": 1, "text": "Ways to achieve symmetric key distribution\u2022A key could be selected by A and physically delivered to B\u2022A third party could select the key and physically deliver it to A and B \u2022If A and B have previously and recently used a key, one party could transmit the new key to the other, using the old key to encrypt the new key \u2022If A and B each have an encrypted connection to a third-party C, C could deliver a key on the encrypted links to A and B"}, {"id": "cdc78ae9f0434cb39aa3f6b294511fbf7bd063f9", "filename": "Lecture 24_slides.pdf", "page": 14, "start_line": 1, "end_line": 1, "text": "Terminologies\u2022Session key\u2022Permanent key\u2022key distribution center (KDC) \u2022third party authority, centralized infrastructure\u2022give permissions for two parties to communicate"}, {"id": "8b41c1cd75cb99920ecadc8de6af5ce049e0fe95", "filename": "Lecture 24_slides.pdf", "page": 15, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman Key ExchangeSection 3.5"}, {"id": "e87678a8db9de72718ff4bbffe342ab3a68dbcd1", "filename": "Lecture 24_slides.pdf", "page": 16, "start_line": 1, "end_line": 1, "text": "In class quiz on Wednesday\u2022We will have a short quiz on Wednesday, Oct. 30, in class\u2022A short quiz will cover the materials taught that day.\u2022Please be on time for class to avoid missing the quiz questions."}, {"id": "e5a650956ebd85477ffa99e707aa9d6f7e22fb47", "filename": "Lecture 25_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman Key ExchangeSection 3.5"}, {"id": "df9aad747d6d21141761157386a4df00b00514b9", "filename": "Lecture 25_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Outline\u2022Diffie-Hellman Key Exchange (DHKE) Algorithm\u2022Analysis of DHKE"}, {"id": "4fd8608fc54bb0f3211e057d3a3be9f1d5342899", "filename": "Lecture 25_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Use case"}, {"id": "38f211932a64f9aa010cd125fd446c1872aa85b4", "filename": "Lecture 25_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Recall: ways to achieve symmetric key distribution\u2022A key could be selected by A and physically delivered to B\u2022A third party could select the key and physically deliver it to A and B \u2022If A and B have previously and recently used a key, one party could transmit the new key to the other, using the old key to encrypt the new key \u2022If A and B each have an encrypted connection to a third-party C, C could deliver a key on the encrypted links to A and B"}, {"id": "78e7ad416002548e800d763d09f2bb18ce3904ca", "filename": "Lecture 25_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman Key Exchange\u2022Invented by Whitfield Diffie and Martin Hellman in 1976\u2022Allows Alice and Bob to exchange a key without Eve learning it\u2022No third party involved\u2022After DHKE, a common shared key, \ud835\udefc!!!\"is established, it can be used to encrypt message\u2022A common shared key is symmetric"}, {"id": "483ad94808eca41357b0d24a743374a54ec9a8f0", "filename": "Lecture 25_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "The Diffie-Hellman Key Exchange\u2022From B\u2019s view\u2022\ud835\udc3e=\ud835\udc4c!\"!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e=(\ud835\udefc\"\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e)\"!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e=\ud835\udefc\"\"\"!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e"}, {"id": "77662514b2fa42cc1e7abe3437db7a1dda438a6b", "filename": "Lecture 25_slides.pdf", "page": 7, "start_line": 1, "end_line": 2, "text": "Example of the Diffie -Hellman algorithmAliceq=11, \ud835\udf36=7BobXA=3XB=6YA = 73 mod 11 = 2 YB = 76 mod 11 = 4 YB = 4 YA = 2 K1 = 43 mod 11 = 9 K2 = 26 mod 11 = 9 K1 = K2 = K Large RandomNumberLarge RandomNumberLarge Prime Number Note: XA, XB, K1, K2 are Private to others"}, {"id": "717aca8824f45d542b804a966a0dbcae380c5ea6", "filename": "Lecture 25_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Analysis of DHKE -Attack\u2022Adversary gets \ud835\udc5e,\ud835\udefc,\ud835\udc4c,, \ud835\udc4c-.\u2022She needs to compute either \ud835\udc4b,or \ud835\udc4b-=\ud835\udc51\ud835\udc59\ud835\udc5c\ud835\udc54.,0\ud835\udc4c-\u2022Secure?"}, {"id": "166a7f06bcbd3574ce866f70397b34c512c34675", "filename": "Lecture 25_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Discrete Log ProblemCryptographic assumptions:\u2022Discrete logarithm problem(discrete log problem): Given \ud835\udefc,\ud835\udc5e,\ud835\udefc!!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5efor random \ud835\udc4b,, it is computationally hard to find \ud835\udc4b,\u2022Diffie-Hellman assumption: Given\ud835\udefc,\ud835\udc5e,\ud835\udefc!!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e,and \ud835\udefc!\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5efor random\ud835\udc4b,, \ud835\udc4b-, no polynomial time attacker can distinguish between a random value R and \ud835\udefc!!!\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e.\u2022Intuition: The best knownalgorithm is to first calculate \ud835\udc4b\"and then compute (\ud835\udefc#!)#\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e, but this requires solving the discrete log problem, which is hard!\u2022Note: Multiplying the values doesn\u2019t work, since you get \ud835\udefc!!1!\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5d\u2260\ud835\udefc!!!\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5d"}, {"id": "6a48ab7995e2c588da2b4a48853439d9eb11f9fe", "filename": "Lecture 25_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "DHKE in Python Cryptography Library\u2022https://cryptography.io/en/latest/hazmat/primitives/asymmetric/"}, {"id": "19a715bb697d1587049705f3398c512872d66300", "filename": "Lecture 25_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Summing Up\u2022Symmetric Key crypto has a major problem:\u2022How do two people who don\u2019t know each other share a key?\u2022A Diffie-Hellman key exchange lets them compute a shared key even in the presence of an eavesdropper, Eve. \u2022However, if attack is active, instead of passive, this wouldn\u2019t work \u2026\u2022Diffie-Hellman suffers man-in-the-middle attack (next class)"}, {"id": "5c6cbbcc89dabf6837c78dea48638016ccbfcc05", "filename": "Lecture 25_slides.pdf", "page": 12, "start_line": 1, "end_line": 1, "text": "Take home exercises\u2022SW, \u201cNetwork Security Essentials\u201d, 6thEdition, 2017 \u2022Problems \u20133.21Consider a Diffie-Hellman scheme with a common prime \ud835\udc5e= 11 and a primitive root \ud835\udefc= 2.a. if user A has public key \ud835\udc4c\"= 9, what is A\u2019s private key \ud835\udc4b\"?b. If user B has public key \ud835\udc4c$= 3, what is the shared secret key \ud835\udc3e?"}, {"id": "aaf389bc5de593c2ae018463843f079057ee4d9b", "filename": "Lecture 26_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman is susceptible to man-in-the-middle attacks\u2022David can alter messages, block messages, and send her own messages\u2022DH is notsecure against a MITM attacker: David can just do a DH with both sides!"}, {"id": "33386bda597240f8762676406054f33f401243ea", "filename": "Lecture 26_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman: Security"}, {"id": "152d241679a8df916d6648558c9174bf825ec16b", "filename": "Lecture 26_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman: issues\u2022Diffie-Hellman is not secure against a MITM adversary\u2022DHE is an active protocol: Alice and Bob need to be online at the same time to exchange keys\u2022What if Bob wants to encrypt something and send it to Alice for her to read later?\u2022Diffie-Hellman does not provide authentication\u2022You exchanged keys with someone, but Diffie-Hellman makes no guarantees about who you exchanged keys with; it could be David!"}, {"id": "8bdbfff835700e63ed1d585a93e3f6e3197e5cc5", "filename": "Lecture 26_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Ephemerality of Diffie-Hellman\u2022Diffie-Hellman can be used ephemerally (called Diffie-Hellman ephemeral, or DHE)\u2022Ephemeral: Short-term and temporary, not permanent\u2022Alice and Bob discard \ud835\udc4b!,\ud835\udc4b\"and \ud835\udc3e=\ud835\udefc#!#\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5ewhen they\u2019re done\u2022Because you need \ud835\udc4b!and \ud835\udc4b\"to derive \ud835\udc3e, you can never derive \ud835\udc3eagain!\u2022Sometimes \ud835\udc3eis called a session key, because it\u2019s only used for an ephemeral session\u2022Eve can\u2019t decrypt any messages she recorded: Nobody saved \ud835\udc4b!,\ud835\udc4b\"or \ud835\udc3e, and her recording only has \ud835\udefc#!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5eand \ud835\udefc#\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e!"}, {"id": "012a66cb830a1b4aed28ee4f71076cb71d91b876", "filename": "Lecture 26_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Diffie-Hellman Key Exchange: Summary\u2022Algorithm:\u2022Alice chooses \ud835\udc4b!and sends \ud835\udefc#!\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5eto Bob\u2022Bob chooses \ud835\udc4b\"and sends \ud835\udefc#\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5eto Alice\u2022Their shared secret is (\ud835\udefc#!)#\"=(\ud835\udefc#\")#!=\ud835\udefc#!#\"\ud835\udc5a\ud835\udc5c\ud835\udc51\ud835\udc5e\u2022Diffie-Hellman provides forwards secrecy: Nothing is saved or can be recorded that can ever recover the key\u2022Diffie-Hellman can be performed over other mathematical groups, such as elliptic-curve Diffie-Hellman (ECDH)\u2022Issues\u2022Notsecure against MITM\u2022Both parties must be online\u2022Does not provide authenticity"}, {"id": "0a24c94c070465be051ff618f9da0de4eb71506b", "filename": "Lecture 26_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Kerberos4.3"}, {"id": "0e30eba7d4478dfe3e92d4500dfb40ce10c505f4", "filename": "Lecture 26_slides.pdf", "page": 7, "start_line": 1, "end_line": 2, "text": "Many-to Many Authentication How do users prove their identities when requesting services from machines on the network?"}, {"id": "2a701846b913ca4e3f035875c1929a99063aae20", "filename": "Lecture 26_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Threats\u2022User impersonation\u2022Malicious user with access to a workstation pretends to be another user from the same workstation\u2022Network address impersonation\u2022Malicious user changes network address of his workstation to impersonate another workstation \u2022Eavesdropping, tampering, replay \u2022Malicious user eavesdrops, tampers, or replays other users\u2019 conversations to gain unauthorized access"}, {"id": "4010aa3896aa93addc7e0e61cb6e130d48f5b14d", "filename": "Lecture 26_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Requirements\u2022Security\u2022against attacks by eavesdroppers and malicious users\u2022Transparency\u2022users shouldn\u2019t notice authentication taking place\u2022entering password is ok, if done rarely\u2022Scalability\u2022Large number of users and servers"}, {"id": "7c8e7550c0b107c61283a31cda8eea467725926d", "filename": "Lecture 26_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Kerberos\u2022scenario: users at workstations wish to access services on servers distributed throughout the network \u2013many to many authentication"}, {"id": "f4eb3b584b18b4cc2ef91be43a8c0d91d2ca18af", "filename": "Lecture 26_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Kerberos\u2022a centralized authentication server provides mutual authentication between users and servers\u2022a key distribution and user authentication service developed at MIT\u2022works in an open distributed environment\u2022client-service model\u2022Kerberos protocol messages are protected against eavesdropping and replay attacks \u2022Kerberos v4 and v5 [RFC 4120]"}, {"id": "5f205e4b582a3bac9ba90fdb0accfeefcfabe9f9", "filename": "Lecture 27_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Kerberos\u2022a centralized authentication server provides mutual authentication between users and servers\u2022a key distribution and user authentication service developed at MIT\u2022works in an open distributed environment\u2022client-service model\u2022Kerberos protocol messages are protected against eavesdropping and replay attacks \u2022Kerberos v4 and v5 [RFC 4120]"}, {"id": "37fee3ce752591f0b5d4b2a7c28f5798a79f028d", "filename": "Lecture 27_slides.pdf", "page": 2, "start_line": 1, "end_line": 3, "text": "A Simple Authentication Dialogue\u20221. C \u2014>AS: IDC||PC ||IDV\u20222. AS \u2014> C : Ticket = E(KV, [IDC||ADC ||IDV])\u20223. C \u2014> V: IDC|| Ticket\u2022AS \u2013authentication server \u2022ID*-identifier\u2022PC -password of user\u2022ADC-network address of C\u2022KV -secret encryption key shared by AS and V AS CV123"}, {"id": "c585e7e1be385cc06d91f0f226e86421c03858b3", "filename": "Lecture 27_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Advantage\u2022Client and malicious attacker cannot alter IDC(impersonate), ADC(change of address), IDV\u2022server V can verify the user is authenticated through IDC, and grants service to C\u2022guarantee the ticket is valid only if it is transmitted from the same client that initially requested the ticket"}, {"id": "f262f62ba7d434b829c4b52e6f86db20f3b49cdb", "filename": "Lecture 27_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Secure?\u2022Insecure: password is transmitted openly and frequently\u2022Solution: no password transmitted by involving ticket-granting server (TGS)"}, {"id": "dc90fe723cadb14a38562cc663fa1fd62f2bacda", "filename": "Lecture 27_slides.pdf", "page": 5, "start_line": 1, "end_line": 6, "text": "A More Secure Authentication Dialogue\u2022Once per user logon session\u2022(1) C \u2014>AS: IDC||IDtgs\u2022(2) AS \u2014> C: E(KC, Tickettgs)\u2022Once per type of service:\u2022(3) C\u2014>TGS: IDC||IDv||Tickettgs\u2022(4) TGS \u2014> C: TicketV\u2022Once per service session:\u2022(5) C \u2014> V: IDC|| TicketV AS C V123, Tickettgs TGS45 TicketV"}, {"id": "86a11ec6a62df3ff0b28a26c787d72c6d65a41ae", "filename": "Lecture 27_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Advantage\u2022No password transmitted in plaintext\u2022Timestamp is added to prevent reuse of ticket by an attacker"}, {"id": "9da3ec4cf0ecd8afffec7555b68b4613247602bd", "filename": "Lecture 27_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Secure?\u2022Ticket hijacking \u2022Malicious user may steal the service ticket of another user on the same workstation and try to use it \u2022Network address verification does not help\u2022Servers must verify that the user who is presenting the ticket is the same user to whom the ticket was issued \u2022No server authentication\u2022Attacker may misconfigure the network so that he receives messages addressed to a legitimate server \u2013man in the middle attack\u2022Capture private information from users and/or deny service\u2022Servers must prove their identity to users\u2022Solution: session keyno user authentication"}, {"id": "7ecb3500a1e704a851cda7379b3a06447b8c163e", "filename": "Lecture 27_slides.pdf", "page": 8, "start_line": 1, "end_line": 5, "text": "Kerberos v4. -once per user logon session CpasswordProgram AS client will use this unforgeable ticket to getother tickets without re-authenticatingDecrypts with Kc and obtainsKc,tgs and TickettgsImplicit authentication:only someone who knows Kc can decryptClient only needs to obtain Tickettgs once (say, every morning)Ticket is encrypted; client cannot forge it or tamper with it All users mustpre-register theirpasswords with AS Kc,tgs"}, {"id": "488ddff99e6e8c8b6332c9d3f1ef47801c1d215d", "filename": "Lecture 27_slides.pdf", "page": 9, "start_line": 1, "end_line": 5, "text": "Kerberos v4. -once per type of service CSystem commande.g. \u201clpr \u2013 Pprint\u201dProgram TGSclient will use this unforgeable ticket toget access to service VClient uses Tickettgs to obtain a service ticket, Ticketv and a short-term sessionkey for each network service (printer, email, etc.)Knows Kv Proves that client knows key Kc,tgs contained in encrypted TGS ticket Kc,v"}, {"id": "437fb083f4f75379ed55c760b3d4cfda6b6dace0", "filename": "Lecture 28_slides.pdf", "page": 1, "start_line": 1, "end_line": 3, "text": "Kerberos v4. -once per service session CSystem commande.g. \u201clpr \u2013 Pprint\u201dProgramAuthenticates server to clientChain of Reasoning:Server can produce this message only if he knows Kc,v Server can learn key Kc,v only if he can decrypt service ticketServer can decrypt service ticket only if he knows correct key KV If server knows correct key KV, then he is the right server For each service request, client uses the short-term key, Kc,v , for that service and the ticket he received from TGS Proves that client knows key Kc,v contained in encrypted ticket V"}, {"id": "62be727969e474757a8596fde60bec0c3320dee6", "filename": "Lecture 28_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Overview of Kerberos"}, {"id": "f353e7a6062dd484d0063cab1998987b696c90e7", "filename": "Lecture 28_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Important Ideas in Kerberos\u2022Short-term session keys \u2022Long-term secrets used only to derive short-term keys \u2022Separate session key for each user-server pair\u2022Re-used by multiple sessions between same user and server \u2022Proofs of identity based on authenticators \u2022Client encrypts his identity, addr, time with session key; knowledge of key proves client has authenticated to KDC/AS \u2022Also prevents replays (if clocks are globally synchronized)\u2022Server learns this key separately (via encrypted ticket that client can\u2019t decrypt), then verifies client\u2019s authenticator \u2022Symmetric cryptography only"}, {"id": "f9188e62637d3b0e0c00c8b7ccd6b1e9315cf659", "filename": "Lecture 28_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Kerberos in Large Networks\u2022One KDC isn\u2019t enough for large networks \u2022Network is divided into realms \u2022KDCs in different realms have different key databases \u2022To access a service in another realm, users must... \u2022Get ticket for home-realm TGS from home-realm KDC \u2022Get ticket for remote-realm TGS from home-realm TGS \u2022As if remote-realm TGS were just another network service \u2022Get ticket for remote service from that realm\u2019s TGS\u2022Use remote-realm ticket to access servicehome-realm KDChome-realm TGSTicket_hTGSremote-realm TGSTicket_rTGSremote serviceTicket_rS"}, {"id": "6357d3c2a9ef43bd467587dc2db80692e0c61169", "filename": "Lecture 28_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Practical Uses of Kerberos\u2022Microsoft Windows \u2013Active Directory\u2022Email, FTP , network file systems, many other applications have been kerberized\u2022Use of Kerberos is transparent for the end user \u2022Transparency is important for usability! \u2022Local authentication\u2022login and suin OpenBSD \u2022Authentication for network protocols \u2022rsh\u2022Secure windowing systems"}, {"id": "7a8a4077a44298e6dba1d1cf691d906bdc9892aa", "filename": "Lecture 28_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Readings\u2022Kerberos: The Network Authentication Protocol https://web.mit.edu/kerberos/"}, {"id": "920f82e21a4ecca084bdb6f1b0d0c6cbf424089b", "filename": "Lecture 28_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Practice \u2013no submission \u2022William Stallings, \u201cNetwork Security Essentials\u201d, 6 Edition, 2017\u2022Chapter 4\u2019s problems: 4.8, 4.9, 4.10"}, {"id": "4a0ce1ad5bda4f68539fdd605f2d3e35f8be060a", "filename": "Lecture 28_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Key Distribution Using Asymmetric Encryption"}, {"id": "799766eb1343a0610f3cce3cc899c2a7a4bb1e45", "filename": "Lecture 28_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "PKI and Certificates(Section 4.5)"}, {"id": "e24d9797b4334577a4fcc7152e2ee93678443552", "filename": "Lecture 28_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "What is PKI? \u2022Use of public-key cryptography and X.509 certificates in a distributed server system to establish secure domains and trusted relationships"}, {"id": "61ad2fae4848d8a97e5bd14fd36b5955ab5259b5", "filename": "Lecture 28_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Why use public-key cryptography?\u2022Review: Public-key cryptography is great! We can communicate securely without a shared secret\u2022Public-key encryption: Everybody encrypts with the public key, but only the owner of the private key can decrypt\u2022Digital signatures: Only the owner of the private key can sign, but everybody can verify with the public key"}, {"id": "b8f689d22f10a2d3d24a468a9de5247132598646", "filename": "Lecture 28_slides.pdf", "page": 12, "start_line": 1, "end_line": 1, "text": "Problem: Distributing Public Keys\u2022Public-key cryptography alone is not secure against man-in-the-middle attacks\u2022Scenario\u2022Alice wants to send a message to Bob\u2022Alice asks Bob for his public key\u2022Bob sends his public key to Alice\u2022Alice encrypts her message with Bob\u2019s public key and sends it to Bob\u2022What can David do?\u2022Replace Bob's public key with David\u2019s public key\u2022Now Alice has encrypted the message with David\u2019s public key, and David can read it!"}, {"id": "075fca8899246a2a590368dda075c6eb3905aa75", "filename": "Lecture 28_slides.pdf", "page": 13, "start_line": 1, "end_line": 3, "text": "Problem: Distributing Public Keys AliceDavidBobGenerate PKB, SKB Man-in-the-Middle Attack"}, {"id": "d2bc0a2f091c20acff811e1fb6f073b788266ecd", "filename": "Lecture 28_slides.pdf", "page": 14, "start_line": 1, "end_line": 1, "text": "Solution: Distributing Public Keys\u2022Idea: Sign Bob\u2019s public key to prevent tampering\u2022Problem\u2022If Bob signs his public key, we need his public key to verify the signature\u2022But Bob\u2019s public key is what we were trying to verify in the first place!\u2022Circular problem: Alice can never trust any public key she receives\u2022You cannot gain trust if you trust nothing. You need a root of trust!\u2022Trust anchor: Someone that we implicitly trust\u2022From our trust anchor, we can begin to trust others"}, {"id": "03bcfff364554916d911ac43a60de97fae953e64", "filename": "Lecture 28_slides.pdf", "page": 15, "start_line": 1, "end_line": 1, "text": "Trust-on-First-Use\u2022Trust-on-first-use: The first time you communicate, trust the public key that is used and warn the user if it changes in the future\u2022Used in SSH and a couple other protocols\u2022Idea: Attacks aren\u2019t frequent, so assume that you aren\u2019t being attacked the first time communicate"}, {"id": "cc476eaa45c7398a54b35ff4a49580a8c825ac1a", "filename": "Lecture 28_slides.pdf", "page": 16, "start_line": 1, "end_line": 1, "text": "Certificates"}, {"id": "c75a6fe4c71a028689a02230f4e7b90ade8b5644", "filename": "Lecture 29_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Certificates"}, {"id": "a003e2bfe00132f47bf6ae7f1528fdad81c898bd", "filename": "Lecture 29_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Certificates\u2022Certificate: A signed endorsement of someone\u2019s public key\u2022A certificate contains at least two things: The identityof the person, and the key\u2022Abbreviated notation\u2022Signing with a private key SK: {\u201cMessage\u201d}SK-1\u2022Recall: A signed message must contain the message along with the signature; you can\u2019t send the signature by itself!\u2022Scenario: Alice wants Bob\u2019s public key. Alice trusts Charlie (PKC, SKC)\u2022Charlie is our trust anchor\u2022If we trust PKC, a certificate we would trust is {\u201cBob\u2019s public key is PKB\u201d}SKC-1"}, {"id": "13247efd56ba761d020bb8567f88a536f132d8e6", "filename": "Lecture 29_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "How do we use public-key certificate?"}, {"id": "3094fc62372706e371028d49d172598003f809b1", "filename": "Lecture 29_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "X.509 Certificates\u2022Certificate serial # -SN\u2022Period validity -TA\u2022Subject\u2019s public key info -Ap\u2022Signature signed by CA\u2019s private key\u2022Math notation:"}, {"id": "6865a77f4d88e698121f0b36d901cfcbe8334787", "filename": "Lecture 29_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "readings\u2022Barnes, R.; Hoffman-Andrews, J.; McCarney, D.; Kasten, J. (March 2019).Automatic Certificate Management Environment (ACME) RFC 8555.IETF\u2022Internet Security Research Group, \u201cAnnual Report\u201d, https://www.abetterinternet.org/annual-reports/\u2022MinkyuKim, \u201cA Survey of Kerberos V and Public-Key Kerberos Security\u201d, https://www.cse.wustl.edu/~jain/cse571-09/ftp/kerb5/index.html"}, {"id": "77855ee87e8c9e698aefb8192fe7ab53c838342f", "filename": "Lecture 29_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Obtaining a User Certificate"}, {"id": "bfe1690ea167117895d7b8a5ab9195856d9faabc", "filename": "Lecture 29_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "The Trusted Directory\u2022Idea: Make a central, trusted directory (TD) from where you can fetch anybody\u2019s public key\u2022The TD has a public/private keypair PKTD, SKTD\u2022The directory publishes PKTDso that everyone knows it (baked into computers, phones, OS, etc.)\u2022When you request Bob\u2019s public key, the directory sends a certificate for Bob\u2019s public key\u2022{\u201cBob\u2019s public key is PKB\u201d}SKTD-1\u2022If you trust the directory, then now you trust every public key from the directory\u2022What do we have to trust? (assumption)\u2022We have received TD\u2019s key correctly\u2022TD won\u2019t sign a key without verifying the identity of the owner"}, {"id": "58e4ef0189a9dfbcdeaad619145eabaccb232d73", "filename": "Lecture 29_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "The Trusted Directory\u2022Let\u2019s say that Charlie (an authority) runs the TD\u2022We want Nick\u2019s public key: Ask Charlie\u2022We want Alice\u2019s public key: Ask Charlie\u2022We want Bob\u2019s public key: Ask Charlie\u2022Charlie has better things to do (like making sure his private key isn\u2019t stolen)!\u2022Problems?\u2022Scalability: One directory won\u2019t have enough compute power to serve the entire world\u2022Single point of failure:\u2022If the directory fails, your application might become unavailable\u2022If the directory is compromised, you can\u2019t trust anyone\u2022If the directory is compromised, it is difficult to recoverCharlieNickAliceBob"}, {"id": "27c9c711cdae768e92a5b745ed1c9ecca151bc3b", "filename": "Lecture 29_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Certificate Authorities\u2022Addressing scalability: Hierarchical trust\u2022The roots of trust may delegatetrust and signing power to other authorities\u2022{\u201cCarol Christ\u2019s public key is PKCC, and I trust her to sign for TTU\u201d}SKc-1\u2022{\u201cJohn Canny\u2019spublic key is PKJC, and I trust him to sign for the CS department\u201d}SKCC-1\u2022{\u201cBob\u2019s public key is PKBob(but I don\u2019t trust him to sign for anyone else)\u201d}SKJC-1\u2022Charlie is still the root of trust (root certificate authority, or root CA)\u2022CC and JC receive delegated trust (intermediate CAs)\u2022Bob\u2019s identity can be trusted\u2022When Alice wants to request Bob\u2019s PK, she can obtain this list of certificates (certificate chain) from any untrusted service, and does not need to contact the respective parties because the signatures are unforgeable\u2022Addressing scalability: Multiple trust anchors\u2022There are ~150 root CAs who are implicitly trusted by most devices\u2022Public keys are hard-coded into operating systems and devicesCharlieCarol TTUJohn CSBob"}, {"id": "ab65163719af94933b4cd856aa824aacf60dc586", "filename": "Lecture 29_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Reviewclass&quiz4\u2022Friday (Nov. 15) in class\u2022DHKE & Kerberos"}, {"id": "5e7eb1ec188e860f3292ceab31e9c2e288143e8c", "filename": "Lecture 29_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "\u2022Thank you!"}, {"id": "71ea1ea33c50b85f521123e916ec450191d6255d", "filename": "Lecture 2_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Project \u2022Task1: OnDemand Professor Q&A Bot \u2022Your task is to build a Q&A Bot over private data that answers questions about the network security course using the open-sourcealternatives to ChatGPTthat can be run on your local machine. Data privacy can be compromised when sending data over the internet, so it is mandatory to keep it on your local system. \u2022Your Q&A Bot should be able to understand user questions and provide appropriate answers from the local database, then the citations should be added (must be accomplished) if the response is from the internet, then the web references should be added. \u2022Train your bot using network security lecture slides, network security textbook, and the Internet. \u2022By using Wireshark capture data for Step 4's of the LLM workflow shown in Figure 1. Provide detailed explanations of the trace data. Also, Maintain a record of Step 1's prompt and its mapping to the trace data in Step 4's.\u2022Task2: Quiz Bot \u2022Your task is to build a quiz bot based on a network security course using the open-source alternatives to ChatGPTthat can be run on your local machine. Data privacy can be compromised when sending data over the internet, so it is mandatory to keep it on your local system. \u2022Two types of questions should be offered by the bot: randomly generated questions and specific topic questions and the answers should be pulled from the network security database. Train your bot using network security quizzes, lecture slides, network securitytextbook, and the Internet. \u2022The quiz must include multiple-choice questions, true/false questions, and open-ended questions. \u2022Finally, the bot should be able to provide feedback on the user's answers."}, {"id": "dc2c001e0a09da933bbfae870c0fd39181309d41", "filename": "Lecture 2_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Outline\u2022Review\u2022OSI Security Architecture\u2022Attack model"}, {"id": "302d05eb02a6116a5a851f3d39830b434769217d", "filename": "Lecture 2_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "OSI Security Architecture"}, {"id": "394c22b9093900c881627a40632f526accf6fb37", "filename": "Lecture 2_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "OSI Security Architecture\u2022International Telecommunication Union \u2013Telecommunication (ITU-T) recommends X.800\u2022Security Architecture for Open Systems Interconnection (OSI)\u2022Defines a systematic way of defining and providing security requirements\u2022Used by IT managers and vendors in their productsSecurity attacksSecurity mechanismsSecurity servicesa process (or a device incorporating such a process) to detect, prevent, or recover from an attackenhances the security of the data processing systems and the information transfers, such as policies"}, {"id": "8112dc1df530048c8593ef5423159b0f2c055d31", "filename": "Lecture 2_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Other Security Architectures\u2022NIST, Cybersecurity Framework (CSF)\u2022https://www.nist.gov/cyberframework\u2022VIRTUAL WORKSHOP #2| February 15, 2023 (9:00 AM \u20135:30 PM EST). Discuss potential significant updates to the CSF \u2022https://www.nist.gov/news-events/events/2023/02/journey-nist-cybersecurity-framework-csf-20-workshop-2\u2022OWASP -Open Web Application Security Project\u2022Web application security\u2022OWASP Application Security Verification Standard (ASVS) -https://owasp.org/www-project-application-security-verification-standard/\u2022OWASP Web Security Testing -https://owasp.org/www-project-web-security-testing-guide/\u2022OWASP foundation"}, {"id": "e1e3aa2b1d21739bd4d65d76ae675c05d438f42d", "filename": "Lecture 2_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Security attack\u2022Definition: any action that compromises the security of information owned by an organization\u2022Two types of security attacks\u2022Passive attack\u2022Active attack"}, {"id": "bf4c2b26338e7fd1ff64ec3827e7f43c983bbdbd", "filename": "Lecture 3_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Security attack\u2022Definition: any action that compromises the security of information owned by an organization\u2022Two types of security attacks\u2022Passive attack\u2022Active attack"}, {"id": "5e10349ef2449c309b9e0173cfb423834104c8c7", "filename": "Lecture 3_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Passive attack\u2022i.e.eavesdropping on or monitoring of transmissions\u2022Goal: obtain information being transmitted\u2022release of message contents\u2022traffic analysis \u2013a promiscuous sniffer\u2022Very difficult to detect \u2013no alteration of the data\u2022But easy to prevent, why?"}, {"id": "ff85a2481a0e4c2cd38542eef18e6313cabe7dd4", "filename": "Lecture 3_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Active attack\u2022active attack includes:\u2022replay\u2022Modification of messages\u2022Denial of service\u2022Masquerade"}, {"id": "da31c2feeb5b84f2c1af17a90d2ac336660b39dd", "filename": "Lecture 3_slides.pdf", "page": 4, "start_line": 1, "end_line": 2, "text": "Example: two points communication \u2022Generic types of attacks Eavedropping"}, {"id": "232b841b8c899cb0eb5fdffcf969e59e92dc48e8", "filename": "Lecture 3_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Example of modification attack in 6LoWPAN"}, {"id": "18a4c6f6dea6e9e6538ec038778a071442f0c8f8", "filename": "Lecture 3_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Example: a group of attackers"}, {"id": "da6a922e76411ff8d791f4585b3e68ccaf2ca0ef", "filename": "Lecture 3_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Know Your Threat Model\u2022Threat model:A model of who your attacker is and what resources they have\u2022One of the best ways to counter an attacker is to attack their reasons"}, {"id": "290a727f449679f2e6fea199066134a631e30cce", "filename": "Lecture 3_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Example: adversary model\u2022\u201cThe adversary is assumed to be intelligent and has limited number of resources. Before capturing the nodes, it exploits the various vulnerabilities of the networks. It knows the topology of the network, routing information. It aims to capture the sink node so as todisrupt the whole traffic. If it is not able to capture the sink node, it will capture the nearby nodes of the sink. It tries to disrupt the whole traffic of the network with minimum number of captured nodes. It is also assumed that the adversary tends to attack more on the nodes closer to the data sink than nodes that are far away\u201d"}, {"id": "2964262c1635620726dd315f8bc0e126705a1b2d", "filename": "Lecture 3_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "No class on Wednesday\u2022No class on Wednesday (Sept 18, 2024) due to theJob fair. Wish you good luck!\u2022Reminder toformaproject group by Sept. 9th, 2024"}, {"id": "03957b008ee52bfcfaf24a3351bd6473adbf439a", "filename": "Lecture 4_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Know Your Threat Model\u2022Threat model:A model of who your attacker is and what resources they have\u2022One of the best ways to counter an attacker is to attack their reasons"}, {"id": "eb5530d77d26fc8060611a0c872735dc5dde222e", "filename": "Lecture 4_slides.pdf", "page": 2, "start_line": 1, "end_line": 2, "text": "Story\u2026\u2022The bear race\u2022Takeaway:Even if a defense is not perfect, it is important to always stay on top of best security measures I don\u2019t have to outrun the bear. I just have to outrun you"}, {"id": "fa4ad84a6b6a28b07dc886f86a4e066410dcf098", "filename": "Lecture 4_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Human Factors\u2022The users\u2022Users like convenience (ease of use)\u2022If a security system is unusable, it will be unused\u2022Users will find way to subvert security systems if it makes their lives easier\u2022The programmers\u2022Programmers make mistakes\u2022Programmers use tools that allow them to make mistakes (e.g.C and C++)\u2022Everyone else\u2022Social engineering attacks exploit other people\u2019s trust and access for personal gain"}, {"id": "aae5dfc69253feaae87d2e6966c17d59ddbd0a16", "filename": "Lecture 4_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Design in security from the start\u2022When building a new system, include security as part of the design considerations rather than patching it after the fact\u2022A lot of systems today were not designed with security from the start, resulting in patches that don\u2019t fully fix the problem!\u2022Keep these security principles in mind whenever you write code!"}, {"id": "439efe6eeced265647b6ae7d367b0721261298ff", "filename": "Lecture 4_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Security Services and Mechanisms"}, {"id": "f26d89cdb780756dd0f7313173e862b772551a99", "filename": "Lecture 4_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Supplementary materials\u2022Internet Security Glossary, v2 \u2013produced by Internet Society (ISOC) https://datatracker.ietf.org/doc/html/rfc4949\u2022X.800 \u2013OSI network securityhttps://www.itu.int/rec/dologin_pub.asp?lang=f&id=T-REC-X.800-199103-I!!PDF-E&type=items"}, {"id": "3a752038586a8d876bf0979d7b12ea76f83db511", "filename": "Lecture 4_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Summary for Chapter 1\u2022Have learned:\u2022Security requirements\u2022Attack models\u2022X.800 secure architecture, security services, mechanisms"}, {"id": "17a440ace5086ae78c6382a1765af75163e0e593", "filename": "Lecture 4_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Review Questions\u2022William Stallings (WS), \u201cNetwork Security Essentials\u201d, 6thGlobal Edition\u2022RQ 1.1 -1.3\u2022Prob 1.5"}, {"id": "a012f9bbe985c0808f3d0252ab116495d910a5f2", "filename": "Lecture 5_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Symmetric Encryption and Message ConfidentialityChapter 2"}, {"id": "bbae9a89bc53f406d1ad99e9db4199a746a5351e", "filename": "Lecture 5_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Model for network security"}, {"id": "9a6d2452233fd8019cc11c990cc63140adef7850", "filename": "Lecture 5_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Model for network security\u2022Using this model requires us to:\u2022design a suitable algorithm for the security transformation \u2022generate the secret information (keys) used by the algorithm \u2022develop methods to distribute and share the secret information \u2022specify a protocol enabling the principals to use the transformation and secret information for a security service"}, {"id": "9776ceded77560cd9b9a476f7433397ced5e009e", "filename": "Lecture 5_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Symmetric Encryption Principles"}, {"id": "3458557c78c1fdff4418c318f46b2e8982feb381", "filename": "Lecture 5_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Symmetric encryption\u2022Sender and recipient share a common/same key\u2022Was the only type of cryptography, prior to invention of public-key in 1970\u2019s"}, {"id": "de77d9acb4a566d7877a24e096e5fe39628dc674", "filename": "Lecture 5_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Simplified model of symmetric encryption"}, {"id": "d78a7db7c44310c30e263741c1a7b64e0920aac3", "filename": "Lecture 5_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Symmetric encryption\u2022Has five ingredients\u2022Plaintext: the original message or data\u2022Encryption algorithm: performs various substitutions and transformations on the plaintext\u2022Secret key\u2022Ciphertext: the coded message\u2022Decryption algorithm: takes the ciphertext and the same secret key and produces the original plaintext"}, {"id": "f917d126836423ba4f08761b438822730c2d69d1", "filename": "Lecture 5_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Other basic terminology\u2022cipher-algorithm for transforming plaintext to ciphertext \u2022encipher (encrypt)-converting plaintext to ciphertext\u2022decipher (decrypt)-recovering plaintext from ciphertext\u2022cryptography-study of encryption principles/methods\u2022cryptanalysis (codebreaking)-the study of principles/ methods of deciphering ciphertext withoutknowing key"}, {"id": "216ca6febde3e713fdd097ae337a554f6a8669f0", "filename": "Lecture 5_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Requirements\u2022Two requirements for secure use of symmetric encryption:\u2022a strong encryption algorithm\u2022a secret key known only to sender / receiverY = EK(X)X = DK(Y)\u2022assume encryption algorithm is known\u2022the security of symmetric encryption depends on the secrecy of the key\u2022implies a secure channel to distribute key"}, {"id": "b995811508525a743e73c6df9325edb9b81a493d", "filename": "Lecture 5_slides.pdf", "page": 10, "start_line": 1, "end_line": 2, "text": "A strong encryption algorithm attackerencryption algorithmplaintext / enquirycyphertext / response"}, {"id": "bf686c9e3f88a2b45baaedb46738b452d0ca5d07", "filename": "Lecture 5_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "TA & Grader\u2022TA Name: Faiyaz, Amir (Project, Review & Quiz) \u2022Email: afaiyaz@ttu.edu\u2022Reminder: Submit the namesandemailsofyour group members to FALL 2024 CS5342 PROJECT GROUP NAMES.xlsx\u2022Grader Name: Han, Namgyu(Homework, Quiz, Exam grading)\u2022Email:Namgyu.Han@ttu.edu"}, {"id": "f0c44e63506ef154ff152149a8bc89f6ea347a78", "filename": "Lecture 6_slides.pdf", "page": 1, "start_line": 1, "end_line": 2, "text": "A strong encryption algorithm attackerencryption algorithmplaintext / enquirycyphertext / response"}, {"id": "bff560c24d3f92a54be030b2f0ca70f41ec70f57", "filename": "Lecture 6_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Secure Encryption Scheme\u2022Unconditional security\u2022no matter how much computer power is available, the cipher cannot be broken since the ciphertext provides insufficient information to uniquely determine the corresponding plaintext\u2022Computational security\u2022the cost of breaking the cipher exceeds the value of the encrypted information;\u2022or the time required to break the cipher exceeds the useful lifetime of the information"}, {"id": "3fa6924f3a0f887c2554c6e5d06400b4edf52ccc", "filename": "Lecture 6_slides.pdf", "page": 3, "start_line": 1, "end_line": 4, "text": "Desired characteristics\u2022Cipher needs to completely obscure statistical properties of original message\u2022more practically Shannon suggested combining elements to obtain:\u2022Confusion \u2013how does changing a bit of the key affect the ciphertext?\u2022Diffusion \u2013how does changing one bit of the plaintext affect the ciphertext? confusion ciphertext plaintextdiffusion"}, {"id": "242a676ff36cca85955ace68b3b7558ba49b2b7d", "filename": "Lecture 6_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Ways to achieve\u2022Symmetric Encryption: \u2022substitution / transposition / hybrid\u2022Asymmetric Encryption: \u2022Mathematical hardness -problems that are efficient to compute in one direction, but inefficient to reverse by the attacker\u2022Examples: Modular arithmetic, factoring, discrete logarithm problem, Elliptic Logs over Elliptic Curves"}, {"id": "279ff92fa9635b0121a067fe5710738dd1fb3528", "filename": "Lecture 6_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Two basic types\u2022Block Ciphers \u2022Typically64, 128 bitblocks\u2022A k-bit plaintext block maps to a k-bit ciphertext block \u2022Usually employ Feistel structure \u2022Stream Ciphers\u2022A key is used to generate a stream of pseudo-random bits \u2013key stream\u2022Just XOR plaintext bits with the key stream for encryption \u2022For decryption generate the key stream and XOR with the ciphertext!"}, {"id": "e929fceb98635958aefd512fff6644bae7921d25", "filename": "Lecture 6_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Symmetric Block Encryption"}, {"id": "9ee665be04288eb5257c6b56d7d3b4c52b7bb28a", "filename": "Lecture 6_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Block cipher\u2022the most commonly usedsymmetric encryption algorithms\u2022input: fixed-size blocks (Typically 64, 128 bitblocks), output: equal size blocks\u2022provide secrecy and/or authentication services\u2022Data Encryption Standard (DES), triple DES (3DES), and the Advanced Encryption Standard (AES)s\u2022Usually employ Feistel structure"}, {"id": "9d6aec242ee248ad715868ed962ea8a8b9f8a10a", "filename": "Lecture 6_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Feistel Cipher Structure"}, {"id": "c954d582a30542775a6e249fffe74b398a4731b6", "filename": "Lecture 6_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Feistel Cipher Structure\u2022most symmetric block ciphers are based on a Feistel Cipher Structure\u2022based on the two primitive cryptographic operations\u2022substitution(S-box)\u2022permutation (P-box)\u2022provide confusionand diffusionof message"}, {"id": "d32796715254d6e5cd905174ff4e60612c6adf7d", "filename": "Lecture 6_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Feistel Cipher Structure\u2022Horst Feistel devised the feistelcipher in the 1973\u2022based on concept of invertible product cipher\u2022partitions input block into two halves\u2022process through multiple rounds which\u2022perform a substitution on left data half\u2022based on round function of right half & subkey\u2022then have permutation swapping halves\u2022implements Shannon\u2019s substitution-permutation network concept"}, {"id": "893c3321b551357743cf9308406639ad6d1d684d", "filename": "Lecture 6_slides.pdf", "page": 11, "start_line": 1, "end_line": 1, "text": "Feistel Encryption and Decryption"}, {"id": "0a52a264a84ed69d0a9240bde1fbe570bd9b9756", "filename": "Lecture 7_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Symmetric Block Encryption"}, {"id": "536a10b243cf965eed0818b9f35c2701150692de", "filename": "Lecture 7_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "Block cipher\u2022the most commonly used symmetric encryption algorithms\u2022input: fixed-size blocks (Typically 64, 128 bit blocks), output: equal size blocks\u2022provide secrecy and/or authentication services\u2022Data Encryption Standard (DES), triple DES (3DES), and the Advanced Encryption Standard (AES)s\u2022Usually employ Feistel structure"}, {"id": "285353fd54eebea03240d68ce4ab9353401121d5", "filename": "Lecture 7_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Feistel Cipher Structure"}, {"id": "df1ad13b3a703c0d89fbff51aaf24ced907626d1", "filename": "Lecture 7_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "Feistel Cipher Structure\u2022most symmetric block ciphers are based on a Feistel Cipher Structure\u2022based on the two primitive cryptographic operations\u2022substitution(S-box)\u2022permutation (P-box)\u2022provide confusionand diffusionof message"}, {"id": "b214aef57cbc04876af0e94b6ccf6c6ab9b1ac84", "filename": "Lecture 7_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "Feistel Cipher Structure\u2022Horst Feistel devised the feistelcipher in the 1973\u2022based on concept of invertible product cipher\u2022partitions input block into two halves\u2022process through multiple rounds which\u2022perform a substitution on left data half\u2022based on round function of right half & subkey\u2022then have permutation swapping halves\u2022implements Shannon\u2019s substitution-permutation network concept"}, {"id": "9a8b8e0ae9192c533660ab1412b6ed4eb3db9938", "filename": "Lecture 7_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "Feistel Encryption and Decryption"}, {"id": "af38cceb8aecebc30053d593c8d61abcf222b0a4", "filename": "Lecture 8_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "Feistel Encryption and Decryption"}, {"id": "3656ff277719c7f520a2c3cb792697b19efda931", "filename": "Lecture 8_slides.pdf", "page": 2, "start_line": 1, "end_line": 2, "text": "DES encryption \u202264 bits plaintext\u202256 bits effectivekey length"}, {"id": "23e389841dbd5018d05fcccf13c6f6a33ba1d669", "filename": "Lecture 8_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "DES Weakness\u2022short length key (56 bits) is not secure enough. Brutal force search takes short time."}, {"id": "0aa69adcce55f4489098eba44f6b23d8b157f574", "filename": "Lecture 8_slides.pdf", "page": 4, "start_line": 1, "end_line": 2, "text": "Triple DES (3DES) Decrypting with the wrong key will further convolute the output"}, {"id": "8dcf7ed4cbc731af1e18a5c94fe01afa898d50bd", "filename": "Lecture 8_slides.pdf", "page": 5, "start_line": 1, "end_line": 2, "text": "3DES\u2022Triple DES with three different keys \u2013brute-force complexity 2168\u20223DES is the FIPS-approved symmetric encryption algorithm\u2022Weakness: slow speed for encryption FIPS \u2013 Federal Information Processing Standards. The United States' Federal Information Processing Standards are publicly announced standards developed by the National Institute of Standards and Technology for use in computer systems by non-military American government agencies and government contractors"}, {"id": "ad3a5bd7f162dc11001e232296e199763b680ccd", "filename": "Lecture 8_slides.pdf", "page": 6, "start_line": 1, "end_line": 1, "text": "AES\u2022clearly a replacement for DES was needed\u2022have theoretical attacks that can break it\u2022have demonstrated exhaustive key search attacks\u2022can use Triple-DES \u2013but slow with small blocks\u2022US NIST issued call for ciphers in 1997\u202215 candidates accepted in Jun 98 \u20225 were short-listed in Aug-99 \u2022Rijndael was selected as the AES in Oct-2000\u2022issued as FIPS PUB 197 standard in Nov-2001"}, {"id": "21d4b37d9e47fca644651a6446f0b6d7143b979c", "filename": "Lecture 8_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "Criteria to evaluate AES\u2022General security\u2022Software implementations\u2022Restricted-space environments\u2022Hardware implementations\u2022Attacks on implementations\u2022Encryption versus decryption\u2022Key agility\u2022Other versatility and flexibility\u2022Potential for instruction-level parallelismCryptographic Standards and Guidelines | CSRC (nist.gov)"}, {"id": "ef94f3052caa586610df1b79c117e00a2f4a5e09", "filename": "Lecture 8_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "AES Specification\u2022symmetric block cipher \u2022128-bit data, 128/192/256-bit keys \u2022stronger & faster than Triple-DES \u2022provide full specification & design details \u2022both C & Java implementations\u2022NIST have released all submissions & unclassified analyseshttps://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Standards-and-Guidelines/documents/aes-development/Rijndael-ammended.pdf"}, {"id": "4f5f0b959a7a449d946af88a61ab37b60c4f3751", "filename": "Lecture 8_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "The AES Cipher -Rijndael \u2022an iterative rather than feistelcipher\u2022treats data in 4 groups of 4 bytes\u2022operates an entire block in every round\u2022designed to be:\u2022resistant against known-plaintext attacks\u2022speed and code compactness on many CPUs\u2022design simplicity"}, {"id": "fd6cd2d50a1132d923ce548f09e0b10c11eec38c", "filename": "Lecture 8_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "Rijndael\u2022processes data as 4 groups of 4 bytes (state) = 128 bits\u2022has 10/12/14 rounds in which state undergoes: \u2022byte substitution (1 S-box used on every byte) \u2022shift rows (permute bytes row by row) \u2022mix columns (alter each byte in a column as a function of all of the bytes in the column) \u2022add round key (XOR state with key material) \u2022128-bit keys \u201310 rounds, 192-bit keys \u201312 rounds, 256-bit keys \u201314 rounds"}, {"id": "376d3cdcd062d0a8afaefc3e4ba2c16f4c0eff96", "filename": "Lecture 9_slides.pdf", "page": 1, "start_line": 1, "end_line": 1, "text": "AES Specification\u2022symmetric block cipher \u2022128-bit data, 128/192/256-bit keys \u2022stronger & faster than Triple-DES \u2022provide full specification & design details \u2022both C & Java implementations\u2022NIST have released all submissions & unclassified analyseshttps://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Standards-and-Guidelines/documents/aes-development/Rijndael-ammended.pdf"}, {"id": "dd185540905686b43a3a1554bddd911d9b6f1bd8", "filename": "Lecture 9_slides.pdf", "page": 2, "start_line": 1, "end_line": 1, "text": "The AES Cipher -Rijndael \u2022an iterative rather than feistelcipher\u2022treats data in 4 groups of 4 bytes\u2022operates an entire block in every round\u2022designed to be:\u2022resistant against known-plaintext attacks\u2022speed and code compactness on many CPUs\u2022design simplicity"}, {"id": "f44ec658ac81e3e2676352983b20dcf8e40a531f", "filename": "Lecture 9_slides.pdf", "page": 3, "start_line": 1, "end_line": 1, "text": "Rijndael\u2022processes data as 4 groups of 4 bytes (state) = 128 bits\u2022has 10/12/14 rounds in which state undergoes: \u2022byte substitution (1 S-box used on every byte) \u2022shift rows (permute bytes row by row) \u2022mix columns (alter each byte in a column as a function of all of the bytes in the column) \u2022add round key (XOR state with key material) \u2022128-bit keys \u201310 rounds, 192-bit keys \u201312 rounds, 256-bit keys \u201314 rounds"}, {"id": "ee58a7a6d6b75b744992df8493330b5660f98f7e", "filename": "Lecture 9_slides.pdf", "page": 4, "start_line": 1, "end_line": 1, "text": "AES Encryption and Decryption"}, {"id": "4f5edeb0f6d66eb7aadf46d6c64c6446f21444cf", "filename": "Lecture 9_slides.pdf", "page": 5, "start_line": 1, "end_line": 1, "text": "AES encryption round"}, {"id": "b5c3652531fdde49a39d5dc52e6375c0a2617bdd", "filename": "Lecture 9_slides.pdf", "page": 7, "start_line": 1, "end_line": 1, "text": "AES pros\u2022Most operations can be combined into XOR and table lookups -hence very fast & efficient"}, {"id": "b07758525f305856ee336f97309539a2f2f71f61", "filename": "Lecture 9_slides.pdf", "page": 8, "start_line": 1, "end_line": 1, "text": "Take-home Exercises\u2022Find an AES API to encrypt a text (A), then decrypt it and check whether the original text (A) equals the decrypted text (B). Whether A = B?\u2022Compare the decryption time with different key lengths, and with DES and 3DES. \u2022Suggestions: find a large A file. Run decryption a couple of times and take the average."}, {"id": "4036d0cc6d2a6bdb7179f3651c5252e171ffefa3", "filename": "Lecture 9_slides.pdf", "page": 9, "start_line": 1, "end_line": 1, "text": "Reading materials\u2022FIPS 197, Advanced Encryption Standard (AES) (nist.gov)"}, {"id": "40e2ca6165e26de051cabd622c941877fb145069", "filename": "Lecture 9_slides.pdf", "page": 10, "start_line": 1, "end_line": 1, "text": "WPEC 2024: NIST Workshop on Privacy-Enhancing Cryptography\u2022Time: September 24\u201326, 2024\u2022Free to register\u2022Virtual conference via Zoom\u2022https://csrc.nist.gov/events/2024/wpec2024"}]}